2023-12-06 14:29:32,935 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-06 14:29:32,935 - INFO - descriptor: SuperPoint+Boost-B-attlay3
2023-12-06 14:29:32,935 - INFO - num_epochs: 100
2023-12-06 14:29:32,935 - INFO - train_ratio: 1.0
2023-12-06 14:29:32,935 - INFO - batch_size: 64
2023-12-06 14:29:32,935 - INFO - num_workers: 4
2023-12-06 14:29:32,935 - INFO - print_interval: 20
2023-12-06 14:29:32,935 - INFO - eval_interval: 1
2023-12-06 14:29:32,935 - INFO - save_interval: 10
2023-12-06 14:29:32,936 - INFO - lr: 0.001
2023-12-06 14:29:32,936 - INFO - warmup_step: 20
2023-12-06 14:29:32,936 - INFO - random_seed: 0
2023-12-06 14:29:32,936 - INFO - expand_piexl: 2
2023-12-06 14:29:32,936 - INFO - test_threshold: 0.5
2023-12-06 14:29:32,936 - INFO - test_image: 
2023-12-06 14:29:32,936 - INFO - test_images: []
2023-12-06 14:29:32,936 - INFO - eval: False
2023-12-06 14:29:32,936 - INFO - save_path: work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth
2023-12-06 14:29:32,936 - INFO - log_file: work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_dataset_repeat_1_positive_keypoint_repeat_1_scratch.log
2023-12-06 14:29:32,936 - INFO - checkpoint: 
2023-12-06 14:29:32,936 - INFO - multiprocessing_context: spawn
2023-12-06 14:29:32,936 - INFO - data_root: data/rsdd
2023-12-06 14:29:32,936 - INFO - img_suffix: .jpg
2023-12-06 14:29:32,936 - INFO - train_ann_file: ['train/']
2023-12-06 14:29:32,937 - INFO - test_ann_file: ['test/all/', 'test/offshore/', 'test/inshore/']
2023-12-06 14:29:32,937 - INFO - dataset_class: {'ship': 1}
2023-12-06 14:29:32,937 - INFO - weight_decay: 0.0001
2023-12-06 14:29:32,937 - INFO - dataset_repeat: 1
2023-12-06 14:29:32,937 - INFO - positive_keypoint_repeat: 1
2023-12-06 14:29:32,937 - INFO - image_aug: False
2023-12-06 14:29:32,937 - INFO - print: True
2023-12-06 14:29:32,937 - INFO - feature_booster_pretrained: 
2023-12-06 14:29:32,937 - INFO - device: cuda
2023-12-06 14:29:32,937 - INFO - color: ['#00FF00', '#FF00FF', '#FF4500', '#0000FF', '#00FFFF', '#FF1493', '#808000']
# -*- coding: UTF-8 -*-
import pycolmap # pycolmap 占用的TLS最大,放在最前面 
# 原理参考: https://github.com/pytorch/pytorch/issues/2575#issue-254038499
from extract_features import normalize_keypoints, extractor_build, extract_img_feature
from torch.utils.data import DataLoader, Dataset
from os import path as osp
from pathlib import Path
from torch import nn
import numpy as np
import matplotlib
matplotlib.use('Agg')  # 设置Agg为后端
import matplotlib.pyplot as plt
import importlib
import warnings
import logging
import random
import torch
import copy
import time
import glob
import yaml
import cv2
import os
warnings.filterwarnings('ignore')

def parse_arguments():
    parser = importlib.import_module('argparse').ArgumentParser(description="Extract feature and refine descriptor using neural network to find ship keypoint.")

    parser.add_argument(
        '--descriptor', type=str, default='SuperPoint+Boost-B-attlay3',
        help='descriptor to extract' )

    parser.add_argument(
        '--num_epochs', type=int, default=40,)

    parser.add_argument(
        '--train_ratio', type=float, default=1.0,
        help='The ratio of data used for training out of the training set' )

    parser.add_argument(
        '--batch_size', type=int, default=64,)

    parser.add_argument(
        '--num_workers', type=int, default=4,)

    parser.add_argument(
        '--print_interval', type=int, default=20,)

    parser.add_argument(
        '--eval_interval', type=int, default=1,)

    parser.add_argument(
        '--save_interval', type=int, default=10,)

    parser.add_argument(
        '--lr', type=float, default=1e-3,)

    parser.add_argument(
        '--warmup_step', type=int, default=20,)

    parser.add_argument(
        '--random_seed', type=int, default=0,)

    parser.add_argument(
        '--expand_piexl', type=int, default=5,)

    parser.add_argument(
        '--test_threshold', type=float, default=0.5,)

    parser.add_argument(
        '--test_image', type=str, default='',)
    
    parser.add_argument(
        '--test_images', nargs='*', default=[],)
    
    parser.add_argument(
        '--eval', action='store_true',)

    parser.add_argument(
        '--save_path', type=str, default='',)

    parser.add_argument(
        '--log_file', type=str, default='',)

    parser.add_argument(
        '--checkpoint', type=str, default='',)

    parser.add_argument(
        '--multiprocessing_context', type=str, default=None,)

    parser.add_argument(
        '--data_root', type=str, default='data/hrsid',)

    parser.add_argument(
        '--img_suffix', type=str, default='.png',)

    parser.add_argument(
        '--train_ann_file', nargs='*', default=['train/','val/'],)

    parser.add_argument(
        '--test_ann_file', nargs='*', default=['test/all','test/offshore','test/inshore'],)

    parser.add_argument(
        '--dataset_class',
        nargs='*',
        # default=['ore-oil','Cell-Container','Fishing','LawEnforce','Dredger','Container'], # [166, 89 , 288 , 25 , 263 , 2053]
        default=["ship"],
        help='Dataset classes list. Default is ["ship"].'
    )
    
    parser.add_argument(
        '--weight_decay', type=float, default=1e-4,)
    
    parser.add_argument(
        '--dataset_repeat', type=int, default=1,)
    
    parser.add_argument(
        '--positive_keypoint_repeat', type=int, default=1,)

    parser.add_argument(
        '--image_aug', action='store_true',)
    
    parser.add_argument(
        '--print', action='store_true')

    args = parser.parse_args()
    args.dataset_class = {item: index + 1 for index, item in enumerate(args.dataset_class)}    
    return args

def calculate_md5(file_path):

    hash_md5 = importlib.import_module('hashlib').md5()
    with open(file_path, "rb") as f:
        # 以块的方式读取文件，以防文件太大
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

# 定义舰船目标关键点检测模型（示例）
class ShipKeyPointsModel(nn.Module):
    def __init__(self, args,):
        super().__init__()
        FeatureBooster = importlib.import_module('FeatureBooster.featurebooster').FeatureBooster
        MLP = importlib.import_module('FeatureBooster.featurebooster').MLP

        self.device = args.device

        with open(str(Path(__file__).parent / "config.yaml"), 'r') as f:
            config = yaml.load(f, Loader=yaml.FullLoader)
        self.config = config[args.descriptor]
        # Model
        self.feature_booster = FeatureBooster(self.config)
        # load the model
        if os.path.isfile(args.feature_booster_pretrained):
            self.feature_booster.load_state_dict(torch.load(args.feature_booster_pretrained), strict =False)
            args.logger.info(f"feature_booster weights loaded from {args.feature_booster_pretrained}!")
        self.fc_out = MLP([self.config['output_dim'], self.config['output_dim']//2, len(args.dataset_class) + 1]) 
        self.to(args.device)
        self.args = args

    def forward(self, x):
        feat = self.feature_booster(x[...,self.config['keypoint_dim']:], x[...,:self.config['keypoint_dim']])
        x = self.fc_out(feat)
        return feat, nn.functional.softmax(x, dim=-1)

def rotate_box_90_degrees(coords):
    x1, y1, x2, y2, x3, y3, x4, y4 = coords

    # 计算中心点
    cx = (x1 + x3) / 2
    cy = (y1 + y3) / 2

    # 将矩形平移到原点，旋转90度，然后平移回去
    rotated_coords = []
    for x, y in [(x1, y1), (x2, y2), (x3, y3), (x4, y4)]:
        x_prime = -y + cy + cx
        y_prime = x - cx + cy
        rotated_coords.extend([x_prime, y_prime])

    return rotated_coords

def load_txt_info_srsdd(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix.lstrip(".")}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt',f'.{args.img_suffix.lstrip(".")}').replace('labels','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s[2:]:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]] if len(args.dataset_class) > 1 else 1
            instance['ignore_flag'] = 0
            instance['bbox'] = [float(i) for i in bbox_info[:8]]
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def load_txt_info_rsdd(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix.lstrip(".")}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt',f'.{args.img_suffix.lstrip(".")}').replace('labels','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]] if len(args.dataset_class) > 1 else 1
            instance['ignore_flag'] = 0
            instance['bbox'] = rotate_box_90_degrees([float(i) for i in bbox_info[2:]]) # 这里标注出的矩形框和真实中间差90度。可能是标注换换的问题。
            #人为旋转90度
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def load_txt_info_hrsid(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix.lstrip(".")}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt',f'.{args.img_suffix.lstrip(".")}').replace('labelTxt','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]]
            instance['ignore_flag'] = 0
            instance['bbox'] = [float(i) for i in bbox_info[:8]]
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def get_keypoint_label(keypoints, data_info, args):
    bboxes = []
    bbox_label = []
    for instances in data_info['instances']:
        bboxes.append(np.array([(instances['bbox'][i], instances['bbox'][i + 1]) for i in range(0, len(instances['bbox']), 2)], dtype=np.int32))
        bbox_label.append(instances['bbox_label'])

    tmp = np.zeros(data_info['image_shape'], dtype=np.uint8)
    for box, label in zip(bboxes, bbox_label):
        cv2.fillPoly(tmp, np.array([box]), label)
    target = []
    mode = importlib.import_module('scipy.stats').mode
    for kp in keypoints:
        region = tmp[max(0, int(kp[1] - args.expand_piexl)):min(int(kp[1] + args.expand_piexl), data_info['image_shape'][0]),
                    max(0, int(kp[0] - args.expand_piexl)):min(int(kp[0] +args.expand_piexl), data_info['image_shape'][1])].reshape(-1)
        region = region[region.astype(np.bool_)]
        if region.size > 0:
            # 计算区域的众数
            mode_val = mode(region, axis=None)[0][0]
            target.append(mode_val)
        else:
            target.append(0)
    return np.array(target), bboxes

# 定义数据集（示例）
class ShipKeyPointsDataset(Dataset):
    def __init__(self, args, dataset_repeat = 1, pipeline = [], debug = False, **kwargs):
        super(ShipKeyPointsDataset, self).__init__()
        if len(pipeline):
            importlib.import_module('mmdet.utils').register_all_modules(init_default_scope=False)
            importlib.import_module('mmdet.utils').register_all_modules(init_default_scope=False)
        self.transform = importlib.import_module('mmengine.dataset').Compose(pipeline)
        self.debug = debug
        self.args = args
        with open(str(Path(__file__).parent / "config.yaml"), 'r') as f:
            config = yaml.load(f, Loader=yaml.FullLoader)
        self.config = config[args.descriptor]
        self.extractor = extractor_build(self.args.descriptor, device = args.device)
        if 'ann_file' in kwargs and kwargs['ann_file'] !='':
            # train case
            ann_dir = kwargs['ann_file']
            if isinstance(ann_dir, str):
                ann_dir = [ann_dir]
        else:
            ann_dir = []
        self.txt_files = []
        for path in ann_dir:
            self.txt_files.extend(glob.glob(osp.join(args.data_root, path, "**/*.txt"), recursive=True)) 
        if (not args.eval) and (args.train_ratio<1):
            self.txt_files = random.sample(self.txt_files, int(np.ceil(len(self.txt_files)*args.train_ratio)))
        if (not args.eval) and (dataset_repeat > 1):
            self.txt_files = self.txt_files*dataset_repeat
            args.logger.info(f"The dataset located in {ann_dir} was duplicated {dataset_repeat} times!")

    def __len__(self):
        return len(self.txt_files)

    def load_data_info(self, idx):
        txt_file = self.txt_files[idx]
        load_txt_info_func = globals()['load_txt_info_' + self.args.data_root.rstrip('/').split('/')[-1]]
        return load_txt_info_func(txt_file, self.args)

    def __getitem__(self, idx):
        data_info = self.load_data_info(idx)
        bboxes = []
        if (not self.args.eval) and (len(self.transform.transforms)):
            data = self.transform(data_info)
            data_instance = data['data_samples'].gt_instances
            if (len(data_info['instances'])>0) and (len(data_instance.labels)<1):
                image = cv2.cvtColor(cv2.imread(data_info['img_path']), cv2.COLOR_BGR2RGB)
                data_info['image_shape'] = image.shape[:2]
            else:            
                image = data['inputs'].cpu().numpy().transpose(1, 2, 0)
                data_info['image_shape'] = image.shape[:2]
                data_info['instances'] = [] 
                for box_id in range(len(data_instance.labels)):
                    instance = {}
                    instance['bbox_label'] = int(data_instance.labels[box_id])
                    instance['bbox'] = list(data_instance.bboxes.vertices[box_id].reshape(-1).cpu().numpy())
                    data_info['instances'].append(instance)
            del data
        else:
            image = cv2.cvtColor(cv2.imread(data_info['img_path']), cv2.COLOR_BGR2RGB)
            data_info['image_shape'] = image.shape[:2]

        keypoints, descriptors, image = extract_img_feature(self.args.descriptor, image, self.extractor)
        if keypoints.size == 0:
            message = f"{data_info['img_path']} has no keypoint founded with {self.args.descriptor}"
            print(message)
            with open(self.args.log_file, "a") as file:   
                file.write(message+'\n')
            return torch.zeros([2, self.config['keypoint_dim'] + self.config['descriptor_dim'] + 2], dtype = torch.float32, requires_grad = False).float(), data_info['img_path']
        else:
            target, bboxes = get_keypoint_label(keypoints, data_info, self.args)
            
            if (not self.args.eval) and (self.args.positive_keypoint_repeat>1) and (np.random.rand() > 0.5): # 将正样本的关键点特征进行重复，增加正样本数目
                keypoints = np.concatenate([keypoints, np.tile(keypoints[target.astype(np.bool_)], (self.args.positive_keypoint_repeat,1))], axis=0)
                descriptors = np.concatenate([descriptors, np.tile(descriptors[target.astype(np.bool_)], (self.args.positive_keypoint_repeat,1))], axis=0)
                target = np.concatenate([target, np.tile(target[target.astype(np.bool_)], self.args.positive_keypoint_repeat)], axis=0)

            # visualization
            if self.debug:
                print(f"VISUALIZATION: {data_info['img_path']}")
                kps = np.array([cv2.KeyPoint(*kp) for kp in keypoints])
                image = cv2.drawKeypoints(image, kps[target.astype(np.bool_)], None, color=(255,0,0,))
                image = cv2.drawKeypoints(image, kps[~(target.astype(np.bool_))], None, color=(0,0,255))
                image = cv2.polylines(image, bboxes, isClosed=True, color=(0, 255, 0), thickness=2)
                cv2.imwrite(f"vis_dir/{data_info['img_id']}.png", cv2.cvtColor(image, cv2.COLOR_RGB2BGR))
                
            # boosted the descriptor using trained model
            keypoints = normalize_keypoints(keypoints, image.shape).astype(np.float32)
            if 'orb' in self.args.descriptor.lower():
                descriptors = np.unpackbits(descriptors, axis=1, bitorder='little').astype(np.float32)
                descriptors = descriptors * 2.0 - 1.0
            # 最后的全一是为了区分对齐batch的padding数据
            result = torch.from_numpy(np.concatenate([keypoints, descriptors, target.reshape(-1, 1), np.ones([len(target),1])], axis=-1))
            if (not self.args.eval) and (np.random.rand() > 0.5):
                result = result[torch.randperm(len(result))]
            result.requires_grad = False
            result = result.float()
            return result, data_info['img_path']

def hex_to_rgb(hex_color):
    hex_color = hex_color.lstrip('#')
    return tuple(int(hex_color[i:i+2], 16) for i in (0, 2, 4))

def get_metric(all_labels, all_output, args):
    accuracy_score = importlib.import_module('sklearn.metrics').accuracy_score
    recall_score = importlib.import_module('sklearn.metrics').recall_score
    precision_score = importlib.import_module('sklearn.metrics').precision_score
    precision_recall_curve = importlib.import_module('sklearn.metrics').precision_recall_curve
    average_precision_score = importlib.import_module('sklearn.metrics').average_precision_score
    f1_score = importlib.import_module('sklearn.metrics').f1_score
    if isinstance(all_output, torch.Tensor):
        if all_output.requires_grad:
            all_output = all_output.detach()
        all_output = all_output.cpu().numpy()
    if isinstance(all_labels, torch.Tensor):
        all_labels = all_labels.cpu().numpy()

    metrics_per_class = {}
    Average_Precision_Curve = {}
    avg_metrics = {}
  
    dataset_class = args.dataset_class.copy()
    if len(args.dataset_class) > 1:
        dataset_class['foreground'] = 0

    all_predict = np.zeros_like(all_output, dtype=bool)
    np.put_along_axis(all_predict, np.argmax(all_output, axis=-1).reshape(-1, 1), True, axis=-1)
     
    for class_name, idx in dataset_class.items():
        # 为当前类别准备标签和预测
        if class_name in 'foreground':
            class_labels = (all_labels != idx).astype(int)
            class_output = ~all_predict[:, 0]
            ap = average_precision_score(class_labels, 1-all_output[:, idx])
            precisions, recalls, _ = precision_recall_curve(class_labels, 1-all_output[:, idx])
        else:
            class_labels = (all_labels == idx).astype(int)
            class_output = all_predict[:, idx]
            ap = average_precision_score(class_labels, all_output[:, idx])
            precisions, recalls, _ = precision_recall_curve(class_labels, all_output[:, idx])
        # 计算指标
        accuracy = accuracy_score(class_labels, class_output)
        precision = precision_score(class_labels, class_output)
        recall = recall_score(class_labels, class_output)
        f1 = f1_score(class_labels, class_output)

        metrics_per_class[class_name] = {
            'Accuracy': accuracy,
            'Precision': precision,
            'Recall': recall,
            'F1_score': f1,
            'Average_Precision': ap,
        }
        Average_Precision_Curve[class_name] = {'Precision': precisions,'Recall': recalls}
        metrics_str = ', '.join(f"{metric}: {value:.4f}" for metric, value in metrics_per_class[class_name].items())
        args.logger.info(f"Metrics for {class_name}: {metrics_str}")

    if len(args.dataset_class)>1:    
        # 计算平均值
        for metric in metrics_per_class[list(args.dataset_class.keys())[0]].keys():
            avg_metrics[metric] = np.mean([class_metrics[metric] for class_metrics in metrics_per_class.values()])
        metrics_str = ', '.join(f"{metric}: {value:.4f}" for metric, value in avg_metrics.items())
        args.logger.info(f"Average metrics: {metrics_str}")
        
        if (not ( os.path.isfile(args.test_image) or (len(args.test_images)>0) )):
            for class_name, idx in dataset_class.items():
                plt.plot(Average_Precision_Curve[class_name]['Recall'], 
                        Average_Precision_Curve[class_name]['Precision'], label=class_name, color=args.color[idx % len(args.color)])
            # 设置图例和标签
            plt.xlabel('Recall')
            plt.ylabel('Precision')
            plt.title('Precision-Recall Curve')
            plt.legend()
            if (args.eval): 
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_eval.png'
            else:
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_train.png'
            plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
            plt.close('all') 
            args.logger.info(f"PR_curve has been saved to {PR_curve_path}:")        
        return avg_metrics, Average_Precision_Curve['foreground']
    return metrics_per_class[list(args.dataset_class.keys())[0]], Average_Precision_Curve[list(args.dataset_class.keys())[0]] 

def evaluate(model, eva_loader, args):
    model.eval()

    all_output = torch.tensor([], device=args.device)
    all_labels = torch.tensor([], device=args.device)

    with torch.no_grad():
        for i, (data, img_paths) in enumerate(eva_loader):
            data = data.to(args.device)
            _, outputs = model(data[:,:,:-2])
            valid = data[:,:,-1].reshape(-1).bool()
            all_output = torch.cat([all_output, outputs.view(-1,len(args.dataset_class)+1)[valid,:]], dim=0)
            all_labels = torch.cat([all_labels, data[:,:,-2].long().reshape(-1)[valid]], dim=0)

            if (i + 1) % args.print_interval == 0:
                args.logger.info(f"Epoch(test) : [{i + 1}/{len(eva_loader)}]")

    return get_metric(all_labels, all_output, args)

def test(model, test_image, args):
    model.eval()
    extractor = extractor_build(args.descriptor)
    keypoints, descriptors, image = extract_img_feature(args.descriptor, cv2.cvtColor(cv2.imread(test_image), cv2.COLOR_BGR2RGB), extractor)

    load_txt_info_func = globals()['load_txt_info_' + args.data_root.rstrip('/').split('/')[-1]]
    txt_file = test_image.replace(f'.{args.img_suffix.lstrip(".")}','.txt').replace('images','**')
    txt_file = glob.glob(txt_file, recursive=True)[0] 
    data_info = load_txt_info_func(txt_file, args)
    data_info['image_shape'] = image.shape[:2]
    labels, bboxes = get_keypoint_label(keypoints, data_info, args)
    
    kps = np.array([cv2.KeyPoint(*kp) for kp in keypoints])
    # boosted the descriptor using trained model
    keypoints = normalize_keypoints(keypoints, image.shape).astype(np.float32)
    if 'orb' in args.descriptor.lower():
        descriptors = np.unpackbits(descriptors, axis=1, bitorder='little').astype(np.float32)
        descriptors = descriptors * 2.0 - 1.0
    with torch.no_grad():
        output = model(torch.from_numpy(np.concatenate([keypoints, descriptors,], axis=-1)).to(args.device).float())[1].cpu().numpy()

    metric_dict, PR_dict = get_metric(labels, output, args)
    # predict = (1-output[...,0]) > args.test_threshold
    predict = np.argmax(output, axis=-1)
    dataset_class = dict()
    for class_name, idx in args.dataset_class.items():
        dataset_class[str(idx)] = class_name
        index = (predict==idx) # & (output[:,idx]>args.test_threshold)
        image = cv2.drawKeypoints(image, kps[index&(labels==idx)], None, color=hex_to_rgb(args.color[idx % len(args.color)]),)
        image = cv2.drawKeypoints(image, kps[index&(labels!=idx)], None, color=hex_to_rgb("#40E0D0"),)
        # image = cv2.drawKeypoints(image, kps[(~predict)&(labels)], None, color=(0,0,255)) # Aqua蓝色 漏检
        # image = cv2.drawKeypoints(image, kps[predict&labels], None, color=(0,0,255,),) # 黄色 正确预测(正样本)
        # image = cv2.drawKeypoints(image, kps[(~predict)&(~labels)], None, color= (0, 255, 0) ) # 绿色 正确预测(负样本)
        # image = cv2.drawKeypoints(image, kps[(label)], None, color=(255,0,0,))
        # image = cv2.drawKeypoints(image, kps[~predict], None, color=(0,255,0))
    for instance in data_info['instances']:
        color=hex_to_rgb(args.color[instance['bbox_label'] % len(args.color)])
        box = np.array([(instance['bbox'][i], instance['bbox'][i + 1]) for i in range(0, len(instance['bbox']), 2)], dtype=np.int32)
        image = cv2.polylines(image, [box], isClosed=True, color=color, thickness=1)
        # cls_name = dataset_class[str(instance['bbox_label'])]
        # assert args.dataset_class[cls_name] == instance['bbox_label']
        # cv2.putText(image, cls_name, (int(instance['bbox'][0]), int(instance['bbox'][1])), cv2.FONT_HERSHEY_SIMPLEX, 0.5, color, 1)
    save_path = f"{args.data_root.rstrip('/').split('/')[-1]}_keypoint_results/{args.descriptor}/vis/" + test_image.split('/')[-1]
    if not os.path.exists(os.path.dirname(save_path)):
        os.makedirs(os.path.dirname(save_path))
    cv2.imwrite(save_path, cv2.cvtColor(image, cv2.COLOR_RGB2BGR))
    return metric_dict, PR_dict

def keypoint_match(model, args, test_image1, test_image2):
    model.eval()
    extractor = extractor_build(args.descriptor)
    load_txt_info_func = globals()['load_txt_info_' + args.data_root.rstrip('/').split('/')[-1]]

    imgs = []
    kps = []
    descriptors = []
    labels = []
    for img_path in [test_image1, test_image2]:
        kp, des, img = extract_img_feature(args.descriptor, cv2.cvtColor(cv2.imread(img_path), cv2.COLOR_BGR2RGB), extractor)
        txt_file = img_path.replace(f'.{args.img_suffix.lstrip(".")}','.txt').replace('images','**')
        txt_file = glob.glob(txt_file, recursive=True)[0]
        data_info = load_txt_info_func(txt_file, args)
        data_info['image_shape'] = img.shape[:2]
        label, bboxes = get_keypoint_label(kp, data_info, args)

        if 'orb' in args.descriptor.lower():
            des = np.unpackbits(des, axis=1, bitorder='little').astype(np.float32)
            des = des * 2.0 - 1.0
        kp_norm = normalize_keypoints(kp, img.shape).astype(np.float32)
        des, _ = model(torch.from_numpy(np.concatenate([kp_norm, des], axis=-1)).to(args.device).float())
        des = des.detach().cpu().numpy()
        imgs.append(img)
        kps.append(kp)
        descriptors.append(des)
        labels.append(label)
        
    border = 10
    kps[1] = np.array([cv2.KeyPoint(kp_i[0] + border + imgs[0].shape[1], kp_i[1], kp_i[2]) for kp_i in kps[1]])
    kps[0] = np.array([cv2.KeyPoint(kp_i[0] , kp_i[1], kp_i[2]) for kp_i in kps[0]])
      
    imgs[1] = cv2.copyMakeBorder(imgs[1], 0, 0, border, 0, cv2.BORDER_CONSTANT, value=[255, 255, 255])
    dis = torch.cdist(torch.from_numpy(descriptors[0]),torch.from_numpy(descriptors[1]))
    matches_AB = torch.argmin(dis,dim=-1).cpu().numpy()
    matches_BA = torch.argmin(dis,dim=0).cpu().numpy()
    
    h1, w1 = imgs[0].shape[:2]
    h2, w2 = imgs[1].shape[:2]
    height = max(h1, h2)
    width = w1 + w2
    img_matches = np.zeros((height, width, 3), dtype="uint8")
    img_matches[:h1, :w1, :] = imgs[0]
    img_matches[:h2, w1:(w1 + w2), :] = imgs[1]

    for kp_i, label_i in zip(kps, labels):
        for kp_j, label_j in zip(kp_i, label_i):
            pt2 = tuple(np.round(kp_j.pt).astype(int))
            cv2.circle(img_matches, pt2, 5, color = hex_to_rgb("#40E0D0") if label_j>0 else hex_to_rgb("#FF0000"), thickness = 1) # if label_j>0 else hex_to_rgb("#FF0000")
    def draw_matches(img, kps, matches, color = hex_to_rgb("#FFFF00"), inverse = False):
        if inverse:
            color = hex_to_rgb("#00FF00")
        matches = matches[labels[int(inverse)].astype(np.bool_)] 
        for src,des,idx in zip(kps[int(inverse)][labels[int(inverse)].astype(np.bool_)], kps[1-int(inverse)][matches], matches):
            pt1 = tuple(np.round(src.pt).astype(int))
            pt2 = tuple(np.round(des.pt).astype(int))
            if labels[1-int(inverse)][idx]:
                cv2.arrowedLine(img, pt1, pt2, color , thickness = 1, tipLength=0.01)
            else:
                cv2.arrowedLine(img, pt1, pt2, hex_to_rgb("#FF0000"), thickness = 1, tipLength=0.01)
    draw_matches(img_matches, kps, matches_AB)
    draw_matches(img_matches, kps, matches_BA, inverse = True)

    # bf = cv2.BFMatcher(cv2.NORM_L2, crossCheck=True)
    # matches = bf.match(descriptors[0], descriptors[1])
    # matches = sorted(matches, key=lambda x: x.distance, reverse = True)
    # img_matches = cv2.drawMatches(imgs[0], kps[0], imgs[1], kps[1], matches, None, matchColor=(0, 255, 0), flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)

    save_path = f"{args.data_root.rstrip('/').split('/')[-1]}_keypoint_results/{args.descriptor}/kp_matched/{test_image1.split('/')[-1][:-4]}vs{test_image2.split('/')[-1]}"
    if not os.path.exists(os.path.dirname(save_path)):
        os.makedirs(os.path.dirname(save_path))        
    cv2.imwrite(save_path, cv2.cvtColor(img_matches, cv2.COLOR_RGB2BGR))
    args.logger.info(f"result saved to {save_path}")
    return img_matches

def worker_init_fn(worker_id, group, args):
    # torch.cuda.set_device(worker_id) 指定数加载设备
    torch.cuda.manual_seed_all(worker_id)

def custom_collate_fn(batch):
    rnn_utils = importlib.import_module('torch.nn.utils.rnn')
    results = [item[0] for item in batch]  # 提取每个样本的result
    img_paths = [item[1] for item in batch]  # 提取每个样本的img_path
    padded_results = rnn_utils.pad_sequence(results, batch_first=True, padding_value=0)
    return padded_results, img_paths

def train(model, args):
    CosineAnnealingWarmRestarts = importlib.import_module('torch.optim.lr_scheduler').CosineAnnealingWarmRestarts
    LinearLR = importlib.import_module('torch.optim.lr_scheduler').LinearLR
    MultiStepLR = importlib.import_module('torch.optim.lr_scheduler').MultiStepLR
    ChainedScheduler = importlib.import_module('torch.optim.lr_scheduler').ChainedScheduler
    clip_grad_norm_ = importlib.import_module('torch.nn.utils').clip_grad_norm_
    optimizer_class = importlib.import_module('torch.optim').AdamW
    partial = importlib.import_module('functools').partial
    train_pipeline = []
    if args.image_aug:
        train_pipeline = [
            dict(type='mmdet.LoadImageFromFile', backend_args=None),
            dict(type='mmdet.LoadAnnotations', with_bbox=True, box_type='qbox'),
            dict(
                type='mmrotate.ConvertBoxType',
                box_type_mapping=dict(gt_bboxes='rbox')),
            dict(
                type='mmrotate.RandomRotate',
                prob=0.5,
                angle_range=180,
                rotate_type='mmrotate.Rotate'),
            dict(
                type='mmdet.RandomFlip',
                prob=0.75,
                direction=['horizontal', 'vertical', 'diagonal']),
            dict(
                type='mmdet.RandomAffine',),
            dict(
                type='mmdet.PhotoMetricDistortion',),

            dict(
                type='mmrotate.ConvertBoxType',
                box_type_mapping=dict(gt_bboxes='qbox')),
            dict(type='mmdet.PackDetInputs', meta_keys=())]
    train_dataset = ShipKeyPointsDataset(args, ann_file = args.train_ann_file, dataset_repeat = args.dataset_repeat, pipeline = train_pipeline)
    train_loader = DataLoader(train_dataset, batch_size=args.batch_size, shuffle=True, 
                              num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                              # worker_init_fn=partial(worker_init_fn, group='train', args = args),
                              # pin_memory=True, persistent_workers = True,
                              multiprocessing_context=args.multiprocessing_context)
    eva_loader = {}
    for ann_file in args.test_ann_file:
        eval_args = copy.deepcopy(args)
        eval_args.eval = True
        eva_dataset = ShipKeyPointsDataset(args = eval_args, ann_file = ann_file)
        eva_loader[ann_file] = DataLoader(eva_dataset, batch_size=args.batch_size, shuffle=False, 
                                num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                                # worker_init_fn=partial(worker_init_fn, group='eval', args = args), 
                                # pin_memory=True, persistent_workers = True,
                                multiprocessing_context=args.multiprocessing_context)
    if args.print:
        outputs = importlib.import_module('mmengine.analysis').get_model_complexity_info(
            model,
            input_shape=None,
            inputs=train_dataset.__getitem__(0)[0][:,:-2].float().to(args.device),  # the input tensor of the model
            show_table=True,  # show the complexity table
            show_arch=False)  # show the complexity arch
        for k, v in outputs.items():
            args.logger.info(f"{k}: {v}")
    # 定义损失函数和优化器
    weight = torch.softmax(1/torch.tensor([100000.0,  166, 89 , 288 , 25 , 263 , 2053], device = args.device),dim=-1) # [100000.0,  166, 89 , 288 , 25 , 263 , 2053]

    CenterLoss = getattr(importlib.import_module("CenterLoss"), "CenterLoss")
    loss_weight = 20
    centerloss = CenterLoss(len(args.dataset_class) + 1, model.config['output_dim']).to(args.device)
    nllloss = nn.NLLLoss().to(args.device)
    param_groups = [
        {'params': model.parameters(), 'lr': args.lr, 'weight_decay': 1e-4},
        {'params': centerloss.parameters(), 'lr': args.lr, 'weight_decay': 1e-4}
    ]
    optimizer = optimizer_class(param_groups) # 
    # warmup_scheduler = LinearLR(optimizer, start_factor=1.0 / 20, end_factor=1.0, total_iters=args.warmup_step) 
    if 'srsdd' in args.data_root: 
        scheduler = MultiStepLR(optimizer, milestones=[10, 50, 80, 90], gamma=0.5)
    else:
        scheduler = CosineAnnealingWarmRestarts(optimizer, T_0=20, T_mult=2, eta_min = 1e-5)
    # scheduler = MultiStepLR(optimizer, milestones=[40, 70, 90], gamma=0.5)
    # scheduler = ChainedScheduler([warmup_scheduler, step_scheduler])

    start_epoch = 0
    best_AP = 0.0
    if os.path.isfile(args.checkpoint):
        checkpoint = torch.load(args.checkpoint)
        model.load_state_dict(checkpoint['model_state_dict'])
        centerloss.load_state_dict(checkpoint['centerloss_state_dict'])
        optimizer.load_state_dict(checkpoint['optimizer_state_dict']),
        scheduler.load_state_dict(checkpoint['scheduler_state_dict'])
        start_epoch = checkpoint['epoch']+1
        best_AP = checkpoint['best_AP']
        args.logger.info(f'Continue training from epoch [{start_epoch}] !')

    # getGPUs = importlib.import_module('GPUtil').getGPUs
    # virtual_memory = importlib.import_module('psutil').virtual_memory
    # collect = importlib.import_module('gc').collect
    for epoch in range(start_epoch, args.num_epochs):
        start_time = time.time()
        model.train()
        for i, (data, img_paths)  in enumerate(train_loader):
            torch.cuda.empty_cache() # 在显存资源有限的情况下使用
            data = data.to(args.device)
            # collect() # 显式垃圾回收
            # memory = virtual_memory()
            # args.logger.info(f"总内存: {memory.total / (1024 ** 3):.2f} GB, 可用内存: {memory.available / (1024 ** 3):.2f} GB, 内存使用率: {memory.percent}%")
            # gpu = getGPUs()[0]
            # args.logger.info(f">>>before: GPU: {gpu.name}, 显存总量: {gpu.memoryTotal}MB, 显存使用: {gpu.memoryUsed}MB, 显存空闲: {gpu.memoryFree}MB")
            feat, outputs = model(data[:,:,:-2])
            # args.logger.info(f">>>after: GPU: {gpu.name}, 显存总量: {gpu.memoryTotal}MB, 显存使用: {gpu.memoryUsed}MB, 显存空闲: {gpu.memoryFree}MB")
            valid = data[:,:,-1].reshape(-1).bool()
            label_inc = data[:,:,-2].long().view(-1)[valid]
            feat = feat.view(-1,model.config['output_dim'])[valid,:]
            outputs = outputs.view(-1,len(args.dataset_class)+1)[valid,:]
            
            # label = nn.functional.one_hot(label_inc, num_classes= len(args.dataset_class) + 1).float()
            
            # if len(args.dataset_class) > 1: # soft_label
            #     softening_value = 0.1
            #     non_background_mask = (label_inc != 0).unsqueeze(dim=-1).repeat(1,len(args.dataset_class)+1)
            #     non_background_mask[...,0] = False
            #     label[non_background_mask] = label[non_background_mask]  * (1 - softening_value) + \
            #                                     (1 - label[non_background_mask]) * softening_value / (len(args.dataset_class)-1)  
                                                          
            # loss_cls = torch.mean(- 0.75*label * ((1-outputs)**2) *torch.log(outputs) - 0.25*((1-label) *(outputs**2)* torch.log(1-outputs)), dim = 0)
            # inter_cls_loss = torch.sum(loss_cls*weight)
            inter_cls_loss = nllloss(torch.log(outputs), label_inc)
            inner_cls_loss = centerloss(feat, label_inc)
            loss = loss_weight * inter_cls_loss + inner_cls_loss
            
            optimizer.zero_grad()
            loss.backward()
            clip_grad_norm_(model.parameters(), 35, 2)
            clip_grad_norm_(centerloss.parameters(), 35, 2)
            optimizer.step()
            del outputs, data, valid
            if (i + 1) % args.print_interval == 0:
                current_time = time.time()
                eta_seconds = (current_time - start_time) / (i+1) * ( (args.num_epochs - epoch ) * len(train_loader) - (i + 1))
                eta_str = str(int(eta_seconds // 3600)) + ':' + str(int((eta_seconds % 3600) // 60)) + ':' + str(int(eta_seconds % 60))
                # loss_str = ' '.join([f"{cls_name}:{loss_value:.4f}" for cls_name,loss_value in zip(['background'] + list(args.dataset_class.keys()), loss_cls)])
                args.logger.info(f"Epoch(train)"
                      f"[{epoch + 1}/{args.num_epochs}][{i + 1}/{len(train_loader)}]"
                      f"lr: {optimizer.param_groups[0]['lr']:.4e}  eta: {eta_str}  " 
                      f"time: {current_time - start_time:.4f}  inter_cls_loss: {inter_cls_loss:.4f} inner_cls_loss: {inner_cls_loss.item():.4f}")
        scheduler.step()
        if ((epoch+1) % args.eval_interval == 0) or (epoch == 0) or (epoch == args.num_epochs-1): #            
            for idx, ann_file in enumerate(args.test_ann_file): 
                args.logger.info(f"Epoch(test) {ann_file}:")
                metric_dict_all, PR_dict_all = evaluate(model, eva_loader[ann_file], args)
                if len(args.test_ann_file) >1:
                    plt.plot(PR_dict_all['Recall'], PR_dict_all['Precision'], label=ann_file, color=args.color[idx % len(args.color)])
            if len(args.test_ann_file) >1:
                plt.xlabel('Recall')
                plt.ylabel('Precision')
                plt.title('Precision-Recall Curve')
                plt.legend()
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_train.png'
                plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
                plt.close('all') 
                args.logger.info(f"PR_curve has been saved to {PR_curve_path}:")      
                               
            # 检查是否有更好的模型，如果有，则保存权重
            if metric_dict_all['Average_Precision'] > best_AP:
                best_AP = metric_dict_all['Average_Precision']
                # 保存当前模型的权重
                torch.save(model.state_dict(), args.save_path)
                args.logger.info(f"Best model saved to  {args.save_path} with MD5 {calculate_md5(args.save_path)}, with {args.test_ann_file[-1]} image AP {best_AP:.4f}")
            if (epoch >= args.num_epochs-1):
                last_save_path = 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + '_last_model_weight.pth'
                torch.save(model.state_dict(), last_save_path)
                args.logger.info(f"Last model saved :{last_save_path}")

        if ((epoch+1) % args.save_interval == 0):
            for file_path in glob.glob(args.save_path[:-4] + '*_epoch.pth'):
                os.remove(file_path)
            torch.save({
                'model_state_dict': model.state_dict(),
                'centerloss_state_dict': centerloss.state_dict(),
                'optimizer_state_dict': optimizer.state_dict(),
                'scheduler_state_dict': scheduler.state_dict(),
                'epoch': epoch,
                'best_AP': best_AP,
                }, args.save_path[:-4] + f'_{epoch+1}_epoch.pth')

if __name__ == '__main__':
    args = parse_arguments()

    random.seed(args.random_seed)
    np.random.seed(args.random_seed)
    torch.manual_seed(args.random_seed)
    if torch.cuda.is_available():
        torch.cuda.manual_seed_all(args.random_seed)

    if ('alike' in args.descriptor.lower()) or ('superpoint' in args.descriptor.lower()) or ('hardnet' in args.descriptor.lower()) or ('sosnet' in args.descriptor.lower()):
        args.multiprocessing_context = 'spawn'

    args.feature_booster_pretrained = '' # Path(__file__).parent / str("FeatureBooster/models/" + args.descriptor + ".pth")
    pretrained_str = 'finetune' if os.path.isfile(args.feature_booster_pretrained) else 'scratch'
    args.save_path = args.save_path if len(args.save_path) else 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + f"_bs{args.batch_size}" + f'_best_model_weights_{pretrained_str}.pth'
    args.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    args.color = ['#00FF00', '#FF00FF', '#FF4500', '#0000FF', '#00FFFF','#FF1493', '#808000'] 
    model = ShipKeyPointsModel(args)
    
    # 创建日志器
    logger = logging.getLogger()
    logger.setLevel(logging.INFO)
    # 创建控制台处理程序
    console_handler = logging.StreamHandler()
    console_handler.setLevel(logging.INFO)
    console_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))    
    logger.addHandler(console_handler)
    args.logger = logger
    if (not args.eval) and (not ( os.path.isfile(args.test_image) or (len(args.test_images)>0) )): # train
        args.log_file = args.log_file if len(args.log_file) else 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + f"_bs{args.batch_size}" + f'_dataset_repeat_{args.dataset_repeat}_positive_keypoint_repeat_{args.positive_keypoint_repeat}_{pretrained_str}.log'
        if not os.path.exists(os.path.dirname(args.log_file)):
            os.makedirs(os.path.dirname(args.log_file))
        # 创建文件处理程序
        file_handler = logging.FileHandler(args.log_file, mode='a')
        file_handler.setLevel(logging.INFO)
        file_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))
        # 添加处理程序到日志器
        logger.addHandler(file_handler)
        logger.info(">>>>>=========================Start Train!===========================<<<<<")
        for k, v in vars(args).items():
            if k not in 'logger':
                logger.info(f"{k}: {v}")

        if args.print: 
            with open(__file__, 'r') as file:
                lines = file.readlines()
            with open(args.log_file, "a") as file:   
                for line in lines:
                    file.write(line[:-1]+'\n')
                file.write('\n')
        train(model, args)
        args.logger.info(f"model weights saved to {args.save_path} with MD5 {calculate_md5(args.save_path)}!")
        args.checkpoint = args.save_path
        args.eval = True

    model_weights_md5 = "init_md5"
    if os.path.isfile(args.checkpoint):
        if 'cpu' in args.device.type:
            model.load_state_dict(torch.load(args.checkpoint, map_location=lambda storage, loc:storage), strict=False)
        else:
            model.load_state_dict(torch.load(args.checkpoint), strict=False)
        model_weights_md5 = calculate_md5(args.checkpoint)
        args.logger.info(f"model weights loaded from {args.checkpoint} with MD5 {model_weights_md5}!")
        model_weights_md5 = model_weights_md5[:5]
    
    for img in args.test_images:
        if os.path.isfile(img):
            args.logger.info(f"Epoch(test) - {img}:")
            metric_dict, PR_dict = test(model,img, args)
    for idx in range(len(args.test_images)-1):
        keypoint_match(model, args, args.test_images[idx], args.test_images[idx+1])
    if os.path.isfile(args.test_image):
        args.logger.info(f"Epoch(test) - {args.test_image}:")
        metric_dict, PR_dict = test(model, args.test_image, args)
    if args.eval:
        for idx, ann_file in enumerate(args.test_ann_file):
            args.logger.info(f"Epoch(test) {ann_file}:")
            eva_dataset = ShipKeyPointsDataset(args = args, ann_file = ann_file)
            eva_loader = DataLoader(eva_dataset, batch_size=args.batch_size, shuffle=False, 
                                    num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                                    pin_memory=True, persistent_workers = True, multiprocessing_context=args.multiprocessing_context)
            metric_dict, PR_dict_all = evaluate(model, eva_loader, args)
            if len(args.test_ann_file) >1:
                plt.plot(PR_dict_all['Recall'], PR_dict_all['Precision'], label=ann_file, color=args.color[idx % len(args.color)])
        if len(args.test_ann_file) >1:
            plt.xlabel('Recall')
            plt.ylabel('Precision')
            plt.title('Precision-Recall Curve')
            plt.legend()
            PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_eval_{model_weights_md5}.png'
            plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
            plt.close('all') 
            args.logger.info(f"PR_curve has been saved to {PR_curve_path}!"

2023-12-06 14:29:34,394 - INFO - flops: 224376416
2023-12-06 14:29:34,394 - INFO - flops_str: 0.224G
2023-12-06 14:29:34,394 - INFO - activations: 821058
2023-12-06 14:29:34,394 - INFO - activations_str: 0.821M
2023-12-06 14:29:34,394 - INFO - params: 1987522
2023-12-06 14:29:34,394 - INFO - params_str: 1.988M
2023-12-06 14:29:34,394 - INFO - out_table: 
+---------------------------+----------------------+------------+--------------+
| module                    | #parameters or shape | #flops     | #activations |
+---------------------------+----------------------+------------+--------------+
| model                     | 1.988M               | 0.224G     | 0.821M       |
|  feature_booster          |  1.954M              |  0.221G    |  0.806M      |
|   feature_booster.kenc.e… |   0.109M             |   12.276M  |   83.168K    |
|    feature_booster.kenc.… |    0.128K            |    10.848K |    3.616K    |
|    feature_booster.kenc.… |    2.112K            |    0.231M  |    7.232K    |
|    feature_booster.kenc.… |    8.32K             |    0.926M  |    14.464K   |
|    feature_booster.kenc.… |    33.024K           |    3.703M  |    28.928K   |
|    feature_booster.kenc.… |    65.792K           |    7.406M  |    28.928K   |
|   feature_booster.denc.e… |   0.197M             |   22.217M  |   86.784K    |
|    feature_booster.denc.… |    65.792K           |    7.406M  |    28.928K   |
|    feature_booster.denc.… |    65.792K           |    7.406M  |    28.928K   |
|    feature_booster.denc.… |    65.792K           |    7.406M  |    28.928K   |
|   feature_booster.attn_p… |   1.581M             |   0.179G   |   0.607M     |
|    feature_booster.attn_… |    0.527M            |    59.534M |    0.202M    |
|    feature_booster.attn_… |    0.527M            |    59.534M |    0.202M    |
|    feature_booster.attn_… |    0.527M            |    59.534M |    0.202M    |
|   feature_booster.final_… |   65.792K            |   7.406M   |   28.928K    |
|    feature_booster.final… |    (256, 256)        |            |              |
|    feature_booster.final… |    (256,)            |            |              |
|   feature_booster.layer_… |   0.512K             |   0.145M   |   0          |
|    feature_booster.layer… |    (256,)            |            |              |
|    feature_booster.layer… |    (256,)            |            |              |
|  fc_out                   |  33.154K             |  3.732M    |  14.69K      |
|   fc_out.0                |   32.896K            |   3.703M   |   14.464K    |
|    fc_out.0.weight        |    (128, 256)        |            |              |
|    fc_out.0.bias          |    (128,)            |            |              |
|   fc_out.2                |   0.258K             |   28.928K  |   0.226K     |
|    fc_out.2.weight        |    (2, 128)          |            |              |
|    fc_out.2.bias          |    (2,)              |            |              |
+---------------------------+----------------------+------------+--------------+

2023-12-06 14:29:34,395 - INFO - out_arch: 
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:30:03,386 - INFO - Epoch(train)[1/100][20/79]lr: 1.0000e-03  eta: 3:10:19  time: 28.9847  inter_cls_loss: 0.5121 inner_cls_loss: 57.1774
2023-12-06 14:30:17,007 - INFO - Epoch(train)[1/100][40/79]lr: 1.0000e-03  eta: 2:19:31  time: 42.6048  inter_cls_loss: 0.3740 inner_cls_loss: 45.7557
2023-12-06 14:30:30,929 - INFO - Epoch(train)[1/100][60/79]lr: 1.0000e-03  eta: 2:3:5  time: 56.5246  inter_cls_loss: 0.1957 inner_cls_loss: 34.4278
2023-12-06 14:30:43,557 - INFO - Epoch(test) test/all/:
2023-12-06 14:31:07,294 - INFO - Epoch(test) : [20/32]
2023-12-06 14:31:15,806 - INFO - Metrics for ship: Accuracy: 0.9242, Precision: 0.8605, Recall: 0.7934, F1_score: 0.8256, Average_Precision: 0.8885
2023-12-06 14:31:15,835 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:31:39,766 - INFO - Epoch(test) : [20/29]
2023-12-06 14:31:46,154 - INFO - Metrics for ship: Accuracy: 0.9457, Precision: 0.8941, Recall: 0.9043, F1_score: 0.8992, Average_Precision: 0.9296
2023-12-06 14:31:46,157 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:31:54,153 - INFO - Metrics for ship: Accuracy: 0.8839, Precision: 0.6239, Recall: 0.6409, F1_score: 0.6322, Average_Precision: 0.6373
2023-12-06 14:31:54,899 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:31:54,959 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 beb710010ce4c34f3b29400ac1502d7f, with test/inshore/ image AP 0.6373
2023-12-06 14:32:22,377 - INFO - Epoch(train)[2/100][20/79]lr: 9.9391e-04  eta: 2:58:13  time: 27.4163  inter_cls_loss: 0.2089 inner_cls_loss: 32.2304
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:32:36,414 - INFO - Epoch(train)[2/100][40/79]lr: 9.9391e-04  eta: 2:14:24  time: 41.4549  inter_cls_loss: 0.1442 inner_cls_loss: 26.4488
2023-12-06 14:32:50,948 - INFO - Epoch(train)[2/100][60/79]lr: 9.9391e-04  eta: 2:0:41  time: 55.9852  inter_cls_loss: 0.1577 inner_cls_loss: 25.9907
2023-12-06 14:33:03,461 - INFO - Epoch(test) test/all/:
2023-12-06 14:33:26,900 - INFO - Epoch(test) : [20/32]
2023-12-06 14:33:35,028 - INFO - Metrics for ship: Accuracy: 0.9323, Precision: 0.8684, Recall: 0.8260, F1_score: 0.8466, Average_Precision: 0.9144
2023-12-06 14:33:35,055 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:33:58,152 - INFO - Epoch(test) : [20/29]
2023-12-06 14:34:04,334 - INFO - Metrics for ship: Accuracy: 0.9502, Precision: 0.8779, Recall: 0.9455, F1_score: 0.9104, Average_Precision: 0.9487
2023-12-06 14:34:04,337 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:34:12,283 - INFO - Metrics for ship: Accuracy: 0.8838, Precision: 0.6166, Recall: 0.6724, F1_score: 0.6433, Average_Precision: 0.6938
2023-12-06 14:34:12,962 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:34:13,017 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 9678de49b87d7d4cffbf578615c0a9a9, with test/inshore/ image AP 0.6938
2023-12-06 14:34:40,784 - INFO - Epoch(train)[3/100][20/79]lr: 9.7577e-04  eta: 2:58:39  time: 27.7630  inter_cls_loss: 0.1779 inner_cls_loss: 25.3041
2023-12-06 14:34:54,890 - INFO - Epoch(train)[3/100][40/79]lr: 9.7577e-04  eta: 2:14:21  time: 41.8695  inter_cls_loss: 0.2152 inner_cls_loss: 27.2203
2023-12-06 14:35:10,207 - INFO - Epoch(train)[3/100][60/79]lr: 9.7577e-04  eta: 2:2:2  time: 57.1898  inter_cls_loss: 0.2213 inner_cls_loss: 24.5557
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:35:22,166 - INFO - Epoch(test) test/all/:
2023-12-06 14:35:45,953 - INFO - Epoch(test) : [20/32]
2023-12-06 14:35:53,945 - INFO - Metrics for ship: Accuracy: 0.9359, Precision: 0.8258, Recall: 0.9084, F1_score: 0.8651, Average_Precision: 0.9272
2023-12-06 14:35:53,969 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:36:17,586 - INFO - Epoch(test) : [20/29]
2023-12-06 14:36:23,695 - INFO - Metrics for ship: Accuracy: 0.9579, Precision: 0.8960, Recall: 0.9535, F1_score: 0.9239, Average_Precision: 0.9593
2023-12-06 14:36:23,699 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:36:31,853 - INFO - Metrics for ship: Accuracy: 0.8673, Precision: 0.5477, Recall: 0.8509, F1_score: 0.6665, Average_Precision: 0.7398
2023-12-06 14:36:32,599 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:36:32,656 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 d804f008880e4b69c235ec907c24bd68, with test/inshore/ image AP 0.7398
2023-12-06 14:37:02,094 - INFO - Epoch(train)[4/100][20/79]lr: 9.4605e-04  eta: 3:7:28  time: 29.4338  inter_cls_loss: 0.1092 inner_cls_loss: 19.3509
2023-12-06 14:37:16,148 - INFO - Epoch(train)[4/100][40/79]lr: 9.4605e-04  eta: 2:18:7  time: 43.4876  inter_cls_loss: 0.1208 inner_cls_loss: 19.5982
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:37:29,690 - INFO - Epoch(train)[4/100][60/79]lr: 9.4605e-04  eta: 2:0:26  time: 57.0317  inter_cls_loss: 0.1848 inner_cls_loss: 22.3867
2023-12-06 14:37:42,640 - INFO - Epoch(test) test/all/:
2023-12-06 14:38:06,602 - INFO - Epoch(test) : [20/32]
2023-12-06 14:38:14,574 - INFO - Metrics for ship: Accuracy: 0.9337, Precision: 0.8169, Recall: 0.9109, F1_score: 0.8613, Average_Precision: 0.9238
2023-12-06 14:38:14,606 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:38:38,568 - INFO - Epoch(test) : [20/29]
2023-12-06 14:38:44,946 - INFO - Metrics for ship: Accuracy: 0.9570, Precision: 0.8818, Recall: 0.9693, F1_score: 0.9235, Average_Precision: 0.9566
2023-12-06 14:38:44,950 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:38:52,805 - INFO - Metrics for ship: Accuracy: 0.8322, Precision: 0.4782, Recall: 0.8480, F1_score: 0.6116, Average_Precision: 0.6842
2023-12-06 14:38:53,524 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:39:21,662 - INFO - Epoch(train)[5/100][20/79]lr: 9.0546e-04  eta: 2:57:21  time: 28.1371  inter_cls_loss: 0.1165 inner_cls_loss: 18.3629
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:39:37,118 - INFO - Epoch(train)[5/100][40/79]lr: 9.0546e-04  eta: 2:17:1  time: 43.5926  inter_cls_loss: 0.1258 inner_cls_loss: 18.2915
2023-12-06 14:39:50,316 - INFO - Epoch(train)[5/100][60/79]lr: 9.0546e-04  eta: 1:58:41  time: 56.7907  inter_cls_loss: 0.1715 inner_cls_loss: 19.6818
2023-12-06 14:40:03,576 - INFO - Epoch(test) test/all/:
2023-12-06 14:40:28,139 - INFO - Epoch(test) : [20/32]
2023-12-06 14:40:36,697 - INFO - Metrics for ship: Accuracy: 0.9402, Precision: 0.8430, Recall: 0.9042, F1_score: 0.8725, Average_Precision: 0.9332
2023-12-06 14:40:36,729 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:41:01,397 - INFO - Epoch(test) : [20/29]
2023-12-06 14:41:07,463 - INFO - Metrics for ship: Accuracy: 0.9598, Precision: 0.9091, Recall: 0.9444, F1_score: 0.9264, Average_Precision: 0.9636
2023-12-06 14:41:07,466 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:41:16,255 - INFO - Metrics for ship: Accuracy: 0.8802, Precision: 0.5772, Recall: 0.8636, F1_score: 0.6919, Average_Precision: 0.7245
2023-12-06 14:41:16,987 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:41:46,700 - INFO - Epoch(train)[6/100][20/79]lr: 8.5502e-04  eta: 3:5:18  time: 29.7077  inter_cls_loss: 0.1494 inner_cls_loss: 18.1990
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:42:01,261 - INFO - Epoch(train)[6/100][40/79]lr: 8.5502e-04  eta: 2:17:42  time: 44.2711  inter_cls_loss: 0.1942 inner_cls_loss: 19.5497
2023-12-06 14:42:15,197 - INFO - Epoch(train)[6/100][60/79]lr: 8.5502e-04  eta: 2:0:22  time: 58.2101  inter_cls_loss: 0.1720 inner_cls_loss: 18.2672
2023-12-06 14:42:28,727 - INFO - Epoch(test) test/all/:
2023-12-06 14:42:53,155 - INFO - Epoch(test) : [20/32]
2023-12-06 14:43:01,661 - INFO - Metrics for ship: Accuracy: 0.9437, Precision: 0.8811, Recall: 0.8682, F1_score: 0.8746, Average_Precision: 0.9390
2023-12-06 14:43:01,693 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:43:25,997 - INFO - Epoch(test) : [20/29]
2023-12-06 14:43:32,308 - INFO - Metrics for ship: Accuracy: 0.9596, Precision: 0.9198, Recall: 0.9305, F1_score: 0.9251, Average_Precision: 0.9693
2023-12-06 14:43:32,312 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:43:40,587 - INFO - Metrics for ship: Accuracy: 0.8952, Precision: 0.6353, Recall: 0.7686, F1_score: 0.6956, Average_Precision: 0.7393
2023-12-06 14:43:41,443 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:44:09,406 - INFO - Epoch(train)[7/100][20/79]lr: 7.9595e-04  eta: 2:52:34  time: 27.9623  inter_cls_loss: 0.1535 inner_cls_loss: 16.1327
2023-12-06 14:44:24,683 - INFO - Epoch(train)[7/100][40/79]lr: 7.9595e-04  eta: 2:13:4  time: 43.2391  inter_cls_loss: 0.1447 inner_cls_loss: 15.8158
2023-12-06 14:44:38,321 - INFO - Epoch(train)[7/100][60/79]lr: 7.9595e-04  eta: 1:56:22  time: 56.8759  inter_cls_loss: 0.1596 inner_cls_loss: 16.1258
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:44:51,576 - INFO - Epoch(test) test/all/:
2023-12-06 14:45:16,247 - INFO - Epoch(test) : [20/32]
2023-12-06 14:45:24,575 - INFO - Metrics for ship: Accuracy: 0.9289, Precision: 0.7842, Recall: 0.9458, F1_score: 0.8575, Average_Precision: 0.9378
2023-12-06 14:45:24,606 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:45:48,305 - INFO - Epoch(test) : [20/29]
2023-12-06 14:45:54,528 - INFO - Metrics for ship: Accuracy: 0.9601, Precision: 0.8965, Recall: 0.9621, F1_score: 0.9281, Average_Precision: 0.9691
2023-12-06 14:45:54,532 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:46:03,001 - INFO - Metrics for ship: Accuracy: 0.8477, Precision: 0.5061, Recall: 0.9182, F1_score: 0.6525, Average_Precision: 0.7522
2023-12-06 14:46:03,702 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:46:03,766 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 ecbfa427f0b37c3fdee001db6e73d3f9, with test/inshore/ image AP 0.7522
2023-12-06 14:46:36,654 - INFO - Epoch(train)[8/100][20/79]lr: 7.2973e-04  eta: 3:20:46  time: 32.8823  inter_cls_loss: 0.1196 inner_cls_loss: 14.3106
2023-12-06 14:46:52,383 - INFO - Epoch(train)[8/100][40/79]lr: 7.2973e-04  eta: 2:28:0  time: 48.6138  inter_cls_loss: 0.1006 inner_cls_loss: 13.7752
2023-12-06 14:47:05,022 - INFO - Epoch(train)[8/100][60/79]lr: 7.2973e-04  eta: 2:3:59  time: 61.2552  inter_cls_loss: 0.1315 inner_cls_loss: 14.0248
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:47:17,571 - INFO - Epoch(test) test/all/:
2023-12-06 14:47:41,612 - INFO - Epoch(test) : [20/32]
2023-12-06 14:47:49,893 - INFO - Metrics for ship: Accuracy: 0.9462, Precision: 0.8793, Recall: 0.8836, F1_score: 0.8814, Average_Precision: 0.9432
2023-12-06 14:47:49,925 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:48:13,561 - INFO - Epoch(test) : [20/29]
2023-12-06 14:48:20,090 - INFO - Metrics for ship: Accuracy: 0.9609, Precision: 0.9192, Recall: 0.9365, F1_score: 0.9278, Average_Precision: 0.9712
2023-12-06 14:48:20,095 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:48:28,207 - INFO - Metrics for ship: Accuracy: 0.8926, Precision: 0.6205, Recall: 0.7989, F1_score: 0.6985, Average_Precision: 0.7381
2023-12-06 14:48:28,926 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:48:56,655 - INFO - Epoch(train)[9/100][20/79]lr: 6.5796e-04  eta: 2:47:28  time: 27.7268  inter_cls_loss: 0.1406 inner_cls_loss: 13.6251
2023-12-06 14:49:10,809 - INFO - Epoch(train)[9/100][40/79]lr: 6.5796e-04  eta: 2:6:7  time: 41.8785  inter_cls_loss: 0.1043 inner_cls_loss: 12.8216
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:49:25,119 - INFO - Epoch(train)[9/100][60/79]lr: 6.5796e-04  eta: 1:52:30  time: 56.1919  inter_cls_loss: 0.1324 inner_cls_loss: 13.5613
2023-12-06 14:49:38,052 - INFO - Epoch(test) test/all/:
2023-12-06 14:50:01,831 - INFO - Epoch(test) : [20/32]
2023-12-06 14:50:10,138 - INFO - Metrics for ship: Accuracy: 0.9446, Precision: 0.8549, Recall: 0.9092, F1_score: 0.8812, Average_Precision: 0.9402
2023-12-06 14:50:10,164 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:50:33,701 - INFO - Epoch(test) : [20/29]
2023-12-06 14:50:40,261 - INFO - Metrics for ship: Accuracy: 0.9615, Precision: 0.9048, Recall: 0.9570, F1_score: 0.9302, Average_Precision: 0.9697
2023-12-06 14:50:40,264 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:50:48,508 - INFO - Metrics for ship: Accuracy: 0.8669, Precision: 0.5477, Recall: 0.8378, F1_score: 0.6624, Average_Precision: 0.7105
2023-12-06 14:50:49,277 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:51:17,658 - INFO - Epoch(train)[10/100][20/79]lr: 5.8244e-04  eta: 2:49:31  time: 28.3769  inter_cls_loss: 0.1685 inner_cls_loss: 13.8739
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:51:32,206 - INFO - Epoch(train)[10/100][40/79]lr: 5.8244e-04  eta: 2:7:51  time: 42.9236  inter_cls_loss: 0.0858 inner_cls_loss: 11.4373
2023-12-06 14:51:46,578 - INFO - Epoch(train)[10/100][60/79]lr: 5.8244e-04  eta: 1:53:28  time: 57.3007  inter_cls_loss: 0.0943 inner_cls_loss: 11.5643
2023-12-06 14:51:58,926 - INFO - Epoch(test) test/all/:
2023-12-06 14:52:23,147 - INFO - Epoch(test) : [20/32]
2023-12-06 14:52:31,119 - INFO - Metrics for ship: Accuracy: 0.9477, Precision: 0.8803, Recall: 0.8897, F1_score: 0.8850, Average_Precision: 0.9479
2023-12-06 14:52:31,154 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:52:55,403 - INFO - Epoch(test) : [20/29]
2023-12-06 14:53:01,383 - INFO - Metrics for ship: Accuracy: 0.9603, Precision: 0.9247, Recall: 0.9274, F1_score: 0.9260, Average_Precision: 0.9723
2023-12-06 14:53:01,387 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:53:09,458 - INFO - Metrics for ship: Accuracy: 0.9038, Precision: 0.6501, Recall: 0.8289, F1_score: 0.7287, Average_Precision: 0.7822
2023-12-06 14:53:10,178 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:53:10,233 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 f841acc231be039f032e9b632c44b78d, with test/inshore/ image AP 0.7822
2023-12-06 14:53:39,048 - INFO - Epoch(train)[11/100][20/79]lr: 5.0500e-04  eta: 2:49:54  time: 28.7569  inter_cls_loss: 0.0705 inner_cls_loss: 10.3105
2023-12-06 14:53:53,206 - INFO - Epoch(train)[11/100][40/79]lr: 5.0500e-04  eta: 2:6:24  time: 42.9132  inter_cls_loss: 0.1243 inner_cls_loss: 11.9077
2023-12-06 14:54:07,984 - INFO - Epoch(train)[11/100][60/79]lr: 5.0500e-04  eta: 1:52:58  time: 57.6910  inter_cls_loss: 0.0946 inner_cls_loss: 11.1459
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:54:20,257 - INFO - Epoch(test) test/all/:
2023-12-06 14:54:45,001 - INFO - Epoch(test) : [20/32]
2023-12-06 14:54:53,109 - INFO - Metrics for ship: Accuracy: 0.9484, Precision: 0.8855, Recall: 0.8866, F1_score: 0.8861, Average_Precision: 0.9479
2023-12-06 14:54:53,147 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:55:16,933 - INFO - Epoch(test) : [20/29]
2023-12-06 14:55:23,177 - INFO - Metrics for ship: Accuracy: 0.9609, Precision: 0.9250, Recall: 0.9292, F1_score: 0.9271, Average_Precision: 0.9724
2023-12-06 14:55:23,181 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:55:31,310 - INFO - Metrics for ship: Accuracy: 0.9028, Precision: 0.6483, Recall: 0.8217, F1_score: 0.7248, Average_Precision: 0.7665
2023-12-06 14:55:31,998 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:56:06,066 - INFO - Epoch(train)[12/100][20/79]lr: 4.2756e-04  eta: 3:19:2  time: 34.0671  inter_cls_loss: 0.1138 inner_cls_loss: 11.0693
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:56:21,797 - INFO - Epoch(train)[12/100][40/79]lr: 4.2756e-04  eta: 2:25:3  time: 49.7984  inter_cls_loss: 0.0924 inner_cls_loss: 10.4995
2023-12-06 14:56:35,793 - INFO - Epoch(train)[12/100][60/79]lr: 4.2756e-04  eta: 2:3:31  time: 63.7941  inter_cls_loss: 0.0913 inner_cls_loss: 10.2449
2023-12-06 14:56:48,945 - INFO - Epoch(test) test/all/:
2023-12-06 14:57:13,507 - INFO - Epoch(test) : [20/32]
2023-12-06 14:57:21,479 - INFO - Metrics for ship: Accuracy: 0.9480, Precision: 0.8808, Recall: 0.8904, F1_score: 0.8856, Average_Precision: 0.9491
2023-12-06 14:57:21,511 - INFO - Epoch(test) test/offshore/:
2023-12-06 14:57:46,058 - INFO - Epoch(test) : [20/29]
2023-12-06 14:57:52,502 - INFO - Metrics for ship: Accuracy: 0.9615, Precision: 0.9174, Recall: 0.9410, F1_score: 0.9290, Average_Precision: 0.9719
2023-12-06 14:57:52,507 - INFO - Epoch(test) test/inshore/:
2023-12-06 14:58:01,028 - INFO - Metrics for ship: Accuracy: 0.9037, Precision: 0.6530, Recall: 0.8145, F1_score: 0.7249, Average_Precision: 0.7875
2023-12-06 14:58:01,792 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 14:58:01,849 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 9e172e9d5bb6fa09b4ce31ac5555dc64, with test/inshore/ image AP 0.7875
2023-12-06 14:58:31,369 - INFO - Epoch(train)[13/100][20/79]lr: 3.5204e-04  eta: 2:50:31  time: 29.5194  inter_cls_loss: 0.1101 inner_cls_loss: 10.6700
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 14:58:46,030 - INFO - Epoch(train)[13/100][40/79]lr: 3.5204e-04  eta: 2:7:13  time: 44.1772  inter_cls_loss: 0.1254 inner_cls_loss: 11.1450
2023-12-06 14:58:59,949 - INFO - Epoch(train)[13/100][60/79]lr: 3.5204e-04  eta: 1:51:13  time: 58.0989  inter_cls_loss: 0.0947 inner_cls_loss: 9.9505
2023-12-06 14:59:13,093 - INFO - Epoch(test) test/all/:
2023-12-06 14:59:38,036 - INFO - Epoch(test) : [20/32]
2023-12-06 14:59:46,187 - INFO - Metrics for ship: Accuracy: 0.9484, Precision: 0.8771, Recall: 0.8977, F1_score: 0.8873, Average_Precision: 0.9509
2023-12-06 14:59:46,218 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:00:10,796 - INFO - Epoch(test) : [20/29]
2023-12-06 15:00:17,024 - INFO - Metrics for ship: Accuracy: 0.9618, Precision: 0.9243, Recall: 0.9339, F1_score: 0.9291, Average_Precision: 0.9744
2023-12-06 15:00:17,028 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:00:25,039 - INFO - Metrics for ship: Accuracy: 0.8992, Precision: 0.6315, Recall: 0.8475, F1_score: 0.7237, Average_Precision: 0.7762
2023-12-06 15:00:25,790 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:00:56,027 - INFO - Epoch(train)[14/100][20/79]lr: 2.8027e-04  eta: 2:52:39  time: 30.2335  inter_cls_loss: 0.1123 inner_cls_loss: 10.4772
2023-12-06 15:01:08,870 - INFO - Epoch(train)[14/100][40/79]lr: 2.8027e-04  eta: 2:2:38  time: 43.0788  inter_cls_loss: 0.1151 inner_cls_loss: 10.3790
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:01:24,204 - INFO - Epoch(train)[14/100][60/79]lr: 2.8027e-04  eta: 1:50:32  time: 58.4101  inter_cls_loss: 0.1300 inner_cls_loss: 10.5021
2023-12-06 15:01:36,570 - INFO - Epoch(test) test/all/:
2023-12-06 15:02:01,266 - INFO - Epoch(test) : [20/32]
2023-12-06 15:02:09,849 - INFO - Metrics for ship: Accuracy: 0.9466, Precision: 0.8934, Recall: 0.8675, F1_score: 0.8803, Average_Precision: 0.9494
2023-12-06 15:02:09,877 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:02:34,579 - INFO - Epoch(test) : [20/29]
2023-12-06 15:02:40,513 - INFO - Metrics for ship: Accuracy: 0.9592, Precision: 0.9346, Recall: 0.9113, F1_score: 0.9228, Average_Precision: 0.9754
2023-12-06 15:02:40,517 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:02:48,597 - INFO - Metrics for ship: Accuracy: 0.8997, Precision: 0.6419, Recall: 0.8061, F1_score: 0.7147, Average_Precision: 0.7773
2023-12-06 15:02:49,644 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:03:19,668 - INFO - Epoch(train)[15/100][20/79]lr: 2.1405e-04  eta: 2:49:28  time: 30.0215  inter_cls_loss: 0.0703 inner_cls_loss: 9.0938
2023-12-06 15:03:33,679 - INFO - Epoch(train)[15/100][40/79]lr: 2.1405e-04  eta: 2:3:55  time: 44.0333  inter_cls_loss: 0.0843 inner_cls_loss: 9.5540
2023-12-06 15:03:47,309 - INFO - Epoch(train)[15/100][60/79]lr: 2.1405e-04  eta: 1:47:51  time: 57.6641  inter_cls_loss: 0.1089 inner_cls_loss: 9.7265
2023-12-06 15:04:00,510 - INFO - Epoch(test) test/all/:
2023-12-06 15:04:25,109 - INFO - Epoch(test) : [20/32]
2023-12-06 15:04:33,343 - INFO - Metrics for ship: Accuracy: 0.9494, Precision: 0.8805, Recall: 0.8979, F1_score: 0.8891, Average_Precision: 0.9526
2023-12-06 15:04:33,374 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:04:57,996 - INFO - Epoch(test) : [20/29]
2023-12-06 15:05:04,246 - INFO - Metrics for ship: Accuracy: 0.9625, Precision: 0.9219, Recall: 0.9394, F1_score: 0.9306, Average_Precision: 0.9749
2023-12-06 15:05:04,249 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:05:12,533 - INFO - Metrics for ship: Accuracy: 0.9040, Precision: 0.6476, Recall: 0.8410, F1_score: 0.7318, Average_Precision: 0.7876
2023-12-06 15:05:13,300 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:05:13,358 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 7db4c6b0217c56ce708dd642f089f51b, with test/inshore/ image AP 0.7876
2023-12-06 15:05:42,684 - INFO - Epoch(train)[16/100][20/79]lr: 1.5498e-04  eta: 2:43:36  time: 29.3253  inter_cls_loss: 0.0696 inner_cls_loss: 8.8924
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:05:57,670 - INFO - Epoch(train)[16/100][40/79]lr: 1.5498e-04  eta: 2:3:14  time: 44.3112  inter_cls_loss: 0.0817 inner_cls_loss: 9.1435
2023-12-06 15:06:11,274 - INFO - Epoch(train)[16/100][60/79]lr: 1.5498e-04  eta: 1:47:3  time: 57.9147  inter_cls_loss: 0.0952 inner_cls_loss: 9.6244
2023-12-06 15:06:24,195 - INFO - Epoch(test) test/all/:
2023-12-06 15:06:49,045 - INFO - Epoch(test) : [20/32]
2023-12-06 15:06:56,954 - INFO - Metrics for ship: Accuracy: 0.9488, Precision: 0.8728, Recall: 0.9055, F1_score: 0.8889, Average_Precision: 0.9523
2023-12-06 15:06:56,980 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:07:21,516 - INFO - Epoch(test) : [20/29]
2023-12-06 15:07:27,708 - INFO - Metrics for ship: Accuracy: 0.9625, Precision: 0.9234, Recall: 0.9380, F1_score: 0.9306, Average_Precision: 0.9753
2023-12-06 15:07:27,711 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:07:35,801 - INFO - Metrics for ship: Accuracy: 0.9029, Precision: 0.6410, Recall: 0.8559, F1_score: 0.7330, Average_Precision: 0.7953
2023-12-06 15:07:36,515 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:07:36,572 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 85bcb256b40c3ded3e5e1245d9ab7cf0, with test/inshore/ image AP 0.7953
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:08:06,119 - INFO - Epoch(train)[17/100][20/79]lr: 1.0454e-04  eta: 2:42:53  time: 29.5455  inter_cls_loss: 0.0773 inner_cls_loss: 8.9519
2023-12-06 15:08:20,434 - INFO - Epoch(train)[17/100][40/79]lr: 1.0454e-04  eta: 2:0:32  time: 43.8608  inter_cls_loss: 0.0684 inner_cls_loss: 8.8982
2023-12-06 15:08:33,668 - INFO - Epoch(train)[17/100][60/79]lr: 1.0454e-04  eta: 1:44:17  time: 57.0947  inter_cls_loss: 0.0867 inner_cls_loss: 8.9328
2023-12-06 15:08:47,364 - INFO - Epoch(test) test/all/:
2023-12-06 15:09:12,511 - INFO - Epoch(test) : [20/32]
2023-12-06 15:09:20,487 - INFO - Metrics for ship: Accuracy: 0.9498, Precision: 0.8880, Recall: 0.8905, F1_score: 0.8892, Average_Precision: 0.9528
2023-12-06 15:09:20,517 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:09:45,537 - INFO - Epoch(test) : [20/29]
2023-12-06 15:09:51,611 - INFO - Metrics for ship: Accuracy: 0.9619, Precision: 0.9287, Recall: 0.9291, F1_score: 0.9289, Average_Precision: 0.9757
2023-12-06 15:09:51,614 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:10:00,138 - INFO - Metrics for ship: Accuracy: 0.9099, Precision: 0.6691, Recall: 0.8341, F1_score: 0.7425, Average_Precision: 0.8012
2023-12-06 15:10:00,844 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:10:00,901 - INFO - Best model saved to  work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 497b4bbd88cc08c2d9fa4625c79ea7d6, with test/inshore/ image AP 0.8012
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:10:29,107 - INFO - Epoch(train)[18/100][20/79]lr: 6.3952e-05  eta: 2:33:38  time: 28.2040  inter_cls_loss: 0.1046 inner_cls_loss: 9.1909
2023-12-06 15:10:43,542 - INFO - Epoch(train)[18/100][40/79]lr: 6.3952e-05  eta: 1:55:46  time: 42.6373  inter_cls_loss: 0.1302 inner_cls_loss: 10.1656
2023-12-06 15:10:57,541 - INFO - Epoch(train)[18/100][60/79]lr: 6.3952e-05  eta: 1:42:13  time: 56.6390  inter_cls_loss: 0.0797 inner_cls_loss: 8.9759
2023-12-06 15:11:10,805 - INFO - Epoch(test) test/all/:
2023-12-06 15:11:35,531 - INFO - Epoch(test) : [20/32]
2023-12-06 15:11:43,923 - INFO - Metrics for ship: Accuracy: 0.9494, Precision: 0.8886, Recall: 0.8878, F1_score: 0.8882, Average_Precision: 0.9528
2023-12-06 15:11:43,953 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:12:09,014 - INFO - Epoch(test) : [20/29]
2023-12-06 15:12:15,369 - INFO - Metrics for ship: Accuracy: 0.9622, Precision: 0.9293, Recall: 0.9294, F1_score: 0.9294, Average_Precision: 0.9754
2023-12-06 15:12:15,374 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:12:23,814 - INFO - Metrics for ship: Accuracy: 0.9095, Precision: 0.6679, Recall: 0.8338, F1_score: 0.7417, Average_Precision: 0.7950
2023-12-06 15:12:24,531 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:12:54,292 - INFO - Epoch(train)[19/100][20/79]lr: 3.4227e-05  eta: 2:40:9  time: 29.7593  inter_cls_loss: 0.0818 inner_cls_loss: 8.9018
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:13:08,551 - INFO - Epoch(train)[19/100][40/79]lr: 3.4227e-05  eta: 1:58:4  time: 44.0185  inter_cls_loss: 0.0967 inner_cls_loss: 9.4565
2023-12-06 15:13:22,845 - INFO - Epoch(train)[19/100][60/79]lr: 3.4227e-05  eta: 1:43:57  time: 58.3089  inter_cls_loss: 0.1072 inner_cls_loss: 9.2702
2023-12-06 15:13:35,727 - INFO - Epoch(test) test/all/:
2023-12-06 15:14:00,961 - INFO - Epoch(test) : [20/32]
2023-12-06 15:14:09,158 - INFO - Metrics for ship: Accuracy: 0.9495, Precision: 0.8818, Recall: 0.8968, F1_score: 0.8893, Average_Precision: 0.9526
2023-12-06 15:14:09,190 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:14:34,236 - INFO - Epoch(test) : [20/29]
2023-12-06 15:14:40,496 - INFO - Metrics for ship: Accuracy: 0.9623, Precision: 0.9262, Recall: 0.9338, F1_score: 0.9300, Average_Precision: 0.9757
2023-12-06 15:14:40,499 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:14:49,114 - INFO - Metrics for ship: Accuracy: 0.9063, Precision: 0.6535, Recall: 0.8480, F1_score: 0.7381, Average_Precision: 0.7932
2023-12-06 15:14:49,848 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:15:19,149 - INFO - Epoch(train)[20/100][20/79]lr: 1.6094e-05  eta: 2:35:45  time: 29.2997  inter_cls_loss: 0.1209 inner_cls_loss: 9.6820
2023-12-06 15:15:33,354 - INFO - Epoch(train)[20/100][40/79]lr: 1.6094e-05  eta: 1:55:15  time: 43.5027  inter_cls_loss: 0.0917 inner_cls_loss: 8.7335
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:15:48,517 - INFO - Epoch(train)[20/100][60/79]lr: 1.6094e-05  eta: 1:43:18  time: 58.6687  inter_cls_loss: 0.0700 inner_cls_loss: 8.6670
2023-12-06 15:16:01,300 - INFO - Epoch(test) test/all/:
2023-12-06 15:16:26,380 - INFO - Epoch(test) : [20/32]
2023-12-06 15:16:34,410 - INFO - Metrics for ship: Accuracy: 0.9497, Precision: 0.8813, Recall: 0.8984, F1_score: 0.8898, Average_Precision: 0.9529
2023-12-06 15:16:34,436 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:16:59,363 - INFO - Epoch(test) : [20/29]
2023-12-06 15:17:05,969 - INFO - Metrics for ship: Accuracy: 0.9623, Precision: 0.9241, Recall: 0.9361, F1_score: 0.9300, Average_Precision: 0.9755
2023-12-06 15:17:05,973 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:17:14,531 - INFO - Metrics for ship: Accuracy: 0.9082, Precision: 0.6601, Recall: 0.8472, F1_score: 0.7420, Average_Precision: 0.7953
2023-12-06 15:17:15,274 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:17:43,948 - INFO - Epoch(train)[21/100][20/79]lr: 1.0000e-03  eta: 2:30:12  time: 28.6114  inter_cls_loss: 0.2554 inner_cls_loss: 12.5265
2023-12-06 15:17:59,157 - INFO - Epoch(train)[21/100][40/79]lr: 1.0000e-03  eta: 1:54:39  time: 43.8196  inter_cls_loss: 0.1198 inner_cls_loss: 9.7752
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:18:12,943 - INFO - Epoch(train)[21/100][60/79]lr: 1.0000e-03  eta: 1:40:10  time: 57.6045  inter_cls_loss: 0.0952 inner_cls_loss: 8.3882
2023-12-06 15:18:26,377 - INFO - Epoch(test) test/all/:
2023-12-06 15:18:51,235 - INFO - Epoch(test) : [20/32]
2023-12-06 15:18:59,387 - INFO - Metrics for ship: Accuracy: 0.9404, Precision: 0.8179, Recall: 0.9473, F1_score: 0.8778, Average_Precision: 0.9464
2023-12-06 15:18:59,421 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:19:23,896 - INFO - Epoch(test) : [20/29]
2023-12-06 15:19:30,194 - INFO - Metrics for ship: Accuracy: 0.9601, Precision: 0.8956, Recall: 0.9635, F1_score: 0.9283, Average_Precision: 0.9709
2023-12-06 15:19:30,198 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:19:38,636 - INFO - Metrics for ship: Accuracy: 0.8861, Precision: 0.5863, Recall: 0.9137, F1_score: 0.7142, Average_Precision: 0.7901
2023-12-06 15:19:39,431 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:20:08,997 - INFO - Epoch(train)[22/100][20/79]lr: 9.9847e-04  eta: 2:33:16  time: 29.5645  inter_cls_loss: 0.3944 inner_cls_loss: 15.0344
2023-12-06 15:20:23,223 - INFO - Epoch(train)[22/100][40/79]lr: 9.9847e-04  eta: 1:53:8  time: 43.7917  inter_cls_loss: 0.0759 inner_cls_loss: 7.3738
2023-12-06 15:20:37,603 - INFO - Epoch(train)[22/100][60/79]lr: 9.9847e-04  eta: 1:39:52  time: 58.1699  inter_cls_loss: 0.1035 inner_cls_loss: 7.6625
2023-12-06 15:20:50,725 - INFO - Epoch(test) test/all/:
2023-12-06 15:21:15,629 - INFO - Epoch(test) : [20/32]
2023-12-06 15:21:23,936 - INFO - Metrics for ship: Accuracy: 0.9447, Precision: 0.9161, Recall: 0.8317, F1_score: 0.8719, Average_Precision: 0.9461
2023-12-06 15:21:23,963 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:21:48,860 - INFO - Epoch(test) : [20/29]
2023-12-06 15:21:55,192 - INFO - Metrics for ship: Accuracy: 0.9561, Precision: 0.9465, Recall: 0.8863, F1_score: 0.9154, Average_Precision: 0.9722
2023-12-06 15:21:55,196 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:22:03,513 - INFO - Metrics for ship: Accuracy: 0.9083, Precision: 0.6887, Recall: 0.7510, F1_score: 0.7185, Average_Precision: 0.7500
2023-12-06 15:22:04,223 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:22:33,349 - INFO - Epoch(train)[23/100][20/79]lr: 9.9391e-04  eta: 2:29:4  time: 29.1247  inter_cls_loss: 0.1367 inner_cls_loss: 7.9588
2023-12-06 15:22:48,782 - INFO - Epoch(train)[23/100][40/79]lr: 9.9391e-04  eta: 1:53:39  time: 44.5580  inter_cls_loss: 0.0794 inner_cls_loss: 6.9411
2023-12-06 15:23:02,395 - INFO - Epoch(train)[23/100][60/79]lr: 9.9391e-04  eta: 1:38:35  time: 58.1708  inter_cls_loss: 0.1280 inner_cls_loss: 7.6321
2023-12-06 15:23:14,993 - INFO - Epoch(test) test/all/:
2023-12-06 15:23:39,664 - INFO - Epoch(test) : [20/32]
2023-12-06 15:23:48,065 - INFO - Metrics for ship: Accuracy: 0.9476, Precision: 0.8833, Recall: 0.8853, F1_score: 0.8843, Average_Precision: 0.9493
2023-12-06 15:23:48,096 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:24:13,202 - INFO - Epoch(test) : [20/29]
2023-12-06 15:24:19,391 - INFO - Metrics for ship: Accuracy: 0.9609, Precision: 0.9257, Recall: 0.9284, F1_score: 0.9270, Average_Precision: 0.9729
2023-12-06 15:24:19,396 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:24:27,980 - INFO - Metrics for ship: Accuracy: 0.8929, Precision: 0.6171, Recall: 0.8232, F1_score: 0.7054, Average_Precision: 0.7361
2023-12-06 15:24:28,773 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:24:58,107 - INFO - Epoch(train)[24/100][20/79]lr: 9.8632e-04  eta: 2:28:12  time: 29.3325  inter_cls_loss: 0.1438 inner_cls_loss: 7.2320
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:25:12,967 - INFO - Epoch(train)[24/100][40/79]lr: 9.8632e-04  eta: 1:51:16  time: 44.1941  inter_cls_loss: 0.1141 inner_cls_loss: 6.5204
2023-12-06 15:25:26,881 - INFO - Epoch(train)[24/100][60/79]lr: 9.8632e-04  eta: 1:37:12  time: 58.1060  inter_cls_loss: 0.1044 inner_cls_loss: 6.4109
2023-12-06 15:25:39,989 - INFO - Epoch(test) test/all/:
2023-12-06 15:26:04,329 - INFO - Epoch(test) : [20/32]
2023-12-06 15:26:12,900 - INFO - Metrics for ship: Accuracy: 0.9452, Precision: 0.8403, Recall: 0.9356, F1_score: 0.8854, Average_Precision: 0.9496
2023-12-06 15:26:12,931 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:26:37,833 - INFO - Epoch(test) : [20/29]
2023-12-06 15:26:43,873 - INFO - Metrics for ship: Accuracy: 0.9619, Precision: 0.9059, Recall: 0.9571, F1_score: 0.9308, Average_Precision: 0.9722
2023-12-06 15:26:43,878 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:26:52,353 - INFO - Metrics for ship: Accuracy: 0.8827, Precision: 0.5788, Recall: 0.9080, F1_score: 0.7070, Average_Precision: 0.7681
2023-12-06 15:26:53,099 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:27:21,686 - INFO - Epoch(train)[25/100][20/79]lr: 9.7577e-04  eta: 2:22:32  time: 28.5830  inter_cls_loss: 0.0896 inner_cls_loss: 5.8045
2023-12-06 15:27:37,295 - INFO - Epoch(train)[25/100][40/79]lr: 9.7577e-04  eta: 1:49:49  time: 44.1936  inter_cls_loss: 0.0450 inner_cls_loss: 5.3051
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:27:51,314 - INFO - Epoch(train)[25/100][60/79]lr: 9.7577e-04  eta: 1:36:6  time: 58.2111  inter_cls_loss: 0.1295 inner_cls_loss: 6.1588
2023-12-06 15:28:04,974 - INFO - Epoch(test) test/all/:
2023-12-06 15:28:29,944 - INFO - Epoch(test) : [20/32]
2023-12-06 15:28:38,300 - INFO - Metrics for ship: Accuracy: 0.9440, Precision: 0.8310, Recall: 0.9443, F1_score: 0.8841, Average_Precision: 0.9481
2023-12-06 15:28:38,328 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:29:03,200 - INFO - Epoch(test) : [20/29]
2023-12-06 15:29:09,496 - INFO - Metrics for ship: Accuracy: 0.9614, Precision: 0.8981, Recall: 0.9652, F1_score: 0.9305, Average_Precision: 0.9726
2023-12-06 15:29:09,502 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:29:17,773 - INFO - Metrics for ship: Accuracy: 0.8900, Precision: 0.5971, Recall: 0.9040, F1_score: 0.7192, Average_Precision: 0.7864
2023-12-06 15:29:18,534 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:29:46,893 - INFO - Epoch(train)[26/100][20/79]lr: 9.6232e-04  eta: 2:19:31  time: 28.3542  inter_cls_loss: 0.1036 inner_cls_loss: 5.3253
2023-12-06 15:30:01,777 - INFO - Epoch(train)[26/100][40/79]lr: 9.6232e-04  eta: 1:46:1  time: 43.2401  inter_cls_loss: 0.1109 inner_cls_loss: 5.4845
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:30:16,198 - INFO - Epoch(train)[26/100][60/79]lr: 9.6232e-04  eta: 1:33:56  time: 57.6589  inter_cls_loss: 0.1029 inner_cls_loss: 5.4864
2023-12-06 15:30:29,032 - INFO - Epoch(test) test/all/:
2023-12-06 15:30:53,081 - INFO - Epoch(test) : [20/32]
2023-12-06 15:31:00,876 - INFO - Metrics for ship: Accuracy: 0.9446, Precision: 0.8407, Recall: 0.9319, F1_score: 0.8839, Average_Precision: 0.9485
2023-12-06 15:31:00,905 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:31:25,288 - INFO - Epoch(test) : [20/29]
2023-12-06 15:31:31,433 - INFO - Metrics for ship: Accuracy: 0.9610, Precision: 0.8938, Recall: 0.9698, F1_score: 0.9302, Average_Precision: 0.9725
2023-12-06 15:31:31,438 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:31:39,614 - INFO - Metrics for ship: Accuracy: 0.8799, Precision: 0.5746, Recall: 0.8829, F1_score: 0.6961, Average_Precision: 0.7553
2023-12-06 15:31:40,336 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:32:09,584 - INFO - Epoch(train)[27/100][20/79]lr: 9.4605e-04  eta: 2:21:58  time: 29.2440  inter_cls_loss: 0.0917 inner_cls_loss: 4.7626
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:32:27,881 - INFO - Epoch(train)[27/100][40/79]lr: 9.4605e-04  eta: 1:55:0  time: 47.5438  inter_cls_loss: 0.0878 inner_cls_loss: 4.5683
2023-12-06 15:32:46,411 - INFO - Epoch(train)[27/100][60/79]lr: 9.4605e-04  eta: 1:46:11  time: 66.0723  inter_cls_loss: 0.0674 inner_cls_loss: 4.5213
2023-12-06 15:32:57,574 - INFO - Epoch(test) test/all/:
2023-12-06 15:33:21,390 - INFO - Epoch(test) : [20/32]
2023-12-06 15:33:29,977 - INFO - Metrics for ship: Accuracy: 0.9479, Precision: 0.8994, Recall: 0.8667, F1_score: 0.8827, Average_Precision: 0.9512
2023-12-06 15:33:30,025 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:33:53,752 - INFO - Epoch(test) : [20/29]
2023-12-06 15:34:00,142 - INFO - Metrics for ship: Accuracy: 0.9587, Precision: 0.9368, Recall: 0.9072, F1_score: 0.9218, Average_Precision: 0.9745
2023-12-06 15:34:00,146 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:34:08,165 - INFO - Metrics for ship: Accuracy: 0.9091, Precision: 0.6715, Recall: 0.8147, F1_score: 0.7362, Average_Precision: 0.7519
2023-12-06 15:34:08,879 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:34:37,805 - INFO - Epoch(train)[28/100][20/79]lr: 9.2706e-04  eta: 2:18:31  time: 28.9238  inter_cls_loss: 0.0784 inner_cls_loss: 4.4364
2023-12-06 15:34:52,414 - INFO - Epoch(train)[28/100][40/79]lr: 9.2706e-04  eta: 1:43:52  time: 43.5328  inter_cls_loss: 0.1061 inner_cls_loss: 4.6140
2023-12-06 15:35:05,722 - INFO - Epoch(train)[28/100][60/79]lr: 9.2706e-04  eta: 1:30:6  time: 56.8381  inter_cls_loss: 0.0685 inner_cls_loss: 3.8177
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:35:19,041 - INFO - Epoch(test) test/all/:
2023-12-06 15:35:43,060 - INFO - Epoch(test) : [20/32]
2023-12-06 15:35:51,139 - INFO - Metrics for ship: Accuracy: 0.9498, Precision: 0.9016, Recall: 0.8733, F1_score: 0.8872, Average_Precision: 0.9522
2023-12-06 15:35:51,172 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:36:14,959 - INFO - Epoch(test) : [20/29]
2023-12-06 15:36:21,216 - INFO - Metrics for ship: Accuracy: 0.9598, Precision: 0.9379, Recall: 0.9102, F1_score: 0.9238, Average_Precision: 0.9755
2023-12-06 15:36:21,220 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:36:29,661 - INFO - Metrics for ship: Accuracy: 0.9144, Precision: 0.6922, Recall: 0.8115, F1_score: 0.7471, Average_Precision: 0.7922
2023-12-06 15:36:30,389 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:36:59,760 - INFO - Epoch(train)[29/100][20/79]lr: 9.0546e-04  eta: 2:18:43  time: 29.3690  inter_cls_loss: 0.0912 inner_cls_loss: 4.0888
2023-12-06 15:37:13,672 - INFO - Epoch(train)[29/100][40/79]lr: 9.0546e-04  eta: 1:41:51  time: 43.2818  inter_cls_loss: 0.0605 inner_cls_loss: 3.7436
2023-12-06 15:37:31,365 - INFO - Epoch(train)[29/100][60/79]lr: 9.0546e-04  eta: 1:35:19  time: 60.9754  inter_cls_loss: 0.0498 inner_cls_loss: 3.4493
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:37:47,015 - INFO - Epoch(test) test/all/:
2023-12-06 15:38:11,021 - INFO - Epoch(test) : [20/32]
2023-12-06 15:38:19,067 - INFO - Metrics for ship: Accuracy: 0.9498, Precision: 0.8894, Recall: 0.8886, F1_score: 0.8890, Average_Precision: 0.9501
2023-12-06 15:38:19,093 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:38:43,073 - INFO - Epoch(test) : [20/29]
2023-12-06 15:38:49,138 - INFO - Metrics for ship: Accuracy: 0.9610, Precision: 0.9271, Recall: 0.9275, F1_score: 0.9273, Average_Precision: 0.9730
2023-12-06 15:38:49,142 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:38:57,305 - INFO - Metrics for ship: Accuracy: 0.9111, Precision: 0.6703, Recall: 0.8452, F1_score: 0.7477, Average_Precision: 0.7708
2023-12-06 15:38:58,047 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:39:26,536 - INFO - Epoch(train)[30/100][20/79]lr: 8.8140e-04  eta: 2:12:40  time: 28.4879  inter_cls_loss: 0.0909 inner_cls_loss: 3.6564
2023-12-06 15:39:40,309 - INFO - Epoch(train)[30/100][40/79]lr: 8.8140e-04  eta: 1:38:3  time: 42.2582  inter_cls_loss: 0.0801 inner_cls_loss: 3.5256
2023-12-06 15:39:54,689 - INFO - Epoch(train)[30/100][60/79]lr: 8.8140e-04  eta: 1:27:18  time: 56.6413  inter_cls_loss: 0.0883 inner_cls_loss: 3.5934
2023-12-06 15:40:08,218 - INFO - Epoch(test) test/all/:
2023-12-06 15:40:31,705 - INFO - Epoch(test) : [20/32]
2023-12-06 15:40:39,758 - INFO - Metrics for ship: Accuracy: 0.9508, Precision: 0.8828, Recall: 0.9022, F1_score: 0.8924, Average_Precision: 0.9526
2023-12-06 15:40:39,789 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:41:03,578 - INFO - Epoch(test) : [20/29]
2023-12-06 15:41:10,043 - INFO - Metrics for ship: Accuracy: 0.9614, Precision: 0.9137, Recall: 0.9451, F1_score: 0.9291, Average_Precision: 0.9733
2023-12-06 15:41:10,047 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:41:18,182 - INFO - Metrics for ship: Accuracy: 0.9131, Precision: 0.6771, Recall: 0.8452, F1_score: 0.7519, Average_Precision: 0.7830
2023-12-06 15:41:18,902 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:41:47,181 - INFO - Epoch(train)[31/100][20/79]lr: 8.5502e-04  eta: 2:9:33  time: 28.2145  inter_cls_loss: 0.0979 inner_cls_loss: 3.4400
2023-12-06 15:42:01,289 - INFO - Epoch(train)[31/100][40/79]lr: 8.5502e-04  eta: 1:36:49  time: 42.3243  inter_cls_loss: 0.0743 inner_cls_loss: 3.1913
2023-12-06 15:42:15,410 - INFO - Epoch(train)[31/100][60/79]lr: 8.5502e-04  eta: 1:25:45  time: 56.4392  inter_cls_loss: 0.0648 inner_cls_loss: 3.0122
2023-12-06 15:42:28,879 - INFO - Epoch(test) test/all/:
2023-12-06 15:42:52,753 - INFO - Epoch(test) : [20/32]
2023-12-06 15:43:01,006 - INFO - Metrics for ship: Accuracy: 0.9482, Precision: 0.8693, Recall: 0.9077, F1_score: 0.8881, Average_Precision: 0.9490
2023-12-06 15:43:01,040 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:43:24,916 - INFO - Epoch(test) : [20/29]
2023-12-06 15:43:31,272 - INFO - Metrics for ship: Accuracy: 0.9629, Precision: 0.9236, Recall: 0.9391, F1_score: 0.9313, Average_Precision: 0.9733
2023-12-06 15:43:31,275 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:43:39,400 - INFO - Metrics for ship: Accuracy: 0.9047, Precision: 0.6461, Recall: 0.8579, F1_score: 0.7371, Average_Precision: 0.7743
2023-12-06 15:43:40,122 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:44:08,183 - INFO - Epoch(train)[32/100][20/79]lr: 8.2648e-04  eta: 2:6:59  time: 28.0603  inter_cls_loss: 0.1052 inner_cls_loss: 3.4152
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:44:22,193 - INFO - Epoch(train)[32/100][40/79]lr: 8.2648e-04  eta: 1:34:51  time: 42.0707  inter_cls_loss: 0.0879 inner_cls_loss: 3.1689
2023-12-06 15:44:35,402 - INFO - Epoch(train)[32/100][60/79]lr: 8.2648e-04  eta: 1:22:46  time: 55.2782  inter_cls_loss: 0.0637 inner_cls_loss: 2.8315
2023-12-06 15:44:49,576 - INFO - Epoch(test) test/all/:
2023-12-06 15:45:13,423 - INFO - Epoch(test) : [20/32]
2023-12-06 15:45:21,531 - INFO - Metrics for ship: Accuracy: 0.9492, Precision: 0.8629, Recall: 0.9218, F1_score: 0.8913, Average_Precision: 0.9503
2023-12-06 15:45:21,561 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:45:45,718 - INFO - Epoch(test) : [20/29]
2023-12-06 15:45:51,618 - INFO - Metrics for ship: Accuracy: 0.9625, Precision: 0.9120, Recall: 0.9517, F1_score: 0.9314, Average_Precision: 0.9727
2023-12-06 15:45:51,623 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:45:59,909 - INFO - Metrics for ship: Accuracy: 0.9004, Precision: 0.6291, Recall: 0.8782, F1_score: 0.7331, Average_Precision: 0.7420
2023-12-06 15:46:00,626 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:46:30,227 - INFO - Epoch(train)[33/100][20/79]lr: 7.9595e-04  eta: 2:12:0  time: 29.5979  inter_cls_loss: 0.0909 inner_cls_loss: 2.8335
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:46:43,736 - INFO - Epoch(train)[33/100][40/79]lr: 7.9595e-04  eta: 1:35:46  time: 43.1062  inter_cls_loss: 0.0781 inner_cls_loss: 2.8422
2023-12-06 15:46:58,361 - INFO - Epoch(train)[33/100][60/79]lr: 7.9595e-04  eta: 1:25:11  time: 57.7310  inter_cls_loss: 0.0842 inner_cls_loss: 2.9350
2023-12-06 15:47:11,147 - INFO - Epoch(test) test/all/:
2023-12-06 15:47:35,283 - INFO - Epoch(test) : [20/32]
2023-12-06 15:47:43,298 - INFO - Metrics for ship: Accuracy: 0.9493, Precision: 0.8867, Recall: 0.8895, F1_score: 0.8881, Average_Precision: 0.9479
2023-12-06 15:47:43,328 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:48:06,978 - INFO - Epoch(test) : [20/29]
2023-12-06 15:48:12,780 - INFO - Metrics for ship: Accuracy: 0.9624, Precision: 0.9235, Recall: 0.9373, F1_score: 0.9303, Average_Precision: 0.9733
2023-12-06 15:48:12,784 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:48:20,806 - INFO - Metrics for ship: Accuracy: 0.9121, Precision: 0.6796, Recall: 0.8242, F1_score: 0.7449, Average_Precision: 0.7846
2023-12-06 15:48:22,004 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:48:51,761 - INFO - Epoch(train)[34/100][20/79]lr: 7.6364e-04  eta: 2:10:43  time: 29.7512  inter_cls_loss: 0.0749 inner_cls_loss: 2.7112
2023-12-06 15:49:05,079 - INFO - Epoch(train)[34/100][40/79]lr: 7.6364e-04  eta: 1:34:16  time: 43.0731  inter_cls_loss: 0.0758 inner_cls_loss: 2.5694
2023-12-06 15:49:18,899 - INFO - Epoch(train)[34/100][60/79]lr: 7.6364e-04  eta: 1:22:42  time: 56.8936  inter_cls_loss: 0.0881 inner_cls_loss: 2.5462
2023-12-06 15:49:32,182 - INFO - Epoch(test) test/all/:
2023-12-06 15:49:55,669 - INFO - Epoch(test) : [20/32]
2023-12-06 15:50:03,752 - INFO - Metrics for ship: Accuracy: 0.9448, Precision: 0.8345, Recall: 0.9429, F1_score: 0.8854, Average_Precision: 0.9434
2023-12-06 15:50:03,782 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:50:27,828 - INFO - Epoch(test) : [20/29]
2023-12-06 15:50:34,271 - INFO - Metrics for ship: Accuracy: 0.9621, Precision: 0.9050, Recall: 0.9593, F1_score: 0.9313, Average_Precision: 0.9707
2023-12-06 15:50:34,276 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:50:42,464 - INFO - Metrics for ship: Accuracy: 0.8897, Precision: 0.5965, Recall: 0.9030, F1_score: 0.7184, Average_Precision: 0.7846
2023-12-06 15:50:43,191 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:51:11,070 - INFO - Epoch(train)[35/100][20/79]lr: 7.2973e-04  eta: 2:0:39  time: 27.8773  inter_cls_loss: 0.0749 inner_cls_loss: 2.4831
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:51:26,064 - INFO - Epoch(train)[35/100][40/79]lr: 7.2973e-04  eta: 1:32:25  time: 42.8689  inter_cls_loss: 0.0451 inner_cls_loss: 2.2745
2023-12-06 15:51:40,007 - INFO - Epoch(train)[35/100][60/79]lr: 7.2973e-04  eta: 1:21:20  time: 56.8149  inter_cls_loss: 0.0629 inner_cls_loss: 2.3926
2023-12-06 15:51:52,918 - INFO - Epoch(test) test/all/:
2023-12-06 15:52:16,468 - INFO - Epoch(test) : [20/32]
2023-12-06 15:52:24,573 - INFO - Metrics for ship: Accuracy: 0.9491, Precision: 0.9019, Recall: 0.8693, F1_score: 0.8853, Average_Precision: 0.9491
2023-12-06 15:52:24,603 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:52:48,253 - INFO - Epoch(test) : [20/29]
2023-12-06 15:52:54,198 - INFO - Metrics for ship: Accuracy: 0.9599, Precision: 0.9366, Recall: 0.9122, F1_score: 0.9242, Average_Precision: 0.9712
2023-12-06 15:52:54,201 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:53:02,401 - INFO - Metrics for ship: Accuracy: 0.9186, Precision: 0.7117, Recall: 0.8028, F1_score: 0.7545, Average_Precision: 0.7939
2023-12-06 15:53:03,453 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:53:32,251 - INFO - Epoch(train)[36/100][20/79]lr: 6.9443e-04  eta: 2:2:44  time: 28.7944  inter_cls_loss: 0.0700 inner_cls_loss: 2.3155
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:53:45,493 - INFO - Epoch(train)[36/100][40/79]lr: 6.9443e-04  eta: 1:29:14  time: 42.0368  inter_cls_loss: 0.0696 inner_cls_loss: 2.3249
2023-12-06 15:53:59,880 - INFO - Epoch(train)[36/100][60/79]lr: 6.9443e-04  eta: 1:19:32  time: 56.4269  inter_cls_loss: 0.1081 inner_cls_loss: 2.4117
2023-12-06 15:54:12,642 - INFO - Epoch(test) test/all/:
2023-12-06 15:54:36,497 - INFO - Epoch(test) : [20/32]
2023-12-06 15:54:44,435 - INFO - Metrics for ship: Accuracy: 0.9471, Precision: 0.8491, Recall: 0.9317, F1_score: 0.8885, Average_Precision: 0.9485
2023-12-06 15:54:44,465 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:55:07,997 - INFO - Epoch(test) : [20/29]
2023-12-06 15:55:14,218 - INFO - Metrics for ship: Accuracy: 0.9619, Precision: 0.9060, Recall: 0.9571, F1_score: 0.9309, Average_Precision: 0.9712
2023-12-06 15:55:14,221 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:55:22,239 - INFO - Metrics for ship: Accuracy: 0.9014, Precision: 0.6333, Recall: 0.8715, F1_score: 0.7335, Average_Precision: 0.7824
2023-12-06 15:55:23,122 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:55:50,952 - INFO - Epoch(train)[37/100][20/79]lr: 6.5796e-04  eta: 1:56:47  time: 27.8285  inter_cls_loss: 0.0679 inner_cls_loss: 2.1347
2023-12-06 15:56:05,352 - INFO - Epoch(train)[37/100][40/79]lr: 6.5796e-04  eta: 1:28:15  time: 42.2256  inter_cls_loss: 0.0411 inner_cls_loss: 1.8849
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:56:19,093 - INFO - Epoch(train)[37/100][60/79]lr: 6.5796e-04  eta: 1:17:40  time: 55.9679  inter_cls_loss: 0.0720 inner_cls_loss: 2.1363
2023-12-06 15:56:31,702 - INFO - Epoch(test) test/all/:
2023-12-06 15:56:55,850 - INFO - Epoch(test) : [20/32]
2023-12-06 15:57:03,965 - INFO - Metrics for ship: Accuracy: 0.9483, Precision: 0.8845, Recall: 0.8874, F1_score: 0.8859, Average_Precision: 0.9469
2023-12-06 15:57:03,998 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:57:27,504 - INFO - Epoch(test) : [20/29]
2023-12-06 15:57:33,575 - INFO - Metrics for ship: Accuracy: 0.9608, Precision: 0.9322, Recall: 0.9206, F1_score: 0.9264, Average_Precision: 0.9719
2023-12-06 15:57:33,579 - INFO - Epoch(test) test/inshore/:
2023-12-06 15:57:41,469 - INFO - Metrics for ship: Accuracy: 0.9109, Precision: 0.6700, Recall: 0.8440, F1_score: 0.7470, Average_Precision: 0.7904
2023-12-06 15:57:42,196 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 15:58:11,542 - INFO - Epoch(train)[38/100][20/79]lr: 6.2056e-04  eta: 2:1:12  time: 29.3423  inter_cls_loss: 0.0610 inner_cls_loss: 1.9285
2023-12-06 15:58:24,712 - INFO - Epoch(train)[38/100][40/79]lr: 6.2056e-04  eta: 1:27:27  time: 42.5152  inter_cls_loss: 0.0501 inner_cls_loss: 1.9197
2023-12-06 15:58:38,458 - INFO - Epoch(train)[38/100][60/79]lr: 6.2056e-04  eta: 1:16:50  time: 56.2596  inter_cls_loss: 0.0674 inner_cls_loss: 1.9200
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 15:58:51,625 - INFO - Epoch(test) test/all/:
2023-12-06 15:59:15,636 - INFO - Epoch(test) : [20/32]
2023-12-06 15:59:23,696 - INFO - Metrics for ship: Accuracy: 0.9485, Precision: 0.8705, Recall: 0.9073, F1_score: 0.8885, Average_Precision: 0.9462
2023-12-06 15:59:23,723 - INFO - Epoch(test) test/offshore/:
2023-12-06 15:59:47,563 - INFO - Epoch(test) : [20/29]
2023-12-06 15:59:53,639 - INFO - Metrics for ship: Accuracy: 0.9622, Precision: 0.9126, Recall: 0.9499, F1_score: 0.9309, Average_Precision: 0.9721
2023-12-06 15:59:53,643 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:00:01,851 - INFO - Metrics for ship: Accuracy: 0.9040, Precision: 0.6474, Recall: 0.8433, F1_score: 0.7324, Average_Precision: 0.7659
2023-12-06 16:00:02,596 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:00:30,520 - INFO - Epoch(train)[39/100][20/79]lr: 5.8244e-04  eta: 1:53:30  time: 27.9224  inter_cls_loss: 0.0484 inner_cls_loss: 1.7697
2023-12-06 16:00:44,238 - INFO - Epoch(train)[39/100][40/79]lr: 5.8244e-04  eta: 1:24:17  time: 41.6415  inter_cls_loss: 0.0668 inner_cls_loss: 1.8696
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:00:59,683 - INFO - Epoch(train)[39/100][60/79]lr: 5.8244e-04  eta: 1:16:43  time: 57.0863  inter_cls_loss: 0.0477 inner_cls_loss: 1.7522
2023-12-06 16:01:11,637 - INFO - Epoch(test) test/all/:
2023-12-06 16:01:35,487 - INFO - Epoch(test) : [20/32]
2023-12-06 16:01:43,477 - INFO - Metrics for ship: Accuracy: 0.9482, Precision: 0.8727, Recall: 0.9028, F1_score: 0.8875, Average_Precision: 0.9458
2023-12-06 16:01:43,509 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:02:07,757 - INFO - Epoch(test) : [20/29]
2023-12-06 16:02:13,723 - INFO - Metrics for ship: Accuracy: 0.9622, Precision: 0.9156, Recall: 0.9461, F1_score: 0.9306, Average_Precision: 0.9696
2023-12-06 16:02:13,726 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:02:22,133 - INFO - Metrics for ship: Accuracy: 0.9067, Precision: 0.6579, Recall: 0.8348, F1_score: 0.7359, Average_Precision: 0.7721
2023-12-06 16:02:22,834 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:02:51,586 - INFO - Epoch(train)[40/100][20/79]lr: 5.4384e-04  eta: 1:54:58  time: 28.7485  inter_cls_loss: 0.0516 inner_cls_loss: 1.7442
2023-12-06 16:03:04,825 - INFO - Epoch(train)[40/100][40/79]lr: 5.4384e-04  eta: 1:23:36  time: 41.9876  inter_cls_loss: 0.0461 inner_cls_loss: 1.5957
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:03:20,354 - INFO - Epoch(train)[40/100][60/79]lr: 5.4384e-04  eta: 1:16:2  time: 57.5189  inter_cls_loss: 0.0630 inner_cls_loss: 1.7417
2023-12-06 16:03:32,714 - INFO - Epoch(test) test/all/:
2023-12-06 16:03:56,872 - INFO - Epoch(test) : [20/32]
2023-12-06 16:04:04,948 - INFO - Metrics for ship: Accuracy: 0.9496, Precision: 0.8742, Recall: 0.9077, F1_score: 0.8906, Average_Precision: 0.9461
2023-12-06 16:04:04,975 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:04:29,106 - INFO - Epoch(test) : [20/29]
2023-12-06 16:04:34,969 - INFO - Metrics for ship: Accuracy: 0.9620, Precision: 0.9162, Recall: 0.9446, F1_score: 0.9302, Average_Precision: 0.9715
2023-12-06 16:04:34,973 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:04:43,059 - INFO - Metrics for ship: Accuracy: 0.9083, Precision: 0.6600, Recall: 0.8482, F1_score: 0.7423, Average_Precision: 0.7769
2023-12-06 16:04:43,779 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:05:11,960 - INFO - Epoch(train)[41/100][20/79]lr: 5.0500e-04  eta: 1:50:34  time: 28.1142  inter_cls_loss: 0.0423 inner_cls_loss: 1.5938
2023-12-06 16:05:26,350 - INFO - Epoch(train)[41/100][40/79]lr: 5.0500e-04  eta: 1:23:14  time: 42.5022  inter_cls_loss: 0.0448 inner_cls_loss: 1.5812
2023-12-06 16:05:41,015 - INFO - Epoch(train)[41/100][60/79]lr: 5.0500e-04  eta: 1:14:19  time: 57.1671  inter_cls_loss: 0.0339 inner_cls_loss: 1.5558
2023-12-06 16:05:53,591 - INFO - Epoch(test) test/all/:
2023-12-06 16:06:17,765 - INFO - Epoch(test) : [20/32]
2023-12-06 16:06:25,808 - INFO - Metrics for ship: Accuracy: 0.9498, Precision: 0.8820, Recall: 0.8981, F1_score: 0.8899, Average_Precision: 0.9455
2023-12-06 16:06:25,839 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:06:49,834 - INFO - Epoch(test) : [20/29]
2023-12-06 16:06:55,923 - INFO - Metrics for ship: Accuracy: 0.9625, Precision: 0.9207, Recall: 0.9410, F1_score: 0.9307, Average_Precision: 0.9708
2023-12-06 16:06:55,928 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:07:04,348 - INFO - Metrics for ship: Accuracy: 0.9113, Precision: 0.6759, Recall: 0.8276, F1_score: 0.7441, Average_Precision: 0.7719
2023-12-06 16:07:05,149 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:07:34,028 - INFO - Epoch(train)[42/100][20/79]lr: 4.6616e-04  eta: 1:51:40  time: 28.8755  inter_cls_loss: 0.0414 inner_cls_loss: 1.4299
2023-12-06 16:07:47,949 - INFO - Epoch(train)[42/100][40/79]lr: 4.6616e-04  eta: 1:22:24  time: 42.8001  inter_cls_loss: 0.0657 inner_cls_loss: 1.5826
2023-12-06 16:08:02,829 - INFO - Epoch(train)[42/100][60/79]lr: 4.6616e-04  eta: 1:13:43  time: 57.6795  inter_cls_loss: 0.0430 inner_cls_loss: 1.5571
2023-12-06 16:08:15,372 - INFO - Epoch(test) test/all/:
2023-12-06 16:08:39,394 - INFO - Epoch(test) : [20/32]
2023-12-06 16:08:47,436 - INFO - Metrics for ship: Accuracy: 0.9482, Precision: 0.8933, Recall: 0.8758, F1_score: 0.8845, Average_Precision: 0.9456
2023-12-06 16:08:47,461 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:09:11,257 - INFO - Epoch(test) : [20/29]
2023-12-06 16:09:17,386 - INFO - Metrics for ship: Accuracy: 0.9605, Precision: 0.9334, Recall: 0.9180, F1_score: 0.9256, Average_Precision: 0.9719
2023-12-06 16:09:17,390 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:09:25,614 - INFO - Metrics for ship: Accuracy: 0.9130, Precision: 0.6912, Recall: 0.7981, F1_score: 0.7408, Average_Precision: 0.7712
2023-12-06 16:09:26,324 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:09:54,923 - INFO - Epoch(train)[43/100][20/79]lr: 4.2756e-04  eta: 1:48:43  time: 28.5977  inter_cls_loss: 0.0404 inner_cls_loss: 1.4017
2023-12-06 16:10:08,993 - INFO - Epoch(train)[43/100][40/79]lr: 4.2756e-04  eta: 1:20:44  time: 42.6673  inter_cls_loss: 0.0374 inner_cls_loss: 1.4759
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:10:23,039 - INFO - Epoch(train)[43/100][60/79]lr: 4.2756e-04  eta: 1:11:14  time: 56.7149  inter_cls_loss: 0.0447 inner_cls_loss: 1.4388
2023-12-06 16:10:35,894 - INFO - Epoch(test) test/all/:
2023-12-06 16:10:59,928 - INFO - Epoch(test) : [20/32]
2023-12-06 16:11:08,227 - INFO - Metrics for ship: Accuracy: 0.9487, Precision: 0.8868, Recall: 0.8862, F1_score: 0.8865, Average_Precision: 0.9426
2023-12-06 16:11:08,254 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:11:31,887 - INFO - Epoch(test) : [20/29]
2023-12-06 16:11:37,887 - INFO - Metrics for ship: Accuracy: 0.9609, Precision: 0.9254, Recall: 0.9288, F1_score: 0.9271, Average_Precision: 0.9703
2023-12-06 16:11:37,890 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:11:46,113 - INFO - Metrics for ship: Accuracy: 0.9167, Precision: 0.7020, Recall: 0.8080, F1_score: 0.7513, Average_Precision: 0.7872
2023-12-06 16:11:46,844 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:12:16,106 - INFO - Epoch(train)[44/100][20/79]lr: 3.8944e-04  eta: 1:49:18  time: 29.2580  inter_cls_loss: 0.0418 inner_cls_loss: 1.3060
2023-12-06 16:12:29,678 - INFO - Epoch(train)[44/100][40/79]lr: 3.8944e-04  eta: 1:19:38  time: 42.8320  inter_cls_loss: 0.0318 inner_cls_loss: 1.2875
2023-12-06 16:12:44,098 - INFO - Epoch(train)[44/100][60/79]lr: 3.8944e-04  eta: 1:10:39  time: 57.2504  inter_cls_loss: 0.0434 inner_cls_loss: 1.2831
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:12:56,153 - INFO - Epoch(test) test/all/:
2023-12-06 16:13:20,283 - INFO - Epoch(test) : [20/32]
2023-12-06 16:13:28,416 - INFO - Metrics for ship: Accuracy: 0.9472, Precision: 0.8602, Recall: 0.9153, F1_score: 0.8869, Average_Precision: 0.9407
2023-12-06 16:13:28,442 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:13:52,336 - INFO - Epoch(test) : [20/29]
2023-12-06 16:13:58,349 - INFO - Metrics for ship: Accuracy: 0.9622, Precision: 0.9145, Recall: 0.9476, F1_score: 0.9308, Average_Precision: 0.9706
2023-12-06 16:13:58,353 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:14:06,522 - INFO - Metrics for ship: Accuracy: 0.9048, Precision: 0.6455, Recall: 0.8621, F1_score: 0.7382, Average_Precision: 0.7811
2023-12-06 16:14:07,258 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:14:36,288 - INFO - Epoch(train)[45/100][20/79]lr: 3.5204e-04  eta: 1:46:31  time: 29.0280  inter_cls_loss: 0.0380 inner_cls_loss: 1.2338
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:14:50,662 - INFO - Epoch(train)[45/100][40/79]lr: 3.5204e-04  eta: 1:19:16  time: 43.4005  inter_cls_loss: 0.0369 inner_cls_loss: 1.2419
2023-12-06 16:15:04,553 - INFO - Epoch(train)[45/100][60/79]lr: 3.5204e-04  eta: 1:9:27  time: 57.2927  inter_cls_loss: 0.0409 inner_cls_loss: 1.2985
2023-12-06 16:15:18,172 - INFO - Epoch(test) test/all/:
2023-12-06 16:15:42,557 - INFO - Epoch(test) : [20/32]
2023-12-06 16:15:50,525 - INFO - Metrics for ship: Accuracy: 0.9483, Precision: 0.8689, Recall: 0.9085, F1_score: 0.8882, Average_Precision: 0.9409
2023-12-06 16:15:50,556 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:16:14,783 - INFO - Epoch(test) : [20/29]
2023-12-06 16:16:21,230 - INFO - Metrics for ship: Accuracy: 0.9624, Precision: 0.9147, Recall: 0.9481, F1_score: 0.9311, Average_Precision: 0.9708
2023-12-06 16:16:21,236 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:16:29,529 - INFO - Metrics for ship: Accuracy: 0.9057, Precision: 0.6522, Recall: 0.8450, F1_score: 0.7362, Average_Precision: 0.7511
2023-12-06 16:16:30,272 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:16:58,979 - INFO - Epoch(train)[46/100][20/79]lr: 3.1557e-04  eta: 1:43:27  time: 28.7047  inter_cls_loss: 0.0434 inner_cls_loss: 1.2522
2023-12-06 16:17:13,343 - INFO - Epoch(train)[46/100][40/79]lr: 3.1557e-04  eta: 1:17:14  time: 43.0645  inter_cls_loss: 0.0288 inner_cls_loss: 1.2025
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:17:27,784 - INFO - Epoch(train)[46/100][60/79]lr: 3.1557e-04  eta: 1:8:27  time: 57.5094  inter_cls_loss: 0.0287 inner_cls_loss: 1.1775
2023-12-06 16:17:40,830 - INFO - Epoch(test) test/all/:
2023-12-06 16:18:05,445 - INFO - Epoch(test) : [20/32]
2023-12-06 16:18:13,427 - INFO - Metrics for ship: Accuracy: 0.9475, Precision: 0.8746, Recall: 0.8963, F1_score: 0.8853, Average_Precision: 0.9412
2023-12-06 16:18:13,467 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:18:37,814 - INFO - Epoch(test) : [20/29]
2023-12-06 16:18:44,015 - INFO - Metrics for ship: Accuracy: 0.9608, Precision: 0.9221, Recall: 0.9326, F1_score: 0.9273, Average_Precision: 0.9707
2023-12-06 16:18:44,019 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:18:52,010 - INFO - Metrics for ship: Accuracy: 0.9050, Precision: 0.6553, Recall: 0.8229, F1_score: 0.7296, Average_Precision: 0.7624
2023-12-06 16:18:52,745 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:19:21,713 - INFO - Epoch(train)[47/100][20/79]lr: 2.8027e-04  eta: 1:42:29  time: 28.9646  inter_cls_loss: 0.0275 inner_cls_loss: 1.1357
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:19:35,928 - INFO - Epoch(train)[47/100][40/79]lr: 2.8027e-04  eta: 1:16:1  time: 43.1785  inter_cls_loss: 0.0413 inner_cls_loss: 1.1922
2023-12-06 16:19:49,144 - INFO - Epoch(train)[47/100][60/79]lr: 2.8027e-04  eta: 1:5:53  time: 56.3933  inter_cls_loss: 0.0398 inner_cls_loss: 1.1820
2023-12-06 16:20:02,393 - INFO - Epoch(test) test/all/:
2023-12-06 16:20:26,448 - INFO - Epoch(test) : [20/32]
2023-12-06 16:20:34,863 - INFO - Metrics for ship: Accuracy: 0.9468, Precision: 0.8846, Recall: 0.8797, F1_score: 0.8822, Average_Precision: 0.9342
2023-12-06 16:20:34,901 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:20:59,011 - INFO - Epoch(test) : [20/29]
2023-12-06 16:21:05,223 - INFO - Metrics for ship: Accuracy: 0.9594, Precision: 0.9294, Recall: 0.9181, F1_score: 0.9237, Average_Precision: 0.9696
2023-12-06 16:21:05,230 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:21:13,424 - INFO - Metrics for ship: Accuracy: 0.9137, Precision: 0.6932, Recall: 0.8003, F1_score: 0.7429, Average_Precision: 0.7561
2023-12-06 16:21:14,486 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:21:43,017 - INFO - Epoch(train)[48/100][20/79]lr: 2.4636e-04  eta: 1:39:3  time: 28.5269  inter_cls_loss: 0.0325 inner_cls_loss: 1.1153
2023-12-06 16:21:57,883 - INFO - Epoch(train)[48/100][40/79]lr: 2.4636e-04  eta: 1:14:58  time: 43.3904  inter_cls_loss: 0.0396 inner_cls_loss: 1.1255
2023-12-06 16:22:10,875 - INFO - Epoch(train)[48/100][60/79]lr: 2.4636e-04  eta: 1:4:38  time: 56.3874  inter_cls_loss: 0.0353 inner_cls_loss: 1.1330
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:22:24,111 - INFO - Epoch(test) test/all/:
2023-12-06 16:22:48,231 - INFO - Epoch(test) : [20/32]
2023-12-06 16:22:56,462 - INFO - Metrics for ship: Accuracy: 0.9475, Precision: 0.8677, Recall: 0.9060, F1_score: 0.8864, Average_Precision: 0.9308
2023-12-06 16:22:56,493 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:23:20,470 - INFO - Epoch(test) : [20/29]
2023-12-06 16:23:26,581 - INFO - Metrics for ship: Accuracy: 0.9619, Precision: 0.9149, Recall: 0.9457, F1_score: 0.9301, Average_Precision: 0.9676
2023-12-06 16:23:26,585 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:23:34,809 - INFO - Metrics for ship: Accuracy: 0.9050, Precision: 0.6519, Recall: 0.8375, F1_score: 0.7332, Average_Precision: 0.7482
2023-12-06 16:23:35,553 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:24:05,663 - INFO - Epoch(train)[49/100][20/79]lr: 2.1405e-04  eta: 1:42:34  time: 30.1092  inter_cls_loss: 0.0246 inner_cls_loss: 1.0949
2023-12-06 16:24:18,606 - INFO - Epoch(train)[49/100][40/79]lr: 2.1405e-04  eta: 1:12:58  time: 43.0527  inter_cls_loss: 0.0282 inner_cls_loss: 1.0521
2023-12-06 16:24:32,662 - INFO - Epoch(train)[49/100][60/79]lr: 2.1405e-04  eta: 1:4:12  time: 57.1060  inter_cls_loss: 0.0194 inner_cls_loss: 1.0351
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:24:46,112 - INFO - Epoch(test) test/all/:
2023-12-06 16:25:10,087 - INFO - Epoch(test) : [20/32]
2023-12-06 16:25:18,265 - INFO - Metrics for ship: Accuracy: 0.9469, Precision: 0.8687, Recall: 0.9014, F1_score: 0.8847, Average_Precision: 0.9211
2023-12-06 16:25:18,303 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:25:42,726 - INFO - Epoch(test) : [20/29]
2023-12-06 16:25:48,581 - INFO - Metrics for ship: Accuracy: 0.9611, Precision: 0.9206, Recall: 0.9353, F1_score: 0.9279, Average_Precision: 0.9681
2023-12-06 16:25:48,584 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:25:56,719 - INFO - Metrics for ship: Accuracy: 0.9068, Precision: 0.6570, Recall: 0.8408, F1_score: 0.7376, Average_Precision: 0.7231
2023-12-06 16:25:57,781 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:26:27,115 - INFO - Epoch(train)[50/100][20/79]lr: 1.8352e-04  eta: 1:37:59  time: 29.3299  inter_cls_loss: 0.0303 inner_cls_loss: 1.0800
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:26:41,233 - INFO - Epoch(train)[50/100][40/79]lr: 1.8352e-04  eta: 1:12:12  time: 43.4480  inter_cls_loss: 0.0238 inner_cls_loss: 1.0031
2023-12-06 16:26:54,837 - INFO - Epoch(train)[50/100][60/79]lr: 1.8352e-04  eta: 1:2:53  time: 57.0507  inter_cls_loss: 0.0464 inner_cls_loss: 1.0759
2023-12-06 16:27:07,823 - INFO - Epoch(test) test/all/:
2023-12-06 16:27:31,598 - INFO - Epoch(test) : [20/32]
2023-12-06 16:27:39,911 - INFO - Metrics for ship: Accuracy: 0.9469, Precision: 0.8706, Recall: 0.8989, F1_score: 0.8845, Average_Precision: 0.9304
2023-12-06 16:27:39,942 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:28:04,486 - INFO - Epoch(test) : [20/29]
2023-12-06 16:28:11,160 - INFO - Metrics for ship: Accuracy: 0.9603, Precision: 0.9205, Recall: 0.9324, F1_score: 0.9264, Average_Precision: 0.9684
2023-12-06 16:28:11,164 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:28:19,221 - INFO - Metrics for ship: Accuracy: 0.9067, Precision: 0.6592, Recall: 0.8296, F1_score: 0.7347, Average_Precision: 0.7372
2023-12-06 16:28:20,254 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:28:49,146 - INFO - Epoch(train)[51/100][20/79]lr: 1.5498e-04  eta: 1:34:24  time: 28.8270  inter_cls_loss: 0.0362 inner_cls_loss: 1.0047
2023-12-06 16:29:03,748 - INFO - Epoch(train)[51/100][40/79]lr: 1.5498e-04  eta: 1:10:45  time: 43.4286  inter_cls_loss: 0.0261 inner_cls_loss: 1.0079
2023-12-06 16:29:16,761 - INFO - Epoch(train)[51/100][60/79]lr: 1.5498e-04  eta: 1:0:59  time: 56.4429  inter_cls_loss: 0.0421 inner_cls_loss: 1.0336
2023-12-06 16:29:30,425 - INFO - Epoch(test) test/all/:
2023-12-06 16:29:54,736 - INFO - Epoch(test) : [20/32]
2023-12-06 16:30:03,049 - INFO - Metrics for ship: Accuracy: 0.9466, Precision: 0.8682, Recall: 0.9008, F1_score: 0.8842, Average_Precision: 0.9298
2023-12-06 16:30:03,080 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:30:27,304 - INFO - Epoch(test) : [20/29]
2023-12-06 16:30:33,378 - INFO - Metrics for ship: Accuracy: 0.9604, Precision: 0.9165, Recall: 0.9374, F1_score: 0.9269, Average_Precision: 0.9686
2023-12-06 16:30:33,381 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:30:41,973 - INFO - Metrics for ship: Accuracy: 0.9065, Precision: 0.6573, Recall: 0.8353, F1_score: 0.7357, Average_Precision: 0.7324
2023-12-06 16:30:42,745 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:31:11,076 - INFO - Epoch(train)[52/100][20/79]lr: 1.2860e-04  eta: 1:30:54  time: 28.3290  inter_cls_loss: 0.0197 inner_cls_loss: 0.9707
2023-12-06 16:31:24,884 - INFO - Epoch(train)[52/100][40/79]lr: 1.2860e-04  eta: 1:7:15  time: 42.1380  inter_cls_loss: 0.0230 inner_cls_loss: 0.9668
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:31:39,395 - INFO - Epoch(train)[52/100][60/79]lr: 1.2860e-04  eta: 0:59:58  time: 56.6480  inter_cls_loss: 0.0338 inner_cls_loss: 1.0167
2023-12-06 16:31:52,049 - INFO - Epoch(test) test/all/:
2023-12-06 16:32:15,687 - INFO - Epoch(test) : [20/32]
2023-12-06 16:32:23,832 - INFO - Metrics for ship: Accuracy: 0.9474, Precision: 0.8777, Recall: 0.8918, F1_score: 0.8847, Average_Precision: 0.9305
2023-12-06 16:32:23,863 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:32:47,643 - INFO - Epoch(test) : [20/29]
2023-12-06 16:32:53,687 - INFO - Metrics for ship: Accuracy: 0.9601, Precision: 0.9204, Recall: 0.9316, F1_score: 0.9259, Average_Precision: 0.9683
2023-12-06 16:32:53,690 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:33:01,656 - INFO - Metrics for ship: Accuracy: 0.9127, Precision: 0.6836, Recall: 0.8187, F1_score: 0.7451, Average_Precision: 0.7482
2023-12-06 16:33:02,414 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:33:31,130 - INFO - Epoch(train)[53/100][20/79]lr: 1.0454e-04  eta: 1:30:15  time: 28.7150  inter_cls_loss: 0.0242 inner_cls_loss: 0.9933
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:33:45,968 - INFO - Epoch(train)[53/100][40/79]lr: 1.0454e-04  eta: 1:8:5  time: 43.5529  inter_cls_loss: 0.0243 inner_cls_loss: 0.9897
2023-12-06 16:33:59,374 - INFO - Epoch(train)[53/100][60/79]lr: 1.0454e-04  eta: 0:59:2  time: 56.9591  inter_cls_loss: 0.0362 inner_cls_loss: 1.0051
2023-12-06 16:34:12,859 - INFO - Epoch(test) test/all/:
2023-12-06 16:34:36,883 - INFO - Epoch(test) : [20/32]
2023-12-06 16:34:45,358 - INFO - Metrics for ship: Accuracy: 0.9469, Precision: 0.8722, Recall: 0.8965, F1_score: 0.8842, Average_Precision: 0.9259
2023-12-06 16:34:45,395 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:35:09,415 - INFO - Epoch(test) : [20/29]
2023-12-06 16:35:15,504 - INFO - Metrics for ship: Accuracy: 0.9603, Precision: 0.9183, Recall: 0.9350, F1_score: 0.9265, Average_Precision: 0.9671
2023-12-06 16:35:15,508 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:35:23,733 - INFO - Metrics for ship: Accuracy: 0.9114, Precision: 0.6767, Recall: 0.8254, F1_score: 0.7437, Average_Precision: 0.7391
2023-12-06 16:35:24,485 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:35:52,542 - INFO - Epoch(train)[54/100][20/79]lr: 8.2943e-05  eta: 1:26:20  time: 28.0533  inter_cls_loss: 0.0136 inner_cls_loss: 0.9033
2023-12-06 16:36:07,323 - INFO - Epoch(train)[54/100][40/79]lr: 8.2943e-05  eta: 1:5:33  time: 42.8360  inter_cls_loss: 0.0267 inner_cls_loss: 0.9591
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:36:21,718 - INFO - Epoch(train)[54/100][60/79]lr: 8.2943e-05  eta: 0:58:4  time: 57.2315  inter_cls_loss: 0.0149 inner_cls_loss: 0.8688
2023-12-06 16:36:34,404 - INFO - Epoch(test) test/all/:
2023-12-06 16:36:58,687 - INFO - Epoch(test) : [20/32]
2023-12-06 16:37:06,587 - INFO - Metrics for ship: Accuracy: 0.9460, Precision: 0.8800, Recall: 0.8815, F1_score: 0.8808, Average_Precision: 0.9214
2023-12-06 16:37:06,628 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:37:30,715 - INFO - Epoch(test) : [20/29]
2023-12-06 16:37:36,843 - INFO - Metrics for ship: Accuracy: 0.9596, Precision: 0.9251, Recall: 0.9241, F1_score: 0.9246, Average_Precision: 0.9663
2023-12-06 16:37:36,847 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:37:44,968 - INFO - Metrics for ship: Accuracy: 0.9127, Precision: 0.6868, Recall: 0.8083, F1_score: 0.7426, Average_Precision: 0.7286
2023-12-06 16:37:45,693 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:38:14,947 - INFO - Epoch(train)[55/100][20/79]lr: 6.3952e-05  eta: 1:28:6  time: 29.2531  inter_cls_loss: 0.0164 inner_cls_loss: 0.8965
2023-12-06 16:38:28,938 - INFO - Epoch(train)[55/100][40/79]lr: 6.3952e-05  eta: 1:4:45  time: 43.2441  inter_cls_loss: 0.0292 inner_cls_loss: 0.9311
2023-12-06 16:38:42,448 - INFO - Epoch(train)[55/100][60/79]lr: 6.3952e-05  eta: 0:56:20  time: 56.7539  inter_cls_loss: 0.0144 inner_cls_loss: 0.8800
2023-12-06 16:38:55,963 - INFO - Epoch(test) test/all/:
2023-12-06 16:39:19,963 - INFO - Epoch(test) : [20/32]
2023-12-06 16:39:27,973 - INFO - Metrics for ship: Accuracy: 0.9464, Precision: 0.8775, Recall: 0.8867, F1_score: 0.8821, Average_Precision: 0.9214
2023-12-06 16:39:28,004 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:39:52,246 - INFO - Epoch(test) : [20/29]
2023-12-06 16:39:58,219 - INFO - Metrics for ship: Accuracy: 0.9596, Precision: 0.9233, Recall: 0.9263, F1_score: 0.9248, Average_Precision: 0.9666
2023-12-06 16:39:58,222 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:40:06,457 - INFO - Metrics for ship: Accuracy: 0.9115, Precision: 0.6812, Recall: 0.8120, F1_score: 0.7409, Average_Precision: 0.7266
2023-12-06 16:40:07,188 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:40:35,764 - INFO - Epoch(train)[56/100][20/79]lr: 4.7680e-05  eta: 1:24:10  time: 28.5726  inter_cls_loss: 0.0137 inner_cls_loss: 0.9498
2023-12-06 16:40:50,105 - INFO - Epoch(train)[56/100][40/79]lr: 4.7680e-05  eta: 1:2:50  time: 42.9119  inter_cls_loss: 0.0224 inner_cls_loss: 0.9373
2023-12-06 16:41:03,721 - INFO - Epoch(train)[56/100][60/79]lr: 4.7680e-05  eta: 0:54:52  time: 56.5312  inter_cls_loss: 0.0176 inner_cls_loss: 0.9446
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:41:16,697 - INFO - Epoch(test) test/all/:
2023-12-06 16:41:40,570 - INFO - Epoch(test) : [20/32]
2023-12-06 16:41:48,978 - INFO - Metrics for ship: Accuracy: 0.9457, Precision: 0.8759, Recall: 0.8857, F1_score: 0.8807, Average_Precision: 0.9191
2023-12-06 16:41:49,006 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:42:12,950 - INFO - Epoch(test) : [20/29]
2023-12-06 16:42:19,196 - INFO - Metrics for ship: Accuracy: 0.9592, Precision: 0.9243, Recall: 0.9234, F1_score: 0.9239, Average_Precision: 0.9658
2023-12-06 16:42:19,200 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:42:27,469 - INFO - Metrics for ship: Accuracy: 0.9120, Precision: 0.6818, Recall: 0.8152, F1_score: 0.7426, Average_Precision: 0.7273
2023-12-06 16:42:28,183 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:42:57,132 - INFO - Epoch(train)[57/100][20/79]lr: 3.4227e-05  eta: 1:23:22  time: 28.9479  inter_cls_loss: 0.0302 inner_cls_loss: 0.9152
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:43:10,219 - INFO - Epoch(train)[57/100][40/79]lr: 3.4227e-05  eta: 1:0:10  time: 42.0338  inter_cls_loss: 0.0340 inner_cls_loss: 0.9230
2023-12-06 16:43:25,482 - INFO - Epoch(train)[57/100][60/79]lr: 3.4227e-05  eta: 0:54:22  time: 57.2964  inter_cls_loss: 0.0167 inner_cls_loss: 0.9117
2023-12-06 16:43:37,559 - INFO - Epoch(test) test/all/:
2023-12-06 16:44:02,006 - INFO - Epoch(test) : [20/32]
2023-12-06 16:44:10,343 - INFO - Metrics for ship: Accuracy: 0.9461, Precision: 0.8793, Recall: 0.8827, F1_score: 0.8810, Average_Precision: 0.9168
2023-12-06 16:44:10,373 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:44:34,322 - INFO - Epoch(test) : [20/29]
2023-12-06 16:44:40,497 - INFO - Metrics for ship: Accuracy: 0.9597, Precision: 0.9245, Recall: 0.9252, F1_score: 0.9249, Average_Precision: 0.9657
2023-12-06 16:44:40,500 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:44:48,839 - INFO - Metrics for ship: Accuracy: 0.9123, Precision: 0.6852, Recall: 0.8085, F1_score: 0.7418, Average_Precision: 0.7155
2023-12-06 16:44:49,896 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:45:18,290 - INFO - Epoch(train)[58/100][20/79]lr: 2.3677e-05  eta: 1:19:53  time: 28.3899  inter_cls_loss: 0.0114 inner_cls_loss: 0.8680
2023-12-06 16:45:33,013 - INFO - Epoch(train)[58/100][40/79]lr: 2.3677e-05  eta: 1:0:18  time: 43.1147  inter_cls_loss: 0.0365 inner_cls_loss: 0.9562
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:45:47,428 - INFO - Epoch(train)[58/100][60/79]lr: 2.3677e-05  eta: 0:53:19  time: 57.5280  inter_cls_loss: 0.0233 inner_cls_loss: 0.9407
2023-12-06 16:45:59,345 - INFO - Epoch(test) test/all/:
2023-12-06 16:46:23,311 - INFO - Epoch(test) : [20/32]
2023-12-06 16:46:31,479 - INFO - Metrics for ship: Accuracy: 0.9463, Precision: 0.8722, Recall: 0.8936, F1_score: 0.8827, Average_Precision: 0.9168
2023-12-06 16:46:31,511 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:46:55,505 - INFO - Epoch(test) : [20/29]
2023-12-06 16:47:01,880 - INFO - Metrics for ship: Accuracy: 0.9604, Precision: 0.9195, Recall: 0.9339, F1_score: 0.9266, Average_Precision: 0.9649
2023-12-06 16:47:01,884 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:47:09,954 - INFO - Metrics for ship: Accuracy: 0.9097, Precision: 0.6732, Recall: 0.8170, F1_score: 0.7382, Average_Precision: 0.7118
2023-12-06 16:47:10,978 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:47:39,418 - INFO - Epoch(train)[59/100][20/79]lr: 1.6094e-05  eta: 1:18:9  time: 28.4390  inter_cls_loss: 0.0150 inner_cls_loss: 0.9014
2023-12-06 16:47:53,355 - INFO - Epoch(train)[59/100][40/79]lr: 1.6094e-05  eta: 0:57:52  time: 42.3733  inter_cls_loss: 0.0170 inner_cls_loss: 0.8991
2023-12-06 16:48:07,465 - INFO - Epoch(train)[59/100][60/79]lr: 1.6094e-05  eta: 0:51:7  time: 56.4861  inter_cls_loss: 0.0285 inner_cls_loss: 0.9355
2023-12-06 16:48:20,594 - INFO - Epoch(test) test/all/:
2023-12-06 16:48:44,639 - INFO - Epoch(test) : [20/32]
2023-12-06 16:48:52,738 - INFO - Metrics for ship: Accuracy: 0.9461, Precision: 0.8767, Recall: 0.8865, F1_score: 0.8816, Average_Precision: 0.9170
2023-12-06 16:48:52,768 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:49:16,718 - INFO - Epoch(test) : [20/29]
2023-12-06 16:49:23,159 - INFO - Metrics for ship: Accuracy: 0.9596, Precision: 0.9215, Recall: 0.9284, F1_score: 0.9249, Average_Precision: 0.9650
2023-12-06 16:49:23,162 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:49:31,441 - INFO - Metrics for ship: Accuracy: 0.9113, Precision: 0.6813, Recall: 0.8095, F1_score: 0.7399, Average_Precision: 0.7135
2023-12-06 16:49:32,160 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:50:00,482 - INFO - Epoch(train)[60/100][20/79]lr: 1.1526e-05  eta: 1:15:57  time: 28.3163  inter_cls_loss: 0.0121 inner_cls_loss: 0.8424
2023-12-06 16:50:14,872 - INFO - Epoch(train)[60/100][40/79]lr: 1.1526e-05  eta: 0:56:55  time: 42.7111  inter_cls_loss: 0.0141 inner_cls_loss: 0.8901
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:50:27,953 - INFO - Epoch(train)[60/100][60/79]lr: 1.1526e-05  eta: 0:49:16  time: 55.7916  inter_cls_loss: 0.0266 inner_cls_loss: 0.9515
2023-12-06 16:50:41,349 - INFO - Epoch(test) test/all/:
2023-12-06 16:51:05,381 - INFO - Epoch(test) : [20/32]
2023-12-06 16:51:13,428 - INFO - Metrics for ship: Accuracy: 0.9461, Precision: 0.8737, Recall: 0.8905, F1_score: 0.8820, Average_Precision: 0.9155
2023-12-06 16:51:13,459 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:51:37,862 - INFO - Epoch(test) : [20/29]
2023-12-06 16:51:43,546 - INFO - Metrics for ship: Accuracy: 0.9600, Precision: 0.9212, Recall: 0.9303, F1_score: 0.9257, Average_Precision: 0.9648
2023-12-06 16:51:43,550 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:51:51,828 - INFO - Metrics for ship: Accuracy: 0.9104, Precision: 0.6763, Recall: 0.8147, F1_score: 0.7391, Average_Precision: 0.7132
2023-12-06 16:51:52,892 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:52:21,608 - INFO - Epoch(train)[61/100][20/79]lr: 1.0000e-03  eta: 1:14:57  time: 28.6472  inter_cls_loss: 0.1509 inner_cls_loss: 2.0333
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:52:35,271 - INFO - Epoch(train)[61/100][40/79]lr: 1.0000e-03  eta: 0:55:0  time: 42.3142  inter_cls_loss: 0.0954 inner_cls_loss: 1.4197
2023-12-06 16:52:49,991 - INFO - Epoch(train)[61/100][60/79]lr: 1.0000e-03  eta: 0:49:6  time: 57.0311  inter_cls_loss: 0.0994 inner_cls_loss: 1.2315
2023-12-06 16:53:03,064 - INFO - Epoch(test) test/all/:
2023-12-06 16:53:27,091 - INFO - Epoch(test) : [20/32]
2023-12-06 16:53:35,348 - INFO - Metrics for ship: Accuracy: 0.9443, Precision: 0.8455, Recall: 0.9225, F1_score: 0.8823, Average_Precision: 0.9393
2023-12-06 16:53:35,379 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:53:59,167 - INFO - Epoch(test) : [20/29]
2023-12-06 16:54:05,418 - INFO - Metrics for ship: Accuracy: 0.9595, Precision: 0.8970, Recall: 0.9590, F1_score: 0.9270, Average_Precision: 0.9648
2023-12-06 16:54:05,422 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:54:13,594 - INFO - Metrics for ship: Accuracy: 0.8962, Precision: 0.6180, Recall: 0.8735, F1_score: 0.7239, Average_Precision: 0.7907
2023-12-06 16:54:14,304 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:54:42,086 - INFO - Epoch(train)[62/100][20/79]lr: 9.9962e-04  eta: 1:10:51  time: 27.7775  inter_cls_loss: 0.0588 inner_cls_loss: 0.9379
2023-12-06 16:54:56,940 - INFO - Epoch(train)[62/100][40/79]lr: 9.9962e-04  eta: 0:54:1  time: 42.6323  inter_cls_loss: 0.0506 inner_cls_loss: 0.9350
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:55:10,272 - INFO - Epoch(train)[62/100][60/79]lr: 9.9962e-04  eta: 0:46:57  time: 55.9644  inter_cls_loss: 0.0431 inner_cls_loss: 0.8268
2023-12-06 16:55:23,762 - INFO - Epoch(test) test/all/:
2023-12-06 16:55:48,046 - INFO - Epoch(test) : [20/32]
2023-12-06 16:55:56,131 - INFO - Metrics for ship: Accuracy: 0.9456, Precision: 0.8670, Recall: 0.8974, F1_score: 0.8819, Average_Precision: 0.9371
2023-12-06 16:55:56,162 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:56:19,906 - INFO - Epoch(test) : [20/29]
2023-12-06 16:56:26,197 - INFO - Metrics for ship: Accuracy: 0.9594, Precision: 0.9063, Recall: 0.9463, F1_score: 0.9259, Average_Precision: 0.9620
2023-12-06 16:56:26,201 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:56:34,333 - INFO - Metrics for ship: Accuracy: 0.9088, Precision: 0.6713, Recall: 0.8125, F1_score: 0.7352, Average_Precision: 0.7687
2023-12-06 16:56:35,057 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 16:57:03,431 - INFO - Epoch(train)[63/100][20/79]lr: 9.9847e-04  eta: 1:10:29  time: 28.3693  inter_cls_loss: 0.0925 inner_cls_loss: 0.9795
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:57:17,469 - INFO - Epoch(train)[63/100][40/79]lr: 9.9847e-04  eta: 0:52:20  time: 42.4099  inter_cls_loss: 0.0720 inner_cls_loss: 0.8515
2023-12-06 16:57:31,807 - INFO - Epoch(train)[63/100][60/79]lr: 9.9847e-04  eta: 0:46:22  time: 56.7480  inter_cls_loss: 0.0643 inner_cls_loss: 0.7353
2023-12-06 16:57:44,663 - INFO - Epoch(test) test/all/:
2023-12-06 16:58:08,424 - INFO - Epoch(test) : [20/32]
2023-12-06 16:58:16,499 - INFO - Metrics for ship: Accuracy: 0.9453, Precision: 0.8965, Recall: 0.8569, F1_score: 0.8763, Average_Precision: 0.9419
2023-12-06 16:58:16,529 - INFO - Epoch(test) test/offshore/:
2023-12-06 16:58:40,674 - INFO - Epoch(test) : [20/29]
2023-12-06 16:58:47,098 - INFO - Metrics for ship: Accuracy: 0.9584, Precision: 0.9265, Recall: 0.9175, F1_score: 0.9219, Average_Precision: 0.9658
2023-12-06 16:58:47,102 - INFO - Epoch(test) test/inshore/:
2023-12-06 16:58:55,429 - INFO - Metrics for ship: Accuracy: 0.9112, Precision: 0.7006, Recall: 0.7510, F1_score: 0.7249, Average_Precision: 0.7722
2023-12-06 16:58:56,453 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 16:59:25,805 - INFO - Epoch(train)[64/100][20/79]lr: 9.9657e-04  eta: 1:11:0  time: 29.3498  inter_cls_loss: 0.0553 inner_cls_loss: 0.7197
2023-12-06 16:59:39,276 - INFO - Epoch(train)[64/100][40/79]lr: 9.9657e-04  eta: 0:51:26  time: 42.8182  inter_cls_loss: 0.0555 inner_cls_loss: 0.6506
2023-12-06 16:59:53,748 - INFO - Epoch(train)[64/100][60/79]lr: 9.9657e-04  eta: 0:45:33  time: 57.2905  inter_cls_loss: 0.0695 inner_cls_loss: 0.6741
2023-12-06 17:00:06,540 - INFO - Epoch(test) test/all/:
2023-12-06 17:00:30,736 - INFO - Epoch(test) : [20/32]
2023-12-06 17:00:38,886 - INFO - Metrics for ship: Accuracy: 0.9474, Precision: 0.8656, Recall: 0.9087, F1_score: 0.8866, Average_Precision: 0.9422
2023-12-06 17:00:38,918 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:01:03,347 - INFO - Epoch(test) : [20/29]
2023-12-06 17:01:09,366 - INFO - Metrics for ship: Accuracy: 0.9618, Precision: 0.9186, Recall: 0.9407, F1_score: 0.9295, Average_Precision: 0.9699
2023-12-06 17:01:09,370 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:01:17,626 - INFO - Metrics for ship: Accuracy: 0.9059, Precision: 0.6471, Recall: 0.8713, F1_score: 0.7426, Average_Precision: 0.7858
2023-12-06 17:01:18,654 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:01:47,792 - INFO - Epoch(train)[65/100][20/79]lr: 9.9391e-04  eta: 1:8:34  time: 29.1370  inter_cls_loss: 0.0453 inner_cls_loss: 0.5627
2023-12-06 17:02:00,677 - INFO - Epoch(train)[65/100][40/79]lr: 9.9391e-04  eta: 0:49:5  time: 42.0225  inter_cls_loss: 0.0474 inner_cls_loss: 0.5391
2023-12-06 17:02:15,629 - INFO - Epoch(train)[65/100][60/79]lr: 9.9391e-04  eta: 0:44:3  time: 56.9742  inter_cls_loss: 0.0594 inner_cls_loss: 0.5599
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:02:28,051 - INFO - Epoch(test) test/all/:
2023-12-06 17:02:52,271 - INFO - Epoch(test) : [20/32]
2023-12-06 17:03:00,729 - INFO - Metrics for ship: Accuracy: 0.9480, Precision: 0.8912, Recall: 0.8770, F1_score: 0.8840, Average_Precision: 0.9407
2023-12-06 17:03:00,757 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:03:24,841 - INFO - Epoch(test) : [20/29]
2023-12-06 17:03:31,200 - INFO - Metrics for ship: Accuracy: 0.9591, Precision: 0.9291, Recall: 0.9174, F1_score: 0.9232, Average_Precision: 0.9694
2023-12-06 17:03:31,203 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:03:39,548 - INFO - Metrics for ship: Accuracy: 0.9156, Precision: 0.6965, Recall: 0.8118, F1_score: 0.7497, Average_Precision: 0.7687
2023-12-06 17:03:40,242 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:04:08,660 - INFO - Epoch(train)[66/100][20/79]lr: 9.9049e-04  eta: 1:5:0  time: 28.4162  inter_cls_loss: 0.0695 inner_cls_loss: 0.5534
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:04:23,338 - INFO - Epoch(train)[66/100][40/79]lr: 9.9049e-04  eta: 0:48:55  time: 43.0942  inter_cls_loss: 0.0644 inner_cls_loss: 0.5247
2023-12-06 17:04:38,110 - INFO - Epoch(train)[66/100][60/79]lr: 9.9049e-04  eta: 0:43:28  time: 57.8675  inter_cls_loss: 0.0642 inner_cls_loss: 0.4985
2023-12-06 17:04:50,306 - INFO - Epoch(test) test/all/:
2023-12-06 17:05:14,344 - INFO - Epoch(test) : [20/32]
2023-12-06 17:05:22,405 - INFO - Metrics for ship: Accuracy: 0.9412, Precision: 0.9191, Recall: 0.8115, F1_score: 0.8619, Average_Precision: 0.9420
2023-12-06 17:05:22,440 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:05:46,315 - INFO - Epoch(test) : [20/29]
2023-12-06 17:05:52,357 - INFO - Metrics for ship: Accuracy: 0.9540, Precision: 0.9397, Recall: 0.8851, F1_score: 0.9116, Average_Precision: 0.9680
2023-12-06 17:05:52,362 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:06:00,412 - INFO - Metrics for ship: Accuracy: 0.9111, Precision: 0.7286, Recall: 0.6838, F1_score: 0.7055, Average_Precision: 0.7660
2023-12-06 17:06:01,146 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:06:29,079 - INFO - Epoch(train)[67/100][20/79]lr: 9.8632e-04  eta: 1:2:3  time: 27.9322  inter_cls_loss: 0.0568 inner_cls_loss: 0.5402
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:06:43,935 - INFO - Epoch(train)[67/100][40/79]lr: 9.8632e-04  eta: 0:47:10  time: 42.7870  inter_cls_loss: 0.0504 inner_cls_loss: 0.4688
2023-12-06 17:06:57,293 - INFO - Epoch(train)[67/100][60/79]lr: 9.8632e-04  eta: 0:40:57  time: 56.1454  inter_cls_loss: 0.0541 inner_cls_loss: 0.4284
2023-12-06 17:07:10,415 - INFO - Epoch(test) test/all/:
2023-12-06 17:07:34,340 - INFO - Epoch(test) : [20/32]
2023-12-06 17:07:42,426 - INFO - Metrics for ship: Accuracy: 0.9474, Precision: 0.8892, Recall: 0.8766, F1_score: 0.8829, Average_Precision: 0.9438
2023-12-06 17:07:42,456 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:08:06,636 - INFO - Epoch(test) : [20/29]
2023-12-06 17:08:13,000 - INFO - Metrics for ship: Accuracy: 0.9596, Precision: 0.9251, Recall: 0.9241, F1_score: 0.9246, Average_Precision: 0.9672
2023-12-06 17:08:13,004 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:08:21,178 - INFO - Metrics for ship: Accuracy: 0.9174, Precision: 0.7131, Recall: 0.7855, F1_score: 0.7476, Average_Precision: 0.7958
2023-12-06 17:08:21,906 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:08:50,769 - INFO - Epoch(train)[68/100][20/79]lr: 9.8142e-04  eta: 1:2:13  time: 28.8616  inter_cls_loss: 0.0397 inner_cls_loss: 0.3793
2023-12-06 17:09:05,709 - INFO - Epoch(train)[68/100][40/79]lr: 9.8142e-04  eta: 0:46:50  time: 43.7987  inter_cls_loss: 0.0254 inner_cls_loss: 0.3568
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:09:18,845 - INFO - Epoch(train)[68/100][60/79]lr: 9.8142e-04  eta: 0:40:17  time: 56.9383  inter_cls_loss: 0.0552 inner_cls_loss: 0.3691
2023-12-06 17:09:32,264 - INFO - Epoch(test) test/all/:
2023-12-06 17:09:56,304 - INFO - Epoch(test) : [20/32]
2023-12-06 17:10:04,308 - INFO - Metrics for ship: Accuracy: 0.9452, Precision: 0.8582, Recall: 0.9076, F1_score: 0.8822, Average_Precision: 0.9254
2023-12-06 17:10:04,339 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:10:28,250 - INFO - Epoch(test) : [20/29]
2023-12-06 17:10:34,299 - INFO - Metrics for ship: Accuracy: 0.9619, Precision: 0.9215, Recall: 0.9374, F1_score: 0.9294, Average_Precision: 0.9693
2023-12-06 17:10:34,303 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:10:42,608 - INFO - Metrics for ship: Accuracy: 0.9030, Precision: 0.6410, Recall: 0.8574, F1_score: 0.7336, Average_Precision: 0.7513
2023-12-06 17:10:43,301 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:11:12,094 - INFO - Epoch(train)[69/100][20/79]lr: 9.7577e-04  eta: 1:0:9  time: 28.7877  inter_cls_loss: 0.0502 inner_cls_loss: 0.3318
2023-12-06 17:11:26,594 - INFO - Epoch(train)[69/100][40/79]lr: 9.7577e-04  eta: 0:44:52  time: 43.2929  inter_cls_loss: 0.0536 inner_cls_loss: 0.3472
2023-12-06 17:11:41,219 - INFO - Epoch(train)[69/100][60/79]lr: 9.7577e-04  eta: 0:39:42  time: 57.9165  inter_cls_loss: 0.0447 inner_cls_loss: 0.3136
2023-12-06 17:11:53,518 - INFO - Epoch(test) test/all/:
2023-12-06 17:12:17,327 - INFO - Epoch(test) : [20/32]
2023-12-06 17:12:25,946 - INFO - Metrics for ship: Accuracy: 0.9485, Precision: 0.8815, Recall: 0.8924, F1_score: 0.8869, Average_Precision: 0.9388
2023-12-06 17:12:25,977 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:12:49,972 - INFO - Epoch(test) : [20/29]
2023-12-06 17:12:56,082 - INFO - Metrics for ship: Accuracy: 0.9613, Precision: 0.9167, Recall: 0.9410, F1_score: 0.9287, Average_Precision: 0.9669
2023-12-06 17:12:56,086 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:13:04,751 - INFO - Metrics for ship: Accuracy: 0.9143, Precision: 0.6889, Recall: 0.8207, F1_score: 0.7491, Average_Precision: 0.7710
2023-12-06 17:13:05,460 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:13:34,005 - INFO - Epoch(train)[70/100][20/79]lr: 9.6940e-04  eta: 0:57:46  time: 28.5449  inter_cls_loss: 0.0587 inner_cls_loss: 0.3311
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:13:47,738 - INFO - Epoch(train)[70/100][40/79]lr: 9.6940e-04  eta: 0:42:26  time: 42.2766  inter_cls_loss: 0.0473 inner_cls_loss: 0.2903
2023-12-06 17:14:01,914 - INFO - Epoch(train)[70/100][60/79]lr: 9.6940e-04  eta: 0:37:27  time: 56.4504  inter_cls_loss: 0.0607 inner_cls_loss: 0.2934
2023-12-06 17:14:14,892 - INFO - Epoch(test) test/all/:
2023-12-06 17:14:39,168 - INFO - Epoch(test) : [20/32]
2023-12-06 17:14:47,338 - INFO - Metrics for ship: Accuracy: 0.9491, Precision: 0.8656, Recall: 0.9172, F1_score: 0.8906, Average_Precision: 0.9431
2023-12-06 17:14:47,368 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:15:11,213 - INFO - Epoch(test) : [20/29]
2023-12-06 17:15:17,419 - INFO - Metrics for ship: Accuracy: 0.9612, Precision: 0.9077, Recall: 0.9519, F1_score: 0.9293, Average_Precision: 0.9646
2023-12-06 17:15:17,423 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:15:25,490 - INFO - Metrics for ship: Accuracy: 0.9093, Precision: 0.6638, Recall: 0.8470, F1_score: 0.7443, Average_Precision: 0.7788
2023-12-06 17:15:26,206 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:15:55,420 - INFO - Epoch(train)[71/100][20/79]lr: 9.6232e-04  eta: 0:57:4  time: 29.1476  inter_cls_loss: 0.0518 inner_cls_loss: 0.3021
2023-12-06 17:16:09,466 - INFO - Epoch(train)[71/100][40/79]lr: 9.6232e-04  eta: 0:41:55  time: 43.1921  inter_cls_loss: 0.0465 inner_cls_loss: 0.2712
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:16:23,905 - INFO - Epoch(train)[71/100][60/79]lr: 9.6232e-04  eta: 0:36:58  time: 57.6276  inter_cls_loss: 0.0391 inner_cls_loss: 0.2368
2023-12-06 17:16:36,713 - INFO - Epoch(test) test/all/:
2023-12-06 17:17:00,402 - INFO - Epoch(test) : [20/32]
2023-12-06 17:17:08,594 - INFO - Metrics for ship: Accuracy: 0.9477, Precision: 0.8904, Recall: 0.8764, F1_score: 0.8834, Average_Precision: 0.9396
2023-12-06 17:17:08,625 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:17:32,752 - INFO - Epoch(test) : [20/29]
2023-12-06 17:17:38,818 - INFO - Metrics for ship: Accuracy: 0.9597, Precision: 0.9307, Recall: 0.9178, F1_score: 0.9242, Average_Precision: 0.9692
2023-12-06 17:17:38,823 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:17:46,840 - INFO - Metrics for ship: Accuracy: 0.9178, Precision: 0.7100, Recall: 0.7986, F1_score: 0.7517, Average_Precision: 0.7832
2023-12-06 17:17:47,526 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:18:16,136 - INFO - Epoch(train)[72/100][20/79]lr: 9.5453e-04  eta: 0:54:8  time: 28.6086  inter_cls_loss: 0.0400 inner_cls_loss: 0.2146
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:18:29,865 - INFO - Epoch(train)[72/100][40/79]lr: 9.5453e-04  eta: 0:39:42  time: 42.3384  inter_cls_loss: 0.0399 inner_cls_loss: 0.2131
2023-12-06 17:18:44,885 - INFO - Epoch(train)[72/100][60/79]lr: 9.5453e-04  eta: 0:35:32  time: 57.3575  inter_cls_loss: 0.0299 inner_cls_loss: 0.2053
2023-12-06 17:18:57,015 - INFO - Epoch(test) test/all/:
2023-12-06 17:19:21,137 - INFO - Epoch(test) : [20/32]
2023-12-06 17:19:29,043 - INFO - Metrics for ship: Accuracy: 0.9447, Precision: 0.9000, Recall: 0.8499, F1_score: 0.8742, Average_Precision: 0.9420
2023-12-06 17:19:29,072 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:19:53,240 - INFO - Epoch(test) : [20/29]
2023-12-06 17:19:59,358 - INFO - Metrics for ship: Accuracy: 0.9580, Precision: 0.9387, Recall: 0.9023, F1_score: 0.9201, Average_Precision: 0.9671
2023-12-06 17:19:59,364 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:20:07,422 - INFO - Metrics for ship: Accuracy: 0.9135, Precision: 0.7086, Recall: 0.7552, F1_score: 0.7312, Average_Precision: 0.7713
2023-12-06 17:20:08,448 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:20:36,703 - INFO - Epoch(train)[73/100][20/79]lr: 9.4605e-04  eta: 0:51:36  time: 28.2532  inter_cls_loss: 0.0270 inner_cls_loss: 0.1829
2023-12-06 17:20:50,842 - INFO - Epoch(train)[73/100][40/79]lr: 9.4605e-04  eta: 0:38:21  time: 42.3921  inter_cls_loss: 0.0418 inner_cls_loss: 0.1976
2023-12-06 17:21:04,801 - INFO - Epoch(train)[73/100][60/79]lr: 9.4605e-04  eta: 0:33:41  time: 56.3499  inter_cls_loss: 0.0651 inner_cls_loss: 0.2183
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:21:18,071 - INFO - Epoch(test) test/all/:
2023-12-06 17:21:42,425 - INFO - Epoch(test) : [20/32]
2023-12-06 17:21:50,509 - INFO - Metrics for ship: Accuracy: 0.9434, Precision: 0.8930, Recall: 0.8519, F1_score: 0.8720, Average_Precision: 0.9355
2023-12-06 17:21:50,541 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:22:14,929 - INFO - Epoch(test) : [20/29]
2023-12-06 17:22:21,085 - INFO - Metrics for ship: Accuracy: 0.9566, Precision: 0.9290, Recall: 0.9073, F1_score: 0.9180, Average_Precision: 0.9649
2023-12-06 17:22:21,089 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:22:29,150 - INFO - Metrics for ship: Accuracy: 0.9156, Precision: 0.7111, Recall: 0.7716, F1_score: 0.7401, Average_Precision: 0.7706
2023-12-06 17:22:30,197 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:22:58,210 - INFO - Epoch(train)[74/100][20/79]lr: 9.3689e-04  eta: 0:49:19  time: 28.0120  inter_cls_loss: 0.0496 inner_cls_loss: 0.1905
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:23:13,464 - INFO - Epoch(train)[74/100][40/79]lr: 9.3689e-04  eta: 0:37:43  time: 43.2651  inter_cls_loss: 0.0296 inner_cls_loss: 0.1490
2023-12-06 17:23:27,577 - INFO - Epoch(train)[74/100][60/79]lr: 9.3689e-04  eta: 0:33:2  time: 57.3793  inter_cls_loss: 0.0426 inner_cls_loss: 0.1614
2023-12-06 17:23:40,066 - INFO - Epoch(test) test/all/:
2023-12-06 17:24:04,054 - INFO - Epoch(test) : [20/32]
2023-12-06 17:24:12,211 - INFO - Metrics for ship: Accuracy: 0.9486, Precision: 0.8819, Recall: 0.8920, F1_score: 0.8869, Average_Precision: 0.9378
2023-12-06 17:24:12,240 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:24:35,943 - INFO - Epoch(test) : [20/29]
2023-12-06 17:24:42,088 - INFO - Metrics for ship: Accuracy: 0.9601, Precision: 0.9235, Recall: 0.9280, F1_score: 0.9257, Average_Precision: 0.9680
2023-12-06 17:24:42,092 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:24:50,240 - INFO - Metrics for ship: Accuracy: 0.9183, Precision: 0.7019, Recall: 0.8264, F1_score: 0.7591, Average_Precision: 0.7871
2023-12-06 17:24:50,920 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:25:18,971 - INFO - Epoch(train)[75/100][20/79]lr: 9.2706e-04  eta: 0:47:32  time: 28.0511  inter_cls_loss: 0.0491 inner_cls_loss: 0.1709
2023-12-06 17:25:32,801 - INFO - Epoch(train)[75/100][40/79]lr: 9.2706e-04  eta: 0:35:8  time: 41.8784  inter_cls_loss: 0.0481 inner_cls_loss: 0.1693
2023-12-06 17:25:47,307 - INFO - Epoch(train)[75/100][60/79]lr: 9.2706e-04  eta: 0:31:13  time: 56.3830  inter_cls_loss: 0.0305 inner_cls_loss: 0.1365
2023-12-06 17:26:00,078 - INFO - Epoch(test) test/all/:
2023-12-06 17:26:23,920 - INFO - Epoch(test) : [20/32]
2023-12-06 17:26:32,478 - INFO - Metrics for ship: Accuracy: 0.9451, Precision: 0.9053, Recall: 0.8460, F1_score: 0.8746, Average_Precision: 0.9374
2023-12-06 17:26:32,510 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:26:56,424 - INFO - Epoch(test) : [20/29]
2023-12-06 17:27:02,500 - INFO - Metrics for ship: Accuracy: 0.9563, Precision: 0.9373, Recall: 0.8970, F1_score: 0.9167, Average_Precision: 0.9664
2023-12-06 17:27:02,505 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:27:10,448 - INFO - Metrics for ship: Accuracy: 0.9188, Precision: 0.7305, Recall: 0.7589, F1_score: 0.7444, Average_Precision: 0.7795
2023-12-06 17:27:11,140 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:27:39,732 - INFO - Epoch(train)[76/100][20/79]lr: 9.1658e-04  eta: 0:46:34  time: 28.5912  inter_cls_loss: 0.0367 inner_cls_loss: 0.1460
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:27:54,939 - INFO - Epoch(train)[76/100][40/79]lr: 9.1658e-04  eta: 0:35:18  time: 43.7987  inter_cls_loss: 0.0369 inner_cls_loss: 0.1273
2023-12-06 17:28:09,134 - INFO - Epoch(train)[76/100][60/79]lr: 9.1658e-04  eta: 0:30:50  time: 57.9928  inter_cls_loss: 0.0490 inner_cls_loss: 0.1464
2023-12-06 17:28:21,658 - INFO - Epoch(test) test/all/:
2023-12-06 17:28:45,236 - INFO - Epoch(test) : [20/32]
2023-12-06 17:28:53,539 - INFO - Metrics for ship: Accuracy: 0.9480, Precision: 0.8823, Recall: 0.8885, F1_score: 0.8854, Average_Precision: 0.9387
2023-12-06 17:28:53,570 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:29:17,322 - INFO - Epoch(test) : [20/29]
2023-12-06 17:29:23,720 - INFO - Metrics for ship: Accuracy: 0.9608, Precision: 0.9254, Recall: 0.9286, F1_score: 0.9270, Average_Precision: 0.9681
2023-12-06 17:29:23,724 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:29:31,769 - INFO - Metrics for ship: Accuracy: 0.9135, Precision: 0.6864, Recall: 0.8192, F1_score: 0.7469, Average_Precision: 0.7652
2023-12-06 17:29:32,782 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:30:01,904 - INFO - Epoch(train)[77/100][20/79]lr: 9.0546e-04  eta: 0:45:31  time: 29.1183  inter_cls_loss: 0.0581 inner_cls_loss: 0.1717
2023-12-06 17:30:15,687 - INFO - Epoch(train)[77/100][40/79]lr: 9.0546e-04  eta: 0:33:10  time: 42.9030  inter_cls_loss: 0.0446 inner_cls_loss: 0.1237
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:30:30,045 - INFO - Epoch(train)[77/100][60/79]lr: 9.0546e-04  eta: 0:29:12  time: 57.2612  inter_cls_loss: 0.0213 inner_cls_loss: 0.0997
2023-12-06 17:30:42,653 - INFO - Epoch(test) test/all/:
2023-12-06 17:31:06,659 - INFO - Epoch(test) : [20/32]
2023-12-06 17:31:15,255 - INFO - Metrics for ship: Accuracy: 0.9482, Precision: 0.8816, Recall: 0.8905, F1_score: 0.8860, Average_Precision: 0.9408
2023-12-06 17:31:15,290 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:31:39,407 - INFO - Epoch(test) : [20/29]
2023-12-06 17:31:45,480 - INFO - Metrics for ship: Accuracy: 0.9606, Precision: 0.9258, Recall: 0.9271, F1_score: 0.9264, Average_Precision: 0.9668
2023-12-06 17:31:45,483 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:31:53,667 - INFO - Metrics for ship: Accuracy: 0.9157, Precision: 0.6929, Recall: 0.8244, F1_score: 0.7530, Average_Precision: 0.7773
2023-12-06 17:31:54,352 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:32:22,104 - INFO - Epoch(train)[78/100][20/79]lr: 8.9373e-04  eta: 0:41:33  time: 27.7479  inter_cls_loss: 0.0430 inner_cls_loss: 0.1082
2023-12-06 17:32:35,966 - INFO - Epoch(train)[78/100][40/79]lr: 8.9373e-04  eta: 0:30:48  time: 41.6137  inter_cls_loss: 0.0378 inner_cls_loss: 0.0995
2023-12-06 17:32:50,901 - INFO - Epoch(train)[78/100][60/79]lr: 8.9373e-04  eta: 0:27:35  time: 56.5470  inter_cls_loss: 0.0322 inner_cls_loss: 0.0894
2023-12-06 17:33:03,527 - INFO - Epoch(test) test/all/:
2023-12-06 17:33:27,773 - INFO - Epoch(test) : [20/32]
2023-12-06 17:33:36,031 - INFO - Metrics for ship: Accuracy: 0.9471, Precision: 0.8885, Recall: 0.8763, F1_score: 0.8823, Average_Precision: 0.9323
2023-12-06 17:33:36,061 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:33:59,707 - INFO - Epoch(test) : [20/29]
2023-12-06 17:34:05,651 - INFO - Metrics for ship: Accuracy: 0.9589, Precision: 0.9294, Recall: 0.9163, F1_score: 0.9228, Average_Precision: 0.9654
2023-12-06 17:34:05,655 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:34:13,833 - INFO - Metrics for ship: Accuracy: 0.9138, Precision: 0.6909, Recall: 0.8083, F1_score: 0.7450, Average_Precision: 0.7662
2023-12-06 17:34:14,535 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:34:42,999 - INFO - Epoch(train)[79/100][20/79]lr: 8.8140e-04  eta: 0:40:44  time: 28.4624  inter_cls_loss: 0.0333 inner_cls_loss: 0.0991
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:34:57,059 - INFO - Epoch(train)[79/100][40/79]lr: 8.8140e-04  eta: 0:30:4  time: 42.5184  inter_cls_loss: 0.0437 inner_cls_loss: 0.1011
2023-12-06 17:35:11,018 - INFO - Epoch(train)[79/100][60/79]lr: 8.8140e-04  eta: 0:26:19  time: 56.4812  inter_cls_loss: 0.0470 inner_cls_loss: 0.1051
2023-12-06 17:35:23,982 - INFO - Epoch(test) test/all/:
2023-12-06 17:35:47,971 - INFO - Epoch(test) : [20/32]
2023-12-06 17:35:56,348 - INFO - Metrics for ship: Accuracy: 0.9468, Precision: 0.8662, Recall: 0.9043, F1_score: 0.8849, Average_Precision: 0.9354
2023-12-06 17:35:56,384 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:36:20,809 - INFO - Epoch(test) : [20/29]
2023-12-06 17:36:26,557 - INFO - Metrics for ship: Accuracy: 0.9593, Precision: 0.9119, Recall: 0.9388, F1_score: 0.9252, Average_Precision: 0.9644
2023-12-06 17:36:26,561 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:36:34,634 - INFO - Metrics for ship: Accuracy: 0.9102, Precision: 0.6676, Recall: 0.8433, F1_score: 0.7452, Average_Precision: 0.7746
2023-12-06 17:36:35,676 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:37:04,955 - INFO - Epoch(train)[80/100][20/79]lr: 8.6849e-04  eta: 0:39:59  time: 29.2758  inter_cls_loss: 0.0283 inner_cls_loss: 0.0982
2023-12-06 17:37:19,655 - INFO - Epoch(train)[80/100][40/79]lr: 8.6849e-04  eta: 0:29:39  time: 43.9770  inter_cls_loss: 0.0198 inner_cls_loss: 0.0715
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:37:31,955 - INFO - Epoch(train)[80/100][60/79]lr: 8.6849e-04  eta: 0:24:59  time: 56.2773  inter_cls_loss: 0.0345 inner_cls_loss: 0.0757
2023-12-06 17:37:44,913 - INFO - Epoch(test) test/all/:
2023-12-06 17:38:08,823 - INFO - Epoch(test) : [20/32]
2023-12-06 17:38:16,819 - INFO - Metrics for ship: Accuracy: 0.9466, Precision: 0.8668, Recall: 0.9026, F1_score: 0.8843, Average_Precision: 0.9356
2023-12-06 17:38:16,843 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:38:40,399 - INFO - Epoch(test) : [20/29]
2023-12-06 17:38:46,380 - INFO - Metrics for ship: Accuracy: 0.9594, Precision: 0.9160, Recall: 0.9342, F1_score: 0.9250, Average_Precision: 0.9648
2023-12-06 17:38:46,384 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:38:54,698 - INFO - Metrics for ship: Accuracy: 0.9123, Precision: 0.6749, Recall: 0.8430, F1_score: 0.7497, Average_Precision: 0.7621
2023-12-06 17:38:55,422 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:39:24,092 - INFO - Epoch(train)[81/100][20/79]lr: 8.5502e-04  eta: 0:37:11  time: 28.6053  inter_cls_loss: 0.0225 inner_cls_loss: 0.0627
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:39:37,776 - INFO - Epoch(train)[81/100][40/79]lr: 8.5502e-04  eta: 0:27:8  time: 42.2902  inter_cls_loss: 0.0200 inner_cls_loss: 0.0659
2023-12-06 17:39:53,338 - INFO - Epoch(train)[81/100][60/79]lr: 8.5502e-04  eta: 0:24:25  time: 57.8517  inter_cls_loss: 0.0324 inner_cls_loss: 0.0621
2023-12-06 17:40:05,531 - INFO - Epoch(test) test/all/:
2023-12-06 17:40:29,263 - INFO - Epoch(test) : [20/32]
2023-12-06 17:40:37,355 - INFO - Metrics for ship: Accuracy: 0.9470, Precision: 0.8632, Recall: 0.9101, F1_score: 0.8860, Average_Precision: 0.9316
2023-12-06 17:40:37,385 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:41:01,125 - INFO - Epoch(test) : [20/29]
2023-12-06 17:41:07,294 - INFO - Metrics for ship: Accuracy: 0.9609, Precision: 0.9095, Recall: 0.9484, F1_score: 0.9285, Average_Precision: 0.9601
2023-12-06 17:41:07,297 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:41:15,331 - INFO - Metrics for ship: Accuracy: 0.9074, Precision: 0.6585, Recall: 0.8425, F1_score: 0.7392, Average_Precision: 0.7409
2023-12-06 17:41:16,027 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:41:43,615 - INFO - Epoch(train)[82/100][20/79]lr: 8.4101e-04  eta: 0:34:2  time: 27.5845  inter_cls_loss: 0.0157 inner_cls_loss: 0.0510
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:41:58,189 - INFO - Epoch(train)[82/100][40/79]lr: 8.4101e-04  eta: 0:25:39  time: 42.1594  inter_cls_loss: 0.0177 inner_cls_loss: 0.0505
2023-12-06 17:42:12,071 - INFO - Epoch(train)[82/100][60/79]lr: 8.4101e-04  eta: 0:22:25  time: 56.0413  inter_cls_loss: 0.0256 inner_cls_loss: 0.0502
2023-12-06 17:42:25,103 - INFO - Epoch(test) test/all/:
2023-12-06 17:42:48,908 - INFO - Epoch(test) : [20/32]
2023-12-06 17:42:57,191 - INFO - Metrics for ship: Accuracy: 0.9471, Precision: 0.8886, Recall: 0.8759, F1_score: 0.8822, Average_Precision: 0.9353
2023-12-06 17:42:57,220 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:43:21,219 - INFO - Epoch(test) : [20/29]
2023-12-06 17:43:26,954 - INFO - Metrics for ship: Accuracy: 0.9592, Precision: 0.9251, Recall: 0.9224, F1_score: 0.9237, Average_Precision: 0.9629
2023-12-06 17:43:26,959 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:43:35,013 - INFO - Metrics for ship: Accuracy: 0.9195, Precision: 0.7200, Recall: 0.7907, F1_score: 0.7537, Average_Precision: 0.7733
2023-12-06 17:43:35,710 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:44:03,789 - INFO - Epoch(train)[83/100][20/79]lr: 8.2648e-04  eta: 0:32:48  time: 28.0747  inter_cls_loss: 0.0187 inner_cls_loss: 0.0461
2023-12-06 17:44:18,752 - INFO - Epoch(train)[83/100][40/79]lr: 8.2648e-04  eta: 0:24:47  time: 43.0404  inter_cls_loss: 0.0157 inner_cls_loss: 0.0423
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:44:31,479 - INFO - Epoch(train)[83/100][60/79]lr: 8.2648e-04  eta: 0:21:5  time: 55.7681  inter_cls_loss: 0.0282 inner_cls_loss: 0.0481
2023-12-06 17:44:44,764 - INFO - Epoch(test) test/all/:
2023-12-06 17:45:08,717 - INFO - Epoch(test) : [20/32]
2023-12-06 17:45:17,023 - INFO - Metrics for ship: Accuracy: 0.9466, Precision: 0.8776, Recall: 0.8878, F1_score: 0.8827, Average_Precision: 0.9283
2023-12-06 17:45:17,054 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:45:40,589 - INFO - Epoch(test) : [20/29]
2023-12-06 17:45:47,038 - INFO - Metrics for ship: Accuracy: 0.9586, Precision: 0.9239, Recall: 0.9212, F1_score: 0.9226, Average_Precision: 0.9616
2023-12-06 17:45:47,041 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:45:55,279 - INFO - Metrics for ship: Accuracy: 0.9128, Precision: 0.6828, Recall: 0.8222, F1_score: 0.7460, Average_Precision: 0.7619
2023-12-06 17:45:55,966 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:46:23,992 - INFO - Epoch(train)[84/100][20/79]lr: 8.1145e-04  eta: 0:30:53  time: 28.0236  inter_cls_loss: 0.0314 inner_cls_loss: 0.0609
2023-12-06 17:46:39,097 - INFO - Epoch(train)[84/100][40/79]lr: 8.1145e-04  eta: 0:23:24  time: 43.1292  inter_cls_loss: 0.0205 inner_cls_loss: 0.0427
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:46:52,882 - INFO - Epoch(train)[84/100][60/79]lr: 8.1145e-04  eta: 0:20:17  time: 56.9142  inter_cls_loss: 0.0185 inner_cls_loss: 0.0420
2023-12-06 17:47:05,682 - INFO - Epoch(test) test/all/:
2023-12-06 17:47:29,374 - INFO - Epoch(test) : [20/32]
2023-12-06 17:47:37,482 - INFO - Metrics for ship: Accuracy: 0.9455, Precision: 0.8605, Recall: 0.9059, F1_score: 0.8826, Average_Precision: 0.9259
2023-12-06 17:47:37,513 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:48:01,277 - INFO - Epoch(test) : [20/29]
2023-12-06 17:48:07,786 - INFO - Metrics for ship: Accuracy: 0.9595, Precision: 0.9039, Recall: 0.9497, F1_score: 0.9262, Average_Precision: 0.9555
2023-12-06 17:48:07,789 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:48:16,028 - INFO - Metrics for ship: Accuracy: 0.9059, Precision: 0.6554, Recall: 0.8351, F1_score: 0.7344, Average_Precision: 0.7235
2023-12-06 17:48:16,755 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:48:45,206 - INFO - Epoch(train)[85/100][20/79]lr: 7.9595e-04  eta: 0:29:29  time: 28.4499  inter_cls_loss: 0.0272 inner_cls_loss: 0.0370
2023-12-06 17:48:59,212 - INFO - Epoch(train)[85/100][40/79]lr: 7.9595e-04  eta: 0:21:39  time: 42.4546  inter_cls_loss: 0.0231 inner_cls_loss: 0.0397
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:49:13,349 - INFO - Epoch(train)[85/100][60/79]lr: 7.9595e-04  eta: 0:18:55  time: 56.5924  inter_cls_loss: 0.0196 inner_cls_loss: 0.0354
2023-12-06 17:49:26,606 - INFO - Epoch(test) test/all/:
2023-12-06 17:49:50,305 - INFO - Epoch(test) : [20/32]
2023-12-06 17:49:58,492 - INFO - Metrics for ship: Accuracy: 0.9475, Precision: 0.8666, Recall: 0.9073, F1_score: 0.8865, Average_Precision: 0.9183
2023-12-06 17:49:58,521 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:50:22,298 - INFO - Epoch(test) : [20/29]
2023-12-06 17:50:28,410 - INFO - Metrics for ship: Accuracy: 0.9609, Precision: 0.9112, Recall: 0.9463, F1_score: 0.9284, Average_Precision: 0.9570
2023-12-06 17:50:28,414 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:50:36,608 - INFO - Metrics for ship: Accuracy: 0.9158, Precision: 0.6894, Recall: 0.8363, F1_score: 0.7558, Average_Precision: 0.7579
2023-12-06 17:50:37,293 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:51:05,444 - INFO - Epoch(train)[86/100][20/79]lr: 7.8001e-04  eta: 0:27:19  time: 28.1498  inter_cls_loss: 0.0218 inner_cls_loss: 0.0401
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:51:19,504 - INFO - Epoch(train)[86/100][40/79]lr: 7.8001e-04  eta: 0:20:8  time: 42.2082  inter_cls_loss: 0.0382 inner_cls_loss: 0.0627
2023-12-06 17:51:33,529 - INFO - Epoch(train)[86/100][60/79]lr: 7.8001e-04  eta: 0:17:34  time: 56.2351  inter_cls_loss: 0.0238 inner_cls_loss: 0.0400
2023-12-06 17:51:46,163 - INFO - Epoch(test) test/all/:
2023-12-06 17:52:10,488 - INFO - Epoch(test) : [20/32]
2023-12-06 17:52:18,161 - INFO - Metrics for ship: Accuracy: 0.9480, Precision: 0.8835, Recall: 0.8873, F1_score: 0.8854, Average_Precision: 0.9294
2023-12-06 17:52:18,186 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:52:41,887 - INFO - Epoch(test) : [20/29]
2023-12-06 17:52:48,173 - INFO - Metrics for ship: Accuracy: 0.9593, Precision: 0.9181, Recall: 0.9312, F1_score: 0.9246, Average_Precision: 0.9582
2023-12-06 17:52:48,177 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:52:56,243 - INFO - Metrics for ship: Accuracy: 0.9157, Precision: 0.6991, Recall: 0.8051, F1_score: 0.7484, Average_Precision: 0.7728
2023-12-06 17:52:56,956 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:53:25,580 - INFO - Epoch(train)[87/100][20/79]lr: 7.6364e-04  eta: 0:25:54  time: 28.6202  inter_cls_loss: 0.0204 inner_cls_loss: 0.0344
2023-12-06 17:53:39,851 - INFO - Epoch(train)[87/100][40/79]lr: 7.6364e-04  eta: 0:19:3  time: 42.8951  inter_cls_loss: 0.0240 inner_cls_loss: 0.0380
2023-12-06 17:53:53,331 - INFO - Epoch(train)[87/100][60/79]lr: 7.6364e-04  eta: 0:16:22  time: 56.3742  inter_cls_loss: 0.0221 inner_cls_loss: 0.0345
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:54:06,593 - INFO - Epoch(test) test/all/:
2023-12-06 17:54:30,124 - INFO - Epoch(test) : [20/32]
2023-12-06 17:54:38,494 - INFO - Metrics for ship: Accuracy: 0.9456, Precision: 0.8956, Recall: 0.8598, F1_score: 0.8773, Average_Precision: 0.9317
2023-12-06 17:54:38,529 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:55:02,343 - INFO - Epoch(test) : [20/29]
2023-12-06 17:55:08,445 - INFO - Metrics for ship: Accuracy: 0.9574, Precision: 0.9355, Recall: 0.9034, F1_score: 0.9192, Average_Precision: 0.9629
2023-12-06 17:55:08,448 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:55:16,610 - INFO - Metrics for ship: Accuracy: 0.9206, Precision: 0.7292, Recall: 0.7800, F1_score: 0.7537, Average_Precision: 0.7724
2023-12-06 17:55:17,315 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:55:44,479 - INFO - Epoch(train)[88/100][20/79]lr: 7.4687e-04  eta: 0:22:47  time: 27.1640  inter_cls_loss: 0.0227 inner_cls_loss: 0.0445
2023-12-06 17:55:59,195 - INFO - Epoch(train)[88/100][40/79]lr: 7.4687e-04  eta: 0:17:13  time: 41.8756  inter_cls_loss: 0.0238 inner_cls_loss: 0.0425
2023-12-06 17:56:14,450 - INFO - Epoch(train)[88/100][60/79]lr: 7.4687e-04  eta: 0:15:20  time: 57.1320  inter_cls_loss: 0.0157 inner_cls_loss: 0.0263
2023-12-06 17:56:26,627 - INFO - Epoch(test) test/all/:
2023-12-06 17:56:50,496 - INFO - Epoch(test) : [20/32]
2023-12-06 17:56:58,771 - INFO - Metrics for ship: Accuracy: 0.9456, Precision: 0.8721, Recall: 0.8900, F1_score: 0.8810, Average_Precision: 0.9191
2023-12-06 17:56:58,800 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:57:22,497 - INFO - Epoch(test) : [20/29]
2023-12-06 17:57:28,814 - INFO - Metrics for ship: Accuracy: 0.9590, Precision: 0.9257, Recall: 0.9210, F1_score: 0.9233, Average_Precision: 0.9606
2023-12-06 17:57:28,817 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:57:36,943 - INFO - Metrics for ship: Accuracy: 0.9128, Precision: 0.6808, Recall: 0.8289, F1_score: 0.7476, Average_Precision: 0.7499
2023-12-06 17:57:37,660 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 17:58:06,074 - INFO - Epoch(train)[89/100][20/79]lr: 7.2973e-04  eta: 0:21:58  time: 28.4124  inter_cls_loss: 0.0204 inner_cls_loss: 0.0369
2023-12-06 17:58:20,137 - INFO - Epoch(train)[89/100][40/79]lr: 7.2973e-04  eta: 0:16:4  time: 42.4736  inter_cls_loss: 0.0110 inner_cls_loss: 0.0263
2023-12-06 17:58:33,988 - INFO - Epoch(train)[89/100][60/79]lr: 7.2973e-04  eta: 0:13:53  time: 56.3274  inter_cls_loss: 0.0310 inner_cls_loss: 0.0400
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 17:58:47,490 - INFO - Epoch(test) test/all/:
2023-12-06 17:59:11,476 - INFO - Epoch(test) : [20/32]
2023-12-06 17:59:19,783 - INFO - Metrics for ship: Accuracy: 0.9479, Precision: 0.8747, Recall: 0.8983, F1_score: 0.8863, Average_Precision: 0.9315
2023-12-06 17:59:19,808 - INFO - Epoch(test) test/offshore/:
2023-12-06 17:59:43,664 - INFO - Epoch(test) : [20/29]
2023-12-06 17:59:49,861 - INFO - Metrics for ship: Accuracy: 0.9597, Precision: 0.9236, Recall: 0.9263, F1_score: 0.9249, Average_Precision: 0.9620
2023-12-06 17:59:49,864 - INFO - Epoch(test) test/inshore/:
2023-12-06 17:59:58,168 - INFO - Metrics for ship: Accuracy: 0.9143, Precision: 0.6853, Recall: 0.8316, F1_score: 0.7514, Average_Precision: 0.7585
2023-12-06 17:59:58,939 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:00:28,341 - INFO - Epoch(train)[90/100][20/79]lr: 7.1224e-04  eta: 0:20:48  time: 29.4009  inter_cls_loss: 0.0199 inner_cls_loss: 0.0313
2023-12-06 18:00:40,689 - INFO - Epoch(train)[90/100][40/79]lr: 7.1224e-04  eta: 0:14:25  time: 41.7463  inter_cls_loss: 0.0177 inner_cls_loss: 0.0239
2023-12-06 18:00:54,923 - INFO - Epoch(train)[90/100][60/79]lr: 7.1224e-04  eta: 0:12:34  time: 55.9806  inter_cls_loss: 0.0165 inner_cls_loss: 0.0211
2023-12-06 18:01:08,385 - INFO - Epoch(test) test/all/:
2023-12-06 18:01:32,254 - INFO - Epoch(test) : [20/32]
2023-12-06 18:01:40,262 - INFO - Metrics for ship: Accuracy: 0.9478, Precision: 0.8767, Recall: 0.8953, F1_score: 0.8859, Average_Precision: 0.9339
2023-12-06 18:01:40,293 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:02:04,262 - INFO - Epoch(test) : [20/29]
2023-12-06 18:02:10,507 - INFO - Metrics for ship: Accuracy: 0.9609, Precision: 0.9219, Recall: 0.9332, F1_score: 0.9275, Average_Precision: 0.9629
2023-12-06 18:02:10,510 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:02:18,818 - INFO - Metrics for ship: Accuracy: 0.9183, Precision: 0.6993, Recall: 0.8341, F1_score: 0.7608, Average_Precision: 0.7909
2023-12-06 18:02:19,531 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 18:02:48,446 - INFO - Epoch(train)[91/100][20/79]lr: 6.9443e-04  eta: 0:18:30  time: 28.8490  inter_cls_loss: 0.0270 inner_cls_loss: 0.0282
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:03:01,737 - INFO - Epoch(train)[91/100][40/79]lr: 6.9443e-04  eta: 0:13:10  time: 42.1412  inter_cls_loss: 0.0148 inner_cls_loss: 0.0198
2023-12-06 18:03:16,099 - INFO - Epoch(train)[91/100][60/79]lr: 6.9443e-04  eta: 0:11:27  time: 56.5045  inter_cls_loss: 0.0294 inner_cls_loss: 0.0282
2023-12-06 18:03:28,935 - INFO - Epoch(test) test/all/:
2023-12-06 18:03:52,673 - INFO - Epoch(test) : [20/32]
2023-12-06 18:04:00,841 - INFO - Metrics for ship: Accuracy: 0.9461, Precision: 0.8676, Recall: 0.8988, F1_score: 0.8829, Average_Precision: 0.9258
2023-12-06 18:04:00,869 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:04:24,504 - INFO - Epoch(test) : [20/29]
2023-12-06 18:04:30,767 - INFO - Metrics for ship: Accuracy: 0.9591, Precision: 0.9154, Recall: 0.9338, F1_score: 0.9245, Average_Precision: 0.9603
2023-12-06 18:04:30,770 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:04:38,884 - INFO - Metrics for ship: Accuracy: 0.9099, Precision: 0.6698, Recall: 0.8311, F1_score: 0.7418, Average_Precision: 0.7502
2023-12-06 18:04:39,565 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:05:07,273 - INFO - Epoch(train)[92/100][20/79]lr: 6.7633e-04  eta: 0:15:57  time: 27.7062  inter_cls_loss: 0.0151 inner_cls_loss: 0.0172
2023-12-06 18:05:21,829 - INFO - Epoch(train)[92/100][40/79]lr: 6.7633e-04  eta: 0:11:48  time: 42.2620  inter_cls_loss: 0.0099 inner_cls_loss: 0.0127
2023-12-06 18:05:36,135 - INFO - Epoch(train)[92/100][60/79]lr: 6.7633e-04  eta: 0:10:13  time: 56.5691  inter_cls_loss: 0.0140 inner_cls_loss: 0.0171
2023-12-06 18:05:49,246 - INFO - Epoch(test) test/all/:
2023-12-06 18:06:12,783 - INFO - Epoch(test) : [20/32]
2023-12-06 18:06:20,986 - INFO - Metrics for ship: Accuracy: 0.9471, Precision: 0.8813, Recall: 0.8853, F1_score: 0.8833, Average_Precision: 0.9132
2023-12-06 18:06:21,018 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:06:44,545 - INFO - Epoch(test) : [20/29]
2023-12-06 18:06:50,739 - INFO - Metrics for ship: Accuracy: 0.9590, Precision: 0.9276, Recall: 0.9186, F1_score: 0.9231, Average_Precision: 0.9617
2023-12-06 18:06:50,743 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:06:58,486 - INFO - Metrics for ship: Accuracy: 0.9179, Precision: 0.7005, Recall: 0.8266, F1_score: 0.7584, Average_Precision: 0.7532
2023-12-06 18:06:59,461 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:07:27,644 - INFO - Epoch(train)[93/100][20/79]lr: 6.5796e-04  eta: 0:14:22  time: 28.1815  inter_cls_loss: 0.0170 inner_cls_loss: 0.0232
2023-12-06 18:07:42,675 - INFO - Epoch(train)[93/100][40/79]lr: 6.5796e-04  eta: 0:10:39  time: 43.2126  inter_cls_loss: 0.0160 inner_cls_loss: 0.0189
2023-12-06 18:07:56,176 - INFO - Epoch(train)[93/100][60/79]lr: 6.5796e-04  eta: 0:9:0  time: 56.7146  inter_cls_loss: 0.0182 inner_cls_loss: 0.0194
2023-12-06 18:08:08,985 - INFO - Epoch(test) test/all/:
2023-12-06 18:08:33,168 - INFO - Epoch(test) : [20/32]
2023-12-06 18:08:41,346 - INFO - Metrics for ship: Accuracy: 0.9467, Precision: 0.8849, Recall: 0.8788, F1_score: 0.8818, Average_Precision: 0.9205
2023-12-06 18:08:41,377 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:09:05,268 - INFO - Epoch(test) : [20/29]
2023-12-06 18:09:11,654 - INFO - Metrics for ship: Accuracy: 0.9581, Precision: 0.9253, Recall: 0.9175, F1_score: 0.9214, Average_Precision: 0.9588
2023-12-06 18:09:11,658 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:09:19,722 - INFO - Metrics for ship: Accuracy: 0.9176, Precision: 0.7076, Recall: 0.8023, F1_score: 0.7520, Average_Precision: 0.7359
2023-12-06 18:09:20,742 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 18:09:49,586 - INFO - Epoch(train)[94/100][20/79]lr: 6.3936e-04  eta: 0:12:48  time: 28.8389  inter_cls_loss: 0.0119 inner_cls_loss: 0.0137
2023-12-06 18:10:04,487 - INFO - Epoch(train)[94/100][40/79]lr: 6.3936e-04  eta: 0:9:21  time: 43.7435  inter_cls_loss: 0.0110 inner_cls_loss: 0.0163
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:10:17,953 - INFO - Epoch(train)[94/100][60/79]lr: 6.3936e-04  eta: 0:7:50  time: 57.2064  inter_cls_loss: 0.0188 inner_cls_loss: 0.0209
2023-12-06 18:10:30,524 - INFO - Epoch(test) test/all/:
2023-12-06 18:10:54,397 - INFO - Epoch(test) : [20/32]
2023-12-06 18:11:02,698 - INFO - Metrics for ship: Accuracy: 0.9461, Precision: 0.8669, Recall: 0.8996, F1_score: 0.8830, Average_Precision: 0.9160
2023-12-06 18:11:02,724 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:11:26,551 - INFO - Epoch(test) : [20/29]
2023-12-06 18:11:32,526 - INFO - Metrics for ship: Accuracy: 0.9590, Precision: 0.9187, Recall: 0.9290, F1_score: 0.9238, Average_Precision: 0.9605
2023-12-06 18:11:32,530 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:11:40,619 - INFO - Metrics for ship: Accuracy: 0.9145, Precision: 0.6828, Recall: 0.8423, F1_score: 0.7542, Average_Precision: 0.7528
2023-12-06 18:11:41,611 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 18:12:11,048 - INFO - Epoch(train)[95/100][20/79]lr: 6.2056e-04  eta: 0:11:8  time: 29.4345  inter_cls_loss: 0.0113 inner_cls_loss: 0.0115
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:12:25,333 - INFO - Epoch(train)[95/100][40/79]lr: 6.2056e-04  eta: 0:7:54  time: 43.7162  inter_cls_loss: 0.0108 inner_cls_loss: 0.0168
2023-12-06 18:12:38,235 - INFO - Epoch(train)[95/100][60/79]lr: 6.2056e-04  eta: 0:6:30  time: 56.6226  inter_cls_loss: 0.0159 inner_cls_loss: 0.0148
2023-12-06 18:12:51,755 - INFO - Epoch(test) test/all/:
2023-12-06 18:13:15,629 - INFO - Epoch(test) : [20/32]
2023-12-06 18:13:23,801 - INFO - Metrics for ship: Accuracy: 0.9472, Precision: 0.8671, Recall: 0.9052, F1_score: 0.8857, Average_Precision: 0.9164
2023-12-06 18:13:23,829 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:13:47,349 - INFO - Epoch(test) : [20/29]
2023-12-06 18:13:53,441 - INFO - Metrics for ship: Accuracy: 0.9599, Precision: 0.9135, Recall: 0.9392, F1_score: 0.9262, Average_Precision: 0.9589
2023-12-06 18:13:53,445 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:14:01,723 - INFO - Metrics for ship: Accuracy: 0.9118, Precision: 0.6732, Recall: 0.8435, F1_score: 0.7488, Average_Precision: 0.7494
2023-12-06 18:14:02,374 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 18:14:31,683 - INFO - Epoch(train)[96/100][20/79]lr: 6.0157e-04  eta: 0:9:9  time: 29.3081  inter_cls_loss: 0.0135 inner_cls_loss: 0.0171
2023-12-06 18:14:44,478 - INFO - Epoch(train)[96/100][40/79]lr: 6.0157e-04  eta: 0:6:13  time: 42.1028  inter_cls_loss: 0.0122 inner_cls_loss: 0.0188
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:14:59,544 - INFO - Epoch(train)[96/100][60/79]lr: 6.0157e-04  eta: 0:5:19  time: 57.1682  inter_cls_loss: 0.0144 inner_cls_loss: 0.0175
2023-12-06 18:15:12,215 - INFO - Epoch(test) test/all/:
2023-12-06 18:15:35,922 - INFO - Epoch(test) : [20/32]
2023-12-06 18:15:44,399 - INFO - Metrics for ship: Accuracy: 0.9452, Precision: 0.8617, Recall: 0.9026, F1_score: 0.8817, Average_Precision: 0.9105
2023-12-06 18:15:44,428 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:16:08,224 - INFO - Epoch(test) : [20/29]
2023-12-06 18:16:14,277 - INFO - Metrics for ship: Accuracy: 0.9590, Precision: 0.9123, Recall: 0.9371, F1_score: 0.9245, Average_Precision: 0.9573
2023-12-06 18:16:14,282 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:16:22,528 - INFO - Metrics for ship: Accuracy: 0.9083, Precision: 0.6616, Recall: 0.8418, F1_score: 0.7409, Average_Precision: 0.7428
2023-12-06 18:16:23,242 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 18:16:51,620 - INFO - Epoch(train)[97/100][20/79]lr: 5.8244e-04  eta: 0:6:59  time: 28.3766  inter_cls_loss: 0.0208 inner_cls_loss: 0.0193
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:17:06,060 - INFO - Epoch(train)[97/100][40/79]lr: 5.8244e-04  eta: 0:4:55  time: 42.8167  inter_cls_loss: 0.0228 inner_cls_loss: 0.0183
2023-12-06 18:17:20,222 - INFO - Epoch(train)[97/100][60/79]lr: 5.8244e-04  eta: 0:4:3  time: 56.9758  inter_cls_loss: 0.0089 inner_cls_loss: 0.0100
2023-12-06 18:17:33,424 - INFO - Epoch(test) test/all/:
2023-12-06 18:17:57,212 - INFO - Epoch(test) : [20/32]
2023-12-06 18:18:05,100 - INFO - Metrics for ship: Accuracy: 0.9467, Precision: 0.8680, Recall: 0.9012, F1_score: 0.8843, Average_Precision: 0.8980
2023-12-06 18:18:05,135 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:18:28,880 - INFO - Epoch(test) : [20/29]
2023-12-06 18:18:34,940 - INFO - Metrics for ship: Accuracy: 0.9595, Precision: 0.9179, Recall: 0.9324, F1_score: 0.9251, Average_Precision: 0.9537
2023-12-06 18:18:34,947 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:18:43,083 - INFO - Metrics for ship: Accuracy: 0.9139, Precision: 0.6811, Recall: 0.8410, F1_score: 0.7526, Average_Precision: 0.7409
2023-12-06 18:18:43,750 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 18:19:11,802 - INFO - Epoch(train)[98/100][20/79]lr: 5.6318e-04  eta: 0:5:4  time: 28.0504  inter_cls_loss: 0.0113 inner_cls_loss: 0.0101
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:19:26,137 - INFO - Epoch(train)[98/100][40/79]lr: 5.6318e-04  eta: 0:3:28  time: 42.3853  inter_cls_loss: 0.0070 inner_cls_loss: 0.0094
2023-12-06 18:19:41,383 - INFO - Epoch(train)[98/100][60/79]lr: 5.6318e-04  eta: 0:2:50  time: 57.6308  inter_cls_loss: 0.0082 inner_cls_loss: 0.0142
2023-12-06 18:19:53,641 - INFO - Epoch(test) test/all/:
2023-12-06 18:20:17,692 - INFO - Epoch(test) : [20/32]
2023-12-06 18:20:25,960 - INFO - Metrics for ship: Accuracy: 0.9482, Precision: 0.8868, Recall: 0.8838, F1_score: 0.8853, Average_Precision: 0.9085
2023-12-06 18:20:25,991 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:20:49,645 - INFO - Epoch(test) : [20/29]
2023-12-06 18:20:55,593 - INFO - Metrics for ship: Accuracy: 0.9596, Precision: 0.9256, Recall: 0.9235, F1_score: 0.9245, Average_Precision: 0.9545
2023-12-06 18:20:55,597 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:21:03,635 - INFO - Metrics for ship: Accuracy: 0.9210, Precision: 0.7206, Recall: 0.8046, F1_score: 0.7603, Average_Precision: 0.7532
2023-12-06 18:21:04,343 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:21:32,575 - INFO - Epoch(train)[99/100][20/79]lr: 5.4384e-04  eta: 0:3:14  time: 28.2294  inter_cls_loss: 0.0089 inner_cls_loss: 0.0105
2023-12-06 18:21:46,152 - INFO - Epoch(train)[99/100][40/79]lr: 5.4384e-04  eta: 0:2:3  time: 41.8062  inter_cls_loss: 0.0098 inner_cls_loss: 0.0087
2023-12-06 18:22:00,597 - INFO - Epoch(train)[99/100][60/79]lr: 5.4384e-04  eta: 0:1:31  time: 56.2536  inter_cls_loss: 0.0074 inner_cls_loss: 0.0097
2023-12-06 18:22:14,097 - INFO - Epoch(test) test/all/:
2023-12-06 18:22:38,222 - INFO - Epoch(test) : [20/32]
2023-12-06 18:22:46,569 - INFO - Metrics for ship: Accuracy: 0.9467, Precision: 0.8599, Recall: 0.9131, F1_score: 0.8857, Average_Precision: 0.9234
2023-12-06 18:22:46,599 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:23:10,563 - INFO - Epoch(test) : [20/29]
2023-12-06 18:23:17,031 - INFO - Metrics for ship: Accuracy: 0.9603, Precision: 0.9109, Recall: 0.9443, F1_score: 0.9273, Average_Precision: 0.9546
2023-12-06 18:23:17,039 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:23:25,262 - INFO - Metrics for ship: Accuracy: 0.9107, Precision: 0.6663, Recall: 0.8552, F1_score: 0.7490, Average_Precision: 0.7470
2023-12-06 18:23:25,991 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 18:23:54,704 - INFO - Epoch(train)[100/100][20/79]lr: 5.2443e-04  eta: 0:1:24  time: 28.7129  inter_cls_loss: 0.0077 inner_cls_loss: 0.0114
data/rsdd/train/images/186_14_18.jpg has no keypoint founded with SuperPoint+Boost-B-attlay3
2023-12-06 18:24:09,572 - INFO - Epoch(train)[100/100][40/79]lr: 5.2443e-04  eta: 0:0:42  time: 43.5777  inter_cls_loss: 0.0153 inner_cls_loss: 0.0129
2023-12-06 18:24:24,095 - INFO - Epoch(train)[100/100][60/79]lr: 5.2443e-04  eta: 0:0:18  time: 58.1021  inter_cls_loss: 0.0175 inner_cls_loss: 0.0121
2023-12-06 18:24:36,058 - INFO - Epoch(test) test/all/:
2023-12-06 18:24:59,931 - INFO - Epoch(test) : [20/32]
2023-12-06 18:25:08,003 - INFO - Metrics for ship: Accuracy: 0.9458, Precision: 0.8687, Recall: 0.8959, F1_score: 0.8821, Average_Precision: 0.9163
2023-12-06 18:25:08,033 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:25:31,721 - INFO - Epoch(test) : [20/29]
2023-12-06 18:25:37,715 - INFO - Metrics for ship: Accuracy: 0.9585, Precision: 0.9176, Recall: 0.9283, F1_score: 0.9229, Average_Precision: 0.9501
2023-12-06 18:25:37,721 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:25:45,812 - INFO - Metrics for ship: Accuracy: 0.9147, Precision: 0.6866, Recall: 0.8323, F1_score: 0.7525, Average_Precision: 0.7592
2023-12-06 18:25:46,802 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_train.png:
2023-12-06 18:25:46,823 - INFO - Last model saved :work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_last_model_weight.pth
2023-12-06 18:25:46,905 - INFO - model weights saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 497b4bbd88cc08c2d9fa4625c79ea7d6!
2023-12-06 18:25:46,944 - INFO - model weights loaded from work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch.pth with MD5 497b4bbd88cc08c2d9fa4625c79ea7d6!
2023-12-06 18:25:46,944 - INFO - Epoch(test) test/all/:
2023-12-06 18:26:10,861 - INFO - Epoch(test) : [20/32]
2023-12-06 18:26:18,302 - INFO - Metrics for ship: Accuracy: 0.9498, Precision: 0.8880, Recall: 0.8905, F1_score: 0.8892, Average_Precision: 0.9528
2023-12-06 18:26:18,329 - INFO - Epoch(test) test/offshore/:
2023-12-06 18:26:43,081 - INFO - Epoch(test) : [20/29]
2023-12-06 18:26:48,352 - INFO - Metrics for ship: Accuracy: 0.9619, Precision: 0.9287, Recall: 0.9291, F1_score: 0.9289, Average_Precision: 0.9757
2023-12-06 18:26:48,356 - INFO - Epoch(test) test/inshore/:
2023-12-06 18:26:56,498 - INFO - Metrics for ship: Accuracy: 0.9099, Precision: 0.6691, Recall: 0.8341, F1_score: 0.7425, Average_Precision: 0.8012
2023-12-06 18:26:57,200 - INFO - PR_curve has been saved to work_dirs/rsdd_SuperPoint+Boost-B-attlay3_100_bs64_best_model_weights_scratch_PR_curve_eval_497b4.png!
