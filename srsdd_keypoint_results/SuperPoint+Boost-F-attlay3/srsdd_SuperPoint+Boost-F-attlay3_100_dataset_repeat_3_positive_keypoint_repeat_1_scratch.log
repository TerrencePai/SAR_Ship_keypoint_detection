2023-12-03 20:55:14,895 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-03 20:55:14,895 - INFO - descriptor: SuperPoint+Boost-F-attlay3
2023-12-03 20:55:14,895 - INFO - num_epochs: 100
2023-12-03 20:55:14,895 - INFO - train_ratio: 1.0
2023-12-03 20:55:14,895 - INFO - batch_size: 16
2023-12-03 20:55:14,895 - INFO - num_workers: 4
2023-12-03 20:55:14,895 - INFO - print_interval: 20
2023-12-03 20:55:14,895 - INFO - eval_interval: 1
2023-12-03 20:55:14,895 - INFO - save_interval: 10
2023-12-03 20:55:14,895 - INFO - lr: 0.001
2023-12-03 20:55:14,895 - INFO - warmup_step: 20
2023-12-03 20:55:14,895 - INFO - random_seed: 0
2023-12-03 20:55:14,895 - INFO - expand_piexl: 5
2023-12-03 20:55:14,895 - INFO - test_threshold: 0.5
2023-12-03 20:55:14,896 - INFO - test_image: 
2023-12-03 20:55:14,896 - INFO - eval: False
2023-12-03 20:55:14,896 - INFO - save_path: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth
2023-12-03 20:55:14,896 - INFO - log_file: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_dataset_repeat_3_positive_keypoint_repeat_1_scratch.log
2023-12-03 20:55:14,896 - INFO - checkpoint: 
2023-12-03 20:55:14,896 - INFO - multiprocessing_context: spawn
2023-12-03 20:55:14,896 - INFO - data_root: data/srsdd
2023-12-03 20:55:14,896 - INFO - img_suffix: .png
2023-12-03 20:55:14,896 - INFO - train_ann_file: ['train/']
2023-12-03 20:55:14,896 - INFO - test_ann_file: ['test/']
2023-12-03 20:55:14,896 - INFO - dataset_class: {'ore-oil': 1, 'Cell-Container': 2, 'Fishing': 3, 'LawEnforce': 4, 'Dredger': 5, 'Container': 6}
2023-12-03 20:55:14,896 - INFO - dataset_repeat: 3
2023-12-03 20:55:14,896 - INFO - positive_keypoint_repeat: 1
2023-12-03 20:55:14,896 - INFO - image_aug: False
2023-12-03 20:55:14,896 - INFO - print: False
2023-12-03 20:55:14,896 - INFO - feature_booster_pretrained: 
2023-12-03 20:55:14,896 - INFO - device: cuda
2023-12-03 20:55:15,161 - INFO - The dataset located in ['train/'] was duplicated 3 times!
2023-12-03 20:55:28,441 - INFO - Epoch(train)[1/100][20/100]lr: 1.0000e-03  eta: 1:49:3  time: 13.1126  inter_cls_loss: 1.0005 inner_cls_loss: 93.1029
2023-12-03 20:55:37,000 - INFO - Epoch(train)[1/100][40/100]lr: 1.0000e-03  eta: 1:29:56  time: 21.6715  inter_cls_loss: 0.2215 inner_cls_loss: 89.2070
2023-12-03 20:55:46,329 - INFO - Epoch(train)[1/100][60/100]lr: 1.0000e-03  eta: 1:25:35  time: 31.0002  inter_cls_loss: 0.1798 inner_cls_loss: 85.3195
2023-12-03 20:55:55,942 - INFO - Epoch(train)[1/100][80/100]lr: 1.0000e-03  eta: 1:23:56  time: 40.6143  inter_cls_loss: 0.1227 inner_cls_loss: 82.2203
2023-12-03 20:56:04,261 - INFO - Epoch(train)[1/100][100/100]lr: 1.0000e-03  eta: 1:20:44  time: 48.9335  inter_cls_loss: 0.1981 inner_cls_loss: 79.8467
2023-12-03 20:56:05,143 - INFO - Epoch(test) test/:
2023-12-03 20:56:14,134 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0436
2023-12-03 20:56:14,261 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0879
2023-12-03 20:56:14,391 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0042
2023-12-03 20:56:14,517 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 20:56:14,647 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0407
2023-12-03 20:56:14,774 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0581
2023-12-03 20:56:14,898 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1758
2023-12-03 20:56:14,898 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0586
2023-12-03 20:56:15,488 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 20:56:15,520 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 53710272c9f21b76259e2eb5dd0a88fd, with test/ image AP 0.1758
2023-12-03 20:56:28,746 - INFO - Epoch(train)[2/100][20/100]lr: 1.0000e-03  eta: 1:48:52  time: 13.2244  inter_cls_loss: 0.1640 inner_cls_loss: 76.6531
2023-12-03 20:56:38,098 - INFO - Epoch(train)[2/100][40/100]lr: 1.0000e-03  eta: 1:32:45  time: 22.5776  inter_cls_loss: 0.1008 inner_cls_loss: 73.6768
2023-12-03 20:56:46,499 - INFO - Epoch(train)[2/100][60/100]lr: 1.0000e-03  eta: 1:24:40  time: 30.9764  inter_cls_loss: 0.1750 inner_cls_loss: 71.8094
2023-12-03 20:56:54,886 - INFO - Epoch(train)[2/100][80/100]lr: 1.0000e-03  eta: 1:20:32  time: 39.3649  inter_cls_loss: 0.1375 inner_cls_loss: 68.9924
2023-12-03 20:57:02,633 - INFO - Epoch(train)[2/100][100/100]lr: 1.0000e-03  eta: 1:16:57  time: 47.1125  inter_cls_loss: 0.1324 inner_cls_loss: 66.3424
2023-12-03 20:57:03,490 - INFO - Epoch(test) test/:
2023-12-03 20:57:12,272 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0366
2023-12-03 20:57:12,392 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0840
2023-12-03 20:57:12,513 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0037
2023-12-03 20:57:12,634 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 20:57:12,756 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1260
2023-12-03 20:57:12,880 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0523
2023-12-03 20:57:13,001 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1919
2023-12-03 20:57:13,001 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0707
2023-12-03 20:57:13,562 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 20:57:13,613 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 6743f0d82a6a30dc02e6238c39a75199, with test/ image AP 0.1919
2023-12-03 20:57:26,633 - INFO - Epoch(train)[3/100][20/100]lr: 1.0000e-03  eta: 1:46:6  time: 13.0193  inter_cls_loss: 0.1197 inner_cls_loss: 63.8953
2023-12-03 20:57:36,008 - INFO - Epoch(train)[3/100][40/100]lr: 1.0000e-03  eta: 1:31:4  time: 22.3946  inter_cls_loss: 0.1245 inner_cls_loss: 61.5638
2023-12-03 20:57:44,562 - INFO - Epoch(train)[3/100][60/100]lr: 1.0000e-03  eta: 1:23:43  time: 30.9466  inter_cls_loss: 0.1240 inner_cls_loss: 59.4947
2023-12-03 20:57:52,474 - INFO - Epoch(train)[3/100][80/100]lr: 1.0000e-03  eta: 1:18:41  time: 38.8584  inter_cls_loss: 0.1757 inner_cls_loss: 57.6812
2023-12-03 20:57:59,564 - INFO - Epoch(train)[3/100][100/100]lr: 1.0000e-03  eta: 1:14:17  time: 45.9502  inter_cls_loss: 0.2331 inner_cls_loss: 55.8100
2023-12-03 20:58:00,361 - INFO - Epoch(test) test/:
2023-12-03 20:58:08,824 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0371
2023-12-03 20:58:08,947 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1079
2023-12-03 20:58:09,070 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0034
2023-12-03 20:58:09,193 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0002
2023-12-03 20:58:09,321 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0788
2023-12-03 20:58:09,452 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0548
2023-12-03 20:58:09,576 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1943
2023-12-03 20:58:09,576 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0681
2023-12-03 20:58:10,148 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 20:58:10,205 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 95505c8e1a64d42899c4c694e285abf7, with test/ image AP 0.1943
2023-12-03 20:58:23,553 - INFO - Epoch(train)[4/100][20/100]lr: 1.0000e-03  eta: 1:47:40  time: 13.3477  inter_cls_loss: 0.0816 inner_cls_loss: 53.0106
2023-12-03 20:58:32,517 - INFO - Epoch(train)[4/100][40/100]lr: 1.0000e-03  eta: 1:29:47  time: 22.3071  inter_cls_loss: 0.1188 inner_cls_loss: 51.3998
2023-12-03 20:58:40,968 - INFO - Epoch(train)[4/100][60/100]lr: 1.0000e-03  eta: 1:22:22  time: 30.7629  inter_cls_loss: 0.1012 inner_cls_loss: 49.3142
2023-12-03 20:58:49,882 - INFO - Epoch(train)[4/100][80/100]lr: 1.0000e-03  eta: 1:19:30  time: 39.6751  inter_cls_loss: 0.0853 inner_cls_loss: 47.6262
2023-12-03 20:58:57,983 - INFO - Epoch(train)[4/100][100/100]lr: 1.0000e-03  eta: 1:16:26  time: 47.7777  inter_cls_loss: 0.1350 inner_cls_loss: 46.3737
2023-12-03 20:58:58,813 - INFO - Epoch(test) test/:
2023-12-03 20:59:07,415 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0368
2023-12-03 20:59:07,540 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1407
2023-12-03 20:59:07,665 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0042
2023-12-03 20:59:07,788 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 20:59:07,914 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0978
2023-12-03 20:59:08,084 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0550
2023-12-03 20:59:08,213 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2000
2023-12-03 20:59:08,213 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0764
2023-12-03 20:59:08,806 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 20:59:08,857 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 656ef03097ed6cf7831dd801fd0cb366, with test/ image AP 0.2000
2023-12-03 20:59:21,947 - INFO - Epoch(train)[5/100][20/100]lr: 1.0000e-03  eta: 1:44:28  time: 13.0877  inter_cls_loss: 0.0845 inner_cls_loss: 44.2202
2023-12-03 20:59:30,810 - INFO - Epoch(train)[5/100][40/100]lr: 1.0000e-03  eta: 1:27:26  time: 21.9525  inter_cls_loss: 0.1601 inner_cls_loss: 43.1580
2023-12-03 20:59:32,981 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-03 20:59:32,981 - INFO - descriptor: SuperPoint+Boost-F-attlay3
2023-12-03 20:59:32,981 - INFO - num_epochs: 100
2023-12-03 20:59:32,981 - INFO - train_ratio: 1.0
2023-12-03 20:59:32,981 - INFO - batch_size: 16
2023-12-03 20:59:32,981 - INFO - num_workers: 4
2023-12-03 20:59:32,981 - INFO - print_interval: 20
2023-12-03 20:59:32,981 - INFO - eval_interval: 1
2023-12-03 20:59:32,981 - INFO - save_interval: 10
2023-12-03 20:59:32,981 - INFO - lr: 0.005
2023-12-03 20:59:32,981 - INFO - warmup_step: 20
2023-12-03 20:59:32,981 - INFO - random_seed: 0
2023-12-03 20:59:32,981 - INFO - expand_piexl: 5
2023-12-03 20:59:32,981 - INFO - test_threshold: 0.5
2023-12-03 20:59:32,981 - INFO - test_image: 
2023-12-03 20:59:32,981 - INFO - eval: False
2023-12-03 20:59:32,982 - INFO - save_path: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth
2023-12-03 20:59:32,982 - INFO - log_file: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_dataset_repeat_3_positive_keypoint_repeat_1_scratch.log
2023-12-03 20:59:32,982 - INFO - checkpoint: 
2023-12-03 20:59:32,982 - INFO - multiprocessing_context: spawn
2023-12-03 20:59:32,982 - INFO - data_root: data/srsdd
2023-12-03 20:59:32,982 - INFO - img_suffix: .png
2023-12-03 20:59:32,982 - INFO - train_ann_file: ['train/']
2023-12-03 20:59:32,982 - INFO - test_ann_file: ['test/']
2023-12-03 20:59:32,982 - INFO - dataset_class: {'ore-oil': 1, 'Cell-Container': 2, 'Fishing': 3, 'LawEnforce': 4, 'Dredger': 5, 'Container': 6}
2023-12-03 20:59:32,982 - INFO - dataset_repeat: 3
2023-12-03 20:59:32,982 - INFO - positive_keypoint_repeat: 1
2023-12-03 20:59:32,982 - INFO - image_aug: False
2023-12-03 20:59:32,982 - INFO - print: False
2023-12-03 20:59:32,982 - INFO - feature_booster_pretrained: 
2023-12-03 20:59:32,982 - INFO - device: cuda
2023-12-03 20:59:33,269 - INFO - The dataset located in ['train/'] was duplicated 3 times!
2023-12-03 20:59:40,286 - INFO - Epoch(train)[5/100][60/100]lr: 1.0000e-03  eta: 1:23:17  time: 31.4281  inter_cls_loss: 0.1284 inner_cls_loss: 41.5044
2023-12-03 20:59:49,643 - INFO - Epoch(train)[5/100][80/100]lr: 1.0000e-03  eta: 1:20:53  time: 40.7857  inter_cls_loss: 0.1947 inner_cls_loss: 40.4614
2023-12-03 20:59:57,204 - INFO - Epoch(train)[5/100][100/100]lr: 1.0000e-03  eta: 1:16:32  time: 48.3462  inter_cls_loss: 0.1870 inner_cls_loss: 39.0892
2023-12-03 20:59:58,028 - INFO - Epoch(test) test/:
2023-12-03 21:00:06,680 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0371
2023-12-03 21:00:06,811 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1698
2023-12-03 21:00:06,939 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0046
2023-12-03 21:00:07,066 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 21:00:07,195 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1004
2023-12-03 21:00:07,321 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0552
2023-12-03 21:00:07,444 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2002
2023-12-03 21:00:07,444 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0811
2023-12-03 21:00:08,196 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:00:08,252 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 37ae6107cf72afb513edaece0544da99, with test/ image AP 0.2002
2023-12-03 21:00:21,653 - INFO - Epoch(train)[6/100][20/100]lr: 1.0000e-03  eta: 1:45:51  time: 13.4006  inter_cls_loss: 0.1749 inner_cls_loss: 37.3912
2023-12-03 21:00:30,321 - INFO - Epoch(train)[6/100][40/100]lr: 1.0000e-03  eta: 1:26:59  time: 22.0679  inter_cls_loss: 0.1726 inner_cls_loss: 35.7314
2023-12-03 21:00:38,973 - INFO - Epoch(train)[6/100][60/100]lr: 1.0000e-03  eta: 1:20:33  time: 30.7208  inter_cls_loss: 0.2193 inner_cls_loss: 34.7835
2023-12-03 21:00:47,588 - INFO - Epoch(train)[6/100][80/100]lr: 1.0000e-03  eta: 1:17:11  time: 39.3358  inter_cls_loss: 0.1202 inner_cls_loss: 33.0878
2023-12-03 21:00:55,135 - INFO - Epoch(train)[6/100][100/100]lr: 1.0000e-03  eta: 1:13:26  time: 46.8828  inter_cls_loss: 0.1784 inner_cls_loss: 32.0401
2023-12-03 21:00:55,943 - INFO - Epoch(test) test/:
2023-12-03 21:01:04,456 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0343
2023-12-03 21:01:04,579 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0708
2023-12-03 21:01:04,701 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0039
2023-12-03 21:01:04,822 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0002
2023-12-03 21:01:04,946 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1015
2023-12-03 21:01:05,078 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0556
2023-12-03 21:01:05,200 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1853
2023-12-03 21:01:05,200 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0645
2023-12-03 21:01:05,758 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:01:19,360 - INFO - Epoch(train)[7/100][20/100]lr: 1.0000e-03  eta: 1:46:18  time: 13.5992  inter_cls_loss: 0.1280 inner_cls_loss: 30.9207
2023-12-03 21:01:27,472 - INFO - Epoch(train)[7/100][40/100]lr: 1.0000e-03  eta: 1:24:40  time: 21.7114  inter_cls_loss: 0.1791 inner_cls_loss: 30.0909
2023-12-03 21:01:36,114 - INFO - Epoch(train)[7/100][60/100]lr: 1.0000e-03  eta: 1:18:45  time: 30.3550  inter_cls_loss: 0.2230 inner_cls_loss: 29.1159
2023-12-03 21:01:44,467 - INFO - Epoch(train)[7/100][80/100]lr: 1.0000e-03  eta: 1:15:9  time: 38.7083  inter_cls_loss: 0.1587 inner_cls_loss: 27.8741
2023-12-03 21:01:52,246 - INFO - Epoch(train)[7/100][100/100]lr: 1.0000e-03  eta: 1:12:3  time: 46.4872  inter_cls_loss: 0.0896 inner_cls_loss: 26.4631
2023-12-03 21:01:53,079 - INFO - Epoch(test) test/:
2023-12-03 21:02:01,550 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0343
2023-12-03 21:02:01,678 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1675
2023-12-03 21:02:01,805 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0035
2023-12-03 21:02:01,931 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 21:02:02,056 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0933
2023-12-03 21:02:02,182 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0552
2023-12-03 21:02:02,303 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1935
2023-12-03 21:02:02,303 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0782
2023-12-03 21:02:02,849 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:02:16,071 - INFO - Epoch(train)[8/100][20/100]lr: 1.0000e-03  eta: 1:42:15  time: 13.2222  inter_cls_loss: 0.1082 inner_cls_loss: 25.5453
2023-12-03 21:02:24,119 - INFO - Epoch(train)[8/100][40/100]lr: 1.0000e-03  eta: 1:22:3  time: 21.2697  inter_cls_loss: 0.1796 inner_cls_loss: 24.8621
2023-12-03 21:02:32,560 - INFO - Epoch(train)[8/100][60/100]lr: 1.0000e-03  eta: 1:16:15  time: 29.7110  inter_cls_loss: 0.0975 inner_cls_loss: 23.6600
2023-12-03 21:02:40,861 - INFO - Epoch(train)[8/100][80/100]lr: 1.0000e-03  eta: 1:13:0  time: 38.0102  inter_cls_loss: 0.1385 inner_cls_loss: 22.9687
2023-12-03 21:02:48,600 - INFO - Epoch(train)[8/100][100/100]lr: 1.0000e-03  eta: 1:10:9  time: 45.7514  inter_cls_loss: 0.1185 inner_cls_loss: 22.1087
2023-12-03 21:02:49,419 - INFO - Epoch(test) test/:
2023-12-03 21:02:58,038 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0379
2023-12-03 21:02:58,168 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0727
2023-12-03 21:02:58,292 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0044
2023-12-03 21:02:58,417 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0002
2023-12-03 21:02:58,544 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0855
2023-12-03 21:02:58,671 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0510
2023-12-03 21:02:58,793 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1868
2023-12-03 21:02:58,794 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0626
2023-12-03 21:02:59,365 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:03:12,192 - INFO - Epoch(train)[9/100][20/100]lr: 1.0000e-03  eta: 1:38:7  time: 12.8259  inter_cls_loss: 0.2596 inner_cls_loss: 21.7918
2023-12-03 21:03:21,390 - INFO - Epoch(train)[9/100][40/100]lr: 1.0000e-03  eta: 1:24:3  time: 22.0242  inter_cls_loss: 0.1181 inner_cls_loss: 20.4617
2023-12-03 21:03:30,751 - INFO - Epoch(train)[9/100][60/100]lr: 1.0000e-03  eta: 1:19:41  time: 31.3855  inter_cls_loss: 0.1020 inner_cls_loss: 19.6355
2023-12-03 21:03:40,004 - INFO - Epoch(train)[9/100][80/100]lr: 1.0000e-03  eta: 1:17:12  time: 40.6381  inter_cls_loss: 0.1539 inner_cls_loss: 19.0996
2023-12-03 21:03:48,806 - INFO - Epoch(train)[9/100][100/100]lr: 1.0000e-03  eta: 1:14:59  time: 49.4403  inter_cls_loss: 0.1994 inner_cls_loss: 18.4823
2023-12-03 21:03:49,625 - INFO - Epoch(test) test/:
2023-12-03 21:03:58,264 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0356
2023-12-03 21:03:58,389 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1632
2023-12-03 21:03:58,514 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0039
2023-12-03 21:03:58,637 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0002
2023-12-03 21:03:58,763 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0998
2023-12-03 21:03:58,895 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0548
2023-12-03 21:03:59,020 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1951
2023-12-03 21:03:59,020 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0789
2023-12-03 21:03:59,567 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:04:12,497 - INFO - Epoch(train)[10/100][20/100]lr: 1.0000e-03  eta: 1:37:50  time: 12.9296  inter_cls_loss: 0.1798 inner_cls_loss: 17.7807
2023-12-03 21:04:13,651 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-03 21:04:13,651 - INFO - descriptor: SuperPoint+Boost-F-attlay3
2023-12-03 21:04:13,651 - INFO - num_epochs: 100
2023-12-03 21:04:13,651 - INFO - train_ratio: 1.0
2023-12-03 21:04:13,651 - INFO - batch_size: 16
2023-12-03 21:04:13,651 - INFO - num_workers: 4
2023-12-03 21:04:13,651 - INFO - print_interval: 20
2023-12-03 21:04:13,651 - INFO - eval_interval: 1
2023-12-03 21:04:13,651 - INFO - save_interval: 10
2023-12-03 21:04:13,651 - INFO - lr: 0.0005
2023-12-03 21:04:13,651 - INFO - warmup_step: 20
2023-12-03 21:04:13,651 - INFO - random_seed: 0
2023-12-03 21:04:13,652 - INFO - expand_piexl: 5
2023-12-03 21:04:13,652 - INFO - test_threshold: 0.5
2023-12-03 21:04:13,652 - INFO - test_image: 
2023-12-03 21:04:13,652 - INFO - eval: False
2023-12-03 21:04:13,652 - INFO - save_path: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth
2023-12-03 21:04:13,652 - INFO - log_file: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_dataset_repeat_3_positive_keypoint_repeat_1_scratch.log
2023-12-03 21:04:13,652 - INFO - checkpoint: 
2023-12-03 21:04:13,652 - INFO - multiprocessing_context: spawn
2023-12-03 21:04:13,652 - INFO - data_root: data/srsdd
2023-12-03 21:04:13,652 - INFO - img_suffix: .png
2023-12-03 21:04:13,652 - INFO - train_ann_file: ['train/']
2023-12-03 21:04:13,652 - INFO - test_ann_file: ['test/']
2023-12-03 21:04:13,652 - INFO - dataset_class: {'ore-oil': 1, 'Cell-Container': 2, 'Fishing': 3, 'LawEnforce': 4, 'Dredger': 5, 'Container': 6}
2023-12-03 21:04:13,652 - INFO - dataset_repeat: 3
2023-12-03 21:04:13,652 - INFO - positive_keypoint_repeat: 1
2023-12-03 21:04:13,652 - INFO - image_aug: False
2023-12-03 21:04:13,652 - INFO - print: False
2023-12-03 21:04:13,652 - INFO - feature_booster_pretrained: 
2023-12-03 21:04:13,652 - INFO - device: cuda
2023-12-03 21:04:13,907 - INFO - The dataset located in ['train/'] was duplicated 3 times!
2023-12-03 21:05:54,521 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-03 21:05:54,521 - INFO - descriptor: SuperPoint+Boost-F-attlay3
2023-12-03 21:05:54,521 - INFO - num_epochs: 100
2023-12-03 21:05:54,521 - INFO - train_ratio: 1.0
2023-12-03 21:05:54,521 - INFO - batch_size: 16
2023-12-03 21:05:54,521 - INFO - num_workers: 4
2023-12-03 21:05:54,521 - INFO - print_interval: 20
2023-12-03 21:05:54,521 - INFO - eval_interval: 1
2023-12-03 21:05:54,521 - INFO - save_interval: 10
2023-12-03 21:05:54,521 - INFO - lr: 0.0005
2023-12-03 21:05:54,521 - INFO - warmup_step: 20
2023-12-03 21:05:54,522 - INFO - random_seed: 0
2023-12-03 21:05:54,522 - INFO - expand_piexl: 5
2023-12-03 21:05:54,522 - INFO - test_threshold: 0.5
2023-12-03 21:05:54,522 - INFO - test_image: 
2023-12-03 21:05:54,522 - INFO - eval: False
2023-12-03 21:05:54,522 - INFO - save_path: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth
2023-12-03 21:05:54,522 - INFO - log_file: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_dataset_repeat_3_positive_keypoint_repeat_1_scratch.log
2023-12-03 21:05:54,522 - INFO - checkpoint: 
2023-12-03 21:05:54,522 - INFO - multiprocessing_context: spawn
2023-12-03 21:05:54,522 - INFO - data_root: data/srsdd
2023-12-03 21:05:54,522 - INFO - img_suffix: .png
2023-12-03 21:05:54,522 - INFO - train_ann_file: ['train/']
2023-12-03 21:05:54,522 - INFO - test_ann_file: ['test/']
2023-12-03 21:05:54,522 - INFO - dataset_class: {'ore-oil': 1, 'Cell-Container': 2, 'Fishing': 3, 'LawEnforce': 4, 'Dredger': 5, 'Container': 6}
2023-12-03 21:05:54,522 - INFO - dataset_repeat: 3
2023-12-03 21:05:54,522 - INFO - positive_keypoint_repeat: 1
2023-12-03 21:05:54,522 - INFO - image_aug: False
2023-12-03 21:05:54,522 - INFO - print: False
2023-12-03 21:05:54,522 - INFO - feature_booster_pretrained: 
2023-12-03 21:05:54,522 - INFO - device: cuda
2023-12-03 21:05:54,765 - INFO - The dataset located in ['train/'] was duplicated 3 times!
2023-12-03 21:06:08,626 - INFO - Epoch(train)[1/100][20/100]lr: 5.0000e-04  eta: 1:54:9  time: 13.7273  inter_cls_loss: 1.5581 inner_cls_loss: 94.3460
2023-12-03 21:06:17,929 - INFO - Epoch(train)[1/100][40/100]lr: 5.0000e-04  eta: 1:35:34  time: 23.0306  inter_cls_loss: 0.8762 inner_cls_loss: 93.1890
2023-12-03 21:06:26,929 - INFO - Epoch(train)[1/100][60/100]lr: 5.0000e-04  eta: 1:28:26  time: 32.0310  inter_cls_loss: 0.3676 inner_cls_loss: 91.0030
2023-12-03 21:06:36,291 - INFO - Epoch(train)[1/100][80/100]lr: 5.0000e-04  eta: 1:25:32  time: 41.3927  inter_cls_loss: 0.1893 inner_cls_loss: 88.8486
2023-12-03 21:06:45,420 - INFO - Epoch(train)[1/100][100/100]lr: 5.0000e-04  eta: 1:23:21  time: 50.5216  inter_cls_loss: 0.2197 inner_cls_loss: 87.6441
2023-12-03 21:06:46,248 - INFO - Epoch(test) test/:
2023-12-03 21:06:55,511 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0387
2023-12-03 21:06:55,642 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0868
2023-12-03 21:06:55,769 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0048
2023-12-03 21:06:55,900 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 21:06:56,029 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0557
2023-12-03 21:06:56,166 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0447
2023-12-03 21:06:56,296 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1633
2023-12-03 21:06:56,296 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0563
2023-12-03 21:06:56,939 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:06:56,991 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 a68a078523671c127a46d6ae52afdcbf, with test/ image AP 0.1633
2023-12-03 21:07:10,264 - INFO - Epoch(train)[2/100][20/100]lr: 5.0000e-04  eta: 1:49:15  time: 13.2707  inter_cls_loss: 0.1776 inner_cls_loss: 85.6287
2023-12-03 21:07:19,072 - INFO - Epoch(train)[2/100][40/100]lr: 5.0000e-04  eta: 1:30:42  time: 22.0811  inter_cls_loss: 0.1199 inner_cls_loss: 83.7862
2023-12-03 21:07:27,963 - INFO - Epoch(train)[2/100][60/100]lr: 5.0000e-04  eta: 1:24:39  time: 30.9718  inter_cls_loss: 0.1764 inner_cls_loss: 82.9651
2023-12-03 21:07:36,984 - INFO - Epoch(train)[2/100][80/100]lr: 5.0000e-04  eta: 1:21:48  time: 39.9907  inter_cls_loss: 0.1459 inner_cls_loss: 81.2639
2023-12-03 21:07:45,383 - INFO - Epoch(train)[2/100][100/100]lr: 5.0000e-04  eta: 1:19:2  time: 48.3917  inter_cls_loss: 0.1398 inner_cls_loss: 79.6417
2023-12-03 21:07:46,184 - INFO - Epoch(test) test/:
2023-12-03 21:07:54,724 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0370
2023-12-03 21:07:54,852 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0804
2023-12-03 21:07:54,982 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0032
2023-12-03 21:07:55,115 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 21:07:55,245 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0906
2023-12-03 21:07:55,377 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0566
2023-12-03 21:07:55,503 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1927
2023-12-03 21:07:55,503 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0658
2023-12-03 21:07:56,208 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:07:56,259 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 39f908221ecec94706e842d5a520defe, with test/ image AP 0.1927
2023-12-03 21:08:09,653 - INFO - Epoch(train)[3/100][20/100]lr: 5.0000e-04  eta: 1:49:9  time: 13.3934  inter_cls_loss: 0.1268 inner_cls_loss: 78.0335
2023-12-03 21:08:17,999 - INFO - Epoch(train)[3/100][40/100]lr: 5.0000e-04  eta: 1:28:24  time: 21.7395  inter_cls_loss: 0.1283 inner_cls_loss: 76.6469
2023-12-03 21:08:27,183 - INFO - Epoch(train)[3/100][60/100]lr: 5.0000e-04  eta: 1:23:39  time: 30.9228  inter_cls_loss: 0.1261 inner_cls_loss: 75.3484
2023-12-03 21:08:35,075 - INFO - Epoch(train)[3/100][80/100]lr: 5.0000e-04  eta: 1:18:35  time: 38.8138  inter_cls_loss: 0.1794 inner_cls_loss: 74.3562
2023-12-03 21:08:42,187 - INFO - Epoch(train)[3/100][100/100]lr: 5.0000e-04  eta: 1:14:14  time: 45.9268  inter_cls_loss: 0.2312 inner_cls_loss: 73.2428
2023-12-03 21:08:43,045 - INFO - Epoch(test) test/:
2023-12-03 21:08:51,704 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0363
2023-12-03 21:08:51,839 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0813
2023-12-03 21:08:51,968 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0031
2023-12-03 21:08:52,097 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 21:08:52,232 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1487
2023-12-03 21:08:52,367 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0543
2023-12-03 21:08:52,498 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2080
2023-12-03 21:08:52,498 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0760
2023-12-03 21:08:53,259 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:08:53,310 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 2ea78b0b1a98ee4167edf49f4f555a31, with test/ image AP 0.2080
2023-12-03 21:09:06,995 - INFO - Epoch(train)[4/100][20/100]lr: 5.0000e-04  eta: 1:50:21  time: 13.6799  inter_cls_loss: 0.0857 inner_cls_loss: 71.0343
2023-12-03 21:09:15,611 - INFO - Epoch(train)[4/100][40/100]lr: 5.0000e-04  eta: 1:29:45  time: 22.3006  inter_cls_loss: 0.1190 inner_cls_loss: 70.0633
2023-12-03 21:09:24,508 - INFO - Epoch(train)[4/100][60/100]lr: 5.0000e-04  eta: 1:23:32  time: 31.1977  inter_cls_loss: 0.1016 inner_cls_loss: 68.5536
2023-12-03 21:09:33,492 - INFO - Epoch(train)[4/100][80/100]lr: 5.0000e-04  eta: 1:20:31  time: 40.1794  inter_cls_loss: 0.0860 inner_cls_loss: 67.3627
2023-12-03 21:09:42,226 - INFO - Epoch(train)[4/100][100/100]lr: 5.0000e-04  eta: 1:18:15  time: 48.9155  inter_cls_loss: 0.1364 inner_cls_loss: 66.6465
2023-12-03 21:09:43,063 - INFO - Epoch(test) test/:
2023-12-03 21:09:51,723 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0374
2023-12-03 21:09:51,849 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1798
2023-12-03 21:09:51,976 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0032
2023-12-03 21:09:52,102 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 21:09:52,230 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1060
2023-12-03 21:09:52,358 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0567
2023-12-03 21:09:52,485 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2085
2023-12-03 21:09:52,485 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0845
2023-12-03 21:09:53,323 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:09:53,381 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 a523057742cd171b573dbedf8f8aaf8b, with test/ image AP 0.2085
2023-12-03 21:10:07,324 - INFO - Epoch(train)[5/100][20/100]lr: 5.0000e-04  eta: 1:51:18  time: 13.9425  inter_cls_loss: 0.0849 inner_cls_loss: 64.9023
2023-12-03 21:10:16,676 - INFO - Epoch(train)[5/100][40/100]lr: 5.0000e-04  eta: 1:32:46  time: 23.2927  inter_cls_loss: 0.1599 inner_cls_loss: 64.3244
2023-12-03 21:10:25,606 - INFO - Epoch(train)[5/100][60/100]lr: 5.0000e-04  eta: 1:25:23  time: 32.2246  inter_cls_loss: 0.1285 inner_cls_loss: 62.9879
2023-12-03 21:10:34,814 - INFO - Epoch(train)[5/100][80/100]lr: 5.0000e-04  eta: 1:22:10  time: 41.4323  inter_cls_loss: 0.1973 inner_cls_loss: 62.3867
2023-12-03 21:10:42,704 - INFO - Epoch(train)[5/100][100/100]lr: 5.0000e-04  eta: 1:18:5  time: 49.3228  inter_cls_loss: 0.1865 inner_cls_loss: 61.3707
2023-12-03 21:10:43,515 - INFO - Epoch(test) test/:
2023-12-03 21:10:52,160 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0365
2023-12-03 21:10:52,296 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0699
2023-12-03 21:10:52,431 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0033
2023-12-03 21:10:52,565 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0002
2023-12-03 21:10:52,701 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1028
2023-12-03 21:10:52,833 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0611
2023-12-03 21:10:52,960 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1976
2023-12-03 21:10:52,960 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0673
2023-12-03 21:10:53,985 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:11:07,481 - INFO - Epoch(train)[6/100][20/100]lr: 5.0000e-04  eta: 1:46:36  time: 13.4954  inter_cls_loss: 0.1781 inner_cls_loss: 59.9212
2023-12-03 21:11:16,626 - INFO - Epoch(train)[6/100][40/100]lr: 5.0000e-04  eta: 1:29:14  time: 22.6413  inter_cls_loss: 0.1725 inner_cls_loss: 58.5624
2023-12-03 21:11:25,735 - INFO - Epoch(train)[6/100][60/100]lr: 5.0000e-04  eta: 1:23:15  time: 31.7500  inter_cls_loss: 0.2110 inner_cls_loss: 57.8803
2023-12-03 21:11:35,133 - INFO - Epoch(train)[6/100][80/100]lr: 5.0000e-04  eta: 1:20:45  time: 41.1479  inter_cls_loss: 0.1115 inner_cls_loss: 56.3409
2023-12-03 21:11:43,849 - INFO - Epoch(train)[6/100][100/100]lr: 5.0000e-04  eta: 1:18:7  time: 49.8636  inter_cls_loss: 0.1524 inner_cls_loss: 55.4482
2023-12-03 21:11:44,689 - INFO - Epoch(test) test/:
2023-12-03 21:11:53,503 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0525
2023-12-03 21:11:53,651 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1138
2023-12-03 21:11:53,794 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0118
2023-12-03 21:11:53,937 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0006
2023-12-03 21:11:54,080 - INFO - Metrics for Dredger: Accuracy: 0.9923, Precision: 0.2186, Recall: 0.3376, F1_score: 0.2654, Average_Precision: 0.2243
2023-12-03 21:11:54,220 - INFO - Metrics for Container: Accuracy: 0.9853, Precision: 0.2356, Recall: 0.0267, F1_score: 0.0480, Average_Precision: 0.1162
2023-12-03 21:11:54,362 - INFO - Metrics for foreground: Accuracy: 0.9758, Precision: 0.7464, Recall: 0.2108, F1_score: 0.3287, Average_Precision: 0.3575
2023-12-03 21:11:54,363 - INFO - Average metrics: Accuracy: 0.9919, Precision: 0.1715, Recall: 0.0822, F1_score: 0.0917, Average_Precision: 0.1252
2023-12-03 21:11:55,511 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:11:55,559 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 2aa22f8b56af2e7f30de14f790e2c37e, with test/ image AP 0.3575
2023-12-03 21:12:08,928 - INFO - Epoch(train)[7/100][20/100]lr: 5.0000e-04  eta: 1:44:30  time: 13.3689  inter_cls_loss: 0.1098 inner_cls_loss: 54.4886
2023-12-03 21:12:16,993 - INFO - Epoch(train)[7/100][40/100]lr: 5.0000e-04  eta: 1:23:35  time: 21.4338  inter_cls_loss: 0.1666 inner_cls_loss: 53.8889
2023-12-03 21:12:26,185 - INFO - Epoch(train)[7/100][60/100]lr: 5.0000e-04  eta: 1:19:27  time: 30.6238  inter_cls_loss: 0.1793 inner_cls_loss: 52.9642
2023-12-03 21:12:34,758 - INFO - Epoch(train)[7/100][80/100]lr: 5.0000e-04  eta: 1:16:6  time: 39.1986  inter_cls_loss: 0.1316 inner_cls_loss: 51.7219
2023-12-03 21:12:42,811 - INFO - Epoch(train)[7/100][100/100]lr: 5.0000e-04  eta: 1:13:14  time: 47.2521  inter_cls_loss: 0.0762 inner_cls_loss: 50.4282
2023-12-03 21:12:43,667 - INFO - Epoch(test) test/:
2023-12-03 21:12:52,726 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0573
2023-12-03 21:12:52,869 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2033
2023-12-03 21:12:53,010 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0124
2023-12-03 21:12:53,150 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0014
2023-12-03 21:12:53,297 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1692
2023-12-03 21:12:53,444 - INFO - Metrics for Container: Accuracy: 0.9842, Precision: 0.3380, Recall: 0.1441, F1_score: 0.2021, Average_Precision: 0.1775
2023-12-03 21:12:53,593 - INFO - Metrics for foreground: Accuracy: 0.9756, Precision: 0.8092, Recall: 0.1708, F1_score: 0.2820, Average_Precision: 0.4262
2023-12-03 21:12:53,594 - INFO - Average metrics: Accuracy: 0.9922, Precision: 0.1639, Recall: 0.0450, F1_score: 0.0692, Average_Precision: 0.1496
2023-12-03 21:12:54,723 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:12:54,776 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 b95627b87fda099a51240ece542fe158, with test/ image AP 0.4262
2023-12-03 21:13:08,733 - INFO - Epoch(train)[8/100][20/100]lr: 5.0000e-04  eta: 1:47:56  time: 13.9570  inter_cls_loss: 0.1052 inner_cls_loss: 49.6602
2023-12-03 21:13:16,894 - INFO - Epoch(train)[8/100][40/100]lr: 5.0000e-04  eta: 1:25:19  time: 22.1160  inter_cls_loss: 0.1463 inner_cls_loss: 48.9888
2023-12-03 21:13:26,055 - INFO - Epoch(train)[8/100][60/100]lr: 5.0000e-04  eta: 1:20:16  time: 31.2779  inter_cls_loss: 0.0876 inner_cls_loss: 47.7758
2023-12-03 21:13:35,434 - INFO - Epoch(train)[8/100][80/100]lr: 5.0000e-04  eta: 1:18:5  time: 40.6565  inter_cls_loss: 0.1030 inner_cls_loss: 47.0270
2023-12-03 21:13:44,279 - INFO - Epoch(train)[8/100][100/100]lr: 5.0000e-04  eta: 1:15:54  time: 49.5028  inter_cls_loss: 0.0977 inner_cls_loss: 46.2551
2023-12-03 21:13:45,115 - INFO - Epoch(test) test/:
2023-12-03 21:13:54,059 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0435
2023-12-03 21:13:54,212 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1567
2023-12-03 21:13:54,366 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0130
2023-12-03 21:13:54,517 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0020
2023-12-03 21:13:54,663 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2149
2023-12-03 21:13:54,848 - INFO - Metrics for Container: Accuracy: 0.9837, Precision: 0.3077, Recall: 0.1376, F1_score: 0.1901, Average_Precision: 0.2218
2023-12-03 21:13:55,001 - INFO - Metrics for foreground: Accuracy: 0.9758, Precision: 0.8156, Recall: 0.1805, F1_score: 0.2956, Average_Precision: 0.4852
2023-12-03 21:13:55,001 - INFO - Average metrics: Accuracy: 0.9922, Precision: 0.1605, Recall: 0.0454, F1_score: 0.0694, Average_Precision: 0.1624
2023-12-03 21:13:56,183 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:13:56,234 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 e9a5b981a328b8a912972d2a175c67e0, with test/ image AP 0.4852
2023-12-03 21:14:10,011 - INFO - Epoch(train)[9/100][20/100]lr: 5.0000e-04  eta: 1:45:23  time: 13.7761  inter_cls_loss: 0.1957 inner_cls_loss: 46.0285
2023-12-03 21:14:18,731 - INFO - Epoch(train)[9/100][40/100]lr: 5.0000e-04  eta: 1:25:51  time: 22.4951  inter_cls_loss: 0.0987 inner_cls_loss: 44.5375
2023-12-03 21:14:27,677 - INFO - Epoch(train)[9/100][60/100]lr: 5.0000e-04  eta: 1:19:49  time: 31.4421  inter_cls_loss: 0.0721 inner_cls_loss: 43.5784
2023-12-03 21:14:36,170 - INFO - Epoch(train)[9/100][80/100]lr: 5.0000e-04  eta: 1:15:52  time: 39.9358  inter_cls_loss: 0.1143 inner_cls_loss: 43.0889
2023-12-03 21:14:43,858 - INFO - Epoch(train)[9/100][100/100]lr: 5.0000e-04  eta: 1:12:13  time: 47.6237  inter_cls_loss: 0.1536 inner_cls_loss: 42.4347
2023-12-03 21:14:44,714 - INFO - Epoch(test) test/:
2023-12-03 21:14:53,356 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0436
2023-12-03 21:14:53,501 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1645
2023-12-03 21:14:53,646 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0117
2023-12-03 21:14:53,794 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0022
2023-12-03 21:14:53,946 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1393
2023-12-03 21:14:54,096 - INFO - Metrics for Container: Accuracy: 0.9858, Precision: 0.4167, Recall: 0.0491, F1_score: 0.0879, Average_Precision: 0.2542
2023-12-03 21:14:54,240 - INFO - Metrics for foreground: Accuracy: 0.9732, Precision: 0.8889, Recall: 0.0519, F1_score: 0.0980, Average_Precision: 0.5078
2023-12-03 21:14:54,241 - INFO - Average metrics: Accuracy: 0.9921, Precision: 0.1865, Recall: 0.0144, F1_score: 0.0266, Average_Precision: 0.1605
2023-12-03 21:14:55,374 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:14:55,426 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 a8a08b3d9671fb766cc127049d5d4703, with test/ image AP 0.5078
2023-12-03 21:15:09,166 - INFO - Epoch(train)[10/100][20/100]lr: 5.0000e-04  eta: 1:43:57  time: 13.7398  inter_cls_loss: 0.1281 inner_cls_loss: 41.6160
2023-12-03 21:15:18,070 - INFO - Epoch(train)[10/100][40/100]lr: 5.0000e-04  eta: 1:25:28  time: 22.6433  inter_cls_loss: 0.1474 inner_cls_loss: 40.9362
2023-12-03 21:15:26,223 - INFO - Epoch(train)[10/100][60/100]lr: 5.0000e-04  eta: 1:17:19  time: 30.7925  inter_cls_loss: 0.0679 inner_cls_loss: 39.6800
2023-12-03 21:15:34,656 - INFO - Epoch(train)[10/100][80/100]lr: 5.0000e-04  eta: 1:13:43  time: 39.2294  inter_cls_loss: 0.1392 inner_cls_loss: 39.4873
2023-12-03 21:15:43,374 - INFO - Epoch(train)[10/100][100/100]lr: 5.0000e-04  eta: 1:11:55  time: 47.9479  inter_cls_loss: 0.1097 inner_cls_loss: 38.6241
2023-12-03 21:15:44,241 - INFO - Epoch(test) test/:
2023-12-03 21:15:53,380 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0480
2023-12-03 21:15:53,527 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1449
2023-12-03 21:15:53,669 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0128
2023-12-03 21:15:53,813 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0026
2023-12-03 21:15:53,960 - INFO - Metrics for Dredger: Accuracy: 0.9960, Precision: 0.9167, Recall: 0.0203, F1_score: 0.0397, Average_Precision: 0.1912
2023-12-03 21:15:54,114 - INFO - Metrics for Container: Accuracy: 0.9837, Precision: 0.3252, Recall: 0.1599, F1_score: 0.2144, Average_Precision: 0.2275
2023-12-03 21:15:54,267 - INFO - Metrics for foreground: Accuracy: 0.9767, Precision: 0.8488, Recall: 0.2094, F1_score: 0.3359, Average_Precision: 0.5357
2023-12-03 21:15:54,267 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.2987, Recall: 0.0557, F1_score: 0.0843, Average_Precision: 0.1661
2023-12-03 21:15:55,399 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:15:55,451 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 3f783658adde61fab5fdcfc6d71789b0, with test/ image AP 0.5357
2023-12-03 21:16:08,882 - INFO - Epoch(train)[11/100][20/100]lr: 5.0000e-04  eta: 1:40:11  time: 13.3887  inter_cls_loss: 0.0790 inner_cls_loss: 37.7678
2023-12-03 21:16:17,695 - INFO - Epoch(train)[11/100][40/100]lr: 5.0000e-04  eta: 1:22:53  time: 22.2011  inter_cls_loss: 0.2329 inner_cls_loss: 37.5778
2023-12-03 21:16:26,102 - INFO - Epoch(train)[11/100][60/100]lr: 5.0000e-04  eta: 1:16:0  time: 30.6082  inter_cls_loss: 0.0687 inner_cls_loss: 36.3442
2023-12-03 21:16:34,332 - INFO - Epoch(train)[11/100][80/100]lr: 5.0000e-04  eta: 1:12:10  time: 38.8380  inter_cls_loss: 0.0854 inner_cls_loss: 35.5855
2023-12-03 21:16:42,005 - INFO - Epoch(train)[11/100][100/100]lr: 5.0000e-04  eta: 1:8:59  time: 46.5119  inter_cls_loss: 0.0891 inner_cls_loss: 35.0861
2023-12-03 21:16:42,818 - INFO - Epoch(test) test/:
2023-12-03 21:16:51,860 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0619
2023-12-03 21:16:52,006 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1736
2023-12-03 21:16:52,155 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0110
2023-12-03 21:16:52,305 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0026
2023-12-03 21:16:52,451 - INFO - Metrics for Dredger: Accuracy: 0.9941, Precision: 0.2262, Recall: 0.1753, F1_score: 0.1975, Average_Precision: 0.1889
2023-12-03 21:16:52,598 - INFO - Metrics for Container: Accuracy: 0.9838, Precision: 0.2101, Recall: 0.0590, F1_score: 0.0921, Average_Precision: 0.2395
2023-12-03 21:16:52,745 - INFO - Metrics for foreground: Accuracy: 0.9768, Precision: 0.8448, Recall: 0.2132, F1_score: 0.3405, Average_Precision: 0.5541
2023-12-03 21:16:52,746 - INFO - Average metrics: Accuracy: 0.9921, Precision: 0.1830, Recall: 0.0639, F1_score: 0.0900, Average_Precision: 0.1759
2023-12-03 21:16:53,880 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:16:53,931 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 820da7dda429c72600f08bb0198345b9, with test/ image AP 0.5541
2023-12-03 21:17:07,934 - INFO - Epoch(train)[12/100][20/100]lr: 5.0000e-04  eta: 1:43:37  time: 14.0025  inter_cls_loss: 0.1263 inner_cls_loss: 34.9440
2023-12-03 21:17:16,325 - INFO - Epoch(train)[12/100][40/100]lr: 5.0000e-04  eta: 1:22:39  time: 22.3912  inter_cls_loss: 0.0762 inner_cls_loss: 33.7382
2023-12-03 21:17:24,958 - INFO - Epoch(train)[12/100][60/100]lr: 5.0000e-04  eta: 1:16:10  time: 31.0239  inter_cls_loss: 0.0750 inner_cls_loss: 33.1439
2023-12-03 21:17:33,465 - INFO - Epoch(train)[12/100][80/100]lr: 5.0000e-04  eta: 1:12:38  time: 39.5332  inter_cls_loss: 0.0940 inner_cls_loss: 32.6059
2023-12-03 21:17:41,264 - INFO - Epoch(train)[12/100][100/100]lr: 5.0000e-04  eta: 1:9:25  time: 47.3322  inter_cls_loss: 0.0994 inner_cls_loss: 32.0175
2023-12-03 21:17:42,110 - INFO - Epoch(test) test/:
2023-12-03 21:17:51,052 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0672
2023-12-03 21:17:51,204 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2155
2023-12-03 21:17:51,349 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0141
2023-12-03 21:17:51,498 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0027
2023-12-03 21:17:51,648 - INFO - Metrics for Dredger: Accuracy: 0.9951, Precision: 0.1905, Recall: 0.0590, F1_score: 0.0901, Average_Precision: 0.1822
2023-12-03 21:17:51,804 - INFO - Metrics for Container: Accuracy: 0.9844, Precision: 0.3148, Recall: 0.1053, F1_score: 0.1579, Average_Precision: 0.2450
2023-12-03 21:17:51,959 - INFO - Metrics for foreground: Accuracy: 0.9767, Precision: 0.9014, Recall: 0.1902, F1_score: 0.3141, Average_Precision: 0.5833
2023-12-03 21:17:51,959 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.2010, Recall: 0.0507, F1_score: 0.0803, Average_Precision: 0.1871
2023-12-03 21:17:53,091 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:17:53,151 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 47af6b23d2cb5c3c0aeeb2ce1e8b934c, with test/ image AP 0.5833
2023-12-03 21:18:06,637 - INFO - Epoch(train)[13/100][20/100]lr: 5.0000e-04  eta: 1:38:39  time: 13.4849  inter_cls_loss: 0.1245 inner_cls_loss: 31.5320
2023-12-03 21:18:15,621 - INFO - Epoch(train)[13/100][40/100]lr: 5.0000e-04  eta: 1:22:0  time: 22.4693  inter_cls_loss: 0.1028 inner_cls_loss: 30.9614
2023-12-03 21:18:24,435 - INFO - Epoch(train)[13/100][60/100]lr: 5.0000e-04  eta: 1:15:56  time: 31.2829  inter_cls_loss: 0.0926 inner_cls_loss: 30.3518
2023-12-03 21:18:33,011 - INFO - Epoch(train)[13/100][80/100]lr: 5.0000e-04  eta: 1:12:24  time: 39.8589  inter_cls_loss: 0.1100 inner_cls_loss: 29.8578
2023-12-03 21:18:40,624 - INFO - Epoch(train)[13/100][100/100]lr: 5.0000e-04  eta: 1:8:50  time: 47.4718  inter_cls_loss: 0.1093 inner_cls_loss: 29.2703
2023-12-03 21:18:41,458 - INFO - Epoch(test) test/:
2023-12-03 21:18:50,370 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0673
2023-12-03 21:18:50,520 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1209
2023-12-03 21:18:50,670 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0129
2023-12-03 21:18:50,816 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0025
2023-12-03 21:18:50,968 - INFO - Metrics for Dredger: Accuracy: 0.9957, Precision: 0.4697, Recall: 0.3579, F1_score: 0.4063, Average_Precision: 0.3329
2023-12-03 21:18:51,125 - INFO - Metrics for Container: Accuracy: 0.9851, Precision: 0.3745, Recall: 0.1026, F1_score: 0.1611, Average_Precision: 0.2907
2023-12-03 21:18:51,280 - INFO - Metrics for foreground: Accuracy: 0.9769, Precision: 0.8634, Recall: 0.2135, F1_score: 0.3423, Average_Precision: 0.5729
2023-12-03 21:18:51,280 - INFO - Average metrics: Accuracy: 0.9925, Precision: 0.2439, Recall: 0.0963, F1_score: 0.1300, Average_Precision: 0.2000
2023-12-03 21:18:52,417 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:19:06,373 - INFO - Epoch(train)[14/100][20/100]lr: 5.0000e-04  eta: 1:40:54  time: 13.9515  inter_cls_loss: 0.1328 inner_cls_loss: 28.8773
2023-12-03 21:19:14,772 - INFO - Epoch(train)[14/100][40/100]lr: 5.0000e-04  eta: 1:20:39  time: 22.3540  inter_cls_loss: 0.0897 inner_cls_loss: 28.1050
2023-12-03 21:19:23,438 - INFO - Epoch(train)[14/100][60/100]lr: 5.0000e-04  eta: 1:14:26  time: 31.0182  inter_cls_loss: 0.0973 inner_cls_loss: 27.5728
2023-12-03 21:19:31,517 - INFO - Epoch(train)[14/100][80/100]lr: 5.0000e-04  eta: 1:10:12  time: 39.0974  inter_cls_loss: 0.1827 inner_cls_loss: 27.4791
2023-12-03 21:19:39,527 - INFO - Epoch(train)[14/100][100/100]lr: 5.0000e-04  eta: 1:7:31  time: 47.1096  inter_cls_loss: 0.0676 inner_cls_loss: 26.3286
2023-12-03 21:19:40,373 - INFO - Epoch(test) test/:
2023-12-03 21:19:49,279 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0726
2023-12-03 21:19:49,430 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1389
2023-12-03 21:19:49,578 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0258
2023-12-03 21:19:49,734 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0030
2023-12-03 21:19:49,893 - INFO - Metrics for Dredger: Accuracy: 0.9949, Precision: 0.3618, Recall: 0.3044, F1_score: 0.3307, Average_Precision: 0.2743
2023-12-03 21:19:50,063 - INFO - Metrics for Container: Accuracy: 0.9831, Precision: 0.3744, Recall: 0.3221, F1_score: 0.3462, Average_Precision: 0.2796
2023-12-03 21:19:50,215 - INFO - Metrics for foreground: Accuracy: 0.9791, Precision: 0.7323, Recall: 0.4021, F1_score: 0.5191, Average_Precision: 0.5912
2023-12-03 21:19:50,215 - INFO - Average metrics: Accuracy: 0.9924, Precision: 0.2098, Recall: 0.1469, F1_score: 0.1709, Average_Precision: 0.1979
2023-12-03 21:19:51,358 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:19:51,413 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 4b0bfde398f5d7816ad0c4ab994b956f, with test/ image AP 0.5912
2023-12-03 21:20:04,985 - INFO - Epoch(train)[15/100][20/100]lr: 5.0000e-04  eta: 1:37:2  time: 13.5713  inter_cls_loss: 0.0953 inner_cls_loss: 26.0184
2023-12-03 21:20:13,767 - INFO - Epoch(train)[15/100][40/100]lr: 5.0000e-04  eta: 1:19:43  time: 22.3536  inter_cls_loss: 0.1105 inner_cls_loss: 25.5987
2023-12-03 21:20:22,615 - INFO - Epoch(train)[15/100][60/100]lr: 5.0000e-04  eta: 1:14:1  time: 31.2017  inter_cls_loss: 0.1063 inner_cls_loss: 25.1261
2023-12-03 21:20:32,018 - INFO - Epoch(train)[15/100][80/100]lr: 5.0000e-04  eta: 1:12:4  time: 40.6046  inter_cls_loss: 0.1070 inner_cls_loss: 24.7433
2023-12-03 21:20:41,042 - INFO - Epoch(train)[15/100][100/100]lr: 5.0000e-04  eta: 1:10:18  time: 49.6285  inter_cls_loss: 0.0795 inner_cls_loss: 24.1090
2023-12-03 21:20:41,906 - INFO - Epoch(test) test/:
2023-12-03 21:20:50,841 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0856
2023-12-03 21:20:50,992 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1960
2023-12-03 21:20:51,145 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0288
2023-12-03 21:20:51,293 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0027
2023-12-03 21:20:51,445 - INFO - Metrics for Dredger: Accuracy: 0.9931, Precision: 0.1967, Recall: 0.2196, F1_score: 0.2075, Average_Precision: 0.1875
2023-12-03 21:20:51,602 - INFO - Metrics for Container: Accuracy: 0.9831, Precision: 0.3638, Recall: 0.2844, F1_score: 0.3192, Average_Precision: 0.2721
2023-12-03 21:20:51,756 - INFO - Metrics for foreground: Accuracy: 0.9797, Precision: 0.7516, Recall: 0.4137, F1_score: 0.5336, Average_Precision: 0.6136
2023-12-03 21:20:51,757 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.1874, Recall: 0.1311, F1_score: 0.1515, Average_Precision: 0.1981
2023-12-03 21:20:52,862 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:20:52,914 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 62a2a857adc85230de55c532378a8a3a, with test/ image AP 0.6136
2023-12-03 21:21:06,324 - INFO - Epoch(train)[16/100][20/100]lr: 5.0000e-04  eta: 1:34:45  time: 13.4081  inter_cls_loss: 0.0783 inner_cls_loss: 23.6043
2023-12-03 21:21:15,248 - INFO - Epoch(train)[16/100][40/100]lr: 5.0000e-04  eta: 1:18:43  time: 22.3335  inter_cls_loss: 0.0536 inner_cls_loss: 22.9893
2023-12-03 21:21:23,524 - INFO - Epoch(train)[16/100][60/100]lr: 5.0000e-04  eta: 1:11:45  time: 30.6095  inter_cls_loss: 0.0868 inner_cls_loss: 22.8823
2023-12-03 21:21:32,082 - INFO - Epoch(train)[16/100][80/100]lr: 5.0000e-04  eta: 1:8:42  time: 39.1673  inter_cls_loss: 0.0650 inner_cls_loss: 22.2295
2023-12-03 21:21:39,795 - INFO - Epoch(train)[16/100][100/100]lr: 5.0000e-04  eta: 1:5:38  time: 46.8810  inter_cls_loss: 0.1449 inner_cls_loss: 22.2652
2023-12-03 21:21:40,630 - INFO - Epoch(test) test/:
2023-12-03 21:21:49,807 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1054
2023-12-03 21:21:49,958 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1566
2023-12-03 21:21:50,113 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0287
2023-12-03 21:21:50,267 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0033
2023-12-03 21:21:50,420 - INFO - Metrics for Dredger: Accuracy: 0.9936, Precision: 0.2967, Recall: 0.3985, F1_score: 0.3402, Average_Precision: 0.2590
2023-12-03 21:21:50,580 - INFO - Metrics for Container: Accuracy: 0.9783, Precision: 0.3185, Recall: 0.4924, F1_score: 0.3868, Average_Precision: 0.2810
2023-12-03 21:21:50,739 - INFO - Metrics for foreground: Accuracy: 0.9779, Precision: 0.6107, Recall: 0.5874, F1_score: 0.5988, Average_Precision: 0.6227
2023-12-03 21:21:50,739 - INFO - Average metrics: Accuracy: 0.9914, Precision: 0.1751, Recall: 0.2112, F1_score: 0.1894, Average_Precision: 0.2081
2023-12-03 21:21:51,883 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:21:51,934 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 c11c3c59d0330ad2f98ddcfec7702a97, with test/ image AP 0.6227
2023-12-03 21:22:04,836 - INFO - Epoch(train)[17/100][20/100]lr: 5.0000e-04  eta: 1:30:5  time: 12.9014  inter_cls_loss: 0.0574 inner_cls_loss: 21.2109
2023-12-03 21:22:13,639 - INFO - Epoch(train)[17/100][40/100]lr: 5.0000e-04  eta: 1:15:36  time: 21.7041  inter_cls_loss: 0.0879 inner_cls_loss: 21.0390
2023-12-03 21:22:22,760 - INFO - Epoch(train)[17/100][60/100]lr: 5.0000e-04  eta: 1:11:24  time: 30.8232  inter_cls_loss: 0.0883 inner_cls_loss: 20.7150
2023-12-03 21:22:32,279 - INFO - Epoch(train)[17/100][80/100]lr: 5.0000e-04  eta: 1:9:55  time: 40.3424  inter_cls_loss: 0.0886 inner_cls_loss: 20.2607
2023-12-03 21:22:41,177 - INFO - Epoch(train)[17/100][100/100]lr: 5.0000e-04  eta: 1:8:7  time: 49.2428  inter_cls_loss: 0.0787 inner_cls_loss: 19.9205
2023-12-03 21:22:42,049 - INFO - Epoch(test) test/:
2023-12-03 21:22:51,291 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0960
2023-12-03 21:22:51,440 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2183
2023-12-03 21:22:51,588 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0705
2023-12-03 21:22:51,738 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0022
2023-12-03 21:22:51,890 - INFO - Metrics for Dredger: Accuracy: 0.9939, Precision: 0.2608, Recall: 0.2675, F1_score: 0.2641, Average_Precision: 0.2203
2023-12-03 21:22:52,049 - INFO - Metrics for Container: Accuracy: 0.9827, Precision: 0.3730, Recall: 0.3543, F1_score: 0.3634, Average_Precision: 0.2820
2023-12-03 21:22:52,204 - INFO - Metrics for foreground: Accuracy: 0.9803, Precision: 0.7404, Recall: 0.4593, F1_score: 0.5670, Average_Precision: 0.6255
2023-12-03 21:22:52,204 - INFO - Average metrics: Accuracy: 0.9924, Precision: 0.1963, Recall: 0.1544, F1_score: 0.1706, Average_Precision: 0.2164
2023-12-03 21:22:53,303 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:22:53,357 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 ad849cc42f0cb268e9bb87021371690c, with test/ image AP 0.6255
2023-12-03 21:23:07,101 - INFO - Epoch(train)[18/100][20/100]lr: 5.0000e-04  eta: 1:34:49  time: 13.7422  inter_cls_loss: 0.0987 inner_cls_loss: 19.5413
2023-12-03 21:23:15,368 - INFO - Epoch(train)[18/100][40/100]lr: 5.0000e-04  eta: 1:15:45  time: 22.0113  inter_cls_loss: 0.0698 inner_cls_loss: 19.1232
2023-12-03 21:23:24,283 - INFO - Epoch(train)[18/100][60/100]lr: 5.0000e-04  eta: 1:10:47  time: 30.9256  inter_cls_loss: 0.0745 inner_cls_loss: 18.7118
2023-12-03 21:23:33,117 - INFO - Epoch(train)[18/100][80/100]lr: 5.0000e-04  eta: 1:8:5  time: 39.7602  inter_cls_loss: 0.1188 inner_cls_loss: 18.4171
2023-12-03 21:23:40,844 - INFO - Epoch(train)[18/100][100/100]lr: 5.0000e-04  eta: 1:4:53  time: 47.4868  inter_cls_loss: 0.1085 inner_cls_loss: 17.9983
2023-12-03 21:23:41,714 - INFO - Epoch(test) test/:
2023-12-03 21:23:50,746 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0986
2023-12-03 21:23:50,891 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1567
2023-12-03 21:23:51,036 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0523
2023-12-03 21:23:51,192 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0020
2023-12-03 21:23:51,348 - INFO - Metrics for Dredger: Accuracy: 0.9943, Precision: 0.2790, Recall: 0.2399, F1_score: 0.2579, Average_Precision: 0.2282
2023-12-03 21:23:51,507 - INFO - Metrics for Container: Accuracy: 0.9844, Precision: 0.3844, Recall: 0.2069, F1_score: 0.2690, Average_Precision: 0.2893
2023-12-03 21:23:51,660 - INFO - Metrics for foreground: Accuracy: 0.9795, Precision: 0.8464, Recall: 0.3321, F1_score: 0.4770, Average_Precision: 0.6468
2023-12-03 21:23:51,661 - INFO - Average metrics: Accuracy: 0.9926, Precision: 0.2157, Recall: 0.1113, F1_score: 0.1434, Average_Precision: 0.2106
2023-12-03 21:23:52,788 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:23:52,840 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 193dd036d76fb36cd2ff504e2fbeda03, with test/ image AP 0.6468
2023-12-03 21:24:06,924 - INFO - Epoch(train)[19/100][20/100]lr: 5.0000e-04  eta: 1:36:0  time: 14.0840  inter_cls_loss: 0.1015 inner_cls_loss: 17.6957
2023-12-03 21:24:16,621 - INFO - Epoch(train)[19/100][40/100]lr: 5.0000e-04  eta: 1:20:51  time: 23.7797  inter_cls_loss: 0.0687 inner_cls_loss: 17.2564
2023-12-03 21:24:26,286 - INFO - Epoch(train)[19/100][60/100]lr: 5.0000e-04  eta: 1:15:37  time: 33.4461  inter_cls_loss: 0.0780 inner_cls_loss: 16.9734
2023-12-03 21:24:35,464 - INFO - Epoch(train)[19/100][80/100]lr: 5.0000e-04  eta: 1:12:6  time: 42.6215  inter_cls_loss: 0.0819 inner_cls_loss: 16.6542
2023-12-03 21:24:44,635 - INFO - Epoch(train)[19/100][100/100]lr: 5.0000e-04  eta: 1:9:55  time: 51.7946  inter_cls_loss: 0.0808 inner_cls_loss: 16.2720
2023-12-03 21:24:45,506 - INFO - Epoch(test) test/:
2023-12-03 21:24:54,494 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1272
2023-12-03 21:24:54,646 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1615
2023-12-03 21:24:54,794 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0273
2023-12-03 21:24:54,944 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0021
2023-12-03 21:24:55,096 - INFO - Metrics for Dredger: Accuracy: 0.9939, Precision: 0.2905, Recall: 0.3376, F1_score: 0.3123, Average_Precision: 0.2375
2023-12-03 21:24:55,256 - INFO - Metrics for Container: Accuracy: 0.9822, Precision: 0.3815, Recall: 0.4492, F1_score: 0.4126, Average_Precision: 0.2874
2023-12-03 21:24:55,414 - INFO - Metrics for foreground: Accuracy: 0.9807, Precision: 0.7076, Recall: 0.5328, F1_score: 0.6079, Average_Precision: 0.6455
2023-12-03 21:24:55,415 - INFO - Average metrics: Accuracy: 0.9924, Precision: 0.1971, Recall: 0.1885, F1_score: 0.1904, Average_Precision: 0.2126
2023-12-03 21:24:56,541 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:25:10,466 - INFO - Epoch(train)[20/100][20/100]lr: 5.0000e-04  eta: 1:33:44  time: 13.9217  inter_cls_loss: 0.0616 inner_cls_loss: 15.8651
2023-12-03 21:25:19,762 - INFO - Epoch(train)[20/100][40/100]lr: 5.0000e-04  eta: 1:17:58  time: 23.2163  inter_cls_loss: 0.1170 inner_cls_loss: 15.8763
2023-12-03 21:25:29,034 - INFO - Epoch(train)[20/100][60/100]lr: 5.0000e-04  eta: 1:12:33  time: 32.4916  inter_cls_loss: 0.0917 inner_cls_loss: 15.4126
2023-12-03 21:25:37,225 - INFO - Epoch(train)[20/100][80/100]lr: 5.0000e-04  eta: 1:7:58  time: 40.6830  inter_cls_loss: 0.0858 inner_cls_loss: 15.0398
2023-12-03 21:25:45,284 - INFO - Epoch(train)[20/100][100/100]lr: 5.0000e-04  eta: 1:4:59  time: 48.7425  inter_cls_loss: 0.1008 inner_cls_loss: 14.9493
2023-12-03 21:25:46,099 - INFO - Epoch(test) test/:
2023-12-03 21:25:54,879 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1022
2023-12-03 21:25:55,029 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2270
2023-12-03 21:25:55,178 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0446
2023-12-03 21:25:55,324 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0024
2023-12-03 21:25:55,474 - INFO - Metrics for Dredger: Accuracy: 0.9942, Precision: 0.2998, Recall: 0.3026, F1_score: 0.3012, Average_Precision: 0.2349
2023-12-03 21:25:55,630 - INFO - Metrics for Container: Accuracy: 0.9801, Precision: 0.3526, Recall: 0.5191, F1_score: 0.4200, Average_Precision: 0.3048
2023-12-03 21:25:55,776 - INFO - Metrics for foreground: Accuracy: 0.9802, Precision: 0.6677, Recall: 0.5852, F1_score: 0.6238, Average_Precision: 0.6476
2023-12-03 21:25:55,776 - INFO - Average metrics: Accuracy: 0.9921, Precision: 0.1886, Recall: 0.2010, F1_score: 0.1921, Average_Precision: 0.2234
2023-12-03 21:25:56,887 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:25:56,938 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 f5defd63e8242a8cbf158beb735d14a0, with test/ image AP 0.6476
2023-12-03 21:26:10,263 - INFO - Epoch(train)[21/100][20/100]lr: 5.0000e-04  eta: 1:28:18  time: 13.2790  inter_cls_loss: 0.0534 inner_cls_loss: 14.2259
2023-12-03 21:26:19,922 - INFO - Epoch(train)[21/100][40/100]lr: 5.0000e-04  eta: 1:16:4  time: 22.9371  inter_cls_loss: 0.0518 inner_cls_loss: 14.0088
2023-12-03 21:26:29,331 - INFO - Epoch(train)[21/100][60/100]lr: 5.0000e-04  eta: 1:11:20  time: 32.3477  inter_cls_loss: 0.1035 inner_cls_loss: 13.9634
2023-12-03 21:26:38,598 - INFO - Epoch(train)[21/100][80/100]lr: 5.0000e-04  eta: 1:8:39  time: 41.6144  inter_cls_loss: 0.0764 inner_cls_loss: 13.6677
2023-12-03 21:26:47,349 - INFO - Epoch(train)[21/100][100/100]lr: 5.0000e-04  eta: 1:6:18  time: 50.3655  inter_cls_loss: 0.0376 inner_cls_loss: 13.0936
2023-12-03 21:26:48,226 - INFO - Epoch(test) test/:
2023-12-03 21:26:57,054 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0948
2023-12-03 21:26:57,203 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1161
2023-12-03 21:26:57,346 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0380
2023-12-03 21:26:57,490 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0029
2023-12-03 21:26:57,641 - INFO - Metrics for Dredger: Accuracy: 0.9935, Precision: 0.3092, Recall: 0.4649, F1_score: 0.3714, Average_Precision: 0.3366
2023-12-03 21:26:57,798 - INFO - Metrics for Container: Accuracy: 0.9768, Precision: 0.3061, Recall: 0.5295, F1_score: 0.3879, Average_Precision: 0.2470
2023-12-03 21:26:57,951 - INFO - Metrics for foreground: Accuracy: 0.9778, Precision: 0.5979, Recall: 0.6436, F1_score: 0.6199, Average_Precision: 0.6556
2023-12-03 21:26:57,951 - INFO - Average metrics: Accuracy: 0.9911, Precision: 0.1733, Recall: 0.2340, F1_score: 0.1970, Average_Precision: 0.2130
2023-12-03 21:26:59,137 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:26:59,187 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 ebdc8ab1a686af37930f0fc898aa4cec, with test/ image AP 0.6556
2023-12-03 21:27:12,502 - INFO - Epoch(train)[22/100][20/100]lr: 5.0000e-04  eta: 1:27:25  time: 13.3143  inter_cls_loss: 0.0380 inner_cls_loss: 12.8420
2023-12-03 21:27:20,887 - INFO - Epoch(train)[22/100][40/100]lr: 5.0000e-04  eta: 1:11:3  time: 21.6992  inter_cls_loss: 0.0686 inner_cls_loss: 12.7596
2023-12-03 21:27:29,784 - INFO - Epoch(train)[22/100][60/100]lr: 5.0000e-04  eta: 1:6:37  time: 30.5961  inter_cls_loss: 0.0918 inner_cls_loss: 12.7173
2023-12-03 21:27:38,658 - INFO - Epoch(train)[22/100][80/100]lr: 5.0000e-04  eta: 1:4:18  time: 39.4708  inter_cls_loss: 0.0582 inner_cls_loss: 12.2242
2023-12-03 21:27:46,605 - INFO - Epoch(train)[22/100][100/100]lr: 5.0000e-04  eta: 1:1:38  time: 47.4175  inter_cls_loss: 0.0886 inner_cls_loss: 12.1895
2023-12-03 21:27:47,448 - INFO - Epoch(test) test/:
2023-12-03 21:27:56,354 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1162
2023-12-03 21:27:56,505 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2113
2023-12-03 21:27:56,650 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0346
2023-12-03 21:27:56,797 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0017
2023-12-03 21:27:56,949 - INFO - Metrics for Dredger: Accuracy: 0.9935, Precision: 0.1624, Recall: 0.1421, F1_score: 0.1516, Average_Precision: 0.1927
2023-12-03 21:27:57,109 - INFO - Metrics for Container: Accuracy: 0.9811, Precision: 0.3618, Recall: 0.4722, F1_score: 0.4097, Average_Precision: 0.2953
2023-12-03 21:27:57,261 - INFO - Metrics for foreground: Accuracy: 0.9818, Precision: 0.7277, Recall: 0.5634, F1_score: 0.6351, Average_Precision: 0.6588
2023-12-03 21:27:57,262 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.1789, Recall: 0.1682, F1_score: 0.1709, Average_Precision: 0.2158
2023-12-03 21:27:58,377 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:27:58,429 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 2812f9c20b597589bac288fa06b697b0, with test/ image AP 0.6588
2023-12-03 21:28:12,375 - INFO - Epoch(train)[23/100][20/100]lr: 5.0000e-04  eta: 1:30:24  time: 13.9455  inter_cls_loss: 0.0649 inner_cls_loss: 11.7425
2023-12-03 21:28:20,918 - INFO - Epoch(train)[23/100][40/100]lr: 5.0000e-04  eta: 1:12:42  time: 22.4858  inter_cls_loss: 0.0463 inner_cls_loss: 11.4245
2023-12-03 21:28:30,827 - INFO - Epoch(train)[23/100][60/100]lr: 5.0000e-04  eta: 1:9:39  time: 32.3974  inter_cls_loss: 0.0861 inner_cls_loss: 11.4100
2023-12-03 21:28:39,843 - INFO - Epoch(train)[23/100][80/100]lr: 5.0000e-04  eta: 1:6:36  time: 41.4132  inter_cls_loss: 0.0611 inner_cls_loss: 11.1038
2023-12-03 21:28:48,923 - INFO - Epoch(train)[23/100][100/100]lr: 5.0000e-04  eta: 1:4:48  time: 50.4937  inter_cls_loss: 0.0835 inner_cls_loss: 10.9290
2023-12-03 21:28:49,778 - INFO - Epoch(test) test/:
2023-12-03 21:28:58,488 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1186
2023-12-03 21:28:58,637 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1853
2023-12-03 21:28:58,785 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0478
2023-12-03 21:28:58,930 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0019
2023-12-03 21:28:59,076 - INFO - Metrics for Dredger: Accuracy: 0.9941, Precision: 0.1842, Recall: 0.1292, F1_score: 0.1518, Average_Precision: 0.2031
2023-12-03 21:28:59,221 - INFO - Metrics for Container: Accuracy: 0.9818, Precision: 0.3677, Recall: 0.4318, F1_score: 0.3972, Average_Precision: 0.3036
2023-12-03 21:28:59,359 - INFO - Metrics for foreground: Accuracy: 0.9823, Precision: 0.7701, Recall: 0.5266, F1_score: 0.6255, Average_Precision: 0.6741
2023-12-03 21:28:59,359 - INFO - Average metrics: Accuracy: 0.9926, Precision: 0.1889, Recall: 0.1554, F1_score: 0.1678, Average_Precision: 0.2192
2023-12-03 21:29:00,453 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:29:00,506 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch.pth with MD5 678e69811abbd00b9d51c5b0548e528f, with test/ image AP 0.6741
2023-12-03 21:29:14,517 - INFO - Epoch(train)[24/100][20/100]lr: 5.0000e-04  eta: 1:29:39  time: 14.0081  inter_cls_loss: 0.0733 inner_cls_loss: 10.7153
2023-12-03 21:29:23,499 - INFO - Epoch(train)[24/100][40/100]lr: 5.0000e-04  eta: 1:13:22  time: 22.9903  inter_cls_loss: 0.0613 inner_cls_loss: 10.4019
2023-12-03 21:29:32,709 - INFO - Epoch(train)[24/100][60/100]lr: 5.0000e-04  eta: 1:8:20  time: 32.2025  inter_cls_loss: 0.0634 inner_cls_loss: 10.2655
2023-12-03 21:29:41,948 - INFO - Epoch(train)[24/100][80/100]lr: 5.0000e-04  eta: 1:5:47  time: 41.4399  inter_cls_loss: 0.1078 inner_cls_loss: 10.1544
2023-12-03 21:29:50,959 - INFO - Epoch(train)[24/100][100/100]lr: 5.0000e-04  eta: 1:3:54  time: 50.4526  inter_cls_loss: 0.1064 inner_cls_loss: 10.0235
2023-12-03 21:29:51,885 - INFO - Epoch(test) test/:
2023-12-03 21:30:01,064 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1362
2023-12-03 21:30:01,211 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1456
2023-12-03 21:30:01,356 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0923
2023-12-03 21:30:01,500 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0020
2023-12-03 21:30:01,648 - INFO - Metrics for Dredger: Accuracy: 0.9945, Precision: 0.2534, Recall: 0.1697, F1_score: 0.2033, Average_Precision: 0.2034
2023-12-03 21:30:01,806 - INFO - Metrics for Container: Accuracy: 0.9789, Precision: 0.3391, Recall: 0.5431, F1_score: 0.4175, Average_Precision: 0.2889
2023-12-03 21:30:01,955 - INFO - Metrics for foreground: Accuracy: 0.9816, Precision: 0.6931, Recall: 0.6174, F1_score: 0.6530, Average_Precision: 0.6598
2023-12-03 21:30:01,955 - INFO - Average metrics: Accuracy: 0.9921, Precision: 0.1837, Recall: 0.1900, F1_score: 0.1820, Average_Precision: 0.2183
2023-12-03 21:30:03,092 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:30:16,475 - INFO - Epoch(train)[25/100][20/100]lr: 5.0000e-04  eta: 1:24:30  time: 13.3784  inter_cls_loss: 0.0644 inner_cls_loss: 9.5320
2023-12-03 21:30:25,191 - INFO - Epoch(train)[25/100][40/100]lr: 5.0000e-04  eta: 1:9:36  time: 22.0983  inter_cls_loss: 0.0675 inner_cls_loss: 9.3845
2023-12-03 21:30:33,552 - INFO - Epoch(train)[25/100][60/100]lr: 5.0000e-04  eta: 1:3:47  time: 30.4598  inter_cls_loss: 0.0485 inner_cls_loss: 9.0829
2023-12-03 21:30:41,967 - INFO - Epoch(train)[25/100][80/100]lr: 5.0000e-04  eta: 1:0:54  time: 38.8725  inter_cls_loss: 0.0508 inner_cls_loss: 8.8558
2023-12-03 21:30:50,129 - INFO - Epoch(train)[25/100][100/100]lr: 5.0000e-04  eta: 0:58:47  time: 47.0366  inter_cls_loss: 0.0572 inner_cls_loss: 8.7579
2023-12-03 21:30:50,997 - INFO - Epoch(test) test/:
2023-12-03 21:31:00,190 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1520
2023-12-03 21:31:00,339 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1640
2023-12-03 21:31:00,485 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3036, Recall: 0.2282, F1_score: 0.2605, Average_Precision: 0.2325
2023-12-03 21:31:00,635 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0023
2023-12-03 21:31:00,785 - INFO - Metrics for Dredger: Accuracy: 0.9923, Precision: 0.2726, Recall: 0.5185, F1_score: 0.3573, Average_Precision: 0.2552
2023-12-03 21:31:00,933 - INFO - Metrics for Container: Accuracy: 0.9818, Precision: 0.3613, Recall: 0.4039, F1_score: 0.3814, Average_Precision: 0.2922
2023-12-03 21:31:01,080 - INFO - Metrics for foreground: Accuracy: 0.9819, Precision: 0.7054, Recall: 0.6082, F1_score: 0.6532, Average_Precision: 0.6595
2023-12-03 21:31:01,081 - INFO - Average metrics: Accuracy: 0.9922, Precision: 0.2347, Recall: 0.2513, F1_score: 0.2361, Average_Precision: 0.2511
2023-12-03 21:31:02,360 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:31:15,636 - INFO - Epoch(train)[26/100][20/100]lr: 5.0000e-04  eta: 1:22:44  time: 13.2738  inter_cls_loss: 0.0384 inner_cls_loss: 8.4296
2023-12-03 21:31:24,229 - INFO - Epoch(train)[26/100][40/100]lr: 5.0000e-04  eta: 1:7:58  time: 21.8669  inter_cls_loss: 0.0608 inner_cls_loss: 8.3499
2023-12-03 21:31:32,853 - INFO - Epoch(train)[26/100][60/100]lr: 5.0000e-04  eta: 1:3:1  time: 30.4923  inter_cls_loss: 0.0594 inner_cls_loss: 8.2506
2023-12-03 21:31:41,030 - INFO - Epoch(train)[26/100][80/100]lr: 5.0000e-04  eta: 0:59:46  time: 38.6677  inter_cls_loss: 0.0405 inner_cls_loss: 7.9605
2023-12-03 21:31:49,313 - INFO - Epoch(train)[26/100][100/100]lr: 5.0000e-04  eta: 0:57:54  time: 46.9524  inter_cls_loss: 0.0572 inner_cls_loss: 7.8888
2023-12-03 21:31:50,160 - INFO - Epoch(test) test/:
2023-12-03 21:31:59,114 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0992
2023-12-03 21:31:59,256 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1706
2023-12-03 21:31:59,401 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.2650, Recall: 0.2081, F1_score: 0.2331, Average_Precision: 0.1200
2023-12-03 21:31:59,545 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0017
2023-12-03 21:31:59,695 - INFO - Metrics for Dredger: Accuracy: 0.9957, Precision: 0.2931, Recall: 0.0314, F1_score: 0.0567, Average_Precision: 0.1933
2023-12-03 21:31:59,851 - INFO - Metrics for Container: Accuracy: 0.9823, Precision: 0.3883, Recall: 0.4678, F1_score: 0.4244, Average_Precision: 0.3112
2023-12-03 21:31:59,992 - INFO - Metrics for foreground: Accuracy: 0.9824, Precision: 0.7893, Recall: 0.5080, F1_score: 0.6181, Average_Precision: 0.6619
2023-12-03 21:31:59,992 - INFO - Average metrics: Accuracy: 0.9928, Precision: 0.2479, Recall: 0.1736, F1_score: 0.1903, Average_Precision: 0.2226
2023-12-03 21:32:01,087 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:32:15,273 - INFO - Epoch(train)[27/100][20/100]lr: 5.0000e-04  eta: 1:27:14  time: 14.1862  inter_cls_loss: 0.0462 inner_cls_loss: 7.6284
2023-12-03 21:32:24,892 - INFO - Epoch(train)[27/100][40/100]lr: 5.0000e-04  eta: 1:12:59  time: 23.8029  inter_cls_loss: 0.0947 inner_cls_loss: 7.7092
2023-12-03 21:32:33,959 - INFO - Epoch(train)[27/100][60/100]lr: 5.0000e-04  eta: 1:7:1  time: 32.8715  inter_cls_loss: 0.0931 inner_cls_loss: 7.5512
2023-12-03 21:32:42,627 - INFO - Epoch(train)[27/100][80/100]lr: 5.0000e-04  eta: 1:3:20  time: 41.5356  inter_cls_loss: 0.0750 inner_cls_loss: 7.2099
2023-12-03 21:32:50,477 - INFO - Epoch(train)[27/100][100/100]lr: 5.0000e-04  eta: 1:0:5  time: 49.3894  inter_cls_loss: 0.0589 inner_cls_loss: 6.9857
2023-12-03 21:32:51,337 - INFO - Epoch(test) test/:
2023-12-03 21:33:00,378 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1413
2023-12-03 21:33:00,524 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1611
2023-12-03 21:33:00,675 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4146, Recall: 0.1141, F1_score: 0.1789, Average_Precision: 0.1576
2023-12-03 21:33:00,824 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0024
2023-12-03 21:33:00,976 - INFO - Metrics for Dredger: Accuracy: 0.9947, Precision: 0.3457, Recall: 0.3266, F1_score: 0.3359, Average_Precision: 0.2247
2023-12-03 21:33:01,132 - INFO - Metrics for Container: Accuracy: 0.9842, Precision: 0.4223, Recall: 0.3695, F1_score: 0.3942, Average_Precision: 0.3238
2023-12-03 21:33:01,282 - INFO - Metrics for foreground: Accuracy: 0.9817, Precision: 0.7987, Recall: 0.4653, F1_score: 0.5880, Average_Precision: 0.6545
2023-12-03 21:33:01,282 - INFO - Average metrics: Accuracy: 0.9929, Precision: 0.2831, Recall: 0.1822, F1_score: 0.2139, Average_Precision: 0.2379
2023-12-03 21:33:02,427 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:33:16,071 - INFO - Epoch(train)[28/100][20/100]lr: 5.0000e-04  eta: 1:22:44  time: 13.6398  inter_cls_loss: 0.0388 inner_cls_loss: 6.8238
2023-12-03 21:33:24,361 - INFO - Epoch(train)[28/100][40/100]lr: 5.0000e-04  eta: 1:6:21  time: 21.9339  inter_cls_loss: 0.0622 inner_cls_loss: 6.8378
2023-12-03 21:33:33,331 - INFO - Epoch(train)[28/100][60/100]lr: 5.0000e-04  eta: 1:2:9  time: 30.9035  inter_cls_loss: 0.0904 inner_cls_loss: 6.7476
2023-12-03 21:33:42,052 - INFO - Epoch(train)[28/100][80/100]lr: 5.0000e-04  eta: 0:59:36  time: 39.6248  inter_cls_loss: 0.0640 inner_cls_loss: 6.4671
2023-12-03 21:33:49,777 - INFO - Epoch(train)[28/100][100/100]lr: 5.0000e-04  eta: 0:56:49  time: 47.3494  inter_cls_loss: 0.0473 inner_cls_loss: 6.2518
2023-12-03 21:33:50,608 - INFO - Epoch(test) test/:
2023-12-03 21:33:59,566 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1156
2023-12-03 21:33:59,713 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1641
2023-12-03 21:33:59,856 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5545, Recall: 0.4094, F1_score: 0.4710, Average_Precision: 0.3475
2023-12-03 21:33:59,999 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0025
2023-12-03 21:34:00,151 - INFO - Metrics for Dredger: Accuracy: 0.9939, Precision: 0.1995, Recall: 0.1587, F1_score: 0.1768, Average_Precision: 0.2568
2023-12-03 21:34:00,306 - INFO - Metrics for Container: Accuracy: 0.9825, Precision: 0.3913, Recall: 0.4694, F1_score: 0.4268, Average_Precision: 0.3226
2023-12-03 21:34:00,456 - INFO - Metrics for foreground: Accuracy: 0.9829, Precision: 0.7652, Recall: 0.5663, F1_score: 0.6509, Average_Precision: 0.6639
2023-12-03 21:34:00,456 - INFO - Average metrics: Accuracy: 0.9928, Precision: 0.2729, Recall: 0.2291, F1_score: 0.2465, Average_Precision: 0.2676
2023-12-03 21:34:01,642 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:34:15,175 - INFO - Epoch(train)[29/100][20/100]lr: 5.0000e-04  eta: 1:20:58  time: 13.5323  inter_cls_loss: 0.0504 inner_cls_loss: 6.0885
2023-12-03 21:34:23,458 - INFO - Epoch(train)[29/100][40/100]lr: 5.0000e-04  eta: 1:5:4  time: 21.8156  inter_cls_loss: 0.0772 inner_cls_loss: 6.1294
2023-12-03 21:34:32,071 - INFO - Epoch(train)[29/100][60/100]lr: 5.0000e-04  eta: 1:0:20  time: 30.4285  inter_cls_loss: 0.0543 inner_cls_loss: 5.9139
2023-12-03 21:34:40,208 - INFO - Epoch(train)[29/100][80/100]lr: 5.0000e-04  eta: 0:57:12  time: 38.5641  inter_cls_loss: 0.0419 inner_cls_loss: 5.7040
2023-12-03 21:34:48,467 - INFO - Epoch(train)[29/100][100/100]lr: 5.0000e-04  eta: 0:55:24  time: 46.8247  inter_cls_loss: 0.0822 inner_cls_loss: 5.7917
2023-12-03 21:34:49,269 - INFO - Epoch(test) test/:
2023-12-03 21:34:58,344 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1354
2023-12-03 21:34:58,487 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1911
2023-12-03 21:34:58,634 - INFO - Metrics for Fishing: Accuracy: 0.9974, Precision: 0.2222, Recall: 0.5235, F1_score: 0.3120, Average_Precision: 0.2406
2023-12-03 21:34:58,782 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0024
2023-12-03 21:34:58,935 - INFO - Metrics for Dredger: Accuracy: 0.9941, Precision: 0.2581, Recall: 0.2362, F1_score: 0.2466, Average_Precision: 0.2187
2023-12-03 21:34:59,087 - INFO - Metrics for Container: Accuracy: 0.9822, Precision: 0.3889, Recall: 0.4940, F1_score: 0.4352, Average_Precision: 0.3360
2023-12-03 21:34:59,233 - INFO - Metrics for foreground: Accuracy: 0.9828, Precision: 0.7253, Recall: 0.6220, F1_score: 0.6697, Average_Precision: 0.6364
2023-12-03 21:34:59,233 - INFO - Average metrics: Accuracy: 0.9925, Precision: 0.2278, Recall: 0.2679, F1_score: 0.2376, Average_Precision: 0.2515
2023-12-03 21:35:03,714 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:35:17,597 - INFO - Epoch(train)[30/100][20/100]lr: 5.0000e-04  eta: 1:21:54  time: 13.8823  inter_cls_loss: 0.0366 inner_cls_loss: 5.3894
2023-12-03 21:35:25,992 - INFO - Epoch(train)[30/100][40/100]lr: 5.0000e-04  eta: 1:5:31  time: 22.2754  inter_cls_loss: 0.0441 inner_cls_loss: 5.3288
2023-12-03 21:35:35,243 - INFO - Epoch(train)[30/100][60/100]lr: 5.0000e-04  eta: 1:1:39  time: 31.5288  inter_cls_loss: 0.0562 inner_cls_loss: 5.2426
2023-12-03 21:35:44,763 - INFO - Epoch(train)[30/100][80/100]lr: 5.0000e-04  eta: 1:0:1  time: 41.0469  inter_cls_loss: 0.0565 inner_cls_loss: 5.1265
2023-12-03 21:35:53,007 - INFO - Epoch(train)[30/100][100/100]lr: 5.0000e-04  eta: 0:57:30  time: 49.2925  inter_cls_loss: 0.0646 inner_cls_loss: 5.1217
2023-12-03 21:35:53,835 - INFO - Epoch(test) test/:
2023-12-03 21:36:02,621 - INFO - Metrics for ore-oil: Accuracy: 0.9922, Precision: 0.2614, Recall: 0.0995, F1_score: 0.1442, Average_Precision: 0.1352
2023-12-03 21:36:02,771 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1654
2023-12-03 21:36:02,919 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4667, Recall: 0.5638, F1_score: 0.5106, Average_Precision: 0.4427
2023-12-03 21:36:03,070 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0016
2023-12-03 21:36:03,225 - INFO - Metrics for Dredger: Accuracy: 0.9945, Precision: 0.2194, Recall: 0.1292, F1_score: 0.1626, Average_Precision: 0.2511
2023-12-03 21:36:03,382 - INFO - Metrics for Container: Accuracy: 0.9821, Precision: 0.3792, Recall: 0.4558, F1_score: 0.4140, Average_Precision: 0.3100
2023-12-03 21:36:03,536 - INFO - Metrics for foreground: Accuracy: 0.9823, Precision: 0.7264, Recall: 0.5947, F1_score: 0.6540, Average_Precision: 0.6567
2023-12-03 21:36:03,536 - INFO - Average metrics: Accuracy: 0.9925, Precision: 0.2933, Recall: 0.2633, F1_score: 0.2693, Average_Precision: 0.2804
2023-12-03 21:36:04,653 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:36:18,771 - INFO - Epoch(train)[31/100][20/100]lr: 5.0000e-04  eta: 1:21:50  time: 14.0702  inter_cls_loss: 0.0351 inner_cls_loss: 4.8127
2023-12-03 21:36:28,170 - INFO - Epoch(train)[31/100][40/100]lr: 5.0000e-04  eta: 1:8:4  time: 23.4716  inter_cls_loss: 0.0408 inner_cls_loss: 4.7658
2023-12-03 21:36:37,539 - INFO - Epoch(train)[31/100][60/100]lr: 5.0000e-04  eta: 1:3:18  time: 32.8397  inter_cls_loss: 0.0662 inner_cls_loss: 4.6872
2023-12-03 21:36:46,736 - INFO - Epoch(train)[31/100][80/100]lr: 5.0000e-04  eta: 1:0:36  time: 42.0358  inter_cls_loss: 0.0532 inner_cls_loss: 4.5890
2023-12-03 21:36:55,663 - INFO - Epoch(train)[31/100][100/100]lr: 5.0000e-04  eta: 0:58:36  time: 50.9640  inter_cls_loss: 0.0352 inner_cls_loss: 4.4230
2023-12-03 21:36:56,502 - INFO - Epoch(test) test/:
2023-12-03 21:37:05,177 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.3648, Recall: 0.0671, F1_score: 0.1134, Average_Precision: 0.2093
2023-12-03 21:37:05,324 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0769, Recall: 0.0034, F1_score: 0.0065, Average_Precision: 0.1595
2023-12-03 21:37:05,477 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4714, Recall: 0.4430, F1_score: 0.4567, Average_Precision: 0.3736
2023-12-03 21:37:05,632 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0014
2023-12-03 21:37:05,790 - INFO - Metrics for Dredger: Accuracy: 0.9950, Precision: 0.3736, Recall: 0.3137, F1_score: 0.3410, Average_Precision: 0.2785
2023-12-03 21:37:05,945 - INFO - Metrics for Container: Accuracy: 0.9838, Precision: 0.4277, Recall: 0.4858, F1_score: 0.4549, Average_Precision: 0.3398
2023-12-03 21:37:06,095 - INFO - Metrics for foreground: Accuracy: 0.9835, Precision: 0.7676, Recall: 0.5907, F1_score: 0.6676, Average_Precision: 0.6732
2023-12-03 21:37:06,095 - INFO - Average metrics: Accuracy: 0.9931, Precision: 0.3546, Recall: 0.2719, F1_score: 0.2914, Average_Precision: 0.2908
2023-12-03 21:37:10,654 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:37:24,529 - INFO - Epoch(train)[32/100][20/100]lr: 5.0000e-04  eta: 1:19:32  time: 13.8722  inter_cls_loss: 0.0489 inner_cls_loss: 4.3251
2023-12-03 21:37:33,125 - INFO - Epoch(train)[32/100][40/100]lr: 5.0000e-04  eta: 1:4:13  time: 22.4699  inter_cls_loss: 0.0682 inner_cls_loss: 4.2695
2023-12-03 21:37:41,149 - INFO - Epoch(train)[32/100][60/100]lr: 5.0000e-04  eta: 0:57:56  time: 30.4929  inter_cls_loss: 0.0420 inner_cls_loss: 4.1327
2023-12-03 21:37:50,110 - INFO - Epoch(train)[32/100][80/100]lr: 5.0000e-04  eta: 0:56:3  time: 39.4551  inter_cls_loss: 0.0208 inner_cls_loss: 3.9862
2023-12-03 21:37:57,991 - INFO - Epoch(train)[32/100][100/100]lr: 5.0000e-04  eta: 0:53:38  time: 47.3366  inter_cls_loss: 0.0303 inner_cls_loss: 3.8960
2023-12-03 21:37:58,836 - INFO - Epoch(test) test/:
2023-12-03 21:38:07,600 - INFO - Metrics for ore-oil: Accuracy: 0.9898, Precision: 0.2558, Recall: 0.2940, F1_score: 0.2736, Average_Precision: 0.1803
2023-12-03 21:38:07,747 - INFO - Metrics for Cell-Container: Accuracy: 0.9970, Precision: 0.2143, Recall: 0.1212, F1_score: 0.1548, Average_Precision: 0.2036
2023-12-03 21:38:07,895 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.4121, Recall: 0.5034, F1_score: 0.4532, Average_Precision: 0.3245
2023-12-03 21:38:08,041 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0022
2023-12-03 21:38:08,197 - INFO - Metrics for Dredger: Accuracy: 0.9951, Precision: 0.3453, Recall: 0.2122, F1_score: 0.2629, Average_Precision: 0.3232
2023-12-03 21:38:08,349 - INFO - Metrics for Container: Accuracy: 0.9837, Precision: 0.4071, Recall: 0.3816, F1_score: 0.3939, Average_Precision: 0.3381
2023-12-03 21:38:08,495 - INFO - Metrics for foreground: Accuracy: 0.9820, Precision: 0.6953, Recall: 0.6374, F1_score: 0.6651, Average_Precision: 0.6359
2023-12-03 21:38:08,495 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.3328, Recall: 0.3071, F1_score: 0.3148, Average_Precision: 0.2868
2023-12-03 21:38:09,644 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:38:23,144 - INFO - Epoch(train)[33/100][20/100]lr: 5.0000e-04  eta: 1:16:16  time: 13.4993  inter_cls_loss: 0.0326 inner_cls_loss: 3.8291
2023-12-03 21:38:32,249 - INFO - Epoch(train)[33/100][40/100]lr: 5.0000e-04  eta: 1:3:39  time: 22.6028  inter_cls_loss: 0.0707 inner_cls_loss: 3.9446
2023-12-03 21:38:42,203 - INFO - Epoch(train)[33/100][60/100]lr: 5.0000e-04  eta: 1:0:57  time: 32.5583  inter_cls_loss: 0.0478 inner_cls_loss: 3.6548
2023-12-03 21:38:51,234 - INFO - Epoch(train)[33/100][80/100]lr: 5.0000e-04  eta: 0:58:13  time: 41.5894  inter_cls_loss: 0.0504 inner_cls_loss: 3.6009
2023-12-03 21:38:59,037 - INFO - Epoch(train)[33/100][100/100]lr: 5.0000e-04  eta: 0:55:9  time: 49.3932  inter_cls_loss: 0.0544 inner_cls_loss: 3.4933
2023-12-03 21:38:59,849 - INFO - Epoch(test) test/:
2023-12-03 21:39:08,798 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.4220, Recall: 0.1377, F1_score: 0.2077, Average_Precision: 0.1437
2023-12-03 21:39:08,942 - INFO - Metrics for Cell-Container: Accuracy: 0.9972, Precision: 0.3375, Recall: 0.2727, F1_score: 0.3017, Average_Precision: 0.2716
2023-12-03 21:39:09,089 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3473, Recall: 0.3893, F1_score: 0.3671, Average_Precision: 0.2522
2023-12-03 21:39:09,235 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0028
2023-12-03 21:39:09,385 - INFO - Metrics for Dredger: Accuracy: 0.9957, Precision: 0.4559, Recall: 0.2768, F1_score: 0.3444, Average_Precision: 0.3657
2023-12-03 21:39:09,539 - INFO - Metrics for Container: Accuracy: 0.9858, Precision: 0.4880, Recall: 0.4214, F1_score: 0.4523, Average_Precision: 0.3599
2023-12-03 21:39:09,679 - INFO - Metrics for foreground: Accuracy: 0.9832, Precision: 0.7858, Recall: 0.5520, F1_score: 0.6485, Average_Precision: 0.6531
2023-12-03 21:39:09,680 - INFO - Average metrics: Accuracy: 0.9933, Precision: 0.4052, Recall: 0.2928, F1_score: 0.3317, Average_Precision: 0.2927
2023-12-03 21:39:10,763 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:39:24,374 - INFO - Epoch(train)[34/100][20/100]lr: 5.0000e-04  eta: 1:15:45  time: 13.6097  inter_cls_loss: 0.0413 inner_cls_loss: 3.5232
2023-12-03 21:39:33,229 - INFO - Epoch(train)[34/100][40/100]lr: 5.0000e-04  eta: 1:2:20  time: 22.4633  inter_cls_loss: 0.0353 inner_cls_loss: 3.2660
2023-12-03 21:39:42,853 - INFO - Epoch(train)[34/100][60/100]lr: 5.0000e-04  eta: 0:59:10  time: 32.0872  inter_cls_loss: 0.0335 inner_cls_loss: 3.2597
2023-12-03 21:39:51,449 - INFO - Epoch(train)[34/100][80/100]lr: 5.0000e-04  eta: 0:56:6  time: 40.6848  inter_cls_loss: 0.0352 inner_cls_loss: 3.1503
2023-12-03 21:39:59,057 - INFO - Epoch(train)[34/100][100/100]lr: 5.0000e-04  eta: 0:53:7  time: 48.2927  inter_cls_loss: 0.0478 inner_cls_loss: 3.0958
2023-12-03 21:39:59,923 - INFO - Epoch(test) test/:
2023-12-03 21:40:08,852 - INFO - Metrics for ore-oil: Accuracy: 0.9936, Precision: 0.6207, Recall: 0.0625, F1_score: 0.1136, Average_Precision: 0.2136
2023-12-03 21:40:08,996 - INFO - Metrics for Cell-Container: Accuracy: 0.9963, Precision: 0.2360, Recall: 0.2828, F1_score: 0.2573, Average_Precision: 0.1960
2023-12-03 21:40:09,141 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.6207, Recall: 0.3624, F1_score: 0.4576, Average_Precision: 0.3683
2023-12-03 21:40:09,285 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0026
2023-12-03 21:40:09,427 - INFO - Metrics for Dredger: Accuracy: 0.9958, Precision: 0.4828, Recall: 0.1292, F1_score: 0.2038, Average_Precision: 0.3281
2023-12-03 21:40:09,572 - INFO - Metrics for Container: Accuracy: 0.9809, Precision: 0.3529, Recall: 0.4498, F1_score: 0.3955, Average_Precision: 0.3331
2023-12-03 21:40:09,714 - INFO - Metrics for foreground: Accuracy: 0.9821, Precision: 0.7236, Recall: 0.5885, F1_score: 0.6491, Average_Precision: 0.6510
2023-12-03 21:40:09,715 - INFO - Average metrics: Accuracy: 0.9925, Precision: 0.4338, Recall: 0.2679, F1_score: 0.2967, Average_Precision: 0.2990
2023-12-03 21:40:10,837 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:40:24,592 - INFO - Epoch(train)[35/100][20/100]lr: 5.0000e-04  eta: 1:15:24  time: 13.7527  inter_cls_loss: 0.0535 inner_cls_loss: 3.0729
2023-12-03 21:40:33,811 - INFO - Epoch(train)[35/100][40/100]lr: 5.0000e-04  eta: 1:2:47  time: 22.9739  inter_cls_loss: 0.0357 inner_cls_loss: 2.9352
2023-12-03 21:40:42,620 - INFO - Epoch(train)[35/100][60/100]lr: 5.0000e-04  eta: 0:57:44  time: 31.7827  inter_cls_loss: 0.0476 inner_cls_loss: 2.9057
2023-12-03 21:40:50,857 - INFO - Epoch(train)[35/100][80/100]lr: 5.0000e-04  eta: 0:54:21  time: 40.0173  inter_cls_loss: 0.0231 inner_cls_loss: 2.7651
2023-12-03 21:40:58,930 - INFO - Epoch(train)[35/100][100/100]lr: 5.0000e-04  eta: 0:52:6  time: 48.0925  inter_cls_loss: 0.0736 inner_cls_loss: 2.8393
2023-12-03 21:40:59,790 - INFO - Epoch(test) test/:
2023-12-03 21:41:08,924 - INFO - Metrics for ore-oil: Accuracy: 0.9935, Precision: 0.5157, Recall: 0.1898, F1_score: 0.2775, Average_Precision: 0.3038
2023-12-03 21:41:09,079 - INFO - Metrics for Cell-Container: Accuracy: 0.9973, Precision: 0.3333, Recall: 0.2020, F1_score: 0.2516, Average_Precision: 0.1929
2023-12-03 21:41:09,227 - INFO - Metrics for Fishing: Accuracy: 0.9991, Precision: 0.6239, Recall: 0.4564, F1_score: 0.5271, Average_Precision: 0.4168
2023-12-03 21:41:09,372 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0017
2023-12-03 21:41:09,520 - INFO - Metrics for Dredger: Accuracy: 0.9965, Precision: 0.6267, Recall: 0.3469, F1_score: 0.4466, Average_Precision: 0.4580
2023-12-03 21:41:09,681 - INFO - Metrics for Container: Accuracy: 0.9848, Precision: 0.4579, Recall: 0.5224, F1_score: 0.4880, Average_Precision: 0.4008
2023-12-03 21:41:09,833 - INFO - Metrics for foreground: Accuracy: 0.9835, Precision: 0.7551, Recall: 0.6115, F1_score: 0.6757, Average_Precision: 0.6466
2023-12-03 21:41:09,833 - INFO - Average metrics: Accuracy: 0.9935, Precision: 0.4732, Recall: 0.3327, F1_score: 0.3809, Average_Precision: 0.3458
2023-12-03 21:41:14,315 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:41:28,457 - INFO - Epoch(train)[36/100][20/100]lr: 5.0000e-04  eta: 1:16:21  time: 14.1417  inter_cls_loss: 0.0341 inner_cls_loss: 2.6359
2023-12-03 21:41:38,358 - INFO - Epoch(train)[36/100][40/100]lr: 5.0000e-04  eta: 1:4:42  time: 24.0406  inter_cls_loss: 0.0332 inner_cls_loss: 2.6235
2023-12-03 21:41:47,660 - INFO - Epoch(train)[36/100][60/100]lr: 5.0000e-04  eta: 0:59:39  time: 33.3448  inter_cls_loss: 0.0337 inner_cls_loss: 2.5194
2023-12-03 21:41:56,506 - INFO - Epoch(train)[36/100][80/100]lr: 5.0000e-04  eta: 0:56:25  time: 42.1912  inter_cls_loss: 0.0382 inner_cls_loss: 2.4401
2023-12-03 21:42:04,984 - INFO - Epoch(train)[36/100][100/100]lr: 5.0000e-04  eta: 0:54:2  time: 50.6691  inter_cls_loss: 0.0195 inner_cls_loss: 2.3515
2023-12-03 21:42:05,787 - INFO - Epoch(test) test/:
2023-12-03 21:42:14,764 - INFO - Metrics for ore-oil: Accuracy: 0.9936, Precision: 0.5281, Recall: 0.1852, F1_score: 0.2742, Average_Precision: 0.2580
2023-12-03 21:42:14,915 - INFO - Metrics for Cell-Container: Accuracy: 0.9973, Precision: 0.4079, Recall: 0.4545, F1_score: 0.4299, Average_Precision: 0.3343
2023-12-03 21:42:15,071 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.6316, Recall: 0.2416, F1_score: 0.3495, Average_Precision: 0.3675
2023-12-03 21:42:15,220 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0017
2023-12-03 21:42:15,368 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6866, Recall: 0.4649, F1_score: 0.5545, Average_Precision: 0.4799
2023-12-03 21:42:15,550 - INFO - Metrics for Container: Accuracy: 0.9856, Precision: 0.4841, Recall: 0.4825, F1_score: 0.4833, Average_Precision: 0.4268
2023-12-03 21:42:15,708 - INFO - Metrics for foreground: Accuracy: 0.9831, Precision: 0.7552, Recall: 0.5885, F1_score: 0.6615, Average_Precision: 0.6547
2023-12-03 21:42:15,708 - INFO - Average metrics: Accuracy: 0.9936, Precision: 0.4991, Recall: 0.3453, F1_score: 0.3933, Average_Precision: 0.3604
2023-12-03 21:42:20,233 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:42:34,071 - INFO - Epoch(train)[37/100][20/100]lr: 5.0000e-04  eta: 1:13:34  time: 13.8378  inter_cls_loss: 0.0460 inner_cls_loss: 2.3778
2023-12-03 21:42:42,990 - INFO - Epoch(train)[37/100][40/100]lr: 5.0000e-04  eta: 1:0:18  time: 22.7549  inter_cls_loss: 0.0245 inner_cls_loss: 2.2376
2023-12-03 21:42:52,023 - INFO - Epoch(train)[37/100][60/100]lr: 5.0000e-04  eta: 0:55:58  time: 31.7874  inter_cls_loss: 0.0278 inner_cls_loss: 2.2208
2023-12-03 21:43:01,038 - INFO - Epoch(train)[37/100][80/100]lr: 5.0000e-04  eta: 0:53:43  time: 40.8044  inter_cls_loss: 0.0187 inner_cls_loss: 2.1101
2023-12-03 21:43:09,598 - INFO - Epoch(train)[37/100][100/100]lr: 5.0000e-04  eta: 0:51:50  time: 49.3652  inter_cls_loss: 0.0457 inner_cls_loss: 2.1430
2023-12-03 21:43:10,447 - INFO - Epoch(test) test/:
2023-12-03 21:43:19,578 - INFO - Metrics for ore-oil: Accuracy: 0.9936, Precision: 0.5275, Recall: 0.1667, F1_score: 0.2533, Average_Precision: 0.2419
2023-12-03 21:43:19,734 - INFO - Metrics for Cell-Container: Accuracy: 0.9971, Precision: 0.3228, Recall: 0.2761, F1_score: 0.2976, Average_Precision: 0.2391
2023-12-03 21:43:19,887 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3810, Recall: 0.5369, F1_score: 0.4457, Average_Precision: 0.4473
2023-12-03 21:43:20,036 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0035
2023-12-03 21:43:20,179 - INFO - Metrics for Dredger: Accuracy: 0.9960, Precision: 0.5248, Recall: 0.3321, F1_score: 0.4068, Average_Precision: 0.4262
2023-12-03 21:43:20,324 - INFO - Metrics for Container: Accuracy: 0.9840, Precision: 0.4411, Recall: 0.5497, F1_score: 0.4894, Average_Precision: 0.4148
2023-12-03 21:43:20,467 - INFO - Metrics for foreground: Accuracy: 0.9824, Precision: 0.7050, Recall: 0.6406, F1_score: 0.6713, Average_Precision: 0.6425
2023-12-03 21:43:20,468 - INFO - Average metrics: Accuracy: 0.9931, Precision: 0.4146, Recall: 0.3574, F1_score: 0.3663, Average_Precision: 0.3451
2023-12-03 21:43:24,929 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:43:38,416 - INFO - Epoch(train)[38/100][20/100]lr: 5.0000e-04  eta: 1:10:33  time: 13.4834  inter_cls_loss: 0.0322 inner_cls_loss: 2.0390
2023-12-03 21:43:46,859 - INFO - Epoch(train)[38/100][40/100]lr: 5.0000e-04  eta: 0:57:11  time: 21.9277  inter_cls_loss: 0.0259 inner_cls_loss: 1.9701
2023-12-03 21:43:55,203 - INFO - Epoch(train)[38/100][60/100]lr: 5.0000e-04  eta: 0:52:28  time: 30.2723  inter_cls_loss: 0.0381 inner_cls_loss: 1.9680
2023-12-03 21:44:04,808 - INFO - Epoch(train)[38/100][80/100]lr: 5.0000e-04  eta: 0:51:40  time: 39.8766  inter_cls_loss: 0.0209 inner_cls_loss: 1.8361
2023-12-03 21:44:12,530 - INFO - Epoch(train)[38/100][100/100]lr: 5.0000e-04  eta: 0:49:11  time: 47.6015  inter_cls_loss: 0.0466 inner_cls_loss: 1.8833
2023-12-03 21:44:13,362 - INFO - Epoch(test) test/:
2023-12-03 21:44:22,256 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.4893, Recall: 0.2118, F1_score: 0.2956, Average_Precision: 0.2782
2023-12-03 21:44:22,406 - INFO - Metrics for Cell-Container: Accuracy: 0.9971, Precision: 0.3211, Recall: 0.2660, F1_score: 0.2910, Average_Precision: 0.2224
2023-12-03 21:44:22,554 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.4969, Recall: 0.5302, F1_score: 0.5130, Average_Precision: 0.4731
2023-12-03 21:44:22,704 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0021
2023-12-03 21:44:22,857 - INFO - Metrics for Dredger: Accuracy: 0.9962, Precision: 0.5917, Recall: 0.2380, F1_score: 0.3395, Average_Precision: 0.4323
2023-12-03 21:44:23,022 - INFO - Metrics for Container: Accuracy: 0.9834, Precision: 0.4252, Recall: 0.5551, F1_score: 0.4815, Average_Precision: 0.4279
2023-12-03 21:44:23,170 - INFO - Metrics for foreground: Accuracy: 0.9822, Precision: 0.7002, Recall: 0.6412, F1_score: 0.6694, Average_Precision: 0.6534
2023-12-03 21:44:23,171 - INFO - Average metrics: Accuracy: 0.9930, Precision: 0.4321, Recall: 0.3489, F1_score: 0.3700, Average_Precision: 0.3556
2023-12-03 21:44:27,631 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:44:41,983 - INFO - Epoch(train)[39/100][20/100]lr: 5.0000e-04  eta: 1:13:54  time: 14.3495  inter_cls_loss: 0.0281 inner_cls_loss: 1.7606
2023-12-03 21:44:51,555 - INFO - Epoch(train)[39/100][40/100]lr: 5.0000e-04  eta: 1:1:23  time: 23.9220  inter_cls_loss: 0.0489 inner_cls_loss: 1.7733
2023-12-03 21:45:00,935 - INFO - Epoch(train)[39/100][60/100]lr: 5.0000e-04  eta: 0:56:48  time: 33.3032  inter_cls_loss: 0.0299 inner_cls_loss: 1.6874
2023-12-03 21:45:09,122 - INFO - Epoch(train)[39/100][80/100]lr: 5.0000e-04  eta: 0:52:53  time: 41.4900  inter_cls_loss: 0.0245 inner_cls_loss: 1.6720
2023-12-03 21:45:17,183 - INFO - Epoch(train)[39/100][100/100]lr: 5.0000e-04  eta: 0:50:22  time: 49.5515  inter_cls_loss: 0.0376 inner_cls_loss: 1.6525
2023-12-03 21:45:17,993 - INFO - Epoch(test) test/:
2023-12-03 21:45:26,835 - INFO - Metrics for ore-oil: Accuracy: 0.9925, Precision: 0.4060, Recall: 0.2998, F1_score: 0.3449, Average_Precision: 0.2933
2023-12-03 21:45:26,986 - INFO - Metrics for Cell-Container: Accuracy: 0.9968, Precision: 0.3420, Recall: 0.4411, F1_score: 0.3853, Average_Precision: 0.2838
2023-12-03 21:45:27,130 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5208, Recall: 0.5034, F1_score: 0.5119, Average_Precision: 0.4735
2023-12-03 21:45:27,268 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0018
2023-12-03 21:45:27,408 - INFO - Metrics for Dredger: Accuracy: 0.9964, Precision: 0.6170, Recall: 0.3210, F1_score: 0.4223, Average_Precision: 0.4703
2023-12-03 21:45:27,554 - INFO - Metrics for Container: Accuracy: 0.9854, Precision: 0.4760, Recall: 0.4934, F1_score: 0.4846, Average_Precision: 0.4255
2023-12-03 21:45:27,693 - INFO - Metrics for foreground: Accuracy: 0.9832, Precision: 0.7218, Recall: 0.6525, F1_score: 0.6854, Average_Precision: 0.6497
2023-12-03 21:45:27,693 - INFO - Average metrics: Accuracy: 0.9933, Precision: 0.4405, Recall: 0.3873, F1_score: 0.4049, Average_Precision: 0.3711
2023-12-03 21:45:32,053 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:45:45,341 - INFO - Epoch(train)[40/100][20/100]lr: 5.0000e-04  eta: 1:7:19  time: 13.2868  inter_cls_loss: 0.0173 inner_cls_loss: 1.5576
2023-12-03 21:45:53,926 - INFO - Epoch(train)[40/100][40/100]lr: 5.0000e-04  eta: 0:55:13  time: 21.8712  inter_cls_loss: 0.0137 inner_cls_loss: 1.5055
2023-12-03 21:46:02,920 - INFO - Epoch(train)[40/100][60/100]lr: 5.0000e-04  eta: 0:51:47  time: 30.8651  inter_cls_loss: 0.0274 inner_cls_loss: 1.4510
2023-12-03 21:46:11,813 - INFO - Epoch(train)[40/100][80/100]lr: 5.0000e-04  eta: 0:49:51  time: 39.7575  inter_cls_loss: 0.0420 inner_cls_loss: 1.4531
2023-12-03 21:46:19,039 - INFO - Epoch(train)[40/100][100/100]lr: 5.0000e-04  eta: 0:46:59  time: 46.9862  inter_cls_loss: 0.0244 inner_cls_loss: 1.3997
2023-12-03 21:46:19,867 - INFO - Epoch(test) test/:
2023-12-03 21:46:28,259 - INFO - Metrics for ore-oil: Accuracy: 0.9937, Precision: 0.5478, Recall: 0.1991, F1_score: 0.2920, Average_Precision: 0.2923
2023-12-03 21:46:28,398 - INFO - Metrics for Cell-Container: Accuracy: 0.9975, Precision: 0.4542, Recall: 0.4512, F1_score: 0.4527, Average_Precision: 0.3197
2023-12-03 21:46:28,538 - INFO - Metrics for Fishing: Accuracy: 0.9978, Precision: 0.2848, Recall: 0.6040, F1_score: 0.3871, Average_Precision: 0.2608
2023-12-03 21:46:28,678 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0014
2023-12-03 21:46:28,817 - INFO - Metrics for Dredger: Accuracy: 0.9966, Precision: 0.6236, Recall: 0.4096, F1_score: 0.4944, Average_Precision: 0.5027
2023-12-03 21:46:28,962 - INFO - Metrics for Container: Accuracy: 0.9851, Precision: 0.4673, Recall: 0.5153, F1_score: 0.4901, Average_Precision: 0.4388
2023-12-03 21:46:29,102 - INFO - Metrics for foreground: Accuracy: 0.9832, Precision: 0.7249, Recall: 0.6466, F1_score: 0.6835, Average_Precision: 0.6638
2023-12-03 21:46:29,102 - INFO - Average metrics: Accuracy: 0.9934, Precision: 0.4432, Recall: 0.4037, F1_score: 0.4000, Average_Precision: 0.3542
2023-12-03 21:46:33,411 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:46:47,048 - INFO - Epoch(train)[41/100][20/100]lr: 2.5000e-04  eta: 1:7:44  time: 13.5937  inter_cls_loss: 0.0228 inner_cls_loss: 1.3501
2023-12-03 21:46:55,664 - INFO - Epoch(train)[41/100][40/100]lr: 2.5000e-04  eta: 0:55:9  time: 22.2087  inter_cls_loss: 0.0339 inner_cls_loss: 1.3727
2023-12-03 21:47:04,684 - INFO - Epoch(train)[41/100][60/100]lr: 2.5000e-04  eta: 0:51:31  time: 31.2277  inter_cls_loss: 0.0187 inner_cls_loss: 1.3691
2023-12-03 21:47:12,472 - INFO - Epoch(train)[41/100][80/100]lr: 2.5000e-04  eta: 0:48:7  time: 39.0156  inter_cls_loss: 0.0196 inner_cls_loss: 1.2934
2023-12-03 21:47:20,183 - INFO - Epoch(train)[41/100][100/100]lr: 2.5000e-04  eta: 0:45:56  time: 46.7286  inter_cls_loss: 0.0258 inner_cls_loss: 1.3252
2023-12-03 21:47:21,065 - INFO - Epoch(test) test/:
2023-12-03 21:47:29,462 - INFO - Metrics for ore-oil: Accuracy: 0.9932, Precision: 0.4677, Recall: 0.2928, F1_score: 0.3601, Average_Precision: 0.3123
2023-12-03 21:47:29,607 - INFO - Metrics for Cell-Container: Accuracy: 0.9971, Precision: 0.3178, Recall: 0.2525, F1_score: 0.2814, Average_Precision: 0.3041
2023-12-03 21:47:29,748 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5669, Recall: 0.5973, F1_score: 0.5817, Average_Precision: 0.5338
2023-12-03 21:47:29,885 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0021
2023-12-03 21:47:30,027 - INFO - Metrics for Dredger: Accuracy: 0.9961, Precision: 0.5475, Recall: 0.3192, F1_score: 0.4033, Average_Precision: 0.4535
2023-12-03 21:47:30,171 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.4990, Recall: 0.5360, F1_score: 0.5168, Average_Precision: 0.4603
2023-12-03 21:47:30,308 - INFO - Metrics for foreground: Accuracy: 0.9838, Precision: 0.7443, Recall: 0.6471, F1_score: 0.6923, Average_Precision: 0.6414
2023-12-03 21:47:30,308 - INFO - Average metrics: Accuracy: 0.9936, Precision: 0.4490, Recall: 0.3779, F1_score: 0.4051, Average_Precision: 0.3868
2023-12-03 21:47:34,658 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:47:47,984 - INFO - Epoch(train)[42/100][20/100]lr: 2.5000e-04  eta: 1:5:16  time: 13.3229  inter_cls_loss: 0.0220 inner_cls_loss: 1.2572
2023-12-03 21:47:57,003 - INFO - Epoch(train)[42/100][40/100]lr: 2.5000e-04  eta: 0:54:33  time: 22.3416  inter_cls_loss: 0.0081 inner_cls_loss: 1.2327
2023-12-03 21:48:05,155 - INFO - Epoch(train)[42/100][60/100]lr: 2.5000e-04  eta: 0:49:27  time: 30.4924  inter_cls_loss: 0.0204 inner_cls_loss: 1.2599
2023-12-03 21:48:13,980 - INFO - Epoch(train)[42/100][80/100]lr: 2.5000e-04  eta: 0:47:40  time: 39.3207  inter_cls_loss: 0.0476 inner_cls_loss: 1.2863
2023-12-03 21:48:21,751 - INFO - Epoch(train)[42/100][100/100]lr: 2.5000e-04  eta: 0:45:31  time: 47.0917  inter_cls_loss: 0.0452 inner_cls_loss: 1.3611
2023-12-03 21:48:22,651 - INFO - Epoch(test) test/:
2023-12-03 21:48:31,614 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.5011, Recall: 0.2616, F1_score: 0.3437, Average_Precision: 0.3117
2023-12-03 21:48:31,753 - INFO - Metrics for Cell-Container: Accuracy: 0.9974, Precision: 0.4281, Recall: 0.4512, F1_score: 0.4393, Average_Precision: 0.3024
2023-12-03 21:48:31,894 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5404, Recall: 0.5839, F1_score: 0.5613, Average_Precision: 0.5060
2023-12-03 21:48:32,032 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0023
2023-12-03 21:48:32,171 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6886, Recall: 0.3469, F1_score: 0.4613, Average_Precision: 0.4546
2023-12-03 21:48:32,315 - INFO - Metrics for Container: Accuracy: 0.9862, Precision: 0.5041, Recall: 0.5415, F1_score: 0.5221, Average_Precision: 0.4791
2023-12-03 21:48:32,452 - INFO - Metrics for foreground: Accuracy: 0.9837, Precision: 0.7448, Recall: 0.6371, F1_score: 0.6868, Average_Precision: 0.6429
2023-12-03 21:48:32,452 - INFO - Average metrics: Accuracy: 0.9937, Precision: 0.4867, Recall: 0.4032, F1_score: 0.4307, Average_Precision: 0.3856
2023-12-03 21:48:36,739 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:48:50,162 - INFO - Epoch(train)[43/100][20/100]lr: 2.5000e-04  eta: 1:4:38  time: 13.4213  inter_cls_loss: 0.0173 inner_cls_loss: 1.1866
2023-12-03 21:48:59,675 - INFO - Epoch(train)[43/100][40/100]lr: 2.5000e-04  eta: 0:55:2  time: 22.9328  inter_cls_loss: 0.0331 inner_cls_loss: 1.1715
2023-12-03 21:49:08,062 - INFO - Epoch(train)[43/100][60/100]lr: 2.5000e-04  eta: 0:49:56  time: 31.3220  inter_cls_loss: 0.0122 inner_cls_loss: 1.1314
2023-12-03 21:49:16,710 - INFO - Epoch(train)[43/100][80/100]lr: 2.5000e-04  eta: 0:47:37  time: 39.9681  inter_cls_loss: 0.0195 inner_cls_loss: 1.1511
2023-12-03 21:49:24,210 - INFO - Epoch(train)[43/100][100/100]lr: 2.5000e-04  eta: 0:45:5  time: 47.4701  inter_cls_loss: 0.0294 inner_cls_loss: 1.1224
2023-12-03 21:49:25,010 - INFO - Epoch(test) test/:
2023-12-03 21:49:33,726 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.4843, Recall: 0.2674, F1_score: 0.3445, Average_Precision: 0.3092
2023-12-03 21:49:33,866 - INFO - Metrics for Cell-Container: Accuracy: 0.9971, Precision: 0.3074, Recall: 0.2391, F1_score: 0.2689, Average_Precision: 0.3051
2023-12-03 21:49:34,003 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4800, Recall: 0.5638, F1_score: 0.5185, Average_Precision: 0.5082
2023-12-03 21:49:34,141 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0035
2023-12-03 21:49:34,281 - INFO - Metrics for Dredger: Accuracy: 0.9965, Precision: 0.6050, Recall: 0.4041, F1_score: 0.4845, Average_Precision: 0.4269
2023-12-03 21:49:34,430 - INFO - Metrics for Container: Accuracy: 0.9845, Precision: 0.4538, Recall: 0.5579, F1_score: 0.5005, Average_Precision: 0.4668
2023-12-03 21:49:34,575 - INFO - Metrics for foreground: Accuracy: 0.9828, Precision: 0.7049, Recall: 0.6660, F1_score: 0.6849, Average_Precision: 0.6260
2023-12-03 21:49:34,576 - INFO - Average metrics: Accuracy: 0.9933, Precision: 0.4336, Recall: 0.3854, F1_score: 0.4003, Average_Precision: 0.3780
2023-12-03 21:49:38,846 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:49:52,074 - INFO - Epoch(train)[44/100][20/100]lr: 2.5000e-04  eta: 1:2:36  time: 13.2277  inter_cls_loss: 0.0124 inner_cls_loss: 1.1060
2023-12-03 21:50:00,585 - INFO - Epoch(train)[44/100][40/100]lr: 2.5000e-04  eta: 0:51:15  time: 21.7375  inter_cls_loss: 0.0294 inner_cls_loss: 1.1273
2023-12-03 21:50:08,652 - INFO - Epoch(train)[44/100][60/100]lr: 2.5000e-04  eta: 0:46:41  time: 29.8037  inter_cls_loss: 0.0160 inner_cls_loss: 1.0556
2023-12-03 21:50:17,100 - INFO - Epoch(train)[44/100][80/100]lr: 2.5000e-04  eta: 0:44:47  time: 38.2509  inter_cls_loss: 0.0298 inner_cls_loss: 1.0476
2023-12-03 21:50:25,090 - INFO - Epoch(train)[44/100][100/100]lr: 2.5000e-04  eta: 0:43:9  time: 46.2432  inter_cls_loss: 0.0128 inner_cls_loss: 1.0634
2023-12-03 21:50:25,942 - INFO - Epoch(test) test/:
2023-12-03 21:50:34,708 - INFO - Metrics for ore-oil: Accuracy: 0.9936, Precision: 0.5176, Recall: 0.3067, F1_score: 0.3852, Average_Precision: 0.3240
2023-12-03 21:50:34,847 - INFO - Metrics for Cell-Container: Accuracy: 0.9975, Precision: 0.4010, Recall: 0.2593, F1_score: 0.3149, Average_Precision: 0.2592
2023-12-03 21:50:34,985 - INFO - Metrics for Fishing: Accuracy: 0.9993, Precision: 0.7778, Recall: 0.5168, F1_score: 0.6210, Average_Precision: 0.5198
2023-12-03 21:50:35,127 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0026
2023-12-03 21:50:35,267 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6598, Recall: 0.4151, F1_score: 0.5096, Average_Precision: 0.4927
2023-12-03 21:50:35,409 - INFO - Metrics for Container: Accuracy: 0.9860, Precision: 0.4955, Recall: 0.5459, F1_score: 0.5195, Average_Precision: 0.4585
2023-12-03 21:50:35,546 - INFO - Metrics for foreground: Accuracy: 0.9836, Precision: 0.7441, Recall: 0.6358, F1_score: 0.6857, Average_Precision: 0.6472
2023-12-03 21:50:35,546 - INFO - Average metrics: Accuracy: 0.9938, Precision: 0.5137, Recall: 0.3828, F1_score: 0.4337, Average_Precision: 0.3863
2023-12-03 21:50:40,052 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:50:52,997 - INFO - Epoch(train)[45/100][20/100]lr: 2.5000e-04  eta: 1:0:11  time: 12.9441  inter_cls_loss: 0.0184 inner_cls_loss: 1.0146
2023-12-03 21:51:02,638 - INFO - Epoch(train)[45/100][40/100]lr: 2.5000e-04  eta: 0:52:19  time: 22.5835  inter_cls_loss: 0.0197 inner_cls_loss: 0.9900
2023-12-03 21:51:12,007 - INFO - Epoch(train)[45/100][60/100]lr: 2.5000e-04  eta: 0:49:10  time: 31.9525  inter_cls_loss: 0.0315 inner_cls_loss: 1.0120
2023-12-03 21:51:20,267 - INFO - Epoch(train)[45/100][80/100]lr: 2.5000e-04  eta: 0:46:14  time: 40.2104  inter_cls_loss: 0.0115 inner_cls_loss: 0.9814
2023-12-03 21:51:27,584 - INFO - Epoch(train)[45/100][100/100]lr: 2.5000e-04  eta: 0:43:34  time: 47.5312  inter_cls_loss: 0.0155 inner_cls_loss: 1.0067
2023-12-03 21:51:28,382 - INFO - Epoch(test) test/:
2023-12-03 21:51:37,083 - INFO - Metrics for ore-oil: Accuracy: 0.9911, Precision: 0.3304, Recall: 0.3426, F1_score: 0.3364, Average_Precision: 0.2684
2023-12-03 21:51:37,223 - INFO - Metrics for Cell-Container: Accuracy: 0.9972, Precision: 0.3274, Recall: 0.2458, F1_score: 0.2808, Average_Precision: 0.2905
2023-12-03 21:51:37,368 - INFO - Metrics for Fishing: Accuracy: 0.9992, Precision: 0.7374, Recall: 0.4899, F1_score: 0.5887, Average_Precision: 0.4715
2023-12-03 21:51:37,518 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0021
2023-12-03 21:51:37,664 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6430, Recall: 0.4686, F1_score: 0.5422, Average_Precision: 0.5231
2023-12-03 21:51:37,810 - INFO - Metrics for Container: Accuracy: 0.9864, Precision: 0.5096, Recall: 0.5229, F1_score: 0.5162, Average_Precision: 0.4751
2023-12-03 21:51:37,949 - INFO - Metrics for foreground: Accuracy: 0.9825, Precision: 0.6994, Recall: 0.6601, F1_score: 0.6792, Average_Precision: 0.6090
2023-12-03 21:51:37,950 - INFO - Average metrics: Accuracy: 0.9933, Precision: 0.4639, Recall: 0.3900, F1_score: 0.4205, Average_Precision: 0.3771
2023-12-03 21:51:42,227 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:51:56,229 - INFO - Epoch(train)[46/100][20/100]lr: 2.5000e-04  eta: 1:3:56  time: 14.0005  inter_cls_loss: 0.0146 inner_cls_loss: 0.9598
2023-12-03 21:52:05,342 - INFO - Epoch(train)[46/100][40/100]lr: 2.5000e-04  eta: 0:52:35  time: 23.1145  inter_cls_loss: 0.0253 inner_cls_loss: 0.9719
2023-12-03 21:52:13,740 - INFO - Epoch(train)[46/100][60/100]lr: 2.5000e-04  eta: 0:47:37  time: 31.5123  inter_cls_loss: 0.0164 inner_cls_loss: 0.9089
2023-12-03 21:52:21,999 - INFO - Epoch(train)[46/100][80/100]lr: 2.5000e-04  eta: 0:44:54  time: 39.7675  inter_cls_loss: 0.0148 inner_cls_loss: 0.8873
2023-12-03 21:52:30,438 - INFO - Epoch(train)[46/100][100/100]lr: 2.5000e-04  eta: 0:43:23  time: 48.2104  inter_cls_loss: 0.0178 inner_cls_loss: 0.8750
2023-12-03 21:52:31,287 - INFO - Epoch(test) test/:
2023-12-03 21:52:39,946 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4444, Recall: 0.3009, F1_score: 0.3589, Average_Precision: 0.3151
2023-12-03 21:52:40,089 - INFO - Metrics for Cell-Container: Accuracy: 0.9974, Precision: 0.3990, Recall: 0.2795, F1_score: 0.3287, Average_Precision: 0.3120
2023-12-03 21:52:40,228 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5414, Recall: 0.5705, F1_score: 0.5556, Average_Precision: 0.5189
2023-12-03 21:52:40,365 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0020
2023-12-03 21:52:40,506 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6667, Recall: 0.3801, F1_score: 0.4841, Average_Precision: 0.5070
2023-12-03 21:52:40,651 - INFO - Metrics for Container: Accuracy: 0.9856, Precision: 0.4841, Recall: 0.5551, F1_score: 0.5172, Average_Precision: 0.4835
2023-12-03 21:52:40,789 - INFO - Metrics for foreground: Accuracy: 0.9832, Precision: 0.7208, Recall: 0.6544, F1_score: 0.6860, Average_Precision: 0.6344
2023-12-03 21:52:40,790 - INFO - Average metrics: Accuracy: 0.9935, Precision: 0.4652, Recall: 0.3915, F1_score: 0.4186, Average_Precision: 0.3961
2023-12-03 21:52:45,096 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:52:57,868 - INFO - Epoch(train)[47/100][20/100]lr: 2.5000e-04  eta: 0:57:14  time: 12.7677  inter_cls_loss: 0.0253 inner_cls_loss: 0.8886
2023-12-03 21:53:06,641 - INFO - Epoch(train)[47/100][40/100]lr: 2.5000e-04  eta: 0:48:6  time: 21.5427  inter_cls_loss: 0.0147 inner_cls_loss: 0.8544
2023-12-03 21:53:15,445 - INFO - Epoch(train)[47/100][60/100]lr: 2.5000e-04  eta: 0:45:0  time: 30.3474  inter_cls_loss: 0.0227 inner_cls_loss: 0.8530
2023-12-03 21:53:24,102 - INFO - Epoch(train)[47/100][80/100]lr: 2.5000e-04  eta: 0:43:13  time: 39.0052  inter_cls_loss: 0.0085 inner_cls_loss: 0.8117
2023-12-03 21:53:32,436 - INFO - Epoch(train)[47/100][100/100]lr: 2.5000e-04  eta: 0:41:48  time: 47.3394  inter_cls_loss: 0.0354 inner_cls_loss: 0.8382
2023-12-03 21:53:33,254 - INFO - Epoch(test) test/:
2023-12-03 21:53:42,035 - INFO - Metrics for ore-oil: Accuracy: 0.9922, Precision: 0.3806, Recall: 0.2951, F1_score: 0.3325, Average_Precision: 0.2953
2023-12-03 21:53:42,175 - INFO - Metrics for Cell-Container: Accuracy: 0.9974, Precision: 0.4125, Recall: 0.3569, F1_score: 0.3827, Average_Precision: 0.3237
2023-12-03 21:53:42,323 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4468, Recall: 0.5638, F1_score: 0.4985, Average_Precision: 0.4888
2023-12-03 21:53:42,468 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0031
2023-12-03 21:53:42,616 - INFO - Metrics for Dredger: Accuracy: 0.9966, Precision: 0.6579, Recall: 0.3690, F1_score: 0.4728, Average_Precision: 0.5016
2023-12-03 21:53:42,767 - INFO - Metrics for Container: Accuracy: 0.9850, Precision: 0.4672, Recall: 0.5595, F1_score: 0.5092, Average_Precision: 0.4658
2023-12-03 21:53:42,907 - INFO - Metrics for foreground: Accuracy: 0.9826, Precision: 0.6955, Recall: 0.6790, F1_score: 0.6872, Average_Precision: 0.6263
2023-12-03 21:53:42,908 - INFO - Average metrics: Accuracy: 0.9932, Precision: 0.4372, Recall: 0.4033, F1_score: 0.4118, Average_Precision: 0.3864
2023-12-03 21:53:47,267 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:54:00,798 - INFO - Epoch(train)[48/100][20/100]lr: 2.5000e-04  eta: 0:59:32  time: 13.5306  inter_cls_loss: 0.0159 inner_cls_loss: 0.7858
2023-12-03 21:54:09,047 - INFO - Epoch(train)[48/100][40/100]lr: 2.5000e-04  eta: 0:47:44  time: 21.7801  inter_cls_loss: 0.0181 inner_cls_loss: 0.7973
2023-12-03 21:54:17,792 - INFO - Epoch(train)[48/100][60/100]lr: 2.5000e-04  eta: 0:44:25  time: 30.5230  inter_cls_loss: 0.0231 inner_cls_loss: 0.7774
2023-12-03 21:54:26,472 - INFO - Epoch(train)[48/100][80/100]lr: 2.5000e-04  eta: 0:42:37  time: 39.2022  inter_cls_loss: 0.0182 inner_cls_loss: 0.7969
2023-12-03 21:54:34,703 - INFO - Epoch(train)[48/100][100/100]lr: 2.5000e-04  eta: 0:41:6  time: 47.4358  inter_cls_loss: 0.0176 inner_cls_loss: 0.7493
2023-12-03 21:54:35,562 - INFO - Epoch(test) test/:
2023-12-03 21:54:44,050 - INFO - Metrics for ore-oil: Accuracy: 0.9920, Precision: 0.3614, Recall: 0.2836, F1_score: 0.3178, Average_Precision: 0.2968
2023-12-03 21:54:44,195 - INFO - Metrics for Cell-Container: Accuracy: 0.9975, Precision: 0.4515, Recall: 0.4074, F1_score: 0.4283, Average_Precision: 0.3304
2023-12-03 21:54:44,335 - INFO - Metrics for Fishing: Accuracy: 0.9991, Precision: 0.7500, Recall: 0.3624, F1_score: 0.4887, Average_Precision: 0.4310
2023-12-03 21:54:44,472 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0019
2023-12-03 21:54:44,611 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.7660, Recall: 0.3985, F1_score: 0.5243, Average_Precision: 0.5239
2023-12-03 21:54:44,754 - INFO - Metrics for Container: Accuracy: 0.9868, Precision: 0.5282, Recall: 0.5109, F1_score: 0.5194, Average_Precision: 0.4739
2023-12-03 21:54:44,893 - INFO - Metrics for foreground: Accuracy: 0.9834, Precision: 0.7474, Recall: 0.6204, F1_score: 0.6780, Average_Precision: 0.6151
2023-12-03 21:54:44,893 - INFO - Average metrics: Accuracy: 0.9937, Precision: 0.5149, Recall: 0.3690, F1_score: 0.4224, Average_Precision: 0.3818
2023-12-03 21:54:45,966 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:54:58,900 - INFO - Epoch(train)[49/100][20/100]lr: 2.5000e-04  eta: 0:55:49  time: 12.9340  inter_cls_loss: 0.0098 inner_cls_loss: 0.7376
2023-12-03 21:55:08,321 - INFO - Epoch(train)[49/100][40/100]lr: 2.5000e-04  eta: 0:48:3  time: 22.3552  inter_cls_loss: 0.0192 inner_cls_loss: 0.7436
2023-12-03 21:55:17,137 - INFO - Epoch(train)[49/100][60/100]lr: 2.5000e-04  eta: 0:44:30  time: 31.1704  inter_cls_loss: 0.0132 inner_cls_loss: 0.6918
2023-12-03 21:55:26,343 - INFO - Epoch(train)[49/100][80/100]lr: 2.5000e-04  eta: 0:43:4  time: 40.3769  inter_cls_loss: 0.0125 inner_cls_loss: 0.6950
2023-12-03 21:55:33,933 - INFO - Epoch(train)[49/100][100/100]lr: 2.5000e-04  eta: 0:40:46  time: 47.9673  inter_cls_loss: 0.0537 inner_cls_loss: 0.7531
2023-12-03 21:55:34,782 - INFO - Epoch(test) test/:
2023-12-03 21:55:43,203 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.4868, Recall: 0.3414, F1_score: 0.4014, Average_Precision: 0.3452
2023-12-03 21:55:43,340 - INFO - Metrics for Cell-Container: Accuracy: 0.9973, Precision: 0.3986, Recall: 0.3704, F1_score: 0.3839, Average_Precision: 0.2845
2023-12-03 21:55:43,476 - INFO - Metrics for Fishing: Accuracy: 0.9991, Precision: 0.6200, Recall: 0.4161, F1_score: 0.4980, Average_Precision: 0.4665
2023-12-03 21:55:43,613 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0032
2023-12-03 21:55:43,750 - INFO - Metrics for Dredger: Accuracy: 0.9968, Precision: 0.6804, Recall: 0.4280, F1_score: 0.5255, Average_Precision: 0.4872
2023-12-03 21:55:43,892 - INFO - Metrics for Container: Accuracy: 0.9869, Precision: 0.5282, Recall: 0.5377, F1_score: 0.5329, Average_Precision: 0.4820
2023-12-03 21:55:44,028 - INFO - Metrics for foreground: Accuracy: 0.9839, Precision: 0.7484, Recall: 0.6447, F1_score: 0.6927, Average_Precision: 0.6433
2023-12-03 21:55:44,029 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.4946, Recall: 0.3912, F1_score: 0.4335, Average_Precision: 0.3874
2023-12-03 21:55:48,292 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:56:01,662 - INFO - Epoch(train)[50/100][20/100]lr: 2.5000e-04  eta: 0:56:34  time: 13.3654  inter_cls_loss: 0.0191 inner_cls_loss: 0.6695
2023-12-03 21:56:10,689 - INFO - Epoch(train)[50/100][40/100]lr: 2.5000e-04  eta: 0:47:13  time: 22.3966  inter_cls_loss: 0.0277 inner_cls_loss: 0.6704
2023-12-03 21:56:18,761 - INFO - Epoch(train)[50/100][60/100]lr: 2.5000e-04  eta: 0:42:39  time: 30.4667  inter_cls_loss: 0.0150 inner_cls_loss: 0.6451
2023-12-03 21:56:26,870 - INFO - Epoch(train)[50/100][80/100]lr: 2.5000e-04  eta: 0:40:20  time: 38.5775  inter_cls_loss: 0.0158 inner_cls_loss: 0.6400
2023-12-03 21:56:35,022 - INFO - Epoch(train)[50/100][100/100]lr: 2.5000e-04  eta: 0:38:56  time: 46.7299  inter_cls_loss: 0.0138 inner_cls_loss: 0.6420
2023-12-03 21:56:35,837 - INFO - Epoch(test) test/:
2023-12-03 21:56:44,871 - INFO - Metrics for ore-oil: Accuracy: 0.9937, Precision: 0.5290, Recall: 0.3380, F1_score: 0.4124, Average_Precision: 0.3277
2023-12-03 21:56:45,012 - INFO - Metrics for Cell-Container: Accuracy: 0.9975, Precision: 0.4463, Recall: 0.4613, F1_score: 0.4536, Average_Precision: 0.3148
2023-12-03 21:56:45,155 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5399, Recall: 0.5906, F1_score: 0.5641, Average_Precision: 0.5060
2023-12-03 21:56:45,295 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0027
2023-12-03 21:56:45,438 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.7641, Recall: 0.4244, F1_score: 0.5457, Average_Precision: 0.5477
2023-12-03 21:56:45,587 - INFO - Metrics for Container: Accuracy: 0.9869, Precision: 0.5309, Recall: 0.5246, F1_score: 0.5277, Average_Precision: 0.4669
2023-12-03 21:56:45,729 - INFO - Metrics for foreground: Accuracy: 0.9838, Precision: 0.7501, Recall: 0.6350, F1_score: 0.6877, Average_Precision: 0.6210
2023-12-03 21:56:45,729 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5086, Recall: 0.4248, F1_score: 0.4559, Average_Precision: 0.3981
2023-12-03 21:56:50,025 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:57:03,839 - INFO - Epoch(train)[51/100][20/100]lr: 2.5000e-04  eta: 0:57:8  time: 13.7691  inter_cls_loss: 0.0104 inner_cls_loss: 0.5997
2023-12-03 21:57:13,075 - INFO - Epoch(train)[51/100][40/100]lr: 2.5000e-04  eta: 0:47:32  time: 23.0036  inter_cls_loss: 0.0126 inner_cls_loss: 0.6052
2023-12-03 21:57:22,432 - INFO - Epoch(train)[51/100][60/100]lr: 2.5000e-04  eta: 0:44:24  time: 32.3600  inter_cls_loss: 0.0255 inner_cls_loss: 0.6479
2023-12-03 21:57:31,708 - INFO - Epoch(train)[51/100][80/100]lr: 2.5000e-04  eta: 0:42:40  time: 41.6360  inter_cls_loss: 0.0436 inner_cls_loss: 0.6162
2023-12-03 21:57:40,555 - INFO - Epoch(train)[51/100][100/100]lr: 2.5000e-04  eta: 0:41:13  time: 50.4847  inter_cls_loss: 0.0144 inner_cls_loss: 0.6042
2023-12-03 21:57:41,378 - INFO - Epoch(test) test/:
2023-12-03 21:57:50,058 - INFO - Metrics for ore-oil: Accuracy: 0.9923, Precision: 0.3984, Recall: 0.3472, F1_score: 0.3711, Average_Precision: 0.3040
2023-12-03 21:57:50,205 - INFO - Metrics for Cell-Container: Accuracy: 0.9974, Precision: 0.4000, Recall: 0.3367, F1_score: 0.3656, Average_Precision: 0.3265
2023-12-03 21:57:50,351 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5066, Recall: 0.5168, F1_score: 0.5116, Average_Precision: 0.4685
2023-12-03 21:57:50,496 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0039
2023-12-03 21:57:50,633 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6796, Recall: 0.3875, F1_score: 0.4935, Average_Precision: 0.5363
2023-12-03 21:57:50,774 - INFO - Metrics for Container: Accuracy: 0.9872, Precision: 0.5391, Recall: 0.5344, F1_score: 0.5367, Average_Precision: 0.5080
2023-12-03 21:57:50,912 - INFO - Metrics for foreground: Accuracy: 0.9834, Precision: 0.7311, Recall: 0.6479, F1_score: 0.6870, Average_Precision: 0.6406
2023-12-03 21:57:50,913 - INFO - Average metrics: Accuracy: 0.9937, Precision: 0.4650, Recall: 0.3958, F1_score: 0.4237, Average_Precision: 0.3983
2023-12-03 21:57:55,126 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:58:08,604 - INFO - Epoch(train)[52/100][20/100]lr: 2.5000e-04  eta: 0:54:48  time: 13.4773  inter_cls_loss: 0.0237 inner_cls_loss: 0.6177
2023-12-03 21:58:17,406 - INFO - Epoch(train)[52/100][40/100]lr: 2.5000e-04  eta: 0:45:6  time: 22.2794  inter_cls_loss: 0.0129 inner_cls_loss: 0.5816
2023-12-03 21:58:25,948 - INFO - Epoch(train)[52/100][60/100]lr: 2.5000e-04  eta: 0:41:26  time: 30.8215  inter_cls_loss: 0.0165 inner_cls_loss: 0.5430
2023-12-03 21:58:33,736 - INFO - Epoch(train)[52/100][80/100]lr: 2.5000e-04  eta: 0:38:46  time: 38.6089  inter_cls_loss: 0.0146 inner_cls_loss: 0.5385
2023-12-03 21:58:41,694 - INFO - Epoch(train)[52/100][100/100]lr: 2.5000e-04  eta: 0:37:15  time: 46.5676  inter_cls_loss: 0.0143 inner_cls_loss: 0.5537
2023-12-03 21:58:42,482 - INFO - Epoch(test) test/:
2023-12-03 21:58:51,034 - INFO - Metrics for ore-oil: Accuracy: 0.9919, Precision: 0.3552, Recall: 0.2882, F1_score: 0.3182, Average_Precision: 0.2704
2023-12-03 21:58:51,174 - INFO - Metrics for Cell-Container: Accuracy: 0.9972, Precision: 0.3333, Recall: 0.2290, F1_score: 0.2715, Average_Precision: 0.2580
2023-12-03 21:58:51,309 - INFO - Metrics for Fishing: Accuracy: 0.9991, Precision: 0.6574, Recall: 0.4765, F1_score: 0.5525, Average_Precision: 0.5118
2023-12-03 21:58:51,448 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0028
2023-12-03 21:58:51,592 - INFO - Metrics for Dredger: Accuracy: 0.9965, Precision: 0.5896, Recall: 0.4797, F1_score: 0.5290, Average_Precision: 0.4676
2023-12-03 21:58:51,742 - INFO - Metrics for Container: Accuracy: 0.9857, Precision: 0.4872, Recall: 0.5590, F1_score: 0.5206, Average_Precision: 0.4711
2023-12-03 21:58:51,886 - INFO - Metrics for foreground: Accuracy: 0.9820, Precision: 0.6870, Recall: 0.6601, F1_score: 0.6733, Average_Precision: 0.5852
2023-12-03 21:58:51,887 - INFO - Average metrics: Accuracy: 0.9932, Precision: 0.4442, Recall: 0.3846, F1_score: 0.4093, Average_Precision: 0.3667
2023-12-03 21:58:56,154 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 21:59:09,054 - INFO - Epoch(train)[53/100][20/100]lr: 2.5000e-04  eta: 0:51:22  time: 12.8979  inter_cls_loss: 0.0160 inner_cls_loss: 0.5111
2023-12-03 21:59:18,368 - INFO - Epoch(train)[53/100][40/100]lr: 2.5000e-04  eta: 0:44:3  time: 22.2132  inter_cls_loss: 0.0125 inner_cls_loss: 0.4879
2023-12-03 21:59:26,583 - INFO - Epoch(train)[53/100][60/100]lr: 2.5000e-04  eta: 0:40:3  time: 30.4268  inter_cls_loss: 0.0303 inner_cls_loss: 0.5169
2023-12-03 21:59:34,883 - INFO - Epoch(train)[53/100][80/100]lr: 2.5000e-04  eta: 0:38:4  time: 38.7284  inter_cls_loss: 0.0094 inner_cls_loss: 0.4991
2023-12-03 21:59:43,009 - INFO - Epoch(train)[53/100][100/100]lr: 2.5000e-04  eta: 0:36:42  time: 46.8539  inter_cls_loss: 0.0108 inner_cls_loss: 0.4498
2023-12-03 21:59:43,790 - INFO - Epoch(test) test/:
2023-12-03 21:59:52,465 - INFO - Metrics for ore-oil: Accuracy: 0.9920, Precision: 0.3654, Recall: 0.3032, F1_score: 0.3314, Average_Precision: 0.2958
2023-12-03 21:59:52,603 - INFO - Metrics for Cell-Container: Accuracy: 0.9974, Precision: 0.4052, Recall: 0.3670, F1_score: 0.3852, Average_Precision: 0.3301
2023-12-03 21:59:52,741 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.7500, Recall: 0.0604, F1_score: 0.1118, Average_Precision: 0.2150
2023-12-03 21:59:52,878 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0051
2023-12-03 21:59:53,024 - INFO - Metrics for Dredger: Accuracy: 0.9964, Precision: 0.6016, Recall: 0.4041, F1_score: 0.4834, Average_Precision: 0.4645
2023-12-03 21:59:53,176 - INFO - Metrics for Container: Accuracy: 0.9850, Precision: 0.4691, Recall: 0.5710, F1_score: 0.5150, Average_Precision: 0.4656
2023-12-03 21:59:53,320 - INFO - Metrics for foreground: Accuracy: 0.9823, Precision: 0.6899, Recall: 0.6695, F1_score: 0.6796, Average_Precision: 0.6040
2023-12-03 21:59:53,320 - INFO - Average metrics: Accuracy: 0.9931, Precision: 0.4687, Recall: 0.3393, F1_score: 0.3581, Average_Precision: 0.3400
2023-12-03 21:59:57,609 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:00:10,615 - INFO - Epoch(train)[54/100][20/100]lr: 2.5000e-04  eta: 0:50:42  time: 13.0027  inter_cls_loss: 0.0170 inner_cls_loss: 0.4522
2023-12-03 22:00:19,132 - INFO - Epoch(train)[54/100][40/100]lr: 2.5000e-04  eta: 0:41:47  time: 21.5222  inter_cls_loss: 0.0078 inner_cls_loss: 0.4478
2023-12-03 22:00:27,997 - INFO - Epoch(train)[54/100][60/100]lr: 2.5000e-04  eta: 0:39:9  time: 30.3869  inter_cls_loss: 0.0130 inner_cls_loss: 0.4394
2023-12-03 22:00:37,131 - INFO - Epoch(train)[54/100][80/100]lr: 2.5000e-04  eta: 0:38:2  time: 39.5214  inter_cls_loss: 0.0123 inner_cls_loss: 0.4436
2023-12-03 22:00:46,204 - INFO - Epoch(train)[54/100][100/100]lr: 2.5000e-04  eta: 0:37:15  time: 48.5947  inter_cls_loss: 0.0200 inner_cls_loss: 0.4495
2023-12-03 22:00:47,041 - INFO - Epoch(test) test/:
2023-12-03 22:00:55,930 - INFO - Metrics for ore-oil: Accuracy: 0.9920, Precision: 0.3681, Recall: 0.3067, F1_score: 0.3346, Average_Precision: 0.2990
2023-12-03 22:00:56,069 - INFO - Metrics for Cell-Container: Accuracy: 0.9971, Precision: 0.3564, Recall: 0.3468, F1_score: 0.3515, Average_Precision: 0.2784
2023-12-03 22:00:56,206 - INFO - Metrics for Fishing: Accuracy: 0.9991, Precision: 0.8696, Recall: 0.2685, F1_score: 0.4103, Average_Precision: 0.4419
2023-12-03 22:00:56,342 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0033
2023-12-03 22:00:56,485 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6647, Recall: 0.4059, F1_score: 0.5040, Average_Precision: 0.4216
2023-12-03 22:00:56,633 - INFO - Metrics for Container: Accuracy: 0.9867, Precision: 0.5213, Recall: 0.5355, F1_score: 0.5283, Average_Precision: 0.5019
2023-12-03 22:00:56,776 - INFO - Metrics for foreground: Accuracy: 0.9833, Precision: 0.7304, Recall: 0.6450, F1_score: 0.6850, Average_Precision: 0.6092
2023-12-03 22:00:56,777 - INFO - Average metrics: Accuracy: 0.9936, Precision: 0.5015, Recall: 0.3583, F1_score: 0.4020, Average_Precision: 0.3650
2023-12-03 22:01:01,080 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:01:13,789 - INFO - Epoch(train)[55/100][20/100]lr: 2.5000e-04  eta: 0:48:29  time: 12.7066  inter_cls_loss: 0.0111 inner_cls_loss: 0.4267
2023-12-03 22:01:22,295 - INFO - Epoch(train)[55/100][40/100]lr: 2.5000e-04  eta: 0:40:18  time: 21.2106  inter_cls_loss: 0.0146 inner_cls_loss: 0.4134
2023-12-03 22:01:30,528 - INFO - Epoch(train)[55/100][60/100]lr: 2.5000e-04  eta: 0:37:8  time: 29.4477  inter_cls_loss: 0.0166 inner_cls_loss: 0.3954
2023-12-03 22:01:39,254 - INFO - Epoch(train)[55/100][80/100]lr: 2.5000e-04  eta: 0:35:56  time: 38.1722  inter_cls_loss: 0.0253 inner_cls_loss: 0.4291
2023-12-03 22:01:47,023 - INFO - Epoch(train)[55/100][100/100]lr: 2.5000e-04  eta: 0:34:27  time: 45.9431  inter_cls_loss: 0.0180 inner_cls_loss: 0.3781
2023-12-03 22:01:47,935 - INFO - Epoch(test) test/:
2023-12-03 22:11:35,928 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-03 22:11:35,928 - INFO - descriptor: SuperPoint+Boost-F-attlay3
2023-12-03 22:11:35,928 - INFO - num_epochs: 100
2023-12-03 22:11:35,928 - INFO - train_ratio: 1.0
2023-12-03 22:11:35,928 - INFO - batch_size: 16
2023-12-03 22:11:35,928 - INFO - num_workers: 4
2023-12-03 22:11:35,928 - INFO - print_interval: 20
2023-12-03 22:11:35,928 - INFO - eval_interval: 1
2023-12-03 22:11:35,928 - INFO - save_interval: 10
2023-12-03 22:11:35,928 - INFO - lr: 0.0005
2023-12-03 22:11:35,928 - INFO - warmup_step: 20
2023-12-03 22:11:35,928 - INFO - random_seed: 0
2023-12-03 22:11:35,928 - INFO - expand_piexl: 5
2023-12-03 22:11:35,928 - INFO - test_threshold: 0.5
2023-12-03 22:11:35,928 - INFO - test_image: 
2023-12-03 22:11:35,929 - INFO - eval: False
2023-12-03 22:11:35,929 - INFO - save_path: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth
2023-12-03 22:11:35,929 - INFO - log_file: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_dataset_repeat_3_positive_keypoint_repeat_1_scratch.log
2023-12-03 22:11:35,929 - INFO - checkpoint: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100__best_model_weights_scratch_50_epoch.pth
2023-12-03 22:11:35,929 - INFO - multiprocessing_context: spawn
2023-12-03 22:11:35,929 - INFO - data_root: data/srsdd
2023-12-03 22:11:35,929 - INFO - img_suffix: .png
2023-12-03 22:11:35,929 - INFO - train_ann_file: ['train/']
2023-12-03 22:11:35,929 - INFO - test_ann_file: ['test/']
2023-12-03 22:11:35,929 - INFO - dataset_class: {'ore-oil': 1, 'Cell-Container': 2, 'Fishing': 3, 'LawEnforce': 4, 'Dredger': 5, 'Container': 6}
2023-12-03 22:11:35,929 - INFO - dataset_repeat: 3
2023-12-03 22:11:35,929 - INFO - positive_keypoint_repeat: 1
2023-12-03 22:11:35,929 - INFO - image_aug: False
2023-12-03 22:11:35,929 - INFO - print: True
2023-12-03 22:11:35,929 - INFO - feature_booster_pretrained: 
2023-12-03 22:11:35,929 - INFO - device: cuda
2023-12-03 22:11:35,929 - INFO - color: ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff00ff', '#990000', '#999900', '#009900', '#009999']
# -*- coding: UTF-8 -*-
import pycolmap # pycolmap 占用的TLS最大,放在最前面 
# 原理参考: https://github.com/pytorch/pytorch/issues/2575#issue-254038499
from extract_features import normalize_keypoints, extractor_build, extract_img_feature
from torch.utils.data import DataLoader, Dataset
from os import path as osp
from pathlib import Path
from torch import nn
import numpy as np
import matplotlib
matplotlib.use('Agg')  # 设置Agg为后端
import matplotlib.pyplot as plt
import importlib
import warnings
import logging
import random
import torch
import time
import glob
import yaml
import cv2
import os
warnings.filterwarnings('ignore')

def parse_arguments():
    parser = importlib.import_module('argparse').ArgumentParser(description="Extract feature and refine descriptor using neural network to find ship keypoint.")

    parser.add_argument(
        '--descriptor', type=str, default='ORB+Boost-B-attlay3',
        help='descriptor to extract' )

    parser.add_argument(
        '--num_epochs', type=int, default=100,)

    parser.add_argument(
        '--train_ratio', type=float, default=1.0,
        help='The ratio of data used for training out of the training set' )

    parser.add_argument(
        '--batch_size', type=int, default=16,)

    parser.add_argument(
        '--num_workers', type=int, default=4,)

    parser.add_argument(
        '--print_interval', type=int, default=20,)

    parser.add_argument(
        '--eval_interval', type=int, default=5,)

    parser.add_argument(
        '--save_interval', type=int, default=10,)

    parser.add_argument(
        '--lr', type=float, default=1e-3,)

    parser.add_argument(
        '--warmup_step', type=int, default=20,)

    parser.add_argument(
        '--random_seed', type=int, default=0,)

    parser.add_argument(
        '--expand_piexl', type=int, default=5,)

    parser.add_argument(
        '--test_threshold', type=float, default=0.5,)

    parser.add_argument(
        '--test_image', type=str, default='',)

    parser.add_argument(
        '--eval', action='store_true',)

    parser.add_argument(
        '--save_path', type=str, default='',)

    parser.add_argument(
        '--log_file', type=str, default='',)

    parser.add_argument(
        '--checkpoint', type=str, default='',)

    parser.add_argument(
        '--multiprocessing_context', type=str, default=None,)

    parser.add_argument(
        '--data_root', type=str, default='data/srsdd',)

    parser.add_argument(
        '--img_suffix', type=str, default='.png',)

    parser.add_argument(
        '--train_ann_file', nargs='*', default=['train/'],)

    parser.add_argument(
        '--test_ann_file', nargs='*', default=['test/'],)

    parser.add_argument(
        '--dataset_class',
        nargs='*',
        default=['ore-oil','Cell-Container','Fishing','LawEnforce','Dredger','Container'], # [166, 89 , 288 , 25 , 263 , 2053]
        help='Dataset classes list. Default is ["ship"].'
    )

    parser.add_argument(
        '--dataset_repeat', type=int, default=3,)
    
    parser.add_argument(
        '--positive_keypoint_repeat', type=int, default=6,)

    parser.add_argument(
        '--image_aug', action='store_true',)
    
    parser.add_argument(
        '--print', action='store_true')

    args = parser.parse_args()
    args.dataset_class = {item: index + 1 for index, item in enumerate(args.dataset_class)}    
    return args

def calculate_md5(file_path):

    hash_md5 = importlib.import_module('hashlib').md5()
    with open(file_path, "rb") as f:
        # 以块的方式读取文件，以防文件太大
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

# 定义舰船目标关键点检测模型（示例）
class ShipKeyPointsModel(nn.Module):
    def __init__(self, args,):
        super().__init__()
        FeatureBooster = importlib.import_module('FeatureBooster.featurebooster').FeatureBooster
        MLP = importlib.import_module('FeatureBooster.featurebooster').MLP

        self.device = args.device

        with open(str(Path(__file__).parent / "config.yaml"), 'r') as f:
            config = yaml.load(f, Loader=yaml.FullLoader)
        self.config = config[args.descriptor]
        # Model
        self.feature_booster = FeatureBooster(self.config)
        # load the model
        if os.path.isfile(args.feature_booster_pretrained):
            self.feature_booster.load_state_dict(torch.load(args.feature_booster_pretrained), strict =False)
            args.logger.info(f"feature_booster weights loaded from {args.feature_booster_pretrained}!")
        self.fc_out = MLP([self.config['output_dim'], self.config['output_dim']//2, len(args.dataset_class)+1])
        self.to(args.device)

    def forward(self, x):
        feat = self.feature_booster(x[...,self.config['keypoint_dim']:], x[...,:self.config['keypoint_dim']])
        x = self.fc_out(feat)
        if self.training:
            return feat, nn.functional.softmax(x, dim=-1)
        else:
            return nn.functional.softmax(x, dim=-1)

def load_txt_info_srsdd(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt','.png').replace('labels','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s[2:]:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]] if len(args.dataset_class) > 1 else 1
            instance['ignore_flag'] = 0
            instance['bbox'] = [float(i) for i in bbox_info[:8]]
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def load_txt_info_hrsid(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt','.png').replace('labelTxt','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]]
            instance['ignore_flag'] = 0
            instance['bbox'] = [float(i) for i in bbox_info[:8]]
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def get_keypoint_label(keypoints, data_info, args):
    bboxes = []
    bbox_label = []
    for instances in data_info['instances']:
        bboxes.append(np.array([(instances['bbox'][i], instances['bbox'][i + 1]) for i in range(0, len(instances['bbox']), 2)], dtype=np.int32))
        bbox_label.append(instances['bbox_label'])

    tmp = np.zeros(data_info['image_shape'], dtype=np.uint8)
    for box, label in zip(bboxes, bbox_label):
        cv2.fillPoly(tmp, np.array([box]), label)
    target = []
    mode = importlib.import_module('scipy.stats').mode
    for kp in keypoints: 
        region = tmp[max(0, int(kp[1] - args.expand_piexl)):min(int(kp[1] + args.expand_piexl), data_info['image_shape'][0]),
                    max(0, int(kp[0] - args.expand_piexl)):min(int(kp[0] +args.expand_piexl), data_info['image_shape'][1])]
        if region[region != 0].size > 0:
            # 计算区域的众数
            mode_val = mode(region, axis=None)[0][0]
            target.append(mode_val)
        else:
            target.append(0)  
    return np.array(target), bboxes

# 定义数据集（示例）
class ShipKeyPointsDataset(Dataset):
    def __init__(self, args, dataset_repeat = 1, pipeline = [], debug = False, **kwargs):
        super(ShipKeyPointsDataset, self).__init__()
        if len(pipeline):
            importlib.import_module('mmdet.utils').register_all_modules(init_default_scope=False)
            importlib.import_module('mmdet.utils').register_all_modules(init_default_scope=False)
        self.transform = importlib.import_module('mmengine.dataset').Compose(pipeline)
        self.debug = debug
        self.args = args
        with open(str(Path(__file__).parent / "config.yaml"), 'r') as f:
            config = yaml.load(f, Loader=yaml.FullLoader)
        self.config = config[args.descriptor]
        self.extractor = extractor_build(self.args.descriptor, device = args.device)
        if 'ann_file' in kwargs and kwargs['ann_file'] !='':
            # train case
            ann_dir = kwargs['ann_file']
            if isinstance(ann_dir, str):
                ann_dir = [ann_dir]
        else:
            ann_dir = []
        self.txt_files = []
        for path in ann_dir:
            self.txt_files.extend(glob.glob(osp.join(args.data_root, path, "**/*.txt"), recursive=True)) 
        if (not args.eval) and (args.train_ratio<1):
            self.txt_files = random.sample(self.txt_files, int(np.ceil(len(self.txt_files)*args.train_ratio)))
        if (not args.eval) and (dataset_repeat > 1):
            self.txt_files = self.txt_files*dataset_repeat
            args.logger.info(f"The dataset located in {ann_dir} was duplicated {dataset_repeat} times!")

    def __len__(self):
        return len(self.txt_files)

    def load_data_info(self, idx):
        txt_file = self.txt_files[idx]
        load_txt_info_func = globals()['load_txt_info_' + self.args.data_root.rstrip('/').split('/')[-1]]
        return load_txt_info_func(txt_file, self.args)

    def __getitem__(self, idx):
        data_info = self.load_data_info(idx)
        bboxes = []
        if (not self.args.eval) and (len(self.transform.transforms)):
            data = self.transform(data_info)
            data_instance = data['data_samples'].gt_instances
            if (len(data_info['instances'])>0) and (len(data_instance.labels)<1):
                image = cv2.cvtColor(cv2.imread(data_info['img_path']), cv2.COLOR_BGR2RGB)
                data_info['image_shape'] = image.shape[:2]
            else:            
                image = data['inputs'].cpu().numpy().transpose(1, 2, 0)
                data_info['image_shape'] = image.shape[:2]
                data_info['instances'] = [] 
                for box_id in range(len(data_instance.labels)):
                    instance = {}
                    instance['bbox_label'] = int(data_instance.labels[box_id])
                    instance['bbox'] = list(data_instance.bboxes.vertices[box_id].reshape(-1).cpu().numpy())
                    data_info['instances'].append(instance)
            del data
        else:
            image = cv2.cvtColor(cv2.imread(data_info['img_path']), cv2.COLOR_BGR2RGB)
            data_info['image_shape'] = image.shape[:2]

        keypoints, descriptors, image = extract_img_feature(self.args.descriptor, image, self.extractor)
        if len(keypoints) <= 0:
            args.logger.info(f"{data_info['img_path']} has no keypoint founded with {self.args.descriptor}")
            return torch.zeros([2, self.config['keypoint_dim'] + self.config['descriptor_dim'] + 2], dtype = torch.float32, requires_grad = False).float(), data_info['img_path']
        else:
            target, bboxes = get_keypoint_label(keypoints, data_info, self.args)
            
            if (not self.args.eval) and (self.args.positive_keypoint_repeat>1) and (np.random.rand() > 0.5): # 将正样本的关键点特征进行重复，增加正样本数目
                keypoints = np.concatenate([keypoints, np.tile(keypoints[target.astype(np.bool_)], (self.args.positive_keypoint_repeat,1))], axis=0)
                descriptors = np.concatenate([descriptors, np.tile(descriptors[target.astype(np.bool_)], (self.args.positive_keypoint_repeat,1))], axis=0)
                target = np.concatenate([target, np.tile(target[target.astype(np.bool_)], self.args.positive_keypoint_repeat)], axis=0)

            # visualization
            if self.debug:
                # args.logger.info(f"VISUALIZATION: {data_info['img_path']}")
                kps = np.array([cv2.KeyPoint(*kp) for kp in keypoints])
                image = cv2.drawKeypoints(image, kps[target.astype(np.bool_)], None, color=(255,0,0,))
                image = cv2.drawKeypoints(image, kps[~(target.astype(np.bool_))], None, color=(0,0,255))
                image = cv2.polylines(image, bboxes, isClosed=True, color=(0, 255, 0), thickness=2)
                cv2.imwrite(f"vis_dir/{data_info['img_id']}.png", cv2.cvtColor(image, cv2.COLOR_RGB2BGR))
                
            # boosted the descriptor using trained model
            keypoints = normalize_keypoints(keypoints, image.shape).astype(np.float32)
            if 'orb' in self.args.descriptor.lower():
                descriptors = np.unpackbits(descriptors, axis=1, bitorder='little').astype(np.float32)
                descriptors = descriptors * 2.0 - 1.0
            # 最后的全一是为了区分对齐batch的padding数据
            result = torch.from_numpy(np.concatenate([keypoints, descriptors, target.reshape(-1, 1), np.ones([len(target),1])], axis=-1))
            if (not self.args.eval) and (np.random.rand() > 0.5):
                result = result[torch.randperm(len(result))]
            result.requires_grad = False
            result = result.float()
            return result, data_info['img_path']

def hex_to_rgb(hex_color):
    hex_color = hex_color.lstrip('#')
    return tuple(int(hex_color[i:i+2], 16) for i in (0, 2, 4))

def get_metric(all_labels, all_output, args):
    accuracy_score = importlib.import_module('sklearn.metrics').accuracy_score
    recall_score = importlib.import_module('sklearn.metrics').recall_score
    precision_score = importlib.import_module('sklearn.metrics').precision_score
    precision_recall_curve = importlib.import_module('sklearn.metrics').precision_recall_curve
    average_precision_score = importlib.import_module('sklearn.metrics').average_precision_score
    f1_score = importlib.import_module('sklearn.metrics').f1_score
    if isinstance(all_output, torch.Tensor):
        if all_output.requires_grad:
            all_output = all_output.detach()
        all_output = all_output.cpu().numpy()
    if isinstance(all_labels, torch.Tensor):
        all_labels = all_labels.cpu().numpy()

    metrics_per_class = {}
    Average_Precision_Curve = {}
    avg_metrics = {}
  
    dataset_class = args.dataset_class.copy()
    if len(args.dataset_class) > 1:
        dataset_class['foreground'] = 0

    all_predict = np.zeros_like(all_output, dtype=bool)
    np.put_along_axis(all_predict, np.argmax(all_output, axis=-1).reshape(-1, 1), True, axis=-1)
     
    for class_name, idx in dataset_class.items():
        # 为当前类别准备标签和预测
        if class_name in 'foreground':
            class_labels = (all_labels != idx).astype(int)
            class_output = ~all_predict[:, 0]
            ap = average_precision_score(class_labels, 1-all_output[:, idx])
            precisions, recalls, _ = precision_recall_curve(class_labels, 1-all_output[:, idx])
        else:
            class_labels = (all_labels == idx).astype(int)
            class_output = all_predict[:, idx]
            ap = average_precision_score(class_labels, all_output[:, idx])
            precisions, recalls, _ = precision_recall_curve(class_labels, all_output[:, idx])
        # 计算指标
        accuracy = accuracy_score(class_labels, class_output)
        precision = precision_score(class_labels, class_output)
        recall = recall_score(class_labels, class_output)
        f1 = f1_score(class_labels, class_output)

        metrics_per_class[class_name] = {
            'Accuracy': accuracy,
            'Precision': precision,
            'Recall': recall,
            'F1_score': f1,
            'Average_Precision': ap,
        }
        Average_Precision_Curve[class_name] = {'Precision': precisions,'Recall': recalls}
        metrics_str = ', '.join(f"{metric}: {value:.4f}" for metric, value in metrics_per_class[class_name].items())
        args.logger.info(f"Metrics for {class_name}: {metrics_str}")

    if len(args.dataset_class)>1:    
        # 计算平均值
        for metric in metrics_per_class[list(args.dataset_class.keys())[0]].keys():
            avg_metrics[metric] = np.mean([class_metrics[metric] for class_metrics in metrics_per_class.values()])
        metrics_str = ', '.join(f"{metric}: {value:.4f}" for metric, value in avg_metrics.items())
        args.logger.info(f"Average metrics: {metrics_str}")
        
        if (not os.path.isfile(args.test_image)):
            for class_name, idx in dataset_class.items():
                plt.plot(Average_Precision_Curve[class_name]['Recall'], 
                        Average_Precision_Curve[class_name]['Precision'], label=class_name, color=args.color[idx % len(args.color)])
            # 设置图例和标签
            plt.xlabel('Recall')
            plt.ylabel('Precision')
            plt.title('Precision-Recall Curve')
            plt.legend()
            if (args.eval): 
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_eval.png'
            else:
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_train.png'
            plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
            plt.close('all') 
            args.logger.info(f"PR_curve has been saved to {PR_curve_path}:")        
        return avg_metrics['Average_Precision'], Average_Precision_Curve['foreground']
    return metrics_per_class[list(args.dataset_class.keys())[0]], Average_Precision_Curve[list(args.dataset_class.keys())[0]] 

def evaluate(model, eva_loader, args):
    model.eval()

    all_output = torch.tensor([], device=args.device)
    all_labels = torch.tensor([], device=args.device)

    with torch.no_grad():
        for i, (data, img_paths) in enumerate(eva_loader):
            data = data.to(args.device)
            outputs = model(data[:,:,:-2])
            valid = data[:,:,-1].reshape(-1).bool()
            all_output = torch.cat([all_output, outputs.view(-1,len(args.dataset_class)+1)[valid,:]], dim=0)
            all_labels = torch.cat([all_labels, data[:,:,-2].long().reshape(-1)[valid]], dim=0)

            if (i + 1) % args.print_interval == 0:
                args.logger.info(f"Epoch(test) : [{i + 1}/{len(eva_loader)}]")

    return get_metric(all_labels, all_output, args)

def test(model, args):
    model.eval()
    extractor = extractor_build(args.descriptor)
    keypoints, descriptors, image = extract_img_feature(args.descriptor, cv2.cvtColor(cv2.imread(args.test_image), cv2.COLOR_BGR2RGB), extractor)

    load_txt_info_func = globals()['load_txt_info_' + args.data_root.rstrip('/').split('/')[-1]]
    txt_file = args.test_image.replace(args.img_suffix,'.txt').replace('images','**')
    txt_file = glob.glob(txt_file, recursive=True)[0]
    data_info = load_txt_info_func(txt_file, args)
    data_info['image_shape'] = image.shape[:2]
    labels, bboxes = get_keypoint_label(keypoints, data_info, args)
    
    kps = np.array([cv2.KeyPoint(*kp) for kp in keypoints])
    # boosted the descriptor using trained model
    keypoints = normalize_keypoints(keypoints, image.shape).astype(np.float32)
    if 'orb' in args.descriptor.lower():
        descriptors = np.unpackbits(descriptors, axis=1, bitorder='little').astype(np.float32)
        descriptors = descriptors * 2.0 - 1.0
    with torch.no_grad():
        output = model(torch.from_numpy(np.concatenate([keypoints, descriptors,], axis=-1)).to(args.device).float()).cpu().numpy()

    metric_dict, PR_dict = get_metric(labels, output, args)
    # predict = (1-output[...,0]) > args.test_threshold
    predict = np.argmax(output, axis=-1)
    for class_name, idx in args.dataset_class.items():
        image = cv2.drawKeypoints(image, kps[predict==idx], None, color=hex_to_rgb(args.color[idx % len(args.color)]),) # 红色 虚警
    # image = cv2.drawKeypoints(image, kps[(~predict)&(labels)], None, color=(0,0,255)) # Aqua蓝色 漏检
    # image = cv2.drawKeypoints(image, kps[predict&labels], None, color=(0,0,255,),) # 黄色 正确预测(正样本)
    # image = cv2.drawKeypoints(image, kps[(~predict)&(~labels)], None, color= (0, 255, 0) ) # 绿色 正确预测(负样本)
    # image = cv2.drawKeypoints(image, kps[(label)], None, color=(255,0,0,))
    # image = cv2.drawKeypoints(image, kps[~predict], None, color=(0,255,0))
    image = cv2.polylines(image, bboxes, isClosed=True, color=(255, 255, 0), thickness=1)
    cv2.imwrite('vis_dir/'+ args.test_image.split('/')[-1], cv2.cvtColor(image, cv2.COLOR_RGB2BGR))
    return metric_dict, PR_dict

def worker_init_fn(worker_id, group, args):
    # torch.cuda.set_device(worker_id) 指定数加载设备
    torch.cuda.manual_seed_all(worker_id)

def custom_collate_fn(batch):
    rnn_utils = importlib.import_module('torch.nn.utils.rnn')
    results = [item[0] for item in batch]  # 提取每个样本的result
    img_paths = [item[1] for item in batch]  # 提取每个样本的img_path
    padded_results = rnn_utils.pad_sequence(results, batch_first=True, padding_value=0)
    return padded_results, img_paths

def train(model, args):
    CosineAnnealingWarmRestarts = importlib.import_module('torch.optim.lr_scheduler').CosineAnnealingWarmRestarts
    LinearLR = importlib.import_module('torch.optim.lr_scheduler').LinearLR
    MultiStepLR = importlib.import_module('torch.optim.lr_scheduler').MultiStepLR
    ChainedScheduler = importlib.import_module('torch.optim.lr_scheduler').ChainedScheduler
    clip_grad_norm_ = importlib.import_module('torch.nn.utils').clip_grad_norm_
    optimizer_class = importlib.import_module('torch.optim').AdamW
    partial = importlib.import_module('functools').partial
    train_pipeline = []
    if args.image_aug:
        train_pipeline = [
            dict(type='mmdet.LoadImageFromFile', backend_args=None),
            dict(type='mmdet.LoadAnnotations', with_bbox=True, box_type='qbox'),
            dict(
                type='mmrotate.ConvertBoxType',
                box_type_mapping=dict(gt_bboxes='rbox')),
            dict(
                type='mmrotate.RandomRotate',
                prob=0.5,
                angle_range=180,
                rotate_type='mmrotate.Rotate'),
            dict(
                type='mmdet.RandomFlip',
                prob=0.75,
                direction=['horizontal', 'vertical', 'diagonal']),
            dict(
                type='mmdet.RandomAffine',),
            dict(
                type='mmdet.PhotoMetricDistortion',),

            dict(
                type='mmrotate.ConvertBoxType',
                box_type_mapping=dict(gt_bboxes='qbox')),
            dict(type='mmdet.PackDetInputs', meta_keys=())]
    train_dataset = ShipKeyPointsDataset(args, ann_file = args.train_ann_file, dataset_repeat = args.dataset_repeat, pipeline = train_pipeline)
    train_loader = DataLoader(train_dataset, batch_size=args.batch_size, shuffle=True, 
                              num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                              # worker_init_fn=partial(worker_init_fn, group='train', args = args),
                              # pin_memory=True, persistent_workers = True,
                              multiprocessing_context=args.multiprocessing_context)
    eva_loader = {}
    for ann_file in args.test_ann_file:
        SimpleNamespace = importlib.import_module('types').SimpleNamespace
        eval_args = vars(args)
        eval_args['eval'] = True
        eval_args = SimpleNamespace(**eval_args)
        eva_dataset = ShipKeyPointsDataset(args = eval_args, ann_file = ann_file)
        eva_loader[ann_file] = DataLoader(eva_dataset, batch_size=args.batch_size, shuffle=False, 
                                num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                                # worker_init_fn=partial(worker_init_fn, group='eval', args = args), 
                                # pin_memory=True, persistent_workers = True,
                                multiprocessing_context=args.multiprocessing_context)
    if args.print:
        outputs = importlib.import_module('mmengine.analysis').get_model_complexity_info(
            model,
            input_shape=None,
            inputs=train_dataset.__getitem__(0)[0][:,:-2].float().to(args.device),  # the input tensor of the model
            show_table=True,  # show the complexity table
            show_arch=False)  # show the complexity arch
        for k, v in outputs.items():
            args.logger.info(f"{k}: {v}")
    # 定义损失函数和优化器
    weight = torch.softmax(1/torch.tensor([100000.0,  166, 89 , 288 , 25 , 263 , 2053], device = args.device),dim=-1) # [100000.0,  166, 89 , 288 , 25 , 263 , 2053]

    CenterLoss = getattr(importlib.import_module("CenterLoss"), "CenterLoss")
    loss_weight = 20
    centerloss = CenterLoss(len(args.dataset_class) + 1, model.config['output_dim']).to(args.device)
    nllloss = nn.NLLLoss().to(args.device)
    param_groups = [
        {'params': model.parameters(), 'lr': args.lr, 'weight_decay': 1e-4},
        {'params': centerloss.parameters(), 'lr': args.lr, 'weight_decay': 1e-4}
    ]
    optimizer = optimizer_class(param_groups) # 
    # warmup_scheduler = LinearLR(optimizer, start_factor=1.0 / 20, end_factor=1.0, total_iters=args.warmup_step)
    # scheduler = CosineAnnealingWarmRestarts(optimizer, T_0=20, T_mult=2, eta_min = 1e-5)
    scheduler = MultiStepLR(optimizer, milestones=[40, 70, 90], gamma=0.5)
    # scheduler = ChainedScheduler([warmup_scheduler, step_scheduler])

    start_epoch = 0
    best_AP = 0.0
    if os.path.isfile(args.checkpoint):
        checkpoint = torch.load(args.checkpoint)
        model.load_state_dict(checkpoint['model_state_dict'])
        optimizer.load_state_dict(checkpoint['optimizer_state_dict']),
        scheduler.load_state_dict(checkpoint['scheduler_state_dict'])
        start_epoch = checkpoint['epoch']+1
        best_AP = checkpoint['best_AP']
        args.logger.info(f'Continue training from epoch [{start_epoch}] !')

    # getGPUs = importlib.import_module('GPUtil').getGPUs
    # virtual_memory = importlib.import_module('psutil').virtual_memory
    # collect = importlib.import_module('gc').collect
    for epoch in range(start_epoch, args.num_epochs):
        start_time = time.time()
        model.train()
        for i, (data, img_paths)  in enumerate(train_loader):
            torch.cuda.empty_cache() # 在显存资源有限的情况下使用
            data = data.to(args.device)
            # collect() # 显式垃圾回收
            # memory = virtual_memory()
            # args.logger.info(f"总内存: {memory.total / (1024 ** 3):.2f} GB, 可用内存: {memory.available / (1024 ** 3):.2f} GB, 内存使用率: {memory.percent}%")
            # gpu = getGPUs()[0]
            # args.logger.info(f">>>before: GPU: {gpu.name}, 显存总量: {gpu.memoryTotal}MB, 显存使用: {gpu.memoryUsed}MB, 显存空闲: {gpu.memoryFree}MB")
            feat, outputs = model(data[:,:,:-2])
            # args.logger.info(f">>>after: GPU: {gpu.name}, 显存总量: {gpu.memoryTotal}MB, 显存使用: {gpu.memoryUsed}MB, 显存空闲: {gpu.memoryFree}MB")
            valid = data[:,:,-1].reshape(-1).bool()
            label_inc = data[:,:,-2].long().view(-1)[valid]
            feat = feat.view(-1,model.config['output_dim'])[valid,:]
            outputs = outputs.view(-1,len(args.dataset_class)+1)[valid,:]
            
            # label = nn.functional.one_hot(label_inc, num_classes= len(args.dataset_class) + 1).float()
            
            # if len(args.dataset_class) > 1: # soft_label
            #     softening_value = 0.1
            #     non_background_mask = (label_inc != 0).unsqueeze(dim=-1).repeat(1,len(args.dataset_class)+1)
            #     non_background_mask[...,0] = False
            #     label[non_background_mask] = label[non_background_mask]  * (1 - softening_value) + \
            #                                     (1 - label[non_background_mask]) * softening_value / (len(args.dataset_class)-1)  
                                                          
            # loss_cls = torch.mean(- 0.75*label * ((1-outputs)**2) *torch.log(outputs) - 0.25*((1-label) *(outputs**2)* torch.log(1-outputs)), dim = 0)
            # inter_cls_loss = torch.sum(loss_cls*weight)
            inter_cls_loss = nllloss(torch.log(outputs), label_inc)
            inner_cls_loss = centerloss(feat, label_inc)
            loss = loss_weight * inter_cls_loss + inner_cls_loss
            
            optimizer.zero_grad()
            loss.backward()
            clip_grad_norm_(model.parameters(), 35, 2)
            clip_grad_norm_(centerloss.parameters(), 35, 2)
            optimizer.step()
            del outputs, data, valid
            if (i + 1) % args.print_interval == 0:
                current_time = time.time()
                eta_seconds = (current_time - start_time) / (i+1) * ( (args.num_epochs - epoch ) * len(train_loader) - (i + 1))
                eta_str = str(int(eta_seconds // 3600)) + ':' + str(int((eta_seconds % 3600) // 60)) + ':' + str(int(eta_seconds % 60))
                # loss_str = ' '.join([f"{cls_name}:{loss_value:.4f}" for cls_name,loss_value in zip(['background'] + list(args.dataset_class.keys()), loss_cls)])
                args.logger.info(f"Epoch(train)"
                      f"[{epoch + 1}/{args.num_epochs}][{i + 1}/{len(train_loader)}]"
                      f"lr: {optimizer.param_groups[0]['lr']:.4e}  eta: {eta_str}  " 
                      f"time: {current_time - start_time:.4f}  inter_cls_loss: {inter_cls_loss:.4f} inner_cls_loss: {inner_cls_loss.item():.4f}")
        scheduler.step()
        if ((epoch+1) % args.eval_interval == 0) or (epoch == 0) or (epoch == args.num_epochs-1): # 
            for ann_file in args.test_ann_file: 
                args.logger.info(f"Epoch(test) {ann_file}:")
                metric_dict_all, PR_dict_all = evaluate(model, eva_loader[ann_file], args)

            # 检查是否有更好的模型，如果有，则保存权重
            if metric_dict_all['Average_Precision'] > best_AP:
                best_AP = metric_dict_all['Average_Precision']
                # 保存当前模型的权重
                torch.save(model.state_dict(), args.save_path)
                args.logger.info(f"Best model saved to  {args.save_path} with MD5 {calculate_md5(args.save_path)}, with {args.test_ann_file[-1]} image AP {best_AP:.4f}")
            if (epoch >= args.num_epochs-1):
                last_save_path = 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + '_last_model_weight.pth'
                torch.save(model.state_dict(), last_save_path)
                args.logger.info(f"Last model saved :{last_save_path}")

        if ((epoch+1) % args.save_interval == 0):
            for file_path in glob.glob(args.save_path[:-4] + '*_epoch.pth'):
                os.remove(file_path)
            torch.save({
                'model_state_dict': model.state_dict(),
                'optimizer_state_dict': optimizer.state_dict(),
                'scheduler_state_dict': scheduler.state_dict(),
                'epoch': epoch,
                'best_AP': best_AP,
                }, args.save_path[:-4] + f'_{epoch+1}_epoch.pth')

if __name__ == '__main__':
    args = parse_arguments()

    random.seed(args.random_seed)
    np.random.seed(args.random_seed)
    torch.manual_seed(args.random_seed)
    if torch.cuda.is_available():
        torch.cuda.manual_seed_all(args.random_seed)

    if ('alike' in args.descriptor.lower()) or ('superpoint' in args.descriptor.lower()) or ('hardnet' in args.descriptor.lower()) or ('sosnet' in args.descriptor.lower()):
        args.multiprocessing_context = 'spawn'

    args.feature_booster_pretrained = '' # Path(__file__).parent / str("FeatureBooster/models/" + args.descriptor + ".pth")
    pretrained_str = 'finetune' if os.path.isfile(args.feature_booster_pretrained) else 'scratch'
    args.save_path = args.save_path if len(args.save_path) else 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}_' + f'best_model_weights_{pretrained_str}.pth'
    args.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    args.color = ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff00ff', '#990000', '#999900', '#009900', '#009999'] 
    model = ShipKeyPointsModel(args)
    
    # 创建日志器
    logger = logging.getLogger()
    logger.setLevel(logging.INFO)
    # 创建控制台处理程序
    console_handler = logging.StreamHandler()
    console_handler.setLevel(logging.INFO)
    console_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))    
    logger.addHandler(console_handler)
    args.logger = logger
    if (not args.eval) and (not os.path.isfile(args.test_image)): # train
        args.log_file = args.log_file if len(args.log_file) else 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + f'_dataset_repeat_{args.dataset_repeat}_positive_keypoint_repeat_{args.positive_keypoint_repeat}_{pretrained_str}.log'
        if not os.path.exists(os.path.dirname(args.log_file)):
            os.makedirs(os.path.dirname(args.log_file))
        # 创建文件处理程序
        file_handler = logging.FileHandler(args.log_file, mode='a')
        file_handler.setLevel(logging.INFO)
        file_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))
        # 添加处理程序到日志器
        logger.addHandler(file_handler)
        logger.info(">>>>>=========================Start Train!===========================<<<<<")
        for k, v in vars(args).items():
            if k not in 'logger':
                logger.info(f"{k}: {v}")

        if args.print: 
            with open(__file__, 'r') as file:
                lines = file.readlines()
            with open(args.log_file, "a") as file:   
                for line in lines:
                    file.write(line[:-1]+'\n')
                file.write('\n')
        train(model, args)
        args.logger.info(f"model weights saved to {args.save_path} with MD5 {calculate_md5(args.save_path)}!")
        args.checkpoint = args.save_path
        args.eval = True

    model_weights_md5 = "init_md5"
    if os.path.isfile(args.checkpoint):
        if 'cpu' in args.device.type:
            model.load_state_dict(torch.load(args.checkpoint, map_location=lambda storage, loc:storage), strict=False)
        else:
            model.load_state_dict(torch.load(args.checkpoint), strict=False)
        model_weights_md5 = calculate_md5(args.checkpoint)
        args.logger.info(f"model weights loaded from {args.checkpoint} with MD5 {model_weights_md5}!")
        model_weights_md5 = model_weights_md5[:5]

    if os.path.isfile(args.test_image):
        args.logger.info(f"Epoch(test) - {args.test_image}:")
        metric_dict, PR_dict = test(model, args)
    if args.eval:
        for ann_file in args.test_ann_file:
            args.logger.info(f"Epoch(test) {ann_file}:")
            eva_dataset = ShipKeyPointsDataset(args = args, ann_file = ann_file)
            eva_loader = DataLoader(eva_dataset, batch_size=args.batch_size, shuffle=False, 
                                    num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                                    pin_memory=True, persistent_workers = True, multiprocessing_context=args.multiprocessing_context)
            metric_dict, PR_dict_all = evaluate(model, eva_loader, args)
            if PR_dict_all is not None:
                plt.plot(PR_dict_all['Recall'], PR_dict_all['Precision'])
                # 设置图例和标签
                plt.xlabel('Recall')
                plt.ylabel('Precision')
                plt.title('Precision-Recall Curve')
                plt.legend()
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_eval_{model_weights_md5}.png'
                plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
                plt.close('all') 
                args.logger.info(f"PR_curve has been saved to {PR_curve_path}!"

2023-12-03 22:11:36,219 - INFO - The dataset located in ['train/'] was duplicated 3 times!
2023-12-03 22:11:37,171 - INFO - flops: 236366368
2023-12-03 22:11:37,171 - INFO - flops_str: 0.236G
2023-12-03 22:11:37,171 - INFO - activations: 865249
2023-12-03 22:11:37,171 - INFO - activations_str: 0.865M
2023-12-03 22:11:37,171 - INFO - params: 1988167
2023-12-03 22:11:37,171 - INFO - params_str: 1.988M
2023-12-03 22:11:37,171 - INFO - out_table: 
+---------------------------+----------------------+------------+--------------+
| module                    | #parameters or shape | #flops     | #activations |
+---------------------------+----------------------+------------+--------------+
| model                     | 1.988M               | 0.236G     | 0.865M       |
|  feature_booster          |  1.954M              |  0.232G    |  0.849M      |
|   feature_booster.kenc.e… |   0.109M             |   12.928M  |   87.584K    |
|    feature_booster.kenc.… |    0.128K            |    11.424K |    3.808K    |
|    feature_booster.kenc.… |    2.112K            |    0.244M  |    7.616K    |
|    feature_booster.kenc.… |    8.32K             |    0.975M  |    15.232K   |
|    feature_booster.kenc.… |    33.024K           |    3.899M  |    30.464K   |
|    feature_booster.kenc.… |    65.792K           |    7.799M  |    30.464K   |
|   feature_booster.denc.e… |   0.197M             |   23.396M  |   91.392K    |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|   feature_booster.attn_p… |   1.581M             |   0.188G   |   0.64M      |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|   feature_booster.final_… |   65.792K            |   7.799M   |   30.464K    |
|    feature_booster.final… |    (256, 256)        |            |              |
|    feature_booster.final… |    (256,)            |            |              |
|   feature_booster.layer_… |   0.512K             |   0.152M   |   0          |
|    feature_booster.layer… |    (256,)            |            |              |
|    feature_booster.layer… |    (256,)            |            |              |
|  fc_out                   |  33.799K             |  4.006M    |  16.065K     |
|   fc_out.0                |   32.896K            |   3.899M   |   15.232K    |
|    fc_out.0.weight        |    (128, 256)        |            |              |
|    fc_out.0.bias          |    (128,)            |            |              |
|   fc_out.2                |   0.903K             |   0.107M   |   0.833K     |
|    fc_out.2.weight        |    (7, 128)          |            |              |
|    fc_out.2.bias          |    (7,)              |            |              |
+---------------------------+----------------------+------------+--------------+

2023-12-03 22:11:37,171 - INFO - out_arch: 
2023-12-03 22:11:37,231 - INFO - Continue training from epoch [50] !
2023-12-03 22:11:53,594 - INFO - Epoch(train)[51/100][20/100]lr: 2.5000e-04  eta: 1:7:54  time: 16.3622  inter_cls_loss: 0.0168 inner_cls_loss: 92.2035
2023-12-03 22:12:03,077 - INFO - Epoch(train)[51/100][40/100]lr: 2.5000e-04  eta: 0:53:24  time: 25.8413  inter_cls_loss: 0.0255 inner_cls_loss: 88.7335
2023-12-03 22:12:11,188 - INFO - Epoch(train)[51/100][60/100]lr: 2.5000e-04  eta: 0:46:35  time: 33.9519  inter_cls_loss: 0.0177 inner_cls_loss: 85.3467
2023-12-03 22:12:19,584 - INFO - Epoch(train)[51/100][80/100]lr: 2.5000e-04  eta: 0:43:24  time: 42.3515  inter_cls_loss: 0.0192 inner_cls_loss: 82.8946
2023-12-03 22:12:27,375 - INFO - Epoch(train)[51/100][100/100]lr: 2.5000e-04  eta: 0:40:57  time: 50.1429  inter_cls_loss: 0.0344 inner_cls_loss: 81.0699
2023-12-03 22:12:28,368 - INFO - Epoch(test) test/:
2023-12-03 22:12:37,635 - INFO - Metrics for ore-oil: Accuracy: 0.9935, Precision: 0.5080, Recall: 0.2928, F1_score: 0.3715, Average_Precision: 0.3302
2023-12-03 22:12:37,782 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.4918, Recall: 0.3030, F1_score: 0.3750, Average_Precision: 0.3019
2023-12-03 22:12:37,929 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4573, Recall: 0.6107, F1_score: 0.5230, Average_Precision: 0.4364
2023-12-03 22:12:38,077 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0034
2023-12-03 22:12:38,227 - INFO - Metrics for Dredger: Accuracy: 0.9964, Precision: 0.5957, Recall: 0.4133, F1_score: 0.4880, Average_Precision: 0.4109
2023-12-03 22:12:38,377 - INFO - Metrics for Container: Accuracy: 0.9862, Precision: 0.5023, Recall: 0.5355, F1_score: 0.5184, Average_Precision: 0.4757
2023-12-03 22:12:38,545 - INFO - Metrics for foreground: Accuracy: 0.9832, Precision: 0.7317, Recall: 0.6344, F1_score: 0.6796, Average_Precision: 0.6093
2023-12-03 22:12:38,545 - INFO - Average metrics: Accuracy: 0.9937, Precision: 0.4696, Recall: 0.3985, F1_score: 0.4222, Average_Precision: 0.3668
2023-12-03 22:12:41,443 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:16:14,088 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-03 22:16:14,088 - INFO - descriptor: SuperPoint+Boost-F-attlay3
2023-12-03 22:16:14,088 - INFO - num_epochs: 100
2023-12-03 22:16:14,088 - INFO - train_ratio: 1.0
2023-12-03 22:16:14,088 - INFO - batch_size: 16
2023-12-03 22:16:14,088 - INFO - num_workers: 4
2023-12-03 22:16:14,088 - INFO - print_interval: 40
2023-12-03 22:16:14,088 - INFO - eval_interval: 1
2023-12-03 22:16:14,088 - INFO - save_interval: 10
2023-12-03 22:16:14,089 - INFO - lr: 0.0006
2023-12-03 22:16:14,089 - INFO - warmup_step: 20
2023-12-03 22:16:14,089 - INFO - random_seed: 0
2023-12-03 22:16:14,089 - INFO - expand_piexl: 5
2023-12-03 22:16:14,089 - INFO - test_threshold: 0.5
2023-12-03 22:16:14,089 - INFO - test_image: 
2023-12-03 22:16:14,089 - INFO - eval: False
2023-12-03 22:16:14,089 - INFO - save_path: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth
2023-12-03 22:16:14,089 - INFO - log_file: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_dataset_repeat_3_positive_keypoint_repeat_1_scratch.log
2023-12-03 22:16:14,089 - INFO - checkpoint: 
2023-12-03 22:16:14,089 - INFO - multiprocessing_context: spawn
2023-12-03 22:16:14,089 - INFO - data_root: data/srsdd
2023-12-03 22:16:14,089 - INFO - img_suffix: .png
2023-12-03 22:16:14,089 - INFO - train_ann_file: ['train/']
2023-12-03 22:16:14,089 - INFO - test_ann_file: ['test/']
2023-12-03 22:16:14,089 - INFO - dataset_class: {'ore-oil': 1, 'Cell-Container': 2, 'Fishing': 3, 'LawEnforce': 4, 'Dredger': 5, 'Container': 6}
2023-12-03 22:16:14,089 - INFO - dataset_repeat: 3
2023-12-03 22:16:14,089 - INFO - positive_keypoint_repeat: 1
2023-12-03 22:16:14,089 - INFO - image_aug: False
2023-12-03 22:16:14,089 - INFO - print: False
2023-12-03 22:16:14,089 - INFO - feature_booster_pretrained: 
2023-12-03 22:16:14,089 - INFO - device: cuda
2023-12-03 22:16:14,089 - INFO - color: ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff00ff', '#990000', '#999900', '#009900', '#009999']
2023-12-03 22:16:14,336 - INFO - The dataset located in ['train/'] was duplicated 3 times!
2023-12-03 22:16:35,946 - INFO - Epoch(train)[1/100][40/100]lr: 6.0000e-04  eta: 1:29:5  time: 21.4691  inter_cls_loss: 0.6608 inner_cls_loss: 92.5098
2023-12-03 22:16:53,906 - INFO - Epoch(train)[1/100][80/100]lr: 6.0000e-04  eta: 1:21:29  time: 39.4299  inter_cls_loss: 0.1553 inner_cls_loss: 87.3736
2023-12-03 22:17:03,762 - INFO - Epoch(test) test/:
2023-12-03 22:17:12,941 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0385
2023-12-03 22:17:13,081 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0943
2023-12-03 22:17:13,215 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0049
2023-12-03 22:17:13,349 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 22:17:13,487 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0562
2023-12-03 22:17:13,625 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0439
2023-12-03 22:17:13,763 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1628
2023-12-03 22:17:13,763 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0572
2023-12-03 22:17:14,379 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:20:29,937 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-03 22:20:29,938 - INFO - descriptor: SuperPoint+Boost-F-attlay3
2023-12-03 22:20:29,938 - INFO - num_epochs: 100
2023-12-03 22:20:29,938 - INFO - train_ratio: 1.0
2023-12-03 22:20:29,938 - INFO - batch_size: 16
2023-12-03 22:20:29,938 - INFO - num_workers: 4
2023-12-03 22:20:29,938 - INFO - print_interval: 40
2023-12-03 22:20:29,938 - INFO - eval_interval: 1
2023-12-03 22:20:29,938 - INFO - save_interval: 10
2023-12-03 22:20:29,938 - INFO - lr: 0.0006
2023-12-03 22:20:29,938 - INFO - warmup_step: 20
2023-12-03 22:20:29,938 - INFO - random_seed: 0
2023-12-03 22:20:29,938 - INFO - expand_piexl: 5
2023-12-03 22:20:29,938 - INFO - test_threshold: 0.5
2023-12-03 22:20:29,938 - INFO - test_image: 
2023-12-03 22:20:29,938 - INFO - eval: False
2023-12-03 22:20:29,938 - INFO - save_path: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth
2023-12-03 22:20:29,938 - INFO - log_file: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_dataset_repeat_3_positive_keypoint_repeat_1_scratch.log
2023-12-03 22:20:29,938 - INFO - checkpoint: 
2023-12-03 22:20:29,938 - INFO - multiprocessing_context: spawn
2023-12-03 22:20:29,938 - INFO - data_root: data/srsdd
2023-12-03 22:20:29,939 - INFO - img_suffix: .png
2023-12-03 22:20:29,939 - INFO - train_ann_file: ['train/']
2023-12-03 22:20:29,939 - INFO - test_ann_file: ['test/']
2023-12-03 22:20:29,939 - INFO - dataset_class: {'ore-oil': 1, 'Cell-Container': 2, 'Fishing': 3, 'LawEnforce': 4, 'Dredger': 5, 'Container': 6}
2023-12-03 22:20:29,939 - INFO - dataset_repeat: 3
2023-12-03 22:20:29,939 - INFO - positive_keypoint_repeat: 1
2023-12-03 22:20:29,939 - INFO - image_aug: True
2023-12-03 22:20:29,939 - INFO - print: True
2023-12-03 22:20:29,939 - INFO - feature_booster_pretrained: 
2023-12-03 22:20:29,939 - INFO - device: cuda
2023-12-03 22:20:29,939 - INFO - color: ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff00ff', '#990000', '#999900', '#009900', '#009999']
# -*- coding: UTF-8 -*-
import pycolmap # pycolmap 占用的TLS最大,放在最前面 
# 原理参考: https://github.com/pytorch/pytorch/issues/2575#issue-254038499
from extract_features import normalize_keypoints, extractor_build, extract_img_feature
from torch.utils.data import DataLoader, Dataset
from os import path as osp
from pathlib import Path
from torch import nn
import numpy as np
import matplotlib
matplotlib.use('Agg')  # 设置Agg为后端
import matplotlib.pyplot as plt
import importlib
import warnings
import logging
import random
import torch
import time
import glob
import yaml
import cv2
import os
warnings.filterwarnings('ignore')

def parse_arguments():
    parser = importlib.import_module('argparse').ArgumentParser(description="Extract feature and refine descriptor using neural network to find ship keypoint.")

    parser.add_argument(
        '--descriptor', type=str, default='ORB+Boost-B-attlay3',
        help='descriptor to extract' )

    parser.add_argument(
        '--num_epochs', type=int, default=100,)

    parser.add_argument(
        '--train_ratio', type=float, default=1.0,
        help='The ratio of data used for training out of the training set' )

    parser.add_argument(
        '--batch_size', type=int, default=16,)

    parser.add_argument(
        '--num_workers', type=int, default=4,)

    parser.add_argument(
        '--print_interval', type=int, default=20,)

    parser.add_argument(
        '--eval_interval', type=int, default=5,)

    parser.add_argument(
        '--save_interval', type=int, default=10,)

    parser.add_argument(
        '--lr', type=float, default=1e-3,)

    parser.add_argument(
        '--warmup_step', type=int, default=20,)

    parser.add_argument(
        '--random_seed', type=int, default=0,)

    parser.add_argument(
        '--expand_piexl', type=int, default=5,)

    parser.add_argument(
        '--test_threshold', type=float, default=0.5,)

    parser.add_argument(
        '--test_image', type=str, default='',)

    parser.add_argument(
        '--eval', action='store_true',)

    parser.add_argument(
        '--save_path', type=str, default='',)

    parser.add_argument(
        '--log_file', type=str, default='',)

    parser.add_argument(
        '--checkpoint', type=str, default='',)

    parser.add_argument(
        '--multiprocessing_context', type=str, default=None,)

    parser.add_argument(
        '--data_root', type=str, default='data/srsdd',)

    parser.add_argument(
        '--img_suffix', type=str, default='.png',)

    parser.add_argument(
        '--train_ann_file', nargs='*', default=['train/'],)

    parser.add_argument(
        '--test_ann_file', nargs='*', default=['test/'],)

    parser.add_argument(
        '--dataset_class',
        nargs='*',
        default=['ore-oil','Cell-Container','Fishing','LawEnforce','Dredger','Container'], # [166, 89 , 288 , 25 , 263 , 2053]
        help='Dataset classes list. Default is ["ship"].'
    )

    parser.add_argument(
        '--dataset_repeat', type=int, default=3,)
    
    parser.add_argument(
        '--positive_keypoint_repeat', type=int, default=6,)

    parser.add_argument(
        '--image_aug', action='store_true',)
    
    parser.add_argument(
        '--print', action='store_true')

    args = parser.parse_args()
    args.dataset_class = {item: index + 1 for index, item in enumerate(args.dataset_class)}    
    return args

def calculate_md5(file_path):

    hash_md5 = importlib.import_module('hashlib').md5()
    with open(file_path, "rb") as f:
        # 以块的方式读取文件，以防文件太大
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

# 定义舰船目标关键点检测模型（示例）
class ShipKeyPointsModel(nn.Module):
    def __init__(self, args,):
        super().__init__()
        FeatureBooster = importlib.import_module('FeatureBooster.featurebooster').FeatureBooster
        MLP = importlib.import_module('FeatureBooster.featurebooster').MLP

        self.device = args.device

        with open(str(Path(__file__).parent / "config.yaml"), 'r') as f:
            config = yaml.load(f, Loader=yaml.FullLoader)
        self.config = config[args.descriptor]
        # Model
        self.feature_booster = FeatureBooster(self.config)
        # load the model
        if os.path.isfile(args.feature_booster_pretrained):
            self.feature_booster.load_state_dict(torch.load(args.feature_booster_pretrained), strict =False)
            args.logger.info(f"feature_booster weights loaded from {args.feature_booster_pretrained}!")
        self.fc_out = MLP([self.config['output_dim'], self.config['output_dim']//2, len(args.dataset_class)+1])
        self.to(args.device)

    def forward(self, x):
        feat = self.feature_booster(x[...,self.config['keypoint_dim']:], x[...,:self.config['keypoint_dim']])
        x = self.fc_out(feat)
        if self.training:
            return feat, nn.functional.softmax(x, dim=-1)
        else:
            return nn.functional.softmax(x, dim=-1)

def load_txt_info_srsdd(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt','.png').replace('labels','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s[2:]:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]] if len(args.dataset_class) > 1 else 1
            instance['ignore_flag'] = 0
            instance['bbox'] = [float(i) for i in bbox_info[:8]]
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def load_txt_info_hrsid(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt','.png').replace('labelTxt','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]]
            instance['ignore_flag'] = 0
            instance['bbox'] = [float(i) for i in bbox_info[:8]]
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def get_keypoint_label(keypoints, data_info, args):
    bboxes = []
    bbox_label = []
    for instances in data_info['instances']:
        bboxes.append(np.array([(instances['bbox'][i], instances['bbox'][i + 1]) for i in range(0, len(instances['bbox']), 2)], dtype=np.int32))
        bbox_label.append(instances['bbox_label'])

    tmp = np.zeros(data_info['image_shape'], dtype=np.uint8)
    for box, label in zip(bboxes, bbox_label):
        cv2.fillPoly(tmp, np.array([box]), label)
    target = []
    mode = importlib.import_module('scipy.stats').mode
    for kp in keypoints: 
        region = tmp[max(0, int(kp[1] - args.expand_piexl)):min(int(kp[1] + args.expand_piexl), data_info['image_shape'][0]),
                    max(0, int(kp[0] - args.expand_piexl)):min(int(kp[0] +args.expand_piexl), data_info['image_shape'][1])]
        if region[region != 0].size > 0:
            # 计算区域的众数
            mode_val = mode(region, axis=None)[0][0]
            target.append(mode_val)
        else:
            target.append(0)  
    return np.array(target), bboxes

# 定义数据集（示例）
class ShipKeyPointsDataset(Dataset):
    def __init__(self, args, dataset_repeat = 1, pipeline = [], debug = False, **kwargs):
        super(ShipKeyPointsDataset, self).__init__()
        if len(pipeline):
            importlib.import_module('mmdet.utils').register_all_modules(init_default_scope=False)
            importlib.import_module('mmdet.utils').register_all_modules(init_default_scope=False)
        self.transform = importlib.import_module('mmengine.dataset').Compose(pipeline)
        self.debug = debug
        self.args = args
        with open(str(Path(__file__).parent / "config.yaml"), 'r') as f:
            config = yaml.load(f, Loader=yaml.FullLoader)
        self.config = config[args.descriptor]
        self.extractor = extractor_build(self.args.descriptor, device = args.device)
        if 'ann_file' in kwargs and kwargs['ann_file'] !='':
            # train case
            ann_dir = kwargs['ann_file']
            if isinstance(ann_dir, str):
                ann_dir = [ann_dir]
        else:
            ann_dir = []
        self.txt_files = []
        for path in ann_dir:
            self.txt_files.extend(glob.glob(osp.join(args.data_root, path, "**/*.txt"), recursive=True)) 
        if (not args.eval) and (args.train_ratio<1):
            self.txt_files = random.sample(self.txt_files, int(np.ceil(len(self.txt_files)*args.train_ratio)))
        if (not args.eval) and (dataset_repeat > 1):
            self.txt_files = self.txt_files*dataset_repeat
            args.logger.info(f"The dataset located in {ann_dir} was duplicated {dataset_repeat} times!")

    def __len__(self):
        return len(self.txt_files)

    def load_data_info(self, idx):
        txt_file = self.txt_files[idx]
        load_txt_info_func = globals()['load_txt_info_' + self.args.data_root.rstrip('/').split('/')[-1]]
        return load_txt_info_func(txt_file, self.args)

    def __getitem__(self, idx):
        data_info = self.load_data_info(idx)
        bboxes = []
        if (not self.args.eval) and (len(self.transform.transforms)):
            data = self.transform(data_info)
            data_instance = data['data_samples'].gt_instances
            if (len(data_info['instances'])>0) and (len(data_instance.labels)<1):
                image = cv2.cvtColor(cv2.imread(data_info['img_path']), cv2.COLOR_BGR2RGB)
                data_info['image_shape'] = image.shape[:2]
            else:            
                image = data['inputs'].cpu().numpy().transpose(1, 2, 0)
                data_info['image_shape'] = image.shape[:2]
                data_info['instances'] = [] 
                for box_id in range(len(data_instance.labels)):
                    instance = {}
                    instance['bbox_label'] = int(data_instance.labels[box_id])
                    instance['bbox'] = list(data_instance.bboxes.vertices[box_id].reshape(-1).cpu().numpy())
                    data_info['instances'].append(instance)
            del data
        else:
            image = cv2.cvtColor(cv2.imread(data_info['img_path']), cv2.COLOR_BGR2RGB)
            data_info['image_shape'] = image.shape[:2]

        keypoints, descriptors, image = extract_img_feature(self.args.descriptor, image, self.extractor)
        if len(keypoints) <= 0:
            args.logger.info(f"{data_info['img_path']} has no keypoint founded with {self.args.descriptor}")
            return torch.zeros([2, self.config['keypoint_dim'] + self.config['descriptor_dim'] + 2], dtype = torch.float32, requires_grad = False).float(), data_info['img_path']
        else:
            target, bboxes = get_keypoint_label(keypoints, data_info, self.args)
            
            if (not self.args.eval) and (self.args.positive_keypoint_repeat>1) and (np.random.rand() > 0.5): # 将正样本的关键点特征进行重复，增加正样本数目
                keypoints = np.concatenate([keypoints, np.tile(keypoints[target.astype(np.bool_)], (self.args.positive_keypoint_repeat,1))], axis=0)
                descriptors = np.concatenate([descriptors, np.tile(descriptors[target.astype(np.bool_)], (self.args.positive_keypoint_repeat,1))], axis=0)
                target = np.concatenate([target, np.tile(target[target.astype(np.bool_)], self.args.positive_keypoint_repeat)], axis=0)

            # visualization
            if self.debug:
                # args.logger.info(f"VISUALIZATION: {data_info['img_path']}")
                kps = np.array([cv2.KeyPoint(*kp) for kp in keypoints])
                image = cv2.drawKeypoints(image, kps[target.astype(np.bool_)], None, color=(255,0,0,))
                image = cv2.drawKeypoints(image, kps[~(target.astype(np.bool_))], None, color=(0,0,255))
                image = cv2.polylines(image, bboxes, isClosed=True, color=(0, 255, 0), thickness=2)
                cv2.imwrite(f"vis_dir/{data_info['img_id']}.png", cv2.cvtColor(image, cv2.COLOR_RGB2BGR))
                
            # boosted the descriptor using trained model
            keypoints = normalize_keypoints(keypoints, image.shape).astype(np.float32)
            if 'orb' in self.args.descriptor.lower():
                descriptors = np.unpackbits(descriptors, axis=1, bitorder='little').astype(np.float32)
                descriptors = descriptors * 2.0 - 1.0
            # 最后的全一是为了区分对齐batch的padding数据
            result = torch.from_numpy(np.concatenate([keypoints, descriptors, target.reshape(-1, 1), np.ones([len(target),1])], axis=-1))
            if (not self.args.eval) and (np.random.rand() > 0.5):
                result = result[torch.randperm(len(result))]
            result.requires_grad = False
            result = result.float()
            return result, data_info['img_path']

def hex_to_rgb(hex_color):
    hex_color = hex_color.lstrip('#')
    return tuple(int(hex_color[i:i+2], 16) for i in (0, 2, 4))

def get_metric(all_labels, all_output, args):
    accuracy_score = importlib.import_module('sklearn.metrics').accuracy_score
    recall_score = importlib.import_module('sklearn.metrics').recall_score
    precision_score = importlib.import_module('sklearn.metrics').precision_score
    precision_recall_curve = importlib.import_module('sklearn.metrics').precision_recall_curve
    average_precision_score = importlib.import_module('sklearn.metrics').average_precision_score
    f1_score = importlib.import_module('sklearn.metrics').f1_score
    if isinstance(all_output, torch.Tensor):
        if all_output.requires_grad:
            all_output = all_output.detach()
        all_output = all_output.cpu().numpy()
    if isinstance(all_labels, torch.Tensor):
        all_labels = all_labels.cpu().numpy()

    metrics_per_class = {}
    Average_Precision_Curve = {}
    avg_metrics = {}
  
    dataset_class = args.dataset_class.copy()
    if len(args.dataset_class) > 1:
        dataset_class['foreground'] = 0

    all_predict = np.zeros_like(all_output, dtype=bool)
    np.put_along_axis(all_predict, np.argmax(all_output, axis=-1).reshape(-1, 1), True, axis=-1)
     
    for class_name, idx in dataset_class.items():
        # 为当前类别准备标签和预测
        if class_name in 'foreground':
            class_labels = (all_labels != idx).astype(int)
            class_output = ~all_predict[:, 0]
            ap = average_precision_score(class_labels, 1-all_output[:, idx])
            precisions, recalls, _ = precision_recall_curve(class_labels, 1-all_output[:, idx])
        else:
            class_labels = (all_labels == idx).astype(int)
            class_output = all_predict[:, idx]
            ap = average_precision_score(class_labels, all_output[:, idx])
            precisions, recalls, _ = precision_recall_curve(class_labels, all_output[:, idx])
        # 计算指标
        accuracy = accuracy_score(class_labels, class_output)
        precision = precision_score(class_labels, class_output)
        recall = recall_score(class_labels, class_output)
        f1 = f1_score(class_labels, class_output)

        metrics_per_class[class_name] = {
            'Accuracy': accuracy,
            'Precision': precision,
            'Recall': recall,
            'F1_score': f1,
            'Average_Precision': ap,
        }
        Average_Precision_Curve[class_name] = {'Precision': precisions,'Recall': recalls}
        metrics_str = ', '.join(f"{metric}: {value:.4f}" for metric, value in metrics_per_class[class_name].items())
        args.logger.info(f"Metrics for {class_name}: {metrics_str}")

    if len(args.dataset_class)>1:    
        # 计算平均值
        for metric in metrics_per_class[list(args.dataset_class.keys())[0]].keys():
            avg_metrics[metric] = np.mean([class_metrics[metric] for class_metrics in metrics_per_class.values()])
        metrics_str = ', '.join(f"{metric}: {value:.4f}" for metric, value in avg_metrics.items())
        args.logger.info(f"Average metrics: {metrics_str}")
        
        if (not os.path.isfile(args.test_image)):
            for class_name, idx in dataset_class.items():
                plt.plot(Average_Precision_Curve[class_name]['Recall'], 
                        Average_Precision_Curve[class_name]['Precision'], label=class_name, color=args.color[idx % len(args.color)])
            # 设置图例和标签
            plt.xlabel('Recall')
            plt.ylabel('Precision')
            plt.title('Precision-Recall Curve')
            plt.legend()
            if (args.eval): 
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_eval.png'
            else:
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_train.png'
            plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
            plt.close('all') 
            args.logger.info(f"PR_curve has been saved to {PR_curve_path}:")        
        return avg_metrics['Average_Precision'], Average_Precision_Curve['foreground']
    return metrics_per_class[list(args.dataset_class.keys())[0]], Average_Precision_Curve[list(args.dataset_class.keys())[0]] 

def evaluate(model, eva_loader, args):
    model.eval()

    all_output = torch.tensor([], device=args.device)
    all_labels = torch.tensor([], device=args.device)

    with torch.no_grad():
        for i, (data, img_paths) in enumerate(eva_loader):
            data = data.to(args.device)
            outputs = model(data[:,:,:-2])
            valid = data[:,:,-1].reshape(-1).bool()
            all_output = torch.cat([all_output, outputs.view(-1,len(args.dataset_class)+1)[valid,:]], dim=0)
            all_labels = torch.cat([all_labels, data[:,:,-2].long().reshape(-1)[valid]], dim=0)

            if (i + 1) % args.print_interval == 0:
                args.logger.info(f"Epoch(test) : [{i + 1}/{len(eva_loader)}]")

    return get_metric(all_labels, all_output, args)

def test(model, args):
    model.eval()
    extractor = extractor_build(args.descriptor)
    keypoints, descriptors, image = extract_img_feature(args.descriptor, cv2.cvtColor(cv2.imread(args.test_image), cv2.COLOR_BGR2RGB), extractor)

    load_txt_info_func = globals()['load_txt_info_' + args.data_root.rstrip('/').split('/')[-1]]
    txt_file = args.test_image.replace(args.img_suffix,'.txt').replace('images','**')
    txt_file = glob.glob(txt_file, recursive=True)[0]
    data_info = load_txt_info_func(txt_file, args)
    data_info['image_shape'] = image.shape[:2]
    labels, bboxes = get_keypoint_label(keypoints, data_info, args)
    
    kps = np.array([cv2.KeyPoint(*kp) for kp in keypoints])
    # boosted the descriptor using trained model
    keypoints = normalize_keypoints(keypoints, image.shape).astype(np.float32)
    if 'orb' in args.descriptor.lower():
        descriptors = np.unpackbits(descriptors, axis=1, bitorder='little').astype(np.float32)
        descriptors = descriptors * 2.0 - 1.0
    with torch.no_grad():
        output = model(torch.from_numpy(np.concatenate([keypoints, descriptors,], axis=-1)).to(args.device).float()).cpu().numpy()

    metric_dict, PR_dict = get_metric(labels, output, args)
    # predict = (1-output[...,0]) > args.test_threshold
    predict = np.argmax(output, axis=-1)
    for class_name, idx in args.dataset_class.items():
        image = cv2.drawKeypoints(image, kps[predict==idx], None, color=hex_to_rgb(args.color[idx % len(args.color)]),) # 红色 虚警
    # image = cv2.drawKeypoints(image, kps[(~predict)&(labels)], None, color=(0,0,255)) # Aqua蓝色 漏检
    # image = cv2.drawKeypoints(image, kps[predict&labels], None, color=(0,0,255,),) # 黄色 正确预测(正样本)
    # image = cv2.drawKeypoints(image, kps[(~predict)&(~labels)], None, color= (0, 255, 0) ) # 绿色 正确预测(负样本)
    # image = cv2.drawKeypoints(image, kps[(label)], None, color=(255,0,0,))
    # image = cv2.drawKeypoints(image, kps[~predict], None, color=(0,255,0))
    image = cv2.polylines(image, bboxes, isClosed=True, color=(255, 255, 0), thickness=1)
    cv2.imwrite('vis_dir/'+ args.test_image.split('/')[-1], cv2.cvtColor(image, cv2.COLOR_RGB2BGR))
    return metric_dict, PR_dict

def worker_init_fn(worker_id, group, args):
    # torch.cuda.set_device(worker_id) 指定数加载设备
    torch.cuda.manual_seed_all(worker_id)

def custom_collate_fn(batch):
    rnn_utils = importlib.import_module('torch.nn.utils.rnn')
    results = [item[0] for item in batch]  # 提取每个样本的result
    img_paths = [item[1] for item in batch]  # 提取每个样本的img_path
    padded_results = rnn_utils.pad_sequence(results, batch_first=True, padding_value=0)
    return padded_results, img_paths

def train(model, args):
    CosineAnnealingWarmRestarts = importlib.import_module('torch.optim.lr_scheduler').CosineAnnealingWarmRestarts
    LinearLR = importlib.import_module('torch.optim.lr_scheduler').LinearLR
    MultiStepLR = importlib.import_module('torch.optim.lr_scheduler').MultiStepLR
    ChainedScheduler = importlib.import_module('torch.optim.lr_scheduler').ChainedScheduler
    clip_grad_norm_ = importlib.import_module('torch.nn.utils').clip_grad_norm_
    optimizer_class = importlib.import_module('torch.optim').AdamW
    partial = importlib.import_module('functools').partial
    train_pipeline = []
    if args.image_aug:
        train_pipeline = [
            dict(type='mmdet.LoadImageFromFile', backend_args=None),
            dict(type='mmdet.LoadAnnotations', with_bbox=True, box_type='qbox'),
            dict(
                type='mmrotate.ConvertBoxType',
                box_type_mapping=dict(gt_bboxes='rbox')),
            dict(
                type='mmrotate.RandomRotate',
                prob=0.5,
                angle_range=180,
                rotate_type='mmrotate.Rotate'),
            dict(
                type='mmdet.RandomFlip',
                prob=0.75,
                direction=['horizontal', 'vertical', 'diagonal']),
            dict(
                type='mmdet.RandomAffine',),
            dict(
                type='mmdet.PhotoMetricDistortion',),

            dict(
                type='mmrotate.ConvertBoxType',
                box_type_mapping=dict(gt_bboxes='qbox')),
            dict(type='mmdet.PackDetInputs', meta_keys=())]
    train_dataset = ShipKeyPointsDataset(args, ann_file = args.train_ann_file, dataset_repeat = args.dataset_repeat, pipeline = train_pipeline)
    train_loader = DataLoader(train_dataset, batch_size=args.batch_size, shuffle=True, 
                              num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                              # worker_init_fn=partial(worker_init_fn, group='train', args = args),
                              # pin_memory=True, persistent_workers = True,
                              multiprocessing_context=args.multiprocessing_context)
    eva_loader = {}
    for ann_file in args.test_ann_file:
        SimpleNamespace = importlib.import_module('types').SimpleNamespace
        eval_args = vars(args)
        eval_args['eval'] = True
        eval_args = SimpleNamespace(**eval_args)
        eva_dataset = ShipKeyPointsDataset(args = eval_args, ann_file = ann_file)
        eva_loader[ann_file] = DataLoader(eva_dataset, batch_size=args.batch_size, shuffle=False, 
                                num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                                # worker_init_fn=partial(worker_init_fn, group='eval', args = args), 
                                # pin_memory=True, persistent_workers = True,
                                multiprocessing_context=args.multiprocessing_context)
    if args.print:
        outputs = importlib.import_module('mmengine.analysis').get_model_complexity_info(
            model,
            input_shape=None,
            inputs=train_dataset.__getitem__(0)[0][:,:-2].float().to(args.device),  # the input tensor of the model
            show_table=True,  # show the complexity table
            show_arch=False)  # show the complexity arch
        for k, v in outputs.items():
            args.logger.info(f"{k}: {v}")
    # 定义损失函数和优化器
    weight = torch.softmax(1/torch.tensor([100000.0,  166, 89 , 288 , 25 , 263 , 2053], device = args.device),dim=-1) # [100000.0,  166, 89 , 288 , 25 , 263 , 2053]

    CenterLoss = getattr(importlib.import_module("CenterLoss"), "CenterLoss")
    loss_weight = 20
    centerloss = CenterLoss(len(args.dataset_class) + 1, model.config['output_dim']).to(args.device)
    nllloss = nn.NLLLoss().to(args.device)
    param_groups = [
        {'params': model.parameters(), 'lr': args.lr, 'weight_decay': 1e-4},
        {'params': centerloss.parameters(), 'lr': args.lr, 'weight_decay': 1e-4}
    ]
    optimizer = optimizer_class(param_groups) # 
    # warmup_scheduler = LinearLR(optimizer, start_factor=1.0 / 20, end_factor=1.0, total_iters=args.warmup_step)
    # scheduler = CosineAnnealingWarmRestarts(optimizer, T_0=20, T_mult=2, eta_min = 1e-5)
    scheduler = MultiStepLR(optimizer, milestones=[40, 70, 90], gamma=0.5)
    # scheduler = ChainedScheduler([warmup_scheduler, step_scheduler])

    start_epoch = 0
    best_AP = 0.0
    if os.path.isfile(args.checkpoint):
        checkpoint = torch.load(args.checkpoint)
        model.load_state_dict(checkpoint['model_state_dict'])
        centerloss.load_state_dict(checkpoint['centerloss_state_dict'])
        optimizer.load_state_dict(checkpoint['optimizer_state_dict']),
        scheduler.load_state_dict(checkpoint['scheduler_state_dict'])
        start_epoch = checkpoint['epoch']+1
        best_AP = checkpoint['best_AP']
        args.logger.info(f'Continue training from epoch [{start_epoch}] !')

    # getGPUs = importlib.import_module('GPUtil').getGPUs
    # virtual_memory = importlib.import_module('psutil').virtual_memory
    # collect = importlib.import_module('gc').collect
    for epoch in range(start_epoch, args.num_epochs):
        start_time = time.time()
        model.train()
        for i, (data, img_paths)  in enumerate(train_loader):
            torch.cuda.empty_cache() # 在显存资源有限的情况下使用
            data = data.to(args.device)
            # collect() # 显式垃圾回收
            # memory = virtual_memory()
            # args.logger.info(f"总内存: {memory.total / (1024 ** 3):.2f} GB, 可用内存: {memory.available / (1024 ** 3):.2f} GB, 内存使用率: {memory.percent}%")
            # gpu = getGPUs()[0]
            # args.logger.info(f">>>before: GPU: {gpu.name}, 显存总量: {gpu.memoryTotal}MB, 显存使用: {gpu.memoryUsed}MB, 显存空闲: {gpu.memoryFree}MB")
            feat, outputs = model(data[:,:,:-2])
            # args.logger.info(f">>>after: GPU: {gpu.name}, 显存总量: {gpu.memoryTotal}MB, 显存使用: {gpu.memoryUsed}MB, 显存空闲: {gpu.memoryFree}MB")
            valid = data[:,:,-1].reshape(-1).bool()
            label_inc = data[:,:,-2].long().view(-1)[valid]
            feat = feat.view(-1,model.config['output_dim'])[valid,:]
            outputs = outputs.view(-1,len(args.dataset_class)+1)[valid,:]
            
            # label = nn.functional.one_hot(label_inc, num_classes= len(args.dataset_class) + 1).float()
            
            # if len(args.dataset_class) > 1: # soft_label
            #     softening_value = 0.1
            #     non_background_mask = (label_inc != 0).unsqueeze(dim=-1).repeat(1,len(args.dataset_class)+1)
            #     non_background_mask[...,0] = False
            #     label[non_background_mask] = label[non_background_mask]  * (1 - softening_value) + \
            #                                     (1 - label[non_background_mask]) * softening_value / (len(args.dataset_class)-1)  
                                                          
            # loss_cls = torch.mean(- 0.75*label * ((1-outputs)**2) *torch.log(outputs) - 0.25*((1-label) *(outputs**2)* torch.log(1-outputs)), dim = 0)
            # inter_cls_loss = torch.sum(loss_cls*weight)
            inter_cls_loss = nllloss(torch.log(outputs), label_inc)
            inner_cls_loss = centerloss(feat, label_inc)
            loss = loss_weight * inter_cls_loss + inner_cls_loss
            
            optimizer.zero_grad()
            loss.backward()
            clip_grad_norm_(model.parameters(), 35, 2)
            clip_grad_norm_(centerloss.parameters(), 35, 2)
            optimizer.step()
            del outputs, data, valid
            if (i + 1) % args.print_interval == 0:
                current_time = time.time()
                eta_seconds = (current_time - start_time) / (i+1) * ( (args.num_epochs - epoch ) * len(train_loader) - (i + 1))
                eta_str = str(int(eta_seconds // 3600)) + ':' + str(int((eta_seconds % 3600) // 60)) + ':' + str(int(eta_seconds % 60))
                # loss_str = ' '.join([f"{cls_name}:{loss_value:.4f}" for cls_name,loss_value in zip(['background'] + list(args.dataset_class.keys()), loss_cls)])
                args.logger.info(f"Epoch(train)"
                      f"[{epoch + 1}/{args.num_epochs}][{i + 1}/{len(train_loader)}]"
                      f"lr: {optimizer.param_groups[0]['lr']:.4e}  eta: {eta_str}  " 
                      f"time: {current_time - start_time:.4f}  inter_cls_loss: {inter_cls_loss:.4f} inner_cls_loss: {inner_cls_loss.item():.4f}")
        scheduler.step()
        if ((epoch+1) % args.eval_interval == 0) or (epoch == 0) or (epoch == args.num_epochs-1): # 
            for ann_file in args.test_ann_file: 
                args.logger.info(f"Epoch(test) {ann_file}:")
                metric_dict_all, PR_dict_all = evaluate(model, eva_loader[ann_file], args)

            # 检查是否有更好的模型，如果有，则保存权重
            if metric_dict_all['Average_Precision'] > best_AP:
                best_AP = metric_dict_all['Average_Precision']
                # 保存当前模型的权重
                torch.save(model.state_dict(), args.save_path)
                args.logger.info(f"Best model saved to  {args.save_path} with MD5 {calculate_md5(args.save_path)}, with {args.test_ann_file[-1]} image AP {best_AP:.4f}")
            if (epoch >= args.num_epochs-1):
                last_save_path = 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + '_last_model_weight.pth'
                torch.save(model.state_dict(), last_save_path)
                args.logger.info(f"Last model saved :{last_save_path}")

        if ((epoch+1) % args.save_interval == 0):
            for file_path in glob.glob(args.save_path[:-4] + '*_epoch.pth'):
                os.remove(file_path)
            torch.save({
                'model_state_dict': model.state_dict(),
                'centerloss_state_dict': centerloss.state_dict(),
                'optimizer_state_dict': optimizer.state_dict(),
                'scheduler_state_dict': scheduler.state_dict(),
                'epoch': epoch,
                'best_AP': best_AP,
                }, args.save_path[:-4] + f'_{epoch+1}_epoch.pth')

if __name__ == '__main__':
    args = parse_arguments()

    random.seed(args.random_seed)
    np.random.seed(args.random_seed)
    torch.manual_seed(args.random_seed)
    if torch.cuda.is_available():
        torch.cuda.manual_seed_all(args.random_seed)

    if ('alike' in args.descriptor.lower()) or ('superpoint' in args.descriptor.lower()) or ('hardnet' in args.descriptor.lower()) or ('sosnet' in args.descriptor.lower()):
        args.multiprocessing_context = 'spawn'

    args.feature_booster_pretrained = '' # Path(__file__).parent / str("FeatureBooster/models/" + args.descriptor + ".pth")
    pretrained_str = 'finetune' if os.path.isfile(args.feature_booster_pretrained) else 'scratch'
    args.save_path = args.save_path if len(args.save_path) else 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}_' + f'best_model_weights_{pretrained_str}.pth'
    args.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    args.color = ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff00ff', '#990000', '#999900', '#009900', '#009999'] 
    model = ShipKeyPointsModel(args)
    
    # 创建日志器
    logger = logging.getLogger()
    logger.setLevel(logging.INFO)
    # 创建控制台处理程序
    console_handler = logging.StreamHandler()
    console_handler.setLevel(logging.INFO)
    console_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))    
    logger.addHandler(console_handler)
    args.logger = logger
    if (not args.eval) and (not os.path.isfile(args.test_image)): # train
        args.log_file = args.log_file if len(args.log_file) else 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + f'_dataset_repeat_{args.dataset_repeat}_positive_keypoint_repeat_{args.positive_keypoint_repeat}_{pretrained_str}.log'
        if not os.path.exists(os.path.dirname(args.log_file)):
            os.makedirs(os.path.dirname(args.log_file))
        # 创建文件处理程序
        file_handler = logging.FileHandler(args.log_file, mode='a')
        file_handler.setLevel(logging.INFO)
        file_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))
        # 添加处理程序到日志器
        logger.addHandler(file_handler)
        logger.info(">>>>>=========================Start Train!===========================<<<<<")
        for k, v in vars(args).items():
            if k not in 'logger':
                logger.info(f"{k}: {v}")

        if args.print: 
            with open(__file__, 'r') as file:
                lines = file.readlines()
            with open(args.log_file, "a") as file:   
                for line in lines:
                    file.write(line[:-1]+'\n')
                file.write('\n')
        train(model, args)
        args.logger.info(f"model weights saved to {args.save_path} with MD5 {calculate_md5(args.save_path)}!")
        args.checkpoint = args.save_path
        args.eval = True

    model_weights_md5 = "init_md5"
    if os.path.isfile(args.checkpoint):
        if 'cpu' in args.device.type:
            model.load_state_dict(torch.load(args.checkpoint, map_location=lambda storage, loc:storage), strict=False)
        else:
            model.load_state_dict(torch.load(args.checkpoint), strict=False)
        model_weights_md5 = calculate_md5(args.checkpoint)
        args.logger.info(f"model weights loaded from {args.checkpoint} with MD5 {model_weights_md5}!")
        model_weights_md5 = model_weights_md5[:5]

    if os.path.isfile(args.test_image):
        args.logger.info(f"Epoch(test) - {args.test_image}:")
        metric_dict, PR_dict = test(model, args)
    if args.eval:
        for ann_file in args.test_ann_file:
            args.logger.info(f"Epoch(test) {ann_file}:")
            eva_dataset = ShipKeyPointsDataset(args = args, ann_file = ann_file)
            eva_loader = DataLoader(eva_dataset, batch_size=args.batch_size, shuffle=False, 
                                    num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                                    pin_memory=True, persistent_workers = True, multiprocessing_context=args.multiprocessing_context)
            metric_dict, PR_dict_all = evaluate(model, eva_loader, args)
            if PR_dict_all is not None:
                plt.plot(PR_dict_all['Recall'], PR_dict_all['Precision'])
                # 设置图例和标签
                plt.xlabel('Recall')
                plt.ylabel('Precision')
                plt.title('Precision-Recall Curve')
                plt.legend()
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_eval_{model_weights_md5}.png'
                plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
                plt.close('all') 
                args.logger.info(f"PR_curve has been saved to {PR_curve_path}!"

2023-12-03 22:20:30,581 - INFO - Created a temporary directory at /tmp/tmpnzk0f0dq
2023-12-03 22:20:30,581 - INFO - Writing /tmp/tmpnzk0f0dq/_remote_module_non_scriptable.py
2023-12-03 22:20:31,648 - INFO - The dataset located in ['train/'] was duplicated 3 times!
2023-12-03 22:20:32,177 - INFO - flops: 236366368
2023-12-03 22:20:32,177 - INFO - flops_str: 0.236G
2023-12-03 22:20:32,177 - INFO - activations: 865249
2023-12-03 22:20:32,177 - INFO - activations_str: 0.865M
2023-12-03 22:20:32,177 - INFO - params: 1988167
2023-12-03 22:20:32,177 - INFO - params_str: 1.988M
2023-12-03 22:20:32,178 - INFO - out_table: 
+---------------------------+----------------------+------------+--------------+
| module                    | #parameters or shape | #flops     | #activations |
+---------------------------+----------------------+------------+--------------+
| model                     | 1.988M               | 0.236G     | 0.865M       |
|  feature_booster          |  1.954M              |  0.232G    |  0.849M      |
|   feature_booster.kenc.e… |   0.109M             |   12.928M  |   87.584K    |
|    feature_booster.kenc.… |    0.128K            |    11.424K |    3.808K    |
|    feature_booster.kenc.… |    2.112K            |    0.244M  |    7.616K    |
|    feature_booster.kenc.… |    8.32K             |    0.975M  |    15.232K   |
|    feature_booster.kenc.… |    33.024K           |    3.899M  |    30.464K   |
|    feature_booster.kenc.… |    65.792K           |    7.799M  |    30.464K   |
|   feature_booster.denc.e… |   0.197M             |   23.396M  |   91.392K    |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|   feature_booster.attn_p… |   1.581M             |   0.188G   |   0.64M      |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|   feature_booster.final_… |   65.792K            |   7.799M   |   30.464K    |
|    feature_booster.final… |    (256, 256)        |            |              |
|    feature_booster.final… |    (256,)            |            |              |
|   feature_booster.layer_… |   0.512K             |   0.152M   |   0          |
|    feature_booster.layer… |    (256,)            |            |              |
|    feature_booster.layer… |    (256,)            |            |              |
|  fc_out                   |  33.799K             |  4.006M    |  16.065K     |
|   fc_out.0                |   32.896K            |   3.899M   |   15.232K    |
|    fc_out.0.weight        |    (128, 256)        |            |              |
|    fc_out.0.bias          |    (128,)            |            |              |
|   fc_out.2                |   0.903K             |   0.107M   |   0.833K     |
|    fc_out.2.weight        |    (7, 128)          |            |              |
|    fc_out.2.bias          |    (7,)              |            |              |
+---------------------------+----------------------+------------+--------------+

2023-12-03 22:20:32,178 - INFO - out_arch: 
2023-12-03 22:20:55,653 - INFO - Epoch(train)[1/100][40/100]lr: 6.0000e-04  eta: 1:37:22  time: 23.4656  inter_cls_loss: 0.6608 inner_cls_loss: 92.5098
2023-12-03 22:21:13,700 - INFO - Epoch(train)[1/100][80/100]lr: 6.0000e-04  eta: 1:25:47  time: 41.5147  inter_cls_loss: 0.1553 inner_cls_loss: 87.3736
2023-12-03 22:21:22,685 - INFO - Epoch(test) test/:
2023-12-03 22:21:31,688 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0385
2023-12-03 22:21:31,826 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0945
2023-12-03 22:21:31,999 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0049
2023-12-03 22:21:32,140 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 22:21:32,279 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0562
2023-12-03 22:21:32,419 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0439
2023-12-03 22:21:32,555 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1628
2023-12-03 22:21:32,556 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0573
2023-12-03 22:21:33,158 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:22:17,501 - INFO - >>>>>=========================Start Train!===========================<<<<<
2023-12-03 22:22:17,501 - INFO - descriptor: SuperPoint+Boost-F-attlay3
2023-12-03 22:22:17,501 - INFO - num_epochs: 100
2023-12-03 22:22:17,501 - INFO - train_ratio: 1.0
2023-12-03 22:22:17,501 - INFO - batch_size: 16
2023-12-03 22:22:17,501 - INFO - num_workers: 4
2023-12-03 22:22:17,501 - INFO - print_interval: 40
2023-12-03 22:22:17,501 - INFO - eval_interval: 1
2023-12-03 22:22:17,501 - INFO - save_interval: 10
2023-12-03 22:22:17,501 - INFO - lr: 0.0006
2023-12-03 22:22:17,501 - INFO - warmup_step: 20
2023-12-03 22:22:17,501 - INFO - random_seed: 0
2023-12-03 22:22:17,501 - INFO - expand_piexl: 5
2023-12-03 22:22:17,501 - INFO - test_threshold: 0.5
2023-12-03 22:22:17,501 - INFO - test_image: 
2023-12-03 22:22:17,501 - INFO - eval: False
2023-12-03 22:22:17,501 - INFO - save_path: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth
2023-12-03 22:22:17,501 - INFO - log_file: work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_dataset_repeat_3_positive_keypoint_repeat_1_scratch.log
2023-12-03 22:22:17,501 - INFO - checkpoint: 
2023-12-03 22:22:17,502 - INFO - multiprocessing_context: spawn
2023-12-03 22:22:17,502 - INFO - data_root: data/srsdd
2023-12-03 22:22:17,502 - INFO - img_suffix: .png
2023-12-03 22:22:17,502 - INFO - train_ann_file: ['train/']
2023-12-03 22:22:17,502 - INFO - test_ann_file: ['test/']
2023-12-03 22:22:17,502 - INFO - dataset_class: {'ore-oil': 1, 'Cell-Container': 2, 'Fishing': 3, 'LawEnforce': 4, 'Dredger': 5, 'Container': 6}
2023-12-03 22:22:17,502 - INFO - dataset_repeat: 3
2023-12-03 22:22:17,502 - INFO - positive_keypoint_repeat: 1
2023-12-03 22:22:17,502 - INFO - image_aug: True
2023-12-03 22:22:17,502 - INFO - print: True
2023-12-03 22:22:17,502 - INFO - feature_booster_pretrained: 
2023-12-03 22:22:17,502 - INFO - device: cuda
2023-12-03 22:22:17,502 - INFO - color: ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff00ff', '#990000', '#999900', '#009900', '#009999']
# -*- coding: UTF-8 -*-
import pycolmap # pycolmap 占用的TLS最大,放在最前面 
# 原理参考: https://github.com/pytorch/pytorch/issues/2575#issue-254038499
from extract_features import normalize_keypoints, extractor_build, extract_img_feature
from torch.utils.data import DataLoader, Dataset
from os import path as osp
from pathlib import Path
from torch import nn
import numpy as np
import matplotlib
matplotlib.use('Agg')  # 设置Agg为后端
import matplotlib.pyplot as plt
import importlib
import warnings
import logging
import random
import torch
import time
import glob
import yaml
import cv2
import os
warnings.filterwarnings('ignore')

def parse_arguments():
    parser = importlib.import_module('argparse').ArgumentParser(description="Extract feature and refine descriptor using neural network to find ship keypoint.")

    parser.add_argument(
        '--descriptor', type=str, default='ORB+Boost-B-attlay3',
        help='descriptor to extract' )

    parser.add_argument(
        '--num_epochs', type=int, default=100,)

    parser.add_argument(
        '--train_ratio', type=float, default=1.0,
        help='The ratio of data used for training out of the training set' )

    parser.add_argument(
        '--batch_size', type=int, default=16,)

    parser.add_argument(
        '--num_workers', type=int, default=4,)

    parser.add_argument(
        '--print_interval', type=int, default=20,)

    parser.add_argument(
        '--eval_interval', type=int, default=5,)

    parser.add_argument(
        '--save_interval', type=int, default=10,)

    parser.add_argument(
        '--lr', type=float, default=1e-3,)

    parser.add_argument(
        '--warmup_step', type=int, default=20,)

    parser.add_argument(
        '--random_seed', type=int, default=0,)

    parser.add_argument(
        '--expand_piexl', type=int, default=5,)

    parser.add_argument(
        '--test_threshold', type=float, default=0.5,)

    parser.add_argument(
        '--test_image', type=str, default='',)

    parser.add_argument(
        '--eval', action='store_true',)

    parser.add_argument(
        '--save_path', type=str, default='',)

    parser.add_argument(
        '--log_file', type=str, default='',)

    parser.add_argument(
        '--checkpoint', type=str, default='',)

    parser.add_argument(
        '--multiprocessing_context', type=str, default=None,)

    parser.add_argument(
        '--data_root', type=str, default='data/srsdd',)

    parser.add_argument(
        '--img_suffix', type=str, default='.png',)

    parser.add_argument(
        '--train_ann_file', nargs='*', default=['train/'],)

    parser.add_argument(
        '--test_ann_file', nargs='*', default=['test/'],)

    parser.add_argument(
        '--dataset_class',
        nargs='*',
        default=['ore-oil','Cell-Container','Fishing','LawEnforce','Dredger','Container'], # [166, 89 , 288 , 25 , 263 , 2053]
        help='Dataset classes list. Default is ["ship"].'
    )

    parser.add_argument(
        '--dataset_repeat', type=int, default=3,)
    
    parser.add_argument(
        '--positive_keypoint_repeat', type=int, default=6,)

    parser.add_argument(
        '--image_aug', action='store_true',)
    
    parser.add_argument(
        '--print', action='store_true')

    args = parser.parse_args()
    args.dataset_class = {item: index + 1 for index, item in enumerate(args.dataset_class)}    
    return args

def calculate_md5(file_path):

    hash_md5 = importlib.import_module('hashlib').md5()
    with open(file_path, "rb") as f:
        # 以块的方式读取文件，以防文件太大
        for chunk in iter(lambda: f.read(4096), b""):
            hash_md5.update(chunk)
    return hash_md5.hexdigest()

# 定义舰船目标关键点检测模型（示例）
class ShipKeyPointsModel(nn.Module):
    def __init__(self, args,):
        super().__init__()
        FeatureBooster = importlib.import_module('FeatureBooster.featurebooster').FeatureBooster
        MLP = importlib.import_module('FeatureBooster.featurebooster').MLP

        self.device = args.device

        with open(str(Path(__file__).parent / "config.yaml"), 'r') as f:
            config = yaml.load(f, Loader=yaml.FullLoader)
        self.config = config[args.descriptor]
        # Model
        self.feature_booster = FeatureBooster(self.config)
        # load the model
        if os.path.isfile(args.feature_booster_pretrained):
            self.feature_booster.load_state_dict(torch.load(args.feature_booster_pretrained), strict =False)
            args.logger.info(f"feature_booster weights loaded from {args.feature_booster_pretrained}!")
        self.fc_out = MLP([self.config['output_dim'], self.config['output_dim']//2, len(args.dataset_class)+1])
        self.to(args.device)

    def forward(self, x):
        feat = self.feature_booster(x[...,self.config['keypoint_dim']:], x[...,:self.config['keypoint_dim']])
        x = self.fc_out(feat)
        if self.training:
            return feat, nn.functional.softmax(x, dim=-1)
        else:
            return nn.functional.softmax(x, dim=-1)

def load_txt_info_srsdd(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt','.png').replace('labels','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s[2:]:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]] if len(args.dataset_class) > 1 else 1
            instance['ignore_flag'] = 0
            instance['bbox'] = [float(i) for i in bbox_info[:8]]
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def load_txt_info_hrsid(txt_file, args):
    data_info = {}
    img_id = osp.split(txt_file)[1][:-4]
    data_info['img_id'] = img_id
    img_name = img_id + f'.{args.img_suffix}'
    data_info['file_name'] = img_name

    img_path = txt_file.replace('.txt','.png').replace('labelTxt','images')
    data_info['img_path'] = img_path

    instances = []
    with open(txt_file) as f:
        s = f.readlines()
        for si in s:
            instance = {}
            bbox_info = si.split()
            instance['bbox_label'] = args.dataset_class[bbox_info[8]]
            instance['ignore_flag'] = 0
            instance['bbox'] = [float(i) for i in bbox_info[:8]]
            instances.append(instance)
    data_info['instances'] = instances
    return data_info

def get_keypoint_label(keypoints, data_info, args):
    bboxes = []
    bbox_label = []
    for instances in data_info['instances']:
        bboxes.append(np.array([(instances['bbox'][i], instances['bbox'][i + 1]) for i in range(0, len(instances['bbox']), 2)], dtype=np.int32))
        bbox_label.append(instances['bbox_label'])

    tmp = np.zeros(data_info['image_shape'], dtype=np.uint8)
    for box, label in zip(bboxes, bbox_label):
        cv2.fillPoly(tmp, np.array([box]), label)
    target = []
    mode = importlib.import_module('scipy.stats').mode
    for kp in keypoints: 
        region = tmp[max(0, int(kp[1] - args.expand_piexl)):min(int(kp[1] + args.expand_piexl), data_info['image_shape'][0]),
                    max(0, int(kp[0] - args.expand_piexl)):min(int(kp[0] +args.expand_piexl), data_info['image_shape'][1])]
        if region[region != 0].size > 0:
            # 计算区域的众数
            mode_val = mode(region, axis=None)[0][0]
            target.append(mode_val)
        else:
            target.append(0)  
    return np.array(target), bboxes

# 定义数据集（示例）
class ShipKeyPointsDataset(Dataset):
    def __init__(self, args, dataset_repeat = 1, pipeline = [], debug = False, **kwargs):
        super(ShipKeyPointsDataset, self).__init__()
        if len(pipeline):
            importlib.import_module('mmdet.utils').register_all_modules(init_default_scope=False)
            importlib.import_module('mmdet.utils').register_all_modules(init_default_scope=False)
        self.transform = importlib.import_module('mmengine.dataset').Compose(pipeline)
        self.debug = debug
        self.args = args
        with open(str(Path(__file__).parent / "config.yaml"), 'r') as f:
            config = yaml.load(f, Loader=yaml.FullLoader)
        self.config = config[args.descriptor]
        self.extractor = extractor_build(self.args.descriptor, device = args.device)
        if 'ann_file' in kwargs and kwargs['ann_file'] !='':
            # train case
            ann_dir = kwargs['ann_file']
            if isinstance(ann_dir, str):
                ann_dir = [ann_dir]
        else:
            ann_dir = []
        self.txt_files = []
        for path in ann_dir:
            self.txt_files.extend(glob.glob(osp.join(args.data_root, path, "**/*.txt"), recursive=True)) 
        if (not args.eval) and (args.train_ratio<1):
            self.txt_files = random.sample(self.txt_files, int(np.ceil(len(self.txt_files)*args.train_ratio)))
        if (not args.eval) and (dataset_repeat > 1):
            self.txt_files = self.txt_files*dataset_repeat
            args.logger.info(f"The dataset located in {ann_dir} was duplicated {dataset_repeat} times!")

    def __len__(self):
        return len(self.txt_files)

    def load_data_info(self, idx):
        txt_file = self.txt_files[idx]
        load_txt_info_func = globals()['load_txt_info_' + self.args.data_root.rstrip('/').split('/')[-1]]
        return load_txt_info_func(txt_file, self.args)

    def __getitem__(self, idx):
        data_info = self.load_data_info(idx)
        bboxes = []
        if (not self.args.eval) and (len(self.transform.transforms)):
            data = self.transform(data_info)
            data_instance = data['data_samples'].gt_instances
            if (len(data_info['instances'])>0) and (len(data_instance.labels)<1):
                image = cv2.cvtColor(cv2.imread(data_info['img_path']), cv2.COLOR_BGR2RGB)
                data_info['image_shape'] = image.shape[:2]
            else:            
                image = data['inputs'].cpu().numpy().transpose(1, 2, 0)
                data_info['image_shape'] = image.shape[:2]
                data_info['instances'] = [] 
                for box_id in range(len(data_instance.labels)):
                    instance = {}
                    instance['bbox_label'] = int(data_instance.labels[box_id])
                    instance['bbox'] = list(data_instance.bboxes.vertices[box_id].reshape(-1).cpu().numpy())
                    data_info['instances'].append(instance)
            del data
        else:
            image = cv2.cvtColor(cv2.imread(data_info['img_path']), cv2.COLOR_BGR2RGB)
            data_info['image_shape'] = image.shape[:2]

        keypoints, descriptors, image = extract_img_feature(self.args.descriptor, image, self.extractor)
        if len(keypoints) <= 0:
            args.logger.info(f"{data_info['img_path']} has no keypoint founded with {self.args.descriptor}")
            return torch.zeros([2, self.config['keypoint_dim'] + self.config['descriptor_dim'] + 2], dtype = torch.float32, requires_grad = False).float(), data_info['img_path']
        else:
            target, bboxes = get_keypoint_label(keypoints, data_info, self.args)
            
            if (not self.args.eval) and (self.args.positive_keypoint_repeat>1) and (np.random.rand() > 0.5): # 将正样本的关键点特征进行重复，增加正样本数目
                keypoints = np.concatenate([keypoints, np.tile(keypoints[target.astype(np.bool_)], (self.args.positive_keypoint_repeat,1))], axis=0)
                descriptors = np.concatenate([descriptors, np.tile(descriptors[target.astype(np.bool_)], (self.args.positive_keypoint_repeat,1))], axis=0)
                target = np.concatenate([target, np.tile(target[target.astype(np.bool_)], self.args.positive_keypoint_repeat)], axis=0)

            # visualization
            if self.debug:
                # args.logger.info(f"VISUALIZATION: {data_info['img_path']}")
                kps = np.array([cv2.KeyPoint(*kp) for kp in keypoints])
                image = cv2.drawKeypoints(image, kps[target.astype(np.bool_)], None, color=(255,0,0,))
                image = cv2.drawKeypoints(image, kps[~(target.astype(np.bool_))], None, color=(0,0,255))
                image = cv2.polylines(image, bboxes, isClosed=True, color=(0, 255, 0), thickness=2)
                cv2.imwrite(f"vis_dir/{data_info['img_id']}.png", cv2.cvtColor(image, cv2.COLOR_RGB2BGR))
                
            # boosted the descriptor using trained model
            keypoints = normalize_keypoints(keypoints, image.shape).astype(np.float32)
            if 'orb' in self.args.descriptor.lower():
                descriptors = np.unpackbits(descriptors, axis=1, bitorder='little').astype(np.float32)
                descriptors = descriptors * 2.0 - 1.0
            # 最后的全一是为了区分对齐batch的padding数据
            result = torch.from_numpy(np.concatenate([keypoints, descriptors, target.reshape(-1, 1), np.ones([len(target),1])], axis=-1))
            if (not self.args.eval) and (np.random.rand() > 0.5):
                result = result[torch.randperm(len(result))]
            result.requires_grad = False
            result = result.float()
            return result, data_info['img_path']

def hex_to_rgb(hex_color):
    hex_color = hex_color.lstrip('#')
    return tuple(int(hex_color[i:i+2], 16) for i in (0, 2, 4))

def get_metric(all_labels, all_output, args):
    accuracy_score = importlib.import_module('sklearn.metrics').accuracy_score
    recall_score = importlib.import_module('sklearn.metrics').recall_score
    precision_score = importlib.import_module('sklearn.metrics').precision_score
    precision_recall_curve = importlib.import_module('sklearn.metrics').precision_recall_curve
    average_precision_score = importlib.import_module('sklearn.metrics').average_precision_score
    f1_score = importlib.import_module('sklearn.metrics').f1_score
    if isinstance(all_output, torch.Tensor):
        if all_output.requires_grad:
            all_output = all_output.detach()
        all_output = all_output.cpu().numpy()
    if isinstance(all_labels, torch.Tensor):
        all_labels = all_labels.cpu().numpy()

    metrics_per_class = {}
    Average_Precision_Curve = {}
    avg_metrics = {}
  
    dataset_class = args.dataset_class.copy()
    if len(args.dataset_class) > 1:
        dataset_class['foreground'] = 0

    all_predict = np.zeros_like(all_output, dtype=bool)
    np.put_along_axis(all_predict, np.argmax(all_output, axis=-1).reshape(-1, 1), True, axis=-1)
     
    for class_name, idx in dataset_class.items():
        # 为当前类别准备标签和预测
        if class_name in 'foreground':
            class_labels = (all_labels != idx).astype(int)
            class_output = ~all_predict[:, 0]
            ap = average_precision_score(class_labels, 1-all_output[:, idx])
            precisions, recalls, _ = precision_recall_curve(class_labels, 1-all_output[:, idx])
        else:
            class_labels = (all_labels == idx).astype(int)
            class_output = all_predict[:, idx]
            ap = average_precision_score(class_labels, all_output[:, idx])
            precisions, recalls, _ = precision_recall_curve(class_labels, all_output[:, idx])
        # 计算指标
        accuracy = accuracy_score(class_labels, class_output)
        precision = precision_score(class_labels, class_output)
        recall = recall_score(class_labels, class_output)
        f1 = f1_score(class_labels, class_output)

        metrics_per_class[class_name] = {
            'Accuracy': accuracy,
            'Precision': precision,
            'Recall': recall,
            'F1_score': f1,
            'Average_Precision': ap,
        }
        Average_Precision_Curve[class_name] = {'Precision': precisions,'Recall': recalls}
        metrics_str = ', '.join(f"{metric}: {value:.4f}" for metric, value in metrics_per_class[class_name].items())
        args.logger.info(f"Metrics for {class_name}: {metrics_str}")

    if len(args.dataset_class)>1:    
        # 计算平均值
        for metric in metrics_per_class[list(args.dataset_class.keys())[0]].keys():
            avg_metrics[metric] = np.mean([class_metrics[metric] for class_metrics in metrics_per_class.values()])
        metrics_str = ', '.join(f"{metric}: {value:.4f}" for metric, value in avg_metrics.items())
        args.logger.info(f"Average metrics: {metrics_str}")
        
        if (not os.path.isfile(args.test_image)):
            for class_name, idx in dataset_class.items():
                plt.plot(Average_Precision_Curve[class_name]['Recall'], 
                        Average_Precision_Curve[class_name]['Precision'], label=class_name, color=args.color[idx % len(args.color)])
            # 设置图例和标签
            plt.xlabel('Recall')
            plt.ylabel('Precision')
            plt.title('Precision-Recall Curve')
            plt.legend()
            if (args.eval): 
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_eval.png'
            else:
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_train.png'
            plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
            plt.close('all') 
            args.logger.info(f"PR_curve has been saved to {PR_curve_path}:")        
        return avg_metrics, Average_Precision_Curve['foreground']
    return metrics_per_class[list(args.dataset_class.keys())[0]], Average_Precision_Curve[list(args.dataset_class.keys())[0]] 

def evaluate(model, eva_loader, args):
    model.eval()

    all_output = torch.tensor([], device=args.device)
    all_labels = torch.tensor([], device=args.device)

    with torch.no_grad():
        for i, (data, img_paths) in enumerate(eva_loader):
            data = data.to(args.device)
            outputs = model(data[:,:,:-2])
            valid = data[:,:,-1].reshape(-1).bool()
            all_output = torch.cat([all_output, outputs.view(-1,len(args.dataset_class)+1)[valid,:]], dim=0)
            all_labels = torch.cat([all_labels, data[:,:,-2].long().reshape(-1)[valid]], dim=0)

            if (i + 1) % args.print_interval == 0:
                args.logger.info(f"Epoch(test) : [{i + 1}/{len(eva_loader)}]")

    return get_metric(all_labels, all_output, args)

def test(model, args):
    model.eval()
    extractor = extractor_build(args.descriptor)
    keypoints, descriptors, image = extract_img_feature(args.descriptor, cv2.cvtColor(cv2.imread(args.test_image), cv2.COLOR_BGR2RGB), extractor)

    load_txt_info_func = globals()['load_txt_info_' + args.data_root.rstrip('/').split('/')[-1]]
    txt_file = args.test_image.replace(args.img_suffix,'.txt').replace('images','**')
    txt_file = glob.glob(txt_file, recursive=True)[0]
    data_info = load_txt_info_func(txt_file, args)
    data_info['image_shape'] = image.shape[:2]
    labels, bboxes = get_keypoint_label(keypoints, data_info, args)
    
    kps = np.array([cv2.KeyPoint(*kp) for kp in keypoints])
    # boosted the descriptor using trained model
    keypoints = normalize_keypoints(keypoints, image.shape).astype(np.float32)
    if 'orb' in args.descriptor.lower():
        descriptors = np.unpackbits(descriptors, axis=1, bitorder='little').astype(np.float32)
        descriptors = descriptors * 2.0 - 1.0
    with torch.no_grad():
        output = model(torch.from_numpy(np.concatenate([keypoints, descriptors,], axis=-1)).to(args.device).float()).cpu().numpy()

    metric_dict, PR_dict = get_metric(labels, output, args)
    # predict = (1-output[...,0]) > args.test_threshold
    predict = np.argmax(output, axis=-1)
    for class_name, idx in args.dataset_class.items():
        image = cv2.drawKeypoints(image, kps[predict==idx], None, color=hex_to_rgb(args.color[idx % len(args.color)]),) # 红色 虚警
    # image = cv2.drawKeypoints(image, kps[(~predict)&(labels)], None, color=(0,0,255)) # Aqua蓝色 漏检
    # image = cv2.drawKeypoints(image, kps[predict&labels], None, color=(0,0,255,),) # 黄色 正确预测(正样本)
    # image = cv2.drawKeypoints(image, kps[(~predict)&(~labels)], None, color= (0, 255, 0) ) # 绿色 正确预测(负样本)
    # image = cv2.drawKeypoints(image, kps[(label)], None, color=(255,0,0,))
    # image = cv2.drawKeypoints(image, kps[~predict], None, color=(0,255,0))
    image = cv2.polylines(image, bboxes, isClosed=True, color=(255, 255, 0), thickness=1)
    cv2.imwrite('vis_dir/'+ args.test_image.split('/')[-1], cv2.cvtColor(image, cv2.COLOR_RGB2BGR))
    return metric_dict, PR_dict

def worker_init_fn(worker_id, group, args):
    # torch.cuda.set_device(worker_id) 指定数加载设备
    torch.cuda.manual_seed_all(worker_id)

def custom_collate_fn(batch):
    rnn_utils = importlib.import_module('torch.nn.utils.rnn')
    results = [item[0] for item in batch]  # 提取每个样本的result
    img_paths = [item[1] for item in batch]  # 提取每个样本的img_path
    padded_results = rnn_utils.pad_sequence(results, batch_first=True, padding_value=0)
    return padded_results, img_paths

def train(model, args):
    CosineAnnealingWarmRestarts = importlib.import_module('torch.optim.lr_scheduler').CosineAnnealingWarmRestarts
    LinearLR = importlib.import_module('torch.optim.lr_scheduler').LinearLR
    MultiStepLR = importlib.import_module('torch.optim.lr_scheduler').MultiStepLR
    ChainedScheduler = importlib.import_module('torch.optim.lr_scheduler').ChainedScheduler
    clip_grad_norm_ = importlib.import_module('torch.nn.utils').clip_grad_norm_
    optimizer_class = importlib.import_module('torch.optim').AdamW
    partial = importlib.import_module('functools').partial
    train_pipeline = []
    if args.image_aug:
        train_pipeline = [
            dict(type='mmdet.LoadImageFromFile', backend_args=None),
            dict(type='mmdet.LoadAnnotations', with_bbox=True, box_type='qbox'),
            dict(
                type='mmrotate.ConvertBoxType',
                box_type_mapping=dict(gt_bboxes='rbox')),
            dict(
                type='mmrotate.RandomRotate',
                prob=0.5,
                angle_range=180,
                rotate_type='mmrotate.Rotate'),
            dict(
                type='mmdet.RandomFlip',
                prob=0.75,
                direction=['horizontal', 'vertical', 'diagonal']),
            dict(
                type='mmdet.RandomAffine',),
            dict(
                type='mmdet.PhotoMetricDistortion',),

            dict(
                type='mmrotate.ConvertBoxType',
                box_type_mapping=dict(gt_bboxes='qbox')),
            dict(type='mmdet.PackDetInputs', meta_keys=())]
    train_dataset = ShipKeyPointsDataset(args, ann_file = args.train_ann_file, dataset_repeat = args.dataset_repeat, pipeline = train_pipeline)
    train_loader = DataLoader(train_dataset, batch_size=args.batch_size, shuffle=True, 
                              num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                              # worker_init_fn=partial(worker_init_fn, group='train', args = args),
                              # pin_memory=True, persistent_workers = True,
                              multiprocessing_context=args.multiprocessing_context)
    eva_loader = {}
    for ann_file in args.test_ann_file:
        SimpleNamespace = importlib.import_module('types').SimpleNamespace
        eval_args = vars(args)
        eval_args['eval'] = True
        eval_args = SimpleNamespace(**eval_args)
        eva_dataset = ShipKeyPointsDataset(args = eval_args, ann_file = ann_file)
        eva_loader[ann_file] = DataLoader(eva_dataset, batch_size=args.batch_size, shuffle=False, 
                                num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                                # worker_init_fn=partial(worker_init_fn, group='eval', args = args), 
                                # pin_memory=True, persistent_workers = True,
                                multiprocessing_context=args.multiprocessing_context)
    if args.print:
        outputs = importlib.import_module('mmengine.analysis').get_model_complexity_info(
            model,
            input_shape=None,
            inputs=train_dataset.__getitem__(0)[0][:,:-2].float().to(args.device),  # the input tensor of the model
            show_table=True,  # show the complexity table
            show_arch=False)  # show the complexity arch
        for k, v in outputs.items():
            args.logger.info(f"{k}: {v}")
    # 定义损失函数和优化器
    weight = torch.softmax(1/torch.tensor([100000.0,  166, 89 , 288 , 25 , 263 , 2053], device = args.device),dim=-1) # [100000.0,  166, 89 , 288 , 25 , 263 , 2053]

    CenterLoss = getattr(importlib.import_module("CenterLoss"), "CenterLoss")
    loss_weight = 20
    centerloss = CenterLoss(len(args.dataset_class) + 1, model.config['output_dim']).to(args.device)
    nllloss = nn.NLLLoss().to(args.device)
    param_groups = [
        {'params': model.parameters(), 'lr': args.lr, 'weight_decay': 1e-4},
        {'params': centerloss.parameters(), 'lr': args.lr, 'weight_decay': 1e-4}
    ]
    optimizer = optimizer_class(param_groups) # 
    # warmup_scheduler = LinearLR(optimizer, start_factor=1.0 / 20, end_factor=1.0, total_iters=args.warmup_step)
    # scheduler = CosineAnnealingWarmRestarts(optimizer, T_0=20, T_mult=2, eta_min = 1e-5)
    scheduler = MultiStepLR(optimizer, milestones=[40, 70, 90], gamma=0.5)
    # scheduler = ChainedScheduler([warmup_scheduler, step_scheduler])

    start_epoch = 0
    best_AP = 0.0
    if os.path.isfile(args.checkpoint):
        checkpoint = torch.load(args.checkpoint)
        model.load_state_dict(checkpoint['model_state_dict'])
        centerloss.load_state_dict(checkpoint['centerloss_state_dict'])
        optimizer.load_state_dict(checkpoint['optimizer_state_dict']),
        scheduler.load_state_dict(checkpoint['scheduler_state_dict'])
        start_epoch = checkpoint['epoch']+1
        best_AP = checkpoint['best_AP']
        args.logger.info(f'Continue training from epoch [{start_epoch}] !')

    # getGPUs = importlib.import_module('GPUtil').getGPUs
    # virtual_memory = importlib.import_module('psutil').virtual_memory
    # collect = importlib.import_module('gc').collect
    for epoch in range(start_epoch, args.num_epochs):
        start_time = time.time()
        model.train()
        for i, (data, img_paths)  in enumerate(train_loader):
            torch.cuda.empty_cache() # 在显存资源有限的情况下使用
            data = data.to(args.device)
            # collect() # 显式垃圾回收
            # memory = virtual_memory()
            # args.logger.info(f"总内存: {memory.total / (1024 ** 3):.2f} GB, 可用内存: {memory.available / (1024 ** 3):.2f} GB, 内存使用率: {memory.percent}%")
            # gpu = getGPUs()[0]
            # args.logger.info(f">>>before: GPU: {gpu.name}, 显存总量: {gpu.memoryTotal}MB, 显存使用: {gpu.memoryUsed}MB, 显存空闲: {gpu.memoryFree}MB")
            feat, outputs = model(data[:,:,:-2])
            # args.logger.info(f">>>after: GPU: {gpu.name}, 显存总量: {gpu.memoryTotal}MB, 显存使用: {gpu.memoryUsed}MB, 显存空闲: {gpu.memoryFree}MB")
            valid = data[:,:,-1].reshape(-1).bool()
            label_inc = data[:,:,-2].long().view(-1)[valid]
            feat = feat.view(-1,model.config['output_dim'])[valid,:]
            outputs = outputs.view(-1,len(args.dataset_class)+1)[valid,:]
            
            # label = nn.functional.one_hot(label_inc, num_classes= len(args.dataset_class) + 1).float()
            
            # if len(args.dataset_class) > 1: # soft_label
            #     softening_value = 0.1
            #     non_background_mask = (label_inc != 0).unsqueeze(dim=-1).repeat(1,len(args.dataset_class)+1)
            #     non_background_mask[...,0] = False
            #     label[non_background_mask] = label[non_background_mask]  * (1 - softening_value) + \
            #                                     (1 - label[non_background_mask]) * softening_value / (len(args.dataset_class)-1)  
                                                          
            # loss_cls = torch.mean(- 0.75*label * ((1-outputs)**2) *torch.log(outputs) - 0.25*((1-label) *(outputs**2)* torch.log(1-outputs)), dim = 0)
            # inter_cls_loss = torch.sum(loss_cls*weight)
            inter_cls_loss = nllloss(torch.log(outputs), label_inc)
            inner_cls_loss = centerloss(feat, label_inc)
            loss = loss_weight * inter_cls_loss + inner_cls_loss
            
            optimizer.zero_grad()
            loss.backward()
            clip_grad_norm_(model.parameters(), 35, 2)
            clip_grad_norm_(centerloss.parameters(), 35, 2)
            optimizer.step()
            del outputs, data, valid
            if (i + 1) % args.print_interval == 0:
                current_time = time.time()
                eta_seconds = (current_time - start_time) / (i+1) * ( (args.num_epochs - epoch ) * len(train_loader) - (i + 1))
                eta_str = str(int(eta_seconds // 3600)) + ':' + str(int((eta_seconds % 3600) // 60)) + ':' + str(int(eta_seconds % 60))
                # loss_str = ' '.join([f"{cls_name}:{loss_value:.4f}" for cls_name,loss_value in zip(['background'] + list(args.dataset_class.keys()), loss_cls)])
                args.logger.info(f"Epoch(train)"
                      f"[{epoch + 1}/{args.num_epochs}][{i + 1}/{len(train_loader)}]"
                      f"lr: {optimizer.param_groups[0]['lr']:.4e}  eta: {eta_str}  " 
                      f"time: {current_time - start_time:.4f}  inter_cls_loss: {inter_cls_loss:.4f} inner_cls_loss: {inner_cls_loss.item():.4f}")
        scheduler.step()
        if ((epoch+1) % args.eval_interval == 0) or (epoch == 0) or (epoch == args.num_epochs-1): # 
            for ann_file in args.test_ann_file: 
                args.logger.info(f"Epoch(test) {ann_file}:")
                metric_dict_all, PR_dict_all = evaluate(model, eva_loader[ann_file], args)

            # 检查是否有更好的模型，如果有，则保存权重
            if metric_dict_all['Average_Precision'] > best_AP:
                best_AP = metric_dict_all['Average_Precision']
                # 保存当前模型的权重
                torch.save(model.state_dict(), args.save_path)
                args.logger.info(f"Best model saved to  {args.save_path} with MD5 {calculate_md5(args.save_path)}, with {args.test_ann_file[-1]} image AP {best_AP:.4f}")
            if (epoch >= args.num_epochs-1):
                last_save_path = 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + '_last_model_weight.pth'
                torch.save(model.state_dict(), last_save_path)
                args.logger.info(f"Last model saved :{last_save_path}")

        if ((epoch+1) % args.save_interval == 0):
            for file_path in glob.glob(args.save_path[:-4] + '*_epoch.pth'):
                os.remove(file_path)
            torch.save({
                'model_state_dict': model.state_dict(),
                'centerloss_state_dict': centerloss.state_dict(),
                'optimizer_state_dict': optimizer.state_dict(),
                'scheduler_state_dict': scheduler.state_dict(),
                'epoch': epoch,
                'best_AP': best_AP,
                }, args.save_path[:-4] + f'_{epoch+1}_epoch.pth')

if __name__ == '__main__':
    args = parse_arguments()

    random.seed(args.random_seed)
    np.random.seed(args.random_seed)
    torch.manual_seed(args.random_seed)
    if torch.cuda.is_available():
        torch.cuda.manual_seed_all(args.random_seed)

    if ('alike' in args.descriptor.lower()) or ('superpoint' in args.descriptor.lower()) or ('hardnet' in args.descriptor.lower()) or ('sosnet' in args.descriptor.lower()):
        args.multiprocessing_context = 'spawn'

    args.feature_booster_pretrained = '' # Path(__file__).parent / str("FeatureBooster/models/" + args.descriptor + ".pth")
    pretrained_str = 'finetune' if os.path.isfile(args.feature_booster_pretrained) else 'scratch'
    args.save_path = args.save_path if len(args.save_path) else 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}_' + f'best_model_weights_{pretrained_str}.pth'
    args.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    args.color = ['#ff0000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff00ff', '#990000', '#999900', '#009900', '#009999'] 
    model = ShipKeyPointsModel(args)
    
    # 创建日志器
    logger = logging.getLogger()
    logger.setLevel(logging.INFO)
    # 创建控制台处理程序
    console_handler = logging.StreamHandler()
    console_handler.setLevel(logging.INFO)
    console_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))    
    logger.addHandler(console_handler)
    args.logger = logger
    if (not args.eval) and (not os.path.isfile(args.test_image)): # train
        args.log_file = args.log_file if len(args.log_file) else 'work_dirs/' + args.data_root.rstrip('/').split('/')[-1] + '_' + args.descriptor + f'_{args.train_ratio*100:.0f}' + f'_dataset_repeat_{args.dataset_repeat}_positive_keypoint_repeat_{args.positive_keypoint_repeat}_{pretrained_str}.log'
        if not os.path.exists(os.path.dirname(args.log_file)):
            os.makedirs(os.path.dirname(args.log_file))
        # 创建文件处理程序
        file_handler = logging.FileHandler(args.log_file, mode='a')
        file_handler.setLevel(logging.INFO)
        file_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))
        # 添加处理程序到日志器
        logger.addHandler(file_handler)
        logger.info(">>>>>=========================Start Train!===========================<<<<<")
        for k, v in vars(args).items():
            if k not in 'logger':
                logger.info(f"{k}: {v}")

        if args.print: 
            with open(__file__, 'r') as file:
                lines = file.readlines()
            with open(args.log_file, "a") as file:   
                for line in lines:
                    file.write(line[:-1]+'\n')
                file.write('\n')
        train(model, args)
        args.logger.info(f"model weights saved to {args.save_path} with MD5 {calculate_md5(args.save_path)}!")
        args.checkpoint = args.save_path
        args.eval = True

    model_weights_md5 = "init_md5"
    if os.path.isfile(args.checkpoint):
        if 'cpu' in args.device.type:
            model.load_state_dict(torch.load(args.checkpoint, map_location=lambda storage, loc:storage), strict=False)
        else:
            model.load_state_dict(torch.load(args.checkpoint), strict=False)
        model_weights_md5 = calculate_md5(args.checkpoint)
        args.logger.info(f"model weights loaded from {args.checkpoint} with MD5 {model_weights_md5}!")
        model_weights_md5 = model_weights_md5[:5]

    if os.path.isfile(args.test_image):
        args.logger.info(f"Epoch(test) - {args.test_image}:")
        metric_dict, PR_dict = test(model, args)
    if args.eval:
        for ann_file in args.test_ann_file:
            args.logger.info(f"Epoch(test) {ann_file}:")
            eva_dataset = ShipKeyPointsDataset(args = args, ann_file = ann_file)
            eva_loader = DataLoader(eva_dataset, batch_size=args.batch_size, shuffle=False, 
                                    num_workers=args.num_workers, collate_fn=custom_collate_fn, 
                                    pin_memory=True, persistent_workers = True, multiprocessing_context=args.multiprocessing_context)
            metric_dict, PR_dict_all = evaluate(model, eva_loader, args)
            if PR_dict_all is not None:
                plt.plot(PR_dict_all['Recall'], PR_dict_all['Precision'])
                # 设置图例和标签
                plt.xlabel('Recall')
                plt.ylabel('Precision')
                plt.title('Precision-Recall Curve')
                plt.legend()
                PR_curve_path = 'work_dirs/' + f'{args.save_path.split("/")[-1][:-4]}_PR_curve_eval_{model_weights_md5}.png'
                plt.savefig(PR_curve_path, bbox_inches='tight', dpi=300)
                plt.close('all') 
                args.logger.info(f"PR_curve has been saved to {PR_curve_path}!"

2023-12-03 22:22:18,128 - INFO - Created a temporary directory at /tmp/tmpj4rz10qd
2023-12-03 22:22:18,129 - INFO - Writing /tmp/tmpj4rz10qd/_remote_module_non_scriptable.py
2023-12-03 22:22:19,167 - INFO - The dataset located in ['train/'] was duplicated 3 times!
2023-12-03 22:22:19,706 - INFO - flops: 236366368
2023-12-03 22:22:19,707 - INFO - flops_str: 0.236G
2023-12-03 22:22:19,707 - INFO - activations: 865249
2023-12-03 22:22:19,707 - INFO - activations_str: 0.865M
2023-12-03 22:22:19,707 - INFO - params: 1988167
2023-12-03 22:22:19,707 - INFO - params_str: 1.988M
2023-12-03 22:22:19,707 - INFO - out_table: 
+---------------------------+----------------------+------------+--------------+
| module                    | #parameters or shape | #flops     | #activations |
+---------------------------+----------------------+------------+--------------+
| model                     | 1.988M               | 0.236G     | 0.865M       |
|  feature_booster          |  1.954M              |  0.232G    |  0.849M      |
|   feature_booster.kenc.e… |   0.109M             |   12.928M  |   87.584K    |
|    feature_booster.kenc.… |    0.128K            |    11.424K |    3.808K    |
|    feature_booster.kenc.… |    2.112K            |    0.244M  |    7.616K    |
|    feature_booster.kenc.… |    8.32K             |    0.975M  |    15.232K   |
|    feature_booster.kenc.… |    33.024K           |    3.899M  |    30.464K   |
|    feature_booster.kenc.… |    65.792K           |    7.799M  |    30.464K   |
|   feature_booster.denc.e… |   0.197M             |   23.396M  |   91.392K    |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|    feature_booster.denc.… |    65.792K           |    7.799M  |    30.464K   |
|   feature_booster.attn_p… |   1.581M             |   0.188G   |   0.64M      |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|    feature_booster.attn_… |    0.527M            |    62.695M |    0.213M    |
|   feature_booster.final_… |   65.792K            |   7.799M   |   30.464K    |
|    feature_booster.final… |    (256, 256)        |            |              |
|    feature_booster.final… |    (256,)            |            |              |
|   feature_booster.layer_… |   0.512K             |   0.152M   |   0          |
|    feature_booster.layer… |    (256,)            |            |              |
|    feature_booster.layer… |    (256,)            |            |              |
|  fc_out                   |  33.799K             |  4.006M    |  16.065K     |
|   fc_out.0                |   32.896K            |   3.899M   |   15.232K    |
|    fc_out.0.weight        |    (128, 256)        |            |              |
|    fc_out.0.bias          |    (128,)            |            |              |
|   fc_out.2                |   0.903K             |   0.107M   |   0.833K     |
|    fc_out.2.weight        |    (7, 128)          |            |              |
|    fc_out.2.bias          |    (7,)              |            |              |
+---------------------------+----------------------+------------+--------------+

2023-12-03 22:22:19,707 - INFO - out_arch: 
2023-12-03 22:22:43,332 - INFO - Epoch(train)[1/100][40/100]lr: 6.0000e-04  eta: 1:38:0  time: 23.6168  inter_cls_loss: 0.6608 inner_cls_loss: 92.5098
2023-12-03 22:23:02,393 - INFO - Epoch(train)[1/100][80/100]lr: 6.0000e-04  eta: 1:28:12  time: 42.6778  inter_cls_loss: 0.1553 inner_cls_loss: 87.3736
2023-12-03 22:23:12,367 - INFO - Epoch(test) test/:
2023-12-03 22:23:21,471 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0385
2023-12-03 22:23:21,618 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0944
2023-12-03 22:23:21,762 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0049
2023-12-03 22:23:21,903 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 22:23:22,084 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0562
2023-12-03 22:23:22,228 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0439
2023-12-03 22:23:22,392 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1628
2023-12-03 22:23:22,392 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0573
2023-12-03 22:23:23,003 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:23:23,036 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 8dcd9d31295a6cc45d24531824514e63, with test/ image AP 0.0573
2023-12-03 22:23:46,427 - INFO - Epoch(train)[2/100][40/100]lr: 6.0000e-04  eta: 1:36:5  time: 23.3899  inter_cls_loss: 0.1112 inner_cls_loss: 81.6745
2023-12-03 22:24:03,556 - INFO - Epoch(train)[2/100][80/100]lr: 6.0000e-04  eta: 1:22:53  time: 40.5199  inter_cls_loss: 0.1428 inner_cls_loss: 78.6280
2023-12-03 22:24:12,631 - INFO - Epoch(test) test/:
2023-12-03 22:24:21,774 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0377
2023-12-03 22:24:21,912 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0770
2023-12-03 22:24:22,052 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0032
2023-12-03 22:24:22,188 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 22:24:22,326 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1646
2023-12-03 22:24:22,467 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0548
2023-12-03 22:24:22,603 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2066
2023-12-03 22:24:22,603 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0777
2023-12-03 22:24:23,254 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:24:23,310 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 75e4e7065d65d6c83b043e1ca4e2bac5, with test/ image AP 0.0777
2023-12-03 22:24:46,841 - INFO - Epoch(train)[3/100][40/100]lr: 6.0000e-04  eta: 1:35:41  time: 23.5303  inter_cls_loss: 0.1285 inner_cls_loss: 73.3828
2023-12-03 22:25:03,118 - INFO - Epoch(train)[3/100][80/100]lr: 6.0000e-04  eta: 1:20:36  time: 39.8077  inter_cls_loss: 0.1778 inner_cls_loss: 70.6454
2023-12-03 22:25:12,150 - INFO - Epoch(test) test/:
2023-12-03 22:25:21,057 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0357
2023-12-03 22:25:21,195 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1730
2023-12-03 22:25:21,339 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0033
2023-12-03 22:25:21,480 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0001
2023-12-03 22:25:21,625 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1136
2023-12-03 22:25:21,770 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0549
2023-12-03 22:25:21,909 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2014
2023-12-03 22:25:21,910 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0831
2023-12-03 22:25:22,647 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:25:22,704 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 158a27d59eee9423f8d5c5a7fd5ab5ff, with test/ image AP 0.0831
2023-12-03 22:25:45,790 - INFO - Epoch(train)[4/100][40/100]lr: 6.0000e-04  eta: 1:32:54  time: 23.0836  inter_cls_loss: 0.1184 inner_cls_loss: 65.8851
2023-12-03 22:26:03,025 - INFO - Epoch(train)[4/100][80/100]lr: 6.0000e-04  eta: 1:20:48  time: 40.3207  inter_cls_loss: 0.0860 inner_cls_loss: 62.8595
2023-12-03 22:26:12,836 - INFO - Epoch(test) test/:
2023-12-03 22:26:21,921 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0352
2023-12-03 22:26:22,065 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1673
2023-12-03 22:26:22,207 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0033
2023-12-03 22:26:22,353 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0002
2023-12-03 22:26:22,501 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0946
2023-12-03 22:26:22,649 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0565
2023-12-03 22:26:22,802 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1970
2023-12-03 22:26:22,802 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0791
2023-12-03 22:26:23,636 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:26:47,172 - INFO - Epoch(train)[5/100][40/100]lr: 6.0000e-04  eta: 1:33:44  time: 23.5320  inter_cls_loss: 0.1586 inner_cls_loss: 59.4079
2023-12-03 22:27:05,310 - INFO - Epoch(train)[5/100][80/100]lr: 6.0000e-04  eta: 1:22:39  time: 41.6732  inter_cls_loss: 0.1959 inner_cls_loss: 57.2317
2023-12-03 22:27:14,513 - INFO - Epoch(test) test/:
2023-12-03 22:27:23,524 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0383
2023-12-03 22:27:23,663 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1691
2023-12-03 22:27:23,803 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0031
2023-12-03 22:27:23,939 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0002
2023-12-03 22:27:24,080 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0977
2023-12-03 22:27:24,221 - INFO - Metrics for Container: Accuracy: 0.9861, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0569
2023-12-03 22:27:24,361 - INFO - Metrics for foreground: Accuracy: 0.9719, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2036
2023-12-03 22:27:24,361 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0813
2023-12-03 22:27:25,178 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:27:47,865 - INFO - Epoch(train)[6/100][40/100]lr: 6.0000e-04  eta: 1:29:25  time: 22.6864  inter_cls_loss: 0.1727 inner_cls_loss: 53.0708
2023-12-03 22:28:05,533 - INFO - Epoch(train)[6/100][80/100]lr: 6.0000e-04  eta: 1:19:11  time: 40.3524  inter_cls_loss: 0.1129 inner_cls_loss: 50.6992
2023-12-03 22:28:14,514 - INFO - Epoch(test) test/:
2023-12-03 22:28:23,737 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0565
2023-12-03 22:28:23,887 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1224
2023-12-03 22:28:24,038 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0065
2023-12-03 22:28:24,186 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0008
2023-12-03 22:28:24,337 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2146
2023-12-03 22:28:24,490 - INFO - Metrics for Container: Accuracy: 0.9848, Precision: 0.2169, Recall: 0.0349, F1_score: 0.0602, Average_Precision: 0.1245
2023-12-03 22:28:24,646 - INFO - Metrics for foreground: Accuracy: 0.9736, Precision: 0.8881, Recall: 0.0708, F1_score: 0.1311, Average_Precision: 0.3863
2023-12-03 22:28:24,647 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.1579, Recall: 0.0151, F1_score: 0.0273, Average_Precision: 0.1302
2023-12-03 22:28:25,806 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:28:25,852 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 1ca983251e5082ad78e729d2e1bf216a, with test/ image AP 0.1302
2023-12-03 22:28:50,192 - INFO - Epoch(train)[7/100][40/100]lr: 6.0000e-04  eta: 1:34:55  time: 24.3400  inter_cls_loss: 0.1617 inner_cls_loss: 47.9889
2023-12-03 22:29:10,119 - INFO - Epoch(train)[7/100][80/100]lr: 6.0000e-04  eta: 1:25:56  time: 44.2648  inter_cls_loss: 0.1299 inner_cls_loss: 45.7274
2023-12-03 22:29:18,810 - INFO - Epoch(test) test/:
2023-12-03 22:29:27,713 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0570
2023-12-03 22:29:27,863 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1070
2023-12-03 22:29:28,010 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0084
2023-12-03 22:29:28,153 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0019
2023-12-03 22:29:28,302 - INFO - Metrics for Dredger: Accuracy: 0.9953, Precision: 0.4070, Recall: 0.3229, F1_score: 0.3601, Average_Precision: 0.2723
2023-12-03 22:29:28,454 - INFO - Metrics for Container: Accuracy: 0.9845, Precision: 0.3399, Recall: 0.1217, F1_score: 0.1793, Average_Precision: 0.1845
2023-12-03 22:29:28,607 - INFO - Metrics for foreground: Accuracy: 0.9765, Precision: 0.7799, Recall: 0.2289, F1_score: 0.3539, Average_Precision: 0.4517
2023-12-03 22:29:28,608 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.2181, Recall: 0.0962, F1_score: 0.1276, Average_Precision: 0.1547
2023-12-03 22:29:29,776 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:29:29,835 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 b88940a1dae649d99d60830ff2dc946a, with test/ image AP 0.1547
2023-12-03 22:29:53,848 - INFO - Epoch(train)[8/100][40/100]lr: 6.0000e-04  eta: 1:32:38  time: 24.0114  inter_cls_loss: 0.1406 inner_cls_loss: 42.8121
2023-12-03 22:30:12,731 - INFO - Epoch(train)[8/100][80/100]lr: 6.0000e-04  eta: 1:22:23  time: 42.8957  inter_cls_loss: 0.1024 inner_cls_loss: 40.7955
2023-12-03 22:30:22,226 - INFO - Epoch(test) test/:
2023-12-03 22:30:31,048 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0484
2023-12-03 22:30:31,193 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1265
2023-12-03 22:30:31,338 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0088
2023-12-03 22:30:31,480 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0021
2023-12-03 22:30:31,622 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2503
2023-12-03 22:30:31,768 - INFO - Metrics for Container: Accuracy: 0.9832, Precision: 0.3218, Recall: 0.1878, F1_score: 0.2372, Average_Precision: 0.2273
2023-12-03 22:30:31,910 - INFO - Metrics for foreground: Accuracy: 0.9767, Precision: 0.7942, Recall: 0.2294, F1_score: 0.3560, Average_Precision: 0.5020
2023-12-03 22:30:31,910 - INFO - Average metrics: Accuracy: 0.9922, Precision: 0.1594, Recall: 0.0596, F1_score: 0.0847, Average_Precision: 0.1665
2023-12-03 22:30:33,024 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:30:33,079 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 e7fe145e4b5125188e7b112f55f980b4, with test/ image AP 0.1665
2023-12-03 22:30:55,184 - INFO - Epoch(train)[9/100][40/100]lr: 6.0000e-04  eta: 1:24:21  time: 22.1034  inter_cls_loss: 0.0962 inner_cls_loss: 38.1704
2023-12-03 22:31:12,245 - INFO - Epoch(train)[9/100][80/100]lr: 6.0000e-04  eta: 1:14:24  time: 39.1653  inter_cls_loss: 0.1139 inner_cls_loss: 36.6759
2023-12-03 22:31:21,153 - INFO - Epoch(test) test/:
2023-12-03 22:31:29,855 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0498
2023-12-03 22:31:30,000 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1289
2023-12-03 22:31:30,142 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0096
2023-12-03 22:31:30,279 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0024
2023-12-03 22:31:30,416 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1904
2023-12-03 22:31:30,555 - INFO - Metrics for Container: Accuracy: 0.9840, Precision: 0.3157, Recall: 0.1272, F1_score: 0.1813, Average_Precision: 0.2424
2023-12-03 22:31:30,692 - INFO - Metrics for foreground: Accuracy: 0.9762, Precision: 0.8794, Recall: 0.1754, F1_score: 0.2924, Average_Precision: 0.5247
2023-12-03 22:31:30,692 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.1707, Recall: 0.0432, F1_score: 0.0677, Average_Precision: 0.1640
2023-12-03 22:31:31,784 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:31:54,415 - INFO - Epoch(train)[10/100][40/100]lr: 6.0000e-04  eta: 1:25:25  time: 22.6296  inter_cls_loss: 0.1359 inner_cls_loss: 34.4664
2023-12-03 22:32:11,139 - INFO - Epoch(train)[10/100][80/100]lr: 6.0000e-04  eta: 1:13:56  time: 39.3523  inter_cls_loss: 0.1389 inner_cls_loss: 33.0017
2023-12-03 22:32:20,113 - INFO - Epoch(test) test/:
2023-12-03 22:32:28,985 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0625
2023-12-03 22:32:29,126 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1358
2023-12-03 22:32:29,265 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0096
2023-12-03 22:32:29,404 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0030
2023-12-03 22:32:29,544 - INFO - Metrics for Dredger: Accuracy: 0.9959, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2233
2023-12-03 22:32:29,686 - INFO - Metrics for Container: Accuracy: 0.9836, Precision: 0.3123, Recall: 0.1512, F1_score: 0.2038, Average_Precision: 0.2410
2023-12-03 22:32:29,827 - INFO - Metrics for foreground: Accuracy: 0.9767, Precision: 0.8534, Recall: 0.2045, F1_score: 0.3300, Average_Precision: 0.5415
2023-12-03 22:32:29,827 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.1665, Recall: 0.0508, F1_score: 0.0762, Average_Precision: 0.1738
2023-12-03 22:32:31,137 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:32:31,190 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 257d4e2fe79c656d529d8893f60d7aea, with test/ image AP 0.1738
2023-12-03 22:32:53,642 - INFO - Epoch(train)[11/100][40/100]lr: 6.0000e-04  eta: 1:23:39  time: 22.4065  inter_cls_loss: 0.2154 inner_cls_loss: 31.0755
2023-12-03 22:33:11,872 - INFO - Epoch(train)[11/100][80/100]lr: 6.0000e-04  eta: 1:15:31  time: 40.6383  inter_cls_loss: 0.0806 inner_cls_loss: 29.1235
2023-12-03 22:33:21,048 - INFO - Epoch(test) test/:
2023-12-03 22:33:29,672 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0607
2023-12-03 22:33:29,817 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1607
2023-12-03 22:33:29,958 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0110
2023-12-03 22:33:30,105 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0029
2023-12-03 22:33:30,244 - INFO - Metrics for Dredger: Accuracy: 0.9937, Precision: 0.2025, Recall: 0.1790, F1_score: 0.1900, Average_Precision: 0.2563
2023-12-03 22:33:30,385 - INFO - Metrics for Container: Accuracy: 0.9845, Precision: 0.2494, Recall: 0.0562, F1_score: 0.0918, Average_Precision: 0.2395
2023-12-03 22:33:30,525 - INFO - Metrics for foreground: Accuracy: 0.9769, Precision: 0.8677, Recall: 0.2091, F1_score: 0.3370, Average_Precision: 0.5633
2023-12-03 22:33:30,526 - INFO - Average metrics: Accuracy: 0.9921, Precision: 0.1885, Recall: 0.0635, F1_score: 0.0884, Average_Precision: 0.1849
2023-12-03 22:33:31,616 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:33:31,670 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 d091cdc481a01eacc792a088d951377c, with test/ image AP 0.1849
2023-12-03 22:33:55,003 - INFO - Epoch(train)[12/100][40/100]lr: 6.0000e-04  eta: 1:26:7  time: 23.3312  inter_cls_loss: 0.0723 inner_cls_loss: 27.2967
2023-12-03 22:34:11,240 - INFO - Epoch(train)[12/100][80/100]lr: 6.0000e-04  eta: 1:12:42  time: 39.5679  inter_cls_loss: 0.0975 inner_cls_loss: 26.2035
2023-12-03 22:34:20,710 - INFO - Epoch(test) test/:
2023-12-03 22:34:29,344 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0600
2023-12-03 22:34:29,489 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2518
2023-12-03 22:34:29,628 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0129
2023-12-03 22:34:29,766 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0032
2023-12-03 22:34:29,907 - INFO - Metrics for Dredger: Accuracy: 0.9939, Precision: 0.2125, Recall: 0.1753, F1_score: 0.1921, Average_Precision: 0.1952
2023-12-03 22:34:30,056 - INFO - Metrics for Container: Accuracy: 0.9841, Precision: 0.3267, Recall: 0.1354, F1_score: 0.1914, Average_Precision: 0.2638
2023-12-03 22:34:30,201 - INFO - Metrics for foreground: Accuracy: 0.9781, Precision: 0.8375, Recall: 0.2729, F1_score: 0.4117, Average_Precision: 0.5903
2023-12-03 22:34:30,201 - INFO - Average metrics: Accuracy: 0.9923, Precision: 0.1967, Recall: 0.0834, F1_score: 0.1136, Average_Precision: 0.1967
2023-12-03 22:34:31,318 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:34:31,374 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 80c93a7db8c1d2e24981a01439ee9598, with test/ image AP 0.1967
2023-12-03 22:34:53,293 - INFO - Epoch(train)[13/100][40/100]lr: 6.0000e-04  eta: 1:20:0  time: 21.9181  inter_cls_loss: 0.0977 inner_cls_loss: 24.5942
2023-12-03 22:35:11,371 - INFO - Epoch(train)[13/100][80/100]lr: 6.0000e-04  eta: 1:12:39  time: 39.9943  inter_cls_loss: 0.1062 inner_cls_loss: 23.5267
2023-12-03 22:35:19,695 - INFO - Epoch(test) test/:
2023-12-03 22:35:28,810 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0710
2023-12-03 22:35:28,946 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2302
2023-12-03 22:35:29,082 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0131
2023-12-03 22:35:29,219 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0034
2023-12-03 22:35:29,358 - INFO - Metrics for Dredger: Accuracy: 0.9941, Precision: 0.2099, Recall: 0.1568, F1_score: 0.1795, Average_Precision: 0.1740
2023-12-03 22:35:29,505 - INFO - Metrics for Container: Accuracy: 0.9844, Precision: 0.3813, Recall: 0.1954, F1_score: 0.2584, Average_Precision: 0.2754
2023-12-03 22:35:29,646 - INFO - Metrics for foreground: Accuracy: 0.9786, Precision: 0.8289, Recall: 0.3010, F1_score: 0.4416, Average_Precision: 0.6020
2023-12-03 22:35:29,646 - INFO - Average metrics: Accuracy: 0.9924, Precision: 0.2029, Recall: 0.0933, F1_score: 0.1256, Average_Precision: 0.1956
2023-12-03 22:35:30,720 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:35:53,093 - INFO - Epoch(train)[14/100][40/100]lr: 6.0000e-04  eta: 1:20:43  time: 22.3720  inter_cls_loss: 0.0888 inner_cls_loss: 21.8828
2023-12-03 22:36:11,154 - INFO - Epoch(train)[14/100][80/100]lr: 6.0000e-04  eta: 1:12:36  time: 40.4331  inter_cls_loss: 0.1933 inner_cls_loss: 21.2674
2023-12-03 22:36:21,010 - INFO - Epoch(test) test/:
2023-12-03 22:36:29,580 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0957
2023-12-03 22:36:29,734 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2125
2023-12-03 22:36:29,877 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0378
2023-12-03 22:36:30,015 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0030
2023-12-03 22:36:30,160 - INFO - Metrics for Dredger: Accuracy: 0.9944, Precision: 0.2742, Recall: 0.2140, F1_score: 0.2404, Average_Precision: 0.2589
2023-12-03 22:36:30,308 - INFO - Metrics for Container: Accuracy: 0.9818, Precision: 0.3502, Recall: 0.3581, F1_score: 0.3541, Average_Precision: 0.2799
2023-12-03 22:36:30,453 - INFO - Metrics for foreground: Accuracy: 0.9791, Precision: 0.7060, Recall: 0.4380, F1_score: 0.5406, Average_Precision: 0.6031
2023-12-03 22:36:30,453 - INFO - Average metrics: Accuracy: 0.9922, Precision: 0.1901, Recall: 0.1443, F1_score: 0.1622, Average_Precision: 0.2130
2023-12-03 22:36:31,537 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:36:31,589 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 2b04144a1bbeb01f50046b890f6dde10, with test/ image AP 0.2130
2023-12-03 22:36:53,502 - INFO - Epoch(train)[15/100][40/100]lr: 6.0000e-04  eta: 1:18:9  time: 21.9128  inter_cls_loss: 0.1080 inner_cls_loss: 19.5276
2023-12-03 22:37:10,902 - INFO - Epoch(train)[15/100][80/100]lr: 6.0000e-04  eta: 1:9:46  time: 39.3129  inter_cls_loss: 0.1046 inner_cls_loss: 18.7436
2023-12-03 22:37:19,589 - INFO - Epoch(test) test/:
2023-12-03 22:37:28,011 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1125
2023-12-03 22:37:28,151 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.3024
2023-12-03 22:37:28,293 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0393
2023-12-03 22:37:28,434 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0027
2023-12-03 22:37:28,576 - INFO - Metrics for Dredger: Accuracy: 0.9937, Precision: 0.2289, Recall: 0.2251, F1_score: 0.2270, Average_Precision: 0.1726
2023-12-03 22:37:28,718 - INFO - Metrics for Container: Accuracy: 0.9830, Precision: 0.3750, Recall: 0.3291, F1_score: 0.3506, Average_Precision: 0.2794
2023-12-03 22:37:28,858 - INFO - Metrics for foreground: Accuracy: 0.9800, Precision: 0.7506, Recall: 0.4342, F1_score: 0.5502, Average_Precision: 0.6222
2023-12-03 22:37:28,858 - INFO - Average metrics: Accuracy: 0.9924, Precision: 0.1935, Recall: 0.1412, F1_score: 0.1611, Average_Precision: 0.2187
2023-12-03 22:37:29,947 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:37:29,994 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 3ba6b81393f0e219c7676125ed8a338b, with test/ image AP 0.2187
2023-12-03 22:37:53,060 - INFO - Epoch(train)[16/100][40/100]lr: 6.0000e-04  eta: 1:21:18  time: 23.0658  inter_cls_loss: 0.0484 inner_cls_loss: 17.1444
2023-12-03 22:38:09,164 - INFO - Epoch(train)[16/100][80/100]lr: 6.0000e-04  eta: 1:8:42  time: 39.1692  inter_cls_loss: 0.0645 inner_cls_loss: 16.4511
2023-12-03 22:38:17,430 - INFO - Epoch(test) test/:
2023-12-03 22:38:25,991 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0921
2023-12-03 22:38:26,132 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1826
2023-12-03 22:38:26,273 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1035
2023-12-03 22:38:26,413 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0026
2023-12-03 22:38:26,554 - INFO - Metrics for Dredger: Accuracy: 0.9951, Precision: 0.3212, Recall: 0.1624, F1_score: 0.2157, Average_Precision: 0.2222
2023-12-03 22:38:26,699 - INFO - Metrics for Container: Accuracy: 0.9772, Precision: 0.3150, Recall: 0.5442, F1_score: 0.3990, Average_Precision: 0.2743
2023-12-03 22:38:26,844 - INFO - Metrics for foreground: Accuracy: 0.9786, Precision: 0.6284, Recall: 0.5839, F1_score: 0.6053, Average_Precision: 0.6312
2023-12-03 22:38:26,845 - INFO - Average metrics: Accuracy: 0.9916, Precision: 0.1807, Recall: 0.1844, F1_score: 0.1743, Average_Precision: 0.2155
2023-12-03 22:38:27,959 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:38:50,763 - INFO - Epoch(train)[17/100][40/100]lr: 6.0000e-04  eta: 1:19:25  time: 22.8031  inter_cls_loss: 0.0912 inner_cls_loss: 15.3976
2023-12-03 22:39:09,754 - INFO - Epoch(train)[17/100][80/100]lr: 6.0000e-04  eta: 1:12:26  time: 41.7943  inter_cls_loss: 0.0855 inner_cls_loss: 14.6919
2023-12-03 22:39:19,115 - INFO - Epoch(test) test/:
2023-12-03 22:39:27,639 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1062
2023-12-03 22:39:27,779 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2345
2023-12-03 22:39:27,918 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0882
2023-12-03 22:39:28,056 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0036
2023-12-03 22:39:28,199 - INFO - Metrics for Dredger: Accuracy: 0.9948, Precision: 0.3817, Recall: 0.4225, F1_score: 0.4011, Average_Precision: 0.2782
2023-12-03 22:39:28,350 - INFO - Metrics for Container: Accuracy: 0.9824, Precision: 0.3880, Recall: 0.4585, F1_score: 0.4203, Average_Precision: 0.3220
2023-12-03 22:39:28,494 - INFO - Metrics for foreground: Accuracy: 0.9804, Precision: 0.7024, Recall: 0.5247, F1_score: 0.6007, Average_Precision: 0.6334
2023-12-03 22:39:28,494 - INFO - Average metrics: Accuracy: 0.9925, Precision: 0.2103, Recall: 0.2008, F1_score: 0.2031, Average_Precision: 0.2380
2023-12-03 22:39:29,561 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:39:29,614 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 78c5fa279b3eae038da24b2d0d5a059a, with test/ image AP 0.2380
2023-12-03 22:39:51,691 - INFO - Epoch(train)[18/100][40/100]lr: 6.0000e-04  eta: 1:15:58  time: 22.0768  inter_cls_loss: 0.0655 inner_cls_loss: 13.6913
2023-12-03 22:40:08,325 - INFO - Epoch(train)[18/100][80/100]lr: 6.0000e-04  eta: 1:6:17  time: 38.7083  inter_cls_loss: 0.1185 inner_cls_loss: 13.0798
2023-12-03 22:40:16,883 - INFO - Epoch(test) test/:
2023-12-03 22:40:25,439 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1014
2023-12-03 22:40:25,578 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1693
2023-12-03 22:40:25,723 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.8235, Recall: 0.0940, F1_score: 0.1687, Average_Precision: 0.2061
2023-12-03 22:40:25,860 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0030
2023-12-03 22:40:26,004 - INFO - Metrics for Dredger: Accuracy: 0.9949, Precision: 0.3483, Recall: 0.2712, F1_score: 0.3050, Average_Precision: 0.2395
2023-12-03 22:40:26,150 - INFO - Metrics for Container: Accuracy: 0.9830, Precision: 0.3986, Recall: 0.4421, F1_score: 0.4193, Average_Precision: 0.3236
2023-12-03 22:40:26,289 - INFO - Metrics for foreground: Accuracy: 0.9812, Precision: 0.7467, Recall: 0.4985, F1_score: 0.5979, Average_Precision: 0.6444
2023-12-03 22:40:26,289 - INFO - Average metrics: Accuracy: 0.9927, Precision: 0.3310, Recall: 0.1865, F1_score: 0.2130, Average_Precision: 0.2410
2023-12-03 22:40:27,381 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:40:27,435 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 37abc119c23b06d94fbeda44656e06fe, with test/ image AP 0.2410
2023-12-03 22:40:49,470 - INFO - Epoch(train)[19/100][40/100]lr: 6.0000e-04  eta: 1:14:54  time: 22.0333  inter_cls_loss: 0.0631 inner_cls_loss: 12.0820
2023-12-03 22:41:05,878 - INFO - Epoch(train)[19/100][80/100]lr: 6.0000e-04  eta: 1:5:1  time: 38.4412  inter_cls_loss: 0.0898 inner_cls_loss: 11.5763
2023-12-03 22:41:14,714 - INFO - Epoch(test) test/:
2023-12-03 22:41:23,619 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0801
2023-12-03 22:41:23,766 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2564
2023-12-03 22:41:23,919 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3767, Recall: 0.3691, F1_score: 0.3729, Average_Precision: 0.1796
2023-12-03 22:41:24,063 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0028
2023-12-03 22:41:24,202 - INFO - Metrics for Dredger: Accuracy: 0.9950, Precision: 0.3907, Recall: 0.3727, F1_score: 0.3815, Average_Precision: 0.3833
2023-12-03 22:41:24,344 - INFO - Metrics for Container: Accuracy: 0.9823, Precision: 0.3976, Recall: 0.5257, F1_score: 0.4528, Average_Precision: 0.3544
2023-12-03 22:41:24,483 - INFO - Metrics for foreground: Accuracy: 0.9808, Precision: 0.6908, Recall: 0.5758, F1_score: 0.6281, Average_Precision: 0.6440
2023-12-03 22:41:24,483 - INFO - Average metrics: Accuracy: 0.9925, Precision: 0.2651, Recall: 0.2633, F1_score: 0.2622, Average_Precision: 0.2715
2023-12-03 22:41:25,573 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:41:25,627 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 bd3047262e43b233f3691646068237d8, with test/ image AP 0.2715
2023-12-03 22:41:47,899 - INFO - Epoch(train)[20/100][40/100]lr: 6.0000e-04  eta: 1:14:47  time: 22.2696  inter_cls_loss: 0.1060 inner_cls_loss: 10.8919
2023-12-03 22:42:04,301 - INFO - Epoch(train)[20/100][80/100]lr: 6.0000e-04  eta: 1:4:36  time: 38.6731  inter_cls_loss: 0.0812 inner_cls_loss: 10.2001
2023-12-03 22:42:13,051 - INFO - Epoch(test) test/:
2023-12-03 22:42:21,542 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0816
2023-12-03 22:42:21,686 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1714
2023-12-03 22:42:21,824 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4569, Recall: 0.3557, F1_score: 0.4000, Average_Precision: 0.3060
2023-12-03 22:42:21,963 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0040
2023-12-03 22:42:22,103 - INFO - Metrics for Dredger: Accuracy: 0.9957, Precision: 0.4781, Recall: 0.4834, F1_score: 0.4807, Average_Precision: 0.4163
2023-12-03 22:42:22,249 - INFO - Metrics for Container: Accuracy: 0.9821, Precision: 0.3953, Recall: 0.5475, F1_score: 0.4591, Average_Precision: 0.3758
2023-12-03 22:42:22,395 - INFO - Metrics for foreground: Accuracy: 0.9803, Precision: 0.6720, Recall: 0.5812, F1_score: 0.6233, Average_Precision: 0.6450
2023-12-03 22:42:22,395 - INFO - Average metrics: Accuracy: 0.9926, Precision: 0.2860, Recall: 0.2811, F1_score: 0.2805, Average_Precision: 0.2857
2023-12-03 22:42:23,489 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:42:23,539 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 0421ec47f97c221b84b28314f2a0e06f, with test/ image AP 0.2857
2023-12-03 22:42:45,666 - INFO - Epoch(train)[21/100][40/100]lr: 6.0000e-04  eta: 1:13:13  time: 22.0765  inter_cls_loss: 0.0546 inner_cls_loss: 9.3571
2023-12-03 22:43:02,302 - INFO - Epoch(train)[21/100][80/100]lr: 6.0000e-04  eta: 1:3:52  time: 38.7105  inter_cls_loss: 0.0710 inner_cls_loss: 9.0721
2023-12-03 22:43:11,079 - INFO - Epoch(test) test/:
2023-12-03 22:43:19,804 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0731
2023-12-03 22:43:19,942 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1408
2023-12-03 22:43:20,086 - INFO - Metrics for Fishing: Accuracy: 0.9974, Precision: 0.2256, Recall: 0.5436, F1_score: 0.3189, Average_Precision: 0.1931
2023-12-03 22:43:20,230 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0025
2023-12-03 22:43:20,371 - INFO - Metrics for Dredger: Accuracy: 0.9953, Precision: 0.4333, Recall: 0.4317, F1_score: 0.4325, Average_Precision: 0.3625
2023-12-03 22:43:20,515 - INFO - Metrics for Container: Accuracy: 0.9807, Precision: 0.3665, Recall: 0.5349, F1_score: 0.4350, Average_Precision: 0.3177
2023-12-03 22:43:20,656 - INFO - Metrics for foreground: Accuracy: 0.9793, Precision: 0.6359, Recall: 0.6139, F1_score: 0.6247, Average_Precision: 0.6486
2023-12-03 22:43:20,656 - INFO - Average metrics: Accuracy: 0.9920, Precision: 0.2373, Recall: 0.3035, F1_score: 0.2587, Average_Precision: 0.2483
2023-12-03 22:43:21,781 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:43:44,825 - INFO - Epoch(train)[22/100][40/100]lr: 6.0000e-04  eta: 1:15:27  time: 23.0431  inter_cls_loss: 0.0611 inner_cls_loss: 8.3355
2023-12-03 22:44:02,527 - INFO - Epoch(train)[22/100][80/100]lr: 6.0000e-04  eta: 1:6:22  time: 40.7441  inter_cls_loss: 0.0534 inner_cls_loss: 7.9159
2023-12-03 22:44:11,378 - INFO - Epoch(test) test/:
2023-12-03 22:44:20,087 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0988
2023-12-03 22:44:20,230 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1742
2023-12-03 22:44:20,373 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3874, Recall: 0.4966, F1_score: 0.4353, Average_Precision: 0.3050
2023-12-03 22:44:20,515 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0033
2023-12-03 22:44:20,661 - INFO - Metrics for Dredger: Accuracy: 0.9952, Precision: 0.4279, Recall: 0.4705, F1_score: 0.4482, Average_Precision: 0.3511
2023-12-03 22:44:20,813 - INFO - Metrics for Container: Accuracy: 0.9830, Precision: 0.4097, Recall: 0.5076, F1_score: 0.4534, Average_Precision: 0.3812
2023-12-03 22:44:20,956 - INFO - Metrics for foreground: Accuracy: 0.9814, Precision: 0.7049, Recall: 0.5823, F1_score: 0.6378, Average_Precision: 0.6552
2023-12-03 22:44:20,956 - INFO - Average metrics: Accuracy: 0.9927, Precision: 0.2757, Recall: 0.2939, F1_score: 0.2821, Average_Precision: 0.2813
2023-12-03 22:44:22,044 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:44:44,592 - INFO - Epoch(train)[23/100][40/100]lr: 6.0000e-04  eta: 1:12:53  time: 22.5459  inter_cls_loss: 0.0494 inner_cls_loss: 7.2899
2023-12-03 22:45:02,025 - INFO - Epoch(train)[23/100][80/100]lr: 6.0000e-04  eta: 1:4:17  time: 39.9788  inter_cls_loss: 0.0526 inner_cls_loss: 7.0253
2023-12-03 22:45:11,303 - INFO - Epoch(test) test/:
2023-12-03 22:45:20,096 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0862
2023-12-03 22:45:20,243 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.2295
2023-12-03 22:45:20,386 - INFO - Metrics for Fishing: Accuracy: 0.9984, Precision: 0.3277, Recall: 0.3893, F1_score: 0.3558, Average_Precision: 0.1960
2023-12-03 22:45:20,530 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0038
2023-12-03 22:45:20,677 - INFO - Metrics for Dredger: Accuracy: 0.9945, Precision: 0.3779, Recall: 0.5369, F1_score: 0.4436, Average_Precision: 0.4096
2023-12-03 22:45:20,826 - INFO - Metrics for Container: Accuracy: 0.9849, Precision: 0.4549, Recall: 0.4269, F1_score: 0.4404, Average_Precision: 0.3725
2023-12-03 22:45:20,972 - INFO - Metrics for foreground: Accuracy: 0.9820, Precision: 0.7502, Recall: 0.5404, F1_score: 0.6282, Average_Precision: 0.6435
2023-12-03 22:45:20,973 - INFO - Average metrics: Accuracy: 0.9930, Precision: 0.2730, Recall: 0.2705, F1_score: 0.2669, Average_Precision: 0.2773
2023-12-03 22:45:22,089 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:45:45,280 - INFO - Epoch(train)[24/100][40/100]lr: 6.0000e-04  eta: 1:14:0  time: 23.1869  inter_cls_loss: 0.0491 inner_cls_loss: 6.4874
2023-12-03 22:46:02,740 - INFO - Epoch(train)[24/100][80/100]lr: 6.0000e-04  eta: 1:4:32  time: 40.6511  inter_cls_loss: 0.1062 inner_cls_loss: 6.2979
2023-12-03 22:46:11,360 - INFO - Epoch(test) test/:
2023-12-03 22:46:20,205 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0931
2023-12-03 22:46:20,356 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.4538, Recall: 0.1987, F1_score: 0.2763, Average_Precision: 0.2667
2023-12-03 22:46:20,504 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.4104, Recall: 0.4765, F1_score: 0.4410, Average_Precision: 0.2352
2023-12-03 22:46:20,651 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0033
2023-12-03 22:46:20,797 - INFO - Metrics for Dredger: Accuracy: 0.9953, Precision: 0.4434, Recall: 0.5203, F1_score: 0.4788, Average_Precision: 0.4289
2023-12-03 22:46:20,945 - INFO - Metrics for Container: Accuracy: 0.9839, Precision: 0.4386, Recall: 0.5497, F1_score: 0.4879, Average_Precision: 0.3558
2023-12-03 22:46:21,095 - INFO - Metrics for foreground: Accuracy: 0.9819, Precision: 0.7045, Recall: 0.6158, F1_score: 0.6572, Average_Precision: 0.6547
2023-12-03 22:46:21,096 - INFO - Average metrics: Accuracy: 0.9930, Precision: 0.3501, Recall: 0.3373, F1_score: 0.3345, Average_Precision: 0.2911
2023-12-03 22:46:22,224 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:46:22,283 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 6eda1347ea32f0ada14ad0883d40a5c7, with test/ image AP 0.2911
2023-12-03 22:46:45,801 - INFO - Epoch(train)[25/100][40/100]lr: 6.0000e-04  eta: 1:14:4  time: 23.5164  inter_cls_loss: 0.0617 inner_cls_loss: 5.7124
2023-12-03 22:47:03,959 - INFO - Epoch(train)[25/100][80/100]lr: 6.0000e-04  eta: 1:5:17  time: 41.6756  inter_cls_loss: 0.0402 inner_cls_loss: 5.2941
2023-12-03 22:47:13,706 - INFO - Epoch(test) test/:
2023-12-03 22:47:22,318 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0803
2023-12-03 22:47:22,462 - INFO - Metrics for Cell-Container: Accuracy: 0.9974, Precision: 0.3904, Recall: 0.2458, F1_score: 0.3017, Average_Precision: 0.3517
2023-12-03 22:47:22,601 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5000, Recall: 0.1812, F1_score: 0.2660, Average_Precision: 0.1923
2023-12-03 22:47:22,740 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0036
2023-12-03 22:47:22,882 - INFO - Metrics for Dredger: Accuracy: 0.9930, Precision: 0.3207, Recall: 0.6255, F1_score: 0.4240, Average_Precision: 0.3980
2023-12-03 22:47:23,028 - INFO - Metrics for Container: Accuracy: 0.9834, Precision: 0.4049, Recall: 0.4099, F1_score: 0.4074, Average_Precision: 0.3332
2023-12-03 22:47:23,168 - INFO - Metrics for foreground: Accuracy: 0.9813, Precision: 0.6968, Recall: 0.5936, F1_score: 0.6411, Average_Precision: 0.6434
2023-12-03 22:47:23,168 - INFO - Average metrics: Accuracy: 0.9925, Precision: 0.3304, Recall: 0.2937, F1_score: 0.2914, Average_Precision: 0.2861
2023-12-03 22:47:24,274 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:47:46,002 - INFO - Epoch(train)[26/100][40/100]lr: 6.0000e-04  eta: 1:7:31  time: 21.7257  inter_cls_loss: 0.0524 inner_cls_loss: 4.9378
2023-12-03 22:48:04,693 - INFO - Epoch(train)[26/100][80/100]lr: 6.0000e-04  eta: 1:2:28  time: 40.4182  inter_cls_loss: 0.0443 inner_cls_loss: 4.6715
2023-12-03 22:48:14,521 - INFO - Epoch(test) test/:
2023-12-03 22:48:23,073 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.1289
2023-12-03 22:48:23,217 - INFO - Metrics for Cell-Container: Accuracy: 0.9979, Precision: 0.6296, Recall: 0.1145, F1_score: 0.1937, Average_Precision: 0.3170
2023-12-03 22:48:23,356 - INFO - Metrics for Fishing: Accuracy: 0.9981, Precision: 0.3208, Recall: 0.5705, F1_score: 0.4106, Average_Precision: 0.3305
2023-12-03 22:48:23,493 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0030
2023-12-03 22:48:23,634 - INFO - Metrics for Dredger: Accuracy: 0.9957, Precision: 0.4567, Recall: 0.1753, F1_score: 0.2533, Average_Precision: 0.3664
2023-12-03 22:48:23,779 - INFO - Metrics for Container: Accuracy: 0.9838, Precision: 0.4309, Recall: 0.5224, F1_score: 0.4722, Average_Precision: 0.3505
2023-12-03 22:48:23,919 - INFO - Metrics for foreground: Accuracy: 0.9826, Precision: 0.7566, Recall: 0.5617, F1_score: 0.6448, Average_Precision: 0.6603
2023-12-03 22:48:23,919 - INFO - Average metrics: Accuracy: 0.9931, Precision: 0.3707, Recall: 0.2778, F1_score: 0.2821, Average_Precision: 0.3081
2023-12-03 22:48:25,005 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:48:25,062 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 7724ece1cd53c964589bdf4784fa6da4, with test/ image AP 0.3081
2023-12-03 22:48:47,805 - INFO - Epoch(train)[27/100][40/100]lr: 6.0000e-04  eta: 1:9:44  time: 22.7429  inter_cls_loss: 0.0701 inner_cls_loss: 4.4958
2023-12-03 22:49:05,192 - INFO - Epoch(train)[27/100][80/100]lr: 6.0000e-04  eta: 1:1:11  time: 40.1301  inter_cls_loss: 0.0794 inner_cls_loss: 4.1212
2023-12-03 22:49:13,989 - INFO - Epoch(test) test/:
2023-12-03 22:49:22,720 - INFO - Metrics for ore-oil: Accuracy: 0.9935, Precision: 0.5455, Recall: 0.0278, F1_score: 0.0529, Average_Precision: 0.1480
2023-12-03 22:49:22,861 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.3750, Recall: 0.0101, F1_score: 0.0197, Average_Precision: 0.2931
2023-12-03 22:49:23,008 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.3281, Recall: 0.1409, F1_score: 0.1972, Average_Precision: 0.2017
2023-12-03 22:49:23,153 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0029
2023-12-03 22:49:23,298 - INFO - Metrics for Dredger: Accuracy: 0.9951, Precision: 0.4117, Recall: 0.4557, F1_score: 0.4326, Average_Precision: 0.3892
2023-12-03 22:49:23,445 - INFO - Metrics for Container: Accuracy: 0.9849, Precision: 0.4619, Recall: 0.5027, F1_score: 0.4814, Average_Precision: 0.3799
2023-12-03 22:49:23,590 - INFO - Metrics for foreground: Accuracy: 0.9832, Precision: 0.7734, Recall: 0.5663, F1_score: 0.6539, Average_Precision: 0.6693
2023-12-03 22:49:23,590 - INFO - Average metrics: Accuracy: 0.9933, Precision: 0.4137, Recall: 0.2434, F1_score: 0.2625, Average_Precision: 0.2977
2023-12-03 22:49:28,018 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:49:49,679 - INFO - Epoch(train)[28/100][40/100]lr: 6.0000e-04  eta: 1:5:31  time: 21.6608  inter_cls_loss: 0.0491 inner_cls_loss: 3.8560
2023-12-03 22:50:07,686 - INFO - Epoch(train)[28/100][80/100]lr: 6.0000e-04  eta: 0:59:39  time: 39.6661  inter_cls_loss: 0.0566 inner_cls_loss: 3.6078
2023-12-03 22:50:15,823 - INFO - Epoch(test) test/:
2023-12-03 22:50:24,640 - INFO - Metrics for ore-oil: Accuracy: 0.9907, Precision: 0.1426, Recall: 0.0833, F1_score: 0.1052, Average_Precision: 0.1096
2023-12-03 22:50:24,784 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.5000, Recall: 0.1751, F1_score: 0.2594, Average_Precision: 0.3636
2023-12-03 22:50:24,927 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3786, Recall: 0.5235, F1_score: 0.4394, Average_Precision: 0.2786
2023-12-03 22:50:25,071 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0027
2023-12-03 22:50:25,218 - INFO - Metrics for Dredger: Accuracy: 0.9960, Precision: 0.5161, Recall: 0.5037, F1_score: 0.5098, Average_Precision: 0.4535
2023-12-03 22:50:25,364 - INFO - Metrics for Container: Accuracy: 0.9839, Precision: 0.4186, Recall: 0.4072, F1_score: 0.4128, Average_Precision: 0.3520
2023-12-03 22:50:25,515 - INFO - Metrics for foreground: Accuracy: 0.9821, Precision: 0.7153, Recall: 0.6042, F1_score: 0.6550, Average_Precision: 0.6410
2023-12-03 22:50:25,515 - INFO - Average metrics: Accuracy: 0.9927, Precision: 0.3816, Recall: 0.3281, F1_score: 0.3402, Average_Precision: 0.3144
2023-12-03 22:50:26,623 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:50:26,676 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 589ea75f0aee65259ddb8c1699cdbabb, with test/ image AP 0.3144
2023-12-03 22:50:49,998 - INFO - Epoch(train)[29/100][40/100]lr: 6.0000e-04  eta: 1:9:34  time: 23.3198  inter_cls_loss: 0.0617 inner_cls_loss: 3.3593
2023-12-03 22:51:08,775 - INFO - Epoch(train)[29/100][80/100]lr: 6.0000e-04  eta: 1:2:26  time: 42.0982  inter_cls_loss: 0.0586 inner_cls_loss: 3.1038
2023-12-03 22:51:17,811 - INFO - Epoch(test) test/:
2023-12-03 22:51:26,602 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.2766, Recall: 0.0301, F1_score: 0.0543, Average_Precision: 0.0840
2023-12-03 22:51:26,749 - INFO - Metrics for Cell-Container: Accuracy: 0.9975, Precision: 0.4134, Recall: 0.2492, F1_score: 0.3109, Average_Precision: 0.3963
2023-12-03 22:51:26,909 - INFO - Metrics for Fishing: Accuracy: 0.9981, Precision: 0.3103, Recall: 0.5436, F1_score: 0.3951, Average_Precision: 0.3360
2023-12-03 22:51:27,062 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0031
2023-12-03 22:51:27,210 - INFO - Metrics for Dredger: Accuracy: 0.9962, Precision: 0.5514, Recall: 0.4649, F1_score: 0.5045, Average_Precision: 0.4706
2023-12-03 22:51:27,364 - INFO - Metrics for Container: Accuracy: 0.9839, Precision: 0.4351, Recall: 0.5322, F1_score: 0.4788, Average_Precision: 0.3479
2023-12-03 22:51:27,512 - INFO - Metrics for foreground: Accuracy: 0.9807, Precision: 0.6795, Recall: 0.5934, F1_score: 0.6335, Average_Precision: 0.6361
2023-12-03 22:51:27,512 - INFO - Average metrics: Accuracy: 0.9928, Precision: 0.3809, Recall: 0.3448, F1_score: 0.3396, Average_Precision: 0.3248
2023-12-03 22:51:28,610 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:51:28,667 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 6fe5f82a3ed2ed843ade121fc20bb67f, with test/ image AP 0.3248
2023-12-03 22:51:51,393 - INFO - Epoch(train)[30/100][40/100]lr: 6.0000e-04  eta: 1:6:50  time: 22.7251  inter_cls_loss: 0.0438 inner_cls_loss: 2.8450
2023-12-03 22:52:08,430 - INFO - Epoch(train)[30/100][80/100]lr: 6.0000e-04  eta: 0:58:9  time: 39.7626  inter_cls_loss: 0.0483 inner_cls_loss: 2.7045
2023-12-03 22:52:16,705 - INFO - Epoch(test) test/:
2023-12-03 22:52:25,534 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.3729, Recall: 0.0255, F1_score: 0.0477, Average_Precision: 0.1365
2023-12-03 22:52:25,682 - INFO - Metrics for Cell-Container: Accuracy: 0.9978, Precision: 0.5385, Recall: 0.2357, F1_score: 0.3279, Average_Precision: 0.3992
2023-12-03 22:52:25,831 - INFO - Metrics for Fishing: Accuracy: 0.9984, Precision: 0.3519, Recall: 0.5101, F1_score: 0.4164, Average_Precision: 0.2527
2023-12-03 22:52:25,976 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0037
2023-12-03 22:52:26,129 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6771, Recall: 0.4797, F1_score: 0.5616, Average_Precision: 0.5067
2023-12-03 22:52:26,282 - INFO - Metrics for Container: Accuracy: 0.9818, Precision: 0.3977, Recall: 0.5933, F1_score: 0.4762, Average_Precision: 0.3814
2023-12-03 22:52:26,424 - INFO - Metrics for foreground: Accuracy: 0.9800, Precision: 0.6522, Recall: 0.6206, F1_score: 0.6360, Average_Precision: 0.6264
2023-12-03 22:52:26,424 - INFO - Average metrics: Accuracy: 0.9926, Precision: 0.4272, Recall: 0.3521, F1_score: 0.3523, Average_Precision: 0.3295
2023-12-03 22:52:27,513 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:52:27,565 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 91122c5520b9c83db4b86d64859fcc5d, with test/ image AP 0.3295
2023-12-03 22:52:50,663 - INFO - Epoch(train)[31/100][40/100]lr: 6.0000e-04  eta: 1:6:50  time: 23.0508  inter_cls_loss: 0.0363 inner_cls_loss: 2.4634
2023-12-03 22:53:09,144 - INFO - Epoch(train)[31/100][80/100]lr: 6.0000e-04  eta: 0:59:52  time: 41.5337  inter_cls_loss: 0.0415 inner_cls_loss: 2.3499
2023-12-03 22:53:18,695 - INFO - Epoch(test) test/:
2023-12-03 22:53:27,506 - INFO - Metrics for ore-oil: Accuracy: 0.9936, Precision: 0.5509, Recall: 0.1065, F1_score: 0.1785, Average_Precision: 0.1842
2023-12-03 22:53:27,650 - INFO - Metrics for Cell-Container: Accuracy: 0.9979, Precision: 0.5833, Recall: 0.1886, F1_score: 0.2850, Average_Precision: 0.3698
2023-12-03 22:53:27,792 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3143, Recall: 0.2215, F1_score: 0.2598, Average_Precision: 0.3216
2023-12-03 22:53:27,936 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0034
2023-12-03 22:53:28,079 - INFO - Metrics for Dredger: Accuracy: 0.9964, Precision: 0.6087, Recall: 0.3616, F1_score: 0.4537, Average_Precision: 0.4866
2023-12-03 22:53:28,227 - INFO - Metrics for Container: Accuracy: 0.9845, Precision: 0.4527, Recall: 0.5491, F1_score: 0.4963, Average_Precision: 0.3877
2023-12-03 22:53:28,370 - INFO - Metrics for foreground: Accuracy: 0.9830, Precision: 0.7500, Recall: 0.5901, F1_score: 0.6605, Average_Precision: 0.6750
2023-12-03 22:53:28,370 - INFO - Average metrics: Accuracy: 0.9934, Precision: 0.4657, Recall: 0.2882, F1_score: 0.3334, Average_Precision: 0.3469
2023-12-03 22:53:32,814 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:53:32,861 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 f996c27914478308364be14effa58f7c, with test/ image AP 0.3469
2023-12-03 22:53:55,709 - INFO - Epoch(train)[32/100][40/100]lr: 6.0000e-04  eta: 1:5:18  time: 22.8468  inter_cls_loss: 0.0429 inner_cls_loss: 2.1357
2023-12-03 22:54:12,143 - INFO - Epoch(train)[32/100][80/100]lr: 6.0000e-04  eta: 0:55:48  time: 39.2816  inter_cls_loss: 0.0181 inner_cls_loss: 1.9704
2023-12-03 22:54:20,772 - INFO - Epoch(test) test/:
2023-12-03 22:54:29,310 - INFO - Metrics for ore-oil: Accuracy: 0.9921, Precision: 0.3025, Recall: 0.1516, F1_score: 0.2020, Average_Precision: 0.1683
2023-12-03 22:54:29,454 - INFO - Metrics for Cell-Container: Accuracy: 0.9980, Precision: 0.6491, Recall: 0.2492, F1_score: 0.3601, Average_Precision: 0.4188
2023-12-03 22:54:29,600 - INFO - Metrics for Fishing: Accuracy: 0.9984, Precision: 0.3518, Recall: 0.4698, F1_score: 0.4023, Average_Precision: 0.3419
2023-12-03 22:54:29,745 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0041
2023-12-03 22:54:29,892 - INFO - Metrics for Dredger: Accuracy: 0.9968, Precision: 0.6780, Recall: 0.4041, F1_score: 0.5064, Average_Precision: 0.4991
2023-12-03 22:54:30,047 - INFO - Metrics for Container: Accuracy: 0.9854, Precision: 0.4777, Recall: 0.5388, F1_score: 0.5064, Average_Precision: 0.4268
2023-12-03 22:54:30,194 - INFO - Metrics for foreground: Accuracy: 0.9823, Precision: 0.7190, Recall: 0.6090, F1_score: 0.6594, Average_Precision: 0.6596
2023-12-03 22:54:30,194 - INFO - Average metrics: Accuracy: 0.9933, Precision: 0.4540, Recall: 0.3461, F1_score: 0.3767, Average_Precision: 0.3598
2023-12-03 22:54:31,314 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:54:31,365 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 179085fa9152335a6e27ee7b0cb62465, with test/ image AP 0.3598
2023-12-03 22:54:54,810 - INFO - Epoch(train)[33/100][40/100]lr: 6.0000e-04  eta: 1:6:2  time: 23.4439  inter_cls_loss: 0.0588 inner_cls_loss: 1.9541
2023-12-03 22:55:13,168 - INFO - Epoch(train)[33/100][80/100]lr: 6.0000e-04  eta: 0:58:31  time: 41.8007  inter_cls_loss: 0.0464 inner_cls_loss: 1.7249
2023-12-03 22:55:21,639 - INFO - Epoch(test) test/:
2023-12-03 22:55:30,378 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.3643, Recall: 0.1227, F1_score: 0.1835, Average_Precision: 0.1461
2023-12-03 22:55:30,526 - INFO - Metrics for Cell-Container: Accuracy: 0.9979, Precision: 0.5372, Recall: 0.5354, F1_score: 0.5363, Average_Precision: 0.4910
2023-12-03 22:55:30,671 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4160, Recall: 0.3490, F1_score: 0.3796, Average_Precision: 0.3231
2023-12-03 22:55:30,813 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0043
2023-12-03 22:55:30,969 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.7522, Recall: 0.4760, F1_score: 0.5831, Average_Precision: 0.5693
2023-12-03 22:55:31,115 - INFO - Metrics for Container: Accuracy: 0.9867, Precision: 0.5222, Recall: 0.5453, F1_score: 0.5335, Average_Precision: 0.4655
2023-12-03 22:55:31,258 - INFO - Metrics for foreground: Accuracy: 0.9829, Precision: 0.7439, Recall: 0.5966, F1_score: 0.6622, Average_Precision: 0.6613
2023-12-03 22:55:31,258 - INFO - Average metrics: Accuracy: 0.9937, Precision: 0.4765, Recall: 0.3750, F1_score: 0.4112, Average_Precision: 0.3801
2023-12-03 22:55:35,651 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:55:35,704 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 a44fc69f0be991524f10b141e3bc7f9f, with test/ image AP 0.3801
2023-12-03 22:55:58,550 - INFO - Epoch(train)[34/100][40/100]lr: 6.0000e-04  eta: 1:3:23  time: 22.8452  inter_cls_loss: 0.0238 inner_cls_loss: 1.5202
2023-12-03 22:56:15,770 - INFO - Epoch(train)[34/100][80/100]lr: 6.0000e-04  eta: 0:55:15  time: 40.0642  inter_cls_loss: 0.0273 inner_cls_loss: 1.4589
2023-12-03 22:56:25,065 - INFO - Epoch(test) test/:
2023-12-03 22:56:33,879 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.3675, Recall: 0.1412, F1_score: 0.2040, Average_Precision: 0.1302
2023-12-03 22:56:34,023 - INFO - Metrics for Cell-Container: Accuracy: 0.9975, Precision: 0.4400, Recall: 0.4074, F1_score: 0.4231, Average_Precision: 0.4106
2023-12-03 22:56:34,163 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.4126, Recall: 0.5705, F1_score: 0.4789, Average_Precision: 0.3308
2023-12-03 22:56:34,303 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0054
2023-12-03 22:56:34,444 - INFO - Metrics for Dredger: Accuracy: 0.9963, Precision: 0.6016, Recall: 0.2731, F1_score: 0.3756, Average_Precision: 0.4551
2023-12-03 22:56:34,588 - INFO - Metrics for Container: Accuracy: 0.9820, Precision: 0.3962, Recall: 0.5666, F1_score: 0.4663, Average_Precision: 0.3993
2023-12-03 22:56:34,733 - INFO - Metrics for foreground: Accuracy: 0.9801, Precision: 0.6469, Recall: 0.6431, F1_score: 0.6450, Average_Precision: 0.6557
2023-12-03 22:56:34,733 - INFO - Average metrics: Accuracy: 0.9924, Precision: 0.4093, Recall: 0.3717, F1_score: 0.3704, Average_Precision: 0.3410
2023-12-03 22:56:35,836 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:56:58,443 - INFO - Epoch(train)[35/100][40/100]lr: 6.0000e-04  eta: 1:1:47  time: 22.6066  inter_cls_loss: 0.0259 inner_cls_loss: 1.3286
2023-12-03 22:57:15,181 - INFO - Epoch(train)[35/100][80/100]lr: 6.0000e-04  eta: 0:53:26  time: 39.3445  inter_cls_loss: 0.0153 inner_cls_loss: 1.2328
2023-12-03 22:57:23,773 - INFO - Epoch(test) test/:
2023-12-03 22:57:32,729 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.4604, Recall: 0.1412, F1_score: 0.2161, Average_Precision: 0.2125
2023-12-03 22:57:32,876 - INFO - Metrics for Cell-Container: Accuracy: 0.9978, Precision: 0.5209, Recall: 0.3771, F1_score: 0.4375, Average_Precision: 0.3957
2023-12-03 22:57:33,027 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4366, Recall: 0.4161, F1_score: 0.4261, Average_Precision: 0.2966
2023-12-03 22:57:33,174 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0045
2023-12-03 22:57:33,323 - INFO - Metrics for Dredger: Accuracy: 0.9963, Precision: 0.5515, Recall: 0.5627, F1_score: 0.5571, Average_Precision: 0.5763
2023-12-03 22:57:33,490 - INFO - Metrics for Container: Accuracy: 0.9867, Precision: 0.5242, Recall: 0.4727, F1_score: 0.4971, Average_Precision: 0.4357
2023-12-03 22:57:33,649 - INFO - Metrics for foreground: Accuracy: 0.9828, Precision: 0.7545, Recall: 0.5763, F1_score: 0.6535, Average_Precision: 0.6556
2023-12-03 22:57:33,650 - INFO - Average metrics: Accuracy: 0.9936, Precision: 0.4640, Recall: 0.3637, F1_score: 0.3982, Average_Precision: 0.3682
2023-12-03 22:57:38,016 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:58:00,878 - INFO - Epoch(train)[36/100][40/100]lr: 6.0000e-04  eta: 1:1:31  time: 22.8605  inter_cls_loss: 0.0302 inner_cls_loss: 1.1617
2023-12-03 22:58:17,566 - INFO - Epoch(train)[36/100][80/100]lr: 6.0000e-04  eta: 0:52:53  time: 39.5456  inter_cls_loss: 0.0317 inner_cls_loss: 1.0574
2023-12-03 22:58:26,324 - INFO - Epoch(test) test/:
2023-12-03 22:58:35,222 - INFO - Metrics for ore-oil: Accuracy: 0.9936, Precision: 0.5538, Recall: 0.1609, F1_score: 0.2493, Average_Precision: 0.2395
2023-12-03 22:58:35,372 - INFO - Metrics for Cell-Container: Accuracy: 0.9980, Precision: 0.5530, Recall: 0.4916, F1_score: 0.5205, Average_Precision: 0.4159
2023-12-03 22:58:35,520 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4805, Recall: 0.4966, F1_score: 0.4884, Average_Precision: 0.3715
2023-12-03 22:58:35,670 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0059
2023-12-03 22:58:35,821 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6897, Recall: 0.5332, F1_score: 0.6015, Average_Precision: 0.5442
2023-12-03 22:58:35,974 - INFO - Metrics for Container: Accuracy: 0.9869, Precision: 0.5249, Recall: 0.5862, F1_score: 0.5539, Average_Precision: 0.5035
2023-12-03 22:58:36,124 - INFO - Metrics for foreground: Accuracy: 0.9833, Precision: 0.7390, Recall: 0.6258, F1_score: 0.6777, Average_Precision: 0.6780
2023-12-03 22:58:36,124 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.5059, Recall: 0.4135, F1_score: 0.4416, Average_Precision: 0.3941
2023-12-03 22:58:40,552 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:58:40,597 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 aced0a76194610e951da37b1df2787ad, with test/ image AP 0.3941
2023-12-03 22:59:03,272 - INFO - Epoch(train)[37/100][40/100]lr: 6.0000e-04  eta: 1:0:5  time: 22.6753  inter_cls_loss: 0.0172 inner_cls_loss: 0.9375
2023-12-03 22:59:22,128 - INFO - Epoch(train)[37/100][80/100]lr: 6.0000e-04  eta: 0:54:40  time: 41.5313  inter_cls_loss: 0.0108 inner_cls_loss: 0.8711
2023-12-03 22:59:32,144 - INFO - Epoch(test) test/:
2023-12-03 22:59:40,946 - INFO - Metrics for ore-oil: Accuracy: 0.9934, Precision: 0.4883, Recall: 0.1690, F1_score: 0.2511, Average_Precision: 0.2476
2023-12-03 22:59:41,091 - INFO - Metrics for Cell-Container: Accuracy: 0.9976, Precision: 0.4661, Recall: 0.3939, F1_score: 0.4270, Average_Precision: 0.4096
2023-12-03 22:59:41,242 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3886, Recall: 0.5034, F1_score: 0.4386, Average_Precision: 0.3793
2023-12-03 22:59:41,390 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0044
2023-12-03 22:59:41,542 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6881, Recall: 0.5332, F1_score: 0.6008, Average_Precision: 0.5993
2023-12-03 22:59:41,699 - INFO - Metrics for Container: Accuracy: 0.9868, Precision: 0.5234, Recall: 0.5606, F1_score: 0.5414, Average_Precision: 0.4755
2023-12-03 22:59:41,846 - INFO - Metrics for foreground: Accuracy: 0.9833, Precision: 0.7411, Recall: 0.6258, F1_score: 0.6786, Average_Precision: 0.6473
2023-12-03 22:59:41,847 - INFO - Average metrics: Accuracy: 0.9938, Precision: 0.4708, Recall: 0.3980, F1_score: 0.4196, Average_Precision: 0.3947
2023-12-03 22:59:46,231 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 22:59:46,284 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 0d88b5df4c967306672cfc25d9e4fb30, with test/ image AP 0.3947
2023-12-03 23:00:09,641 - INFO - Epoch(train)[38/100][40/100]lr: 6.0000e-04  eta: 1:0:55  time: 23.3547  inter_cls_loss: 0.0263 inner_cls_loss: 0.8015
2023-12-03 23:00:26,350 - INFO - Epoch(train)[38/100][80/100]lr: 6.0000e-04  eta: 0:51:55  time: 40.0660  inter_cls_loss: 0.0173 inner_cls_loss: 0.7289
2023-12-03 23:00:34,442 - INFO - Epoch(test) test/:
2023-12-03 23:00:43,353 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4069, Recall: 0.1921, F1_score: 0.2610, Average_Precision: 0.2078
2023-12-03 23:00:43,497 - INFO - Metrics for Cell-Container: Accuracy: 0.9980, Precision: 0.5920, Recall: 0.3468, F1_score: 0.4374, Average_Precision: 0.3637
2023-12-03 23:00:43,644 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.6296, Recall: 0.2282, F1_score: 0.3350, Average_Precision: 0.3920
2023-12-03 23:00:43,788 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0080
2023-12-03 23:00:43,931 - INFO - Metrics for Dredger: Accuracy: 0.9968, Precision: 0.6160, Recall: 0.5978, F1_score: 0.6067, Average_Precision: 0.5304
2023-12-03 23:00:44,079 - INFO - Metrics for Container: Accuracy: 0.9852, Precision: 0.4750, Recall: 0.5955, F1_score: 0.5285, Average_Precision: 0.4953
2023-12-03 23:00:44,218 - INFO - Metrics for foreground: Accuracy: 0.9826, Precision: 0.7040, Recall: 0.6579, F1_score: 0.6802, Average_Precision: 0.6494
2023-12-03 23:00:44,219 - INFO - Average metrics: Accuracy: 0.9935, Precision: 0.4890, Recall: 0.3741, F1_score: 0.4070, Average_Precision: 0.3781
2023-12-03 23:00:48,733 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:01:12,090 - INFO - Epoch(train)[39/100][40/100]lr: 6.0000e-04  eta: 0:59:56  time: 23.3544  inter_cls_loss: 0.0302 inner_cls_loss: 0.6976
2023-12-03 23:01:28,483 - INFO - Epoch(train)[39/100][80/100]lr: 6.0000e-04  eta: 0:50:40  time: 39.7483  inter_cls_loss: 0.0211 inner_cls_loss: 0.6560
2023-12-03 23:01:37,094 - INFO - Epoch(test) test/:
2023-12-03 23:01:45,981 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.4722, Recall: 0.1377, F1_score: 0.2133, Average_Precision: 0.1867
2023-12-03 23:01:46,133 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6097, Recall: 0.5522, F1_score: 0.5795, Average_Precision: 0.4961
2023-12-03 23:01:46,280 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4570, Recall: 0.5705, F1_score: 0.5075, Average_Precision: 0.3414
2023-12-03 23:01:46,443 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0067
2023-12-03 23:01:46,595 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.7662, Recall: 0.4594, F1_score: 0.5744, Average_Precision: 0.5937
2023-12-03 23:01:46,755 - INFO - Metrics for Container: Accuracy: 0.9864, Precision: 0.5116, Recall: 0.5317, F1_score: 0.5214, Average_Precision: 0.4704
2023-12-03 23:01:46,909 - INFO - Metrics for foreground: Accuracy: 0.9836, Precision: 0.7633, Recall: 0.6055, F1_score: 0.6753, Average_Precision: 0.6478
2023-12-03 23:01:46,909 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.5114, Recall: 0.4081, F1_score: 0.4388, Average_Precision: 0.3918
2023-12-03 23:01:51,339 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:02:14,397 - INFO - Epoch(train)[40/100][40/100]lr: 6.0000e-04  eta: 0:58:13  time: 23.0576  inter_cls_loss: 0.0156 inner_cls_loss: 0.5738
2023-12-03 23:02:32,307 - INFO - Epoch(train)[40/100][80/100]lr: 6.0000e-04  eta: 0:51:22  time: 40.9659  inter_cls_loss: 0.0279 inner_cls_loss: 0.5427
2023-12-03 23:02:40,581 - INFO - Epoch(test) test/:
2023-12-03 23:02:49,189 - INFO - Metrics for ore-oil: Accuracy: 0.9936, Precision: 0.5345, Recall: 0.1701, F1_score: 0.2581, Average_Precision: 0.2330
2023-12-03 23:02:49,331 - INFO - Metrics for Cell-Container: Accuracy: 0.9977, Precision: 0.4873, Recall: 0.4512, F1_score: 0.4685, Average_Precision: 0.4513
2023-12-03 23:02:49,474 - INFO - Metrics for Fishing: Accuracy: 0.9977, Precision: 0.2546, Recall: 0.5570, F1_score: 0.3495, Average_Precision: 0.2900
2023-12-03 23:02:49,619 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0064
2023-12-03 23:02:49,764 - INFO - Metrics for Dredger: Accuracy: 0.9968, Precision: 0.6067, Recall: 0.5978, F1_score: 0.6022, Average_Precision: 0.5637
2023-12-03 23:02:49,909 - INFO - Metrics for Container: Accuracy: 0.9880, Precision: 0.5881, Recall: 0.4629, F1_score: 0.5180, Average_Precision: 0.4787
2023-12-03 23:02:50,054 - INFO - Metrics for foreground: Accuracy: 0.9837, Precision: 0.7731, Recall: 0.5958, F1_score: 0.6730, Average_Precision: 0.6665
2023-12-03 23:02:50,054 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.4635, Recall: 0.4050, F1_score: 0.4099, Average_Precision: 0.3842
2023-12-03 23:02:54,406 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:03:17,139 - INFO - Epoch(train)[41/100][40/100]lr: 3.0000e-04  eta: 0:56:19  time: 22.6834  inter_cls_loss: 0.0314 inner_cls_loss: 0.5064
2023-12-03 23:03:34,104 - INFO - Epoch(train)[41/100][80/100]lr: 3.0000e-04  eta: 0:48:53  time: 39.6484  inter_cls_loss: 0.0166 inner_cls_loss: 0.4633
2023-12-03 23:03:42,763 - INFO - Epoch(test) test/:
2023-12-03 23:03:51,443 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4090, Recall: 0.2315, F1_score: 0.2956, Average_Precision: 0.2247
2023-12-03 23:03:51,580 - INFO - Metrics for Cell-Container: Accuracy: 0.9979, Precision: 0.5390, Recall: 0.4882, F1_score: 0.5124, Average_Precision: 0.4228
2023-12-03 23:03:51,716 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5496, Recall: 0.4832, F1_score: 0.5143, Average_Precision: 0.3155
2023-12-03 23:03:51,853 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0055
2023-12-03 23:03:51,993 - INFO - Metrics for Dredger: Accuracy: 0.9962, Precision: 0.5334, Recall: 0.6476, F1_score: 0.5850, Average_Precision: 0.5507
2023-12-03 23:03:52,136 - INFO - Metrics for Container: Accuracy: 0.9880, Precision: 0.5727, Recall: 0.5311, F1_score: 0.5511, Average_Precision: 0.5235
2023-12-03 23:03:52,272 - INFO - Metrics for foreground: Accuracy: 0.9835, Precision: 0.7360, Recall: 0.6455, F1_score: 0.6878, Average_Precision: 0.6558
2023-12-03 23:03:52,272 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.4771, Recall: 0.4324, F1_score: 0.4495, Average_Precision: 0.3855
2023-12-03 23:03:56,578 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:04:20,163 - INFO - Epoch(train)[42/100][40/100]lr: 3.0000e-04  eta: 0:57:35  time: 23.5842  inter_cls_loss: 0.0071 inner_cls_loss: 0.4347
2023-12-03 23:04:37,076 - INFO - Epoch(train)[42/100][80/100]lr: 3.0000e-04  eta: 0:49:6  time: 40.4954  inter_cls_loss: 0.0385 inner_cls_loss: 0.4689
2023-12-03 23:04:45,819 - INFO - Epoch(test) test/:
2023-12-03 23:04:54,312 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4171, Recall: 0.2095, F1_score: 0.2789, Average_Precision: 0.2497
2023-12-03 23:04:54,452 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6340, Recall: 0.5657, F1_score: 0.5979, Average_Precision: 0.4405
2023-12-03 23:04:54,599 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5211, Recall: 0.4966, F1_score: 0.5086, Average_Precision: 0.4166
2023-12-03 23:04:54,747 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0065
2023-12-03 23:04:54,892 - INFO - Metrics for Dredger: Accuracy: 0.9968, Precision: 0.6222, Recall: 0.5683, F1_score: 0.5940, Average_Precision: 0.5522
2023-12-03 23:04:55,046 - INFO - Metrics for Container: Accuracy: 0.9885, Precision: 0.5898, Recall: 0.5611, F1_score: 0.5751, Average_Precision: 0.5145
2023-12-03 23:04:55,187 - INFO - Metrics for foreground: Accuracy: 0.9840, Precision: 0.7590, Recall: 0.6315, F1_score: 0.6894, Average_Precision: 0.6553
2023-12-03 23:04:55,187 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5062, Recall: 0.4332, F1_score: 0.4634, Average_Precision: 0.4051
2023-12-03 23:04:59,401 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:04:59,447 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 a8b75b4686979b17c79a79df6b64c830, with test/ image AP 0.4051
2023-12-03 23:05:22,644 - INFO - Epoch(train)[43/100][40/100]lr: 3.0000e-04  eta: 0:55:39  time: 23.1925  inter_cls_loss: 0.0308 inner_cls_loss: 0.4108
2023-12-03 23:05:41,380 - INFO - Epoch(train)[43/100][80/100]lr: 3.0000e-04  eta: 0:49:58  time: 41.9323  inter_cls_loss: 0.0180 inner_cls_loss: 0.4080
2023-12-03 23:05:50,336 - INFO - Epoch(test) test/:
2023-12-03 23:05:59,112 - INFO - Metrics for ore-oil: Accuracy: 0.9932, Precision: 0.4615, Recall: 0.1944, F1_score: 0.2736, Average_Precision: 0.2459
2023-12-03 23:05:59,257 - INFO - Metrics for Cell-Container: Accuracy: 0.9981, Precision: 0.6209, Recall: 0.4411, F1_score: 0.5157, Average_Precision: 0.4889
2023-12-03 23:05:59,397 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4852, Recall: 0.5503, F1_score: 0.5157, Average_Precision: 0.4445
2023-12-03 23:05:59,539 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0069
2023-12-03 23:05:59,680 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.6914, Recall: 0.5664, F1_score: 0.6227, Average_Precision: 0.5823
2023-12-03 23:05:59,825 - INFO - Metrics for Container: Accuracy: 0.9876, Precision: 0.5529, Recall: 0.5819, F1_score: 0.5670, Average_Precision: 0.5007
2023-12-03 23:05:59,964 - INFO - Metrics for foreground: Accuracy: 0.9840, Precision: 0.7555, Recall: 0.6360, F1_score: 0.6906, Average_Precision: 0.6526
2023-12-03 23:05:59,964 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.5096, Recall: 0.4243, F1_score: 0.4551, Average_Precision: 0.4174
2023-12-03 23:06:04,294 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:06:04,341 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 c1a74825af579b05eef1bdb0db6cebb9, with test/ image AP 0.4174
2023-12-03 23:06:27,174 - INFO - Epoch(train)[44/100][40/100]lr: 3.0000e-04  eta: 0:53:50  time: 22.8326  inter_cls_loss: 0.0226 inner_cls_loss: 0.3994
2023-12-03 23:06:43,926 - INFO - Epoch(train)[44/100][80/100]lr: 3.0000e-04  eta: 0:46:20  time: 39.5844  inter_cls_loss: 0.0233 inner_cls_loss: 0.3510
2023-12-03 23:06:52,662 - INFO - Epoch(test) test/:
2023-12-03 23:07:01,362 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4169, Recall: 0.2060, F1_score: 0.2758, Average_Precision: 0.2399
2023-12-03 23:07:01,501 - INFO - Metrics for Cell-Container: Accuracy: 0.9985, Precision: 0.7358, Recall: 0.5253, F1_score: 0.6130, Average_Precision: 0.5377
2023-12-03 23:07:01,643 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5182, Recall: 0.4765, F1_score: 0.4965, Average_Precision: 0.4277
2023-12-03 23:07:01,783 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0056
2023-12-03 23:07:01,926 - INFO - Metrics for Dredger: Accuracy: 0.9973, Precision: 0.6955, Recall: 0.5941, F1_score: 0.6408, Average_Precision: 0.6044
2023-12-03 23:07:02,077 - INFO - Metrics for Container: Accuracy: 0.9880, Precision: 0.5631, Recall: 0.5988, F1_score: 0.5804, Average_Precision: 0.5253
2023-12-03 23:07:02,221 - INFO - Metrics for foreground: Accuracy: 0.9836, Precision: 0.7414, Recall: 0.6385, F1_score: 0.6861, Average_Precision: 0.6582
2023-12-03 23:07:02,221 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.5244, Recall: 0.4342, F1_score: 0.4704, Average_Precision: 0.4284
2023-12-03 23:07:06,579 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:07:06,628 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 8265921994958ce554286ee5653d066f, with test/ image AP 0.4284
2023-12-03 23:07:29,946 - INFO - Epoch(train)[45/100][40/100]lr: 3.0000e-04  eta: 0:54:0  time: 23.3161  inter_cls_loss: 0.0130 inner_cls_loss: 0.3260
2023-12-03 23:07:46,279 - INFO - Epoch(train)[45/100][80/100]lr: 3.0000e-04  eta: 0:45:35  time: 39.6482  inter_cls_loss: 0.0119 inner_cls_loss: 0.3272
2023-12-03 23:07:55,064 - INFO - Epoch(test) test/:
2023-12-03 23:08:03,826 - INFO - Metrics for ore-oil: Accuracy: 0.9919, Precision: 0.3619, Recall: 0.3079, F1_score: 0.3327, Average_Precision: 0.2269
2023-12-03 23:08:03,964 - INFO - Metrics for Cell-Container: Accuracy: 0.9980, Precision: 0.6184, Recall: 0.3165, F1_score: 0.4187, Average_Precision: 0.4550
2023-12-03 23:08:04,106 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5635, Recall: 0.4765, F1_score: 0.5164, Average_Precision: 0.3590
2023-12-03 23:08:04,248 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0057
2023-12-03 23:08:04,394 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6207, Recall: 0.6310, F1_score: 0.6258, Average_Precision: 0.5659
2023-12-03 23:08:04,544 - INFO - Metrics for Container: Accuracy: 0.9890, Precision: 0.6118, Recall: 0.5808, F1_score: 0.5959, Average_Precision: 0.5386
2023-12-03 23:08:04,687 - INFO - Metrics for foreground: Accuracy: 0.9838, Precision: 0.7366, Recall: 0.6574, F1_score: 0.6947, Average_Precision: 0.6574
2023-12-03 23:08:04,687 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.5019, Recall: 0.4243, F1_score: 0.4549, Average_Precision: 0.4012
2023-12-03 23:08:08,939 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:08:31,789 - INFO - Epoch(train)[46/100][40/100]lr: 3.0000e-04  eta: 0:51:58  time: 22.8493  inter_cls_loss: 0.0192 inner_cls_loss: 0.3270
2023-12-03 23:08:48,874 - INFO - Epoch(train)[46/100][80/100]lr: 3.0000e-04  eta: 0:45:5  time: 39.9318  inter_cls_loss: 0.0125 inner_cls_loss: 0.2822
2023-12-03 23:08:57,491 - INFO - Epoch(test) test/:
2023-12-03 23:09:06,374 - INFO - Metrics for ore-oil: Accuracy: 0.9924, Precision: 0.3845, Recall: 0.2639, F1_score: 0.3130, Average_Precision: 0.2482
2023-12-03 23:09:06,520 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6578, Recall: 0.4141, F1_score: 0.5083, Average_Precision: 0.4675
2023-12-03 23:09:06,662 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5147, Recall: 0.4698, F1_score: 0.4912, Average_Precision: 0.3446
2023-12-03 23:09:06,802 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0061
2023-12-03 23:09:06,943 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6525, Recall: 0.5683, F1_score: 0.6075, Average_Precision: 0.5639
2023-12-03 23:09:07,088 - INFO - Metrics for Container: Accuracy: 0.9881, Precision: 0.5705, Recall: 0.5944, F1_score: 0.5822, Average_Precision: 0.5202
2023-12-03 23:09:07,229 - INFO - Metrics for foreground: Accuracy: 0.9833, Precision: 0.7267, Recall: 0.6474, F1_score: 0.6848, Average_Precision: 0.6444
2023-12-03 23:09:07,229 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5010, Recall: 0.4226, F1_score: 0.4553, Average_Precision: 0.3993
2023-12-03 23:09:11,557 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:09:33,332 - INFO - Epoch(train)[47/100][40/100]lr: 3.0000e-04  eta: 0:48:37  time: 21.7749  inter_cls_loss: 0.0113 inner_cls_loss: 0.2692
2023-12-03 23:09:50,418 - INFO - Epoch(train)[47/100][80/100]lr: 3.0000e-04  eta: 0:43:4  time: 38.8603  inter_cls_loss: 0.0068 inner_cls_loss: 0.2489
2023-12-03 23:09:58,901 - INFO - Epoch(test) test/:
2023-12-03 23:10:07,843 - INFO - Metrics for ore-oil: Accuracy: 0.9920, Precision: 0.3390, Recall: 0.2292, F1_score: 0.2735, Average_Precision: 0.2370
2023-12-03 23:10:07,982 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6308, Recall: 0.5522, F1_score: 0.5889, Average_Precision: 0.5013
2023-12-03 23:10:08,121 - INFO - Metrics for Fishing: Accuracy: 0.9991, Precision: 0.6477, Recall: 0.3826, F1_score: 0.4810, Average_Precision: 0.4095
2023-12-03 23:10:08,259 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0060
2023-12-03 23:10:08,400 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.7020, Recall: 0.5738, F1_score: 0.6315, Average_Precision: 0.5962
2023-12-03 23:10:08,546 - INFO - Metrics for Container: Accuracy: 0.9882, Precision: 0.5768, Recall: 0.5737, F1_score: 0.5753, Average_Precision: 0.5330
2023-12-03 23:10:08,686 - INFO - Metrics for foreground: Accuracy: 0.9837, Precision: 0.7423, Recall: 0.6412, F1_score: 0.6880, Average_Precision: 0.6517
2023-12-03 23:10:08,686 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5198, Recall: 0.4218, F1_score: 0.4626, Average_Precision: 0.4193
2023-12-03 23:10:12,994 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:10:35,156 - INFO - Epoch(train)[48/100][40/100]lr: 3.0000e-04  eta: 0:48:34  time: 22.1613  inter_cls_loss: 0.0145 inner_cls_loss: 0.2493
2023-12-03 23:10:52,046 - INFO - Epoch(train)[48/100][80/100]lr: 3.0000e-04  eta: 0:42:28  time: 39.0516  inter_cls_loss: 0.0140 inner_cls_loss: 0.2497
2023-12-03 23:11:00,729 - INFO - Epoch(test) test/:
2023-12-03 23:11:09,512 - INFO - Metrics for ore-oil: Accuracy: 0.9921, Precision: 0.3463, Recall: 0.2373, F1_score: 0.2816, Average_Precision: 0.2397
2023-12-03 23:11:09,653 - INFO - Metrics for Cell-Container: Accuracy: 0.9981, Precision: 0.6213, Recall: 0.3535, F1_score: 0.4506, Average_Precision: 0.4487
2023-12-03 23:11:09,792 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5405, Recall: 0.2685, F1_score: 0.3587, Average_Precision: 0.3144
2023-12-03 23:11:09,932 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0053
2023-12-03 23:11:10,077 - INFO - Metrics for Dredger: Accuracy: 0.9965, Precision: 0.5676, Recall: 0.6199, F1_score: 0.5926, Average_Precision: 0.5499
2023-12-03 23:11:10,228 - INFO - Metrics for Container: Accuracy: 0.9892, Precision: 0.6252, Recall: 0.5535, F1_score: 0.5871, Average_Precision: 0.5423
2023-12-03 23:11:10,369 - INFO - Metrics for foreground: Accuracy: 0.9839, Precision: 0.7586, Recall: 0.6250, F1_score: 0.6853, Average_Precision: 0.6633
2023-12-03 23:11:10,369 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.4942, Recall: 0.3797, F1_score: 0.4223, Average_Precision: 0.3948
2023-12-03 23:11:14,677 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:11:36,408 - INFO - Epoch(train)[49/100][40/100]lr: 3.0000e-04  eta: 0:46:43  time: 21.7306  inter_cls_loss: 0.0132 inner_cls_loss: 0.2247
2023-12-03 23:11:53,590 - INFO - Epoch(train)[49/100][80/100]lr: 3.0000e-04  eta: 0:41:30  time: 38.9099  inter_cls_loss: 0.0084 inner_cls_loss: 0.2028
2023-12-03 23:12:02,278 - INFO - Epoch(test) test/:
2023-12-03 23:12:11,017 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4027, Recall: 0.2083, F1_score: 0.2746, Average_Precision: 0.2361
2023-12-03 23:12:11,158 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.7039, Recall: 0.4242, F1_score: 0.5294, Average_Precision: 0.4777
2023-12-03 23:12:11,306 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4803, Recall: 0.4899, F1_score: 0.4850, Average_Precision: 0.3912
2023-12-03 23:12:11,447 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0071
2023-12-03 23:12:11,591 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6768, Recall: 0.5332, F1_score: 0.5965, Average_Precision: 0.5736
2023-12-03 23:12:11,737 - INFO - Metrics for Container: Accuracy: 0.9876, Precision: 0.5519, Recall: 0.5895, F1_score: 0.5701, Average_Precision: 0.5160
2023-12-03 23:12:11,878 - INFO - Metrics for foreground: Accuracy: 0.9836, Precision: 0.7438, Recall: 0.6355, F1_score: 0.6854, Average_Precision: 0.6401
2023-12-03 23:12:11,878 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5085, Recall: 0.4115, F1_score: 0.4487, Average_Precision: 0.4060
2023-12-03 23:12:16,189 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:12:39,401 - INFO - Epoch(train)[50/100][40/100]lr: 3.0000e-04  eta: 0:48:56  time: 23.2113  inter_cls_loss: 0.0182 inner_cls_loss: 0.1929
2023-12-03 23:12:56,843 - INFO - Epoch(train)[50/100][80/100]lr: 3.0000e-04  eta: 0:42:31  time: 40.6534  inter_cls_loss: 0.0155 inner_cls_loss: 0.1837
2023-12-03 23:13:05,419 - INFO - Epoch(test) test/:
2023-12-03 23:13:13,895 - INFO - Metrics for ore-oil: Accuracy: 0.9932, Precision: 0.4635, Recall: 0.1910, F1_score: 0.2705, Average_Precision: 0.2608
2023-12-03 23:13:14,034 - INFO - Metrics for Cell-Container: Accuracy: 0.9978, Precision: 0.5193, Recall: 0.4983, F1_score: 0.5086, Average_Precision: 0.4090
2023-12-03 23:13:14,173 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3966, Recall: 0.4631, F1_score: 0.4272, Average_Precision: 0.3986
2023-12-03 23:13:14,312 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0039
2023-12-03 23:13:14,452 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6645, Recall: 0.5775, F1_score: 0.6180, Average_Precision: 0.5986
2023-12-03 23:13:14,595 - INFO - Metrics for Container: Accuracy: 0.9885, Precision: 0.5950, Recall: 0.5486, F1_score: 0.5709, Average_Precision: 0.5273
2023-12-03 23:13:14,734 - INFO - Metrics for foreground: Accuracy: 0.9839, Precision: 0.7664, Recall: 0.6160, F1_score: 0.6830, Average_Precision: 0.6550
2023-12-03 23:13:14,734 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.4865, Recall: 0.4135, F1_score: 0.4397, Average_Precision: 0.4076
2023-12-03 23:13:19,022 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:13:41,564 - INFO - Epoch(train)[51/100][40/100]lr: 3.0000e-04  eta: 0:46:29  time: 22.4950  inter_cls_loss: 0.0101 inner_cls_loss: 0.1696
2023-12-03 23:14:00,052 - INFO - Epoch(train)[51/100][80/100]lr: 3.0000e-04  eta: 0:42:0  time: 40.9790  inter_cls_loss: 0.0296 inner_cls_loss: 0.1769
2023-12-03 23:14:09,125 - INFO - Epoch(test) test/:
2023-12-03 23:14:17,823 - INFO - Metrics for ore-oil: Accuracy: 0.9919, Precision: 0.3456, Recall: 0.2604, F1_score: 0.2970, Average_Precision: 0.2251
2023-12-03 23:14:17,985 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6190, Recall: 0.5690, F1_score: 0.5930, Average_Precision: 0.4970
2023-12-03 23:14:18,126 - INFO - Metrics for Fishing: Accuracy: 0.9991, Precision: 0.6364, Recall: 0.4698, F1_score: 0.5405, Average_Precision: 0.3845
2023-12-03 23:14:18,265 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0137
2023-12-03 23:14:18,406 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6426, Recall: 0.5572, F1_score: 0.5968, Average_Precision: 0.5295
2023-12-03 23:14:18,550 - INFO - Metrics for Container: Accuracy: 0.9894, Precision: 0.6330, Recall: 0.5611, F1_score: 0.5949, Average_Precision: 0.5400
2023-12-03 23:14:18,689 - INFO - Metrics for foreground: Accuracy: 0.9837, Precision: 0.7478, Recall: 0.6320, F1_score: 0.6850, Average_Precision: 0.6478
2023-12-03 23:14:18,689 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5178, Recall: 0.4357, F1_score: 0.4725, Average_Precision: 0.4054
2023-12-03 23:14:22,969 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:14:44,905 - INFO - Epoch(train)[52/100][40/100]lr: 3.0000e-04  eta: 0:44:25  time: 21.9350  inter_cls_loss: 0.0139 inner_cls_loss: 0.1664
2023-12-03 23:15:02,209 - INFO - Epoch(train)[52/100][80/100]lr: 3.0000e-04  eta: 0:39:24  time: 39.2389  inter_cls_loss: 0.0088 inner_cls_loss: 0.1448
2023-12-03 23:15:11,120 - INFO - Epoch(test) test/:
2023-12-03 23:15:19,581 - INFO - Metrics for ore-oil: Accuracy: 0.9921, Precision: 0.3691, Recall: 0.2986, F1_score: 0.3301, Average_Precision: 0.2455
2023-12-03 23:15:19,722 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6463, Recall: 0.5354, F1_score: 0.5856, Average_Precision: 0.5045
2023-12-03 23:15:19,864 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5489, Recall: 0.4899, F1_score: 0.5177, Average_Precision: 0.3966
2023-12-03 23:15:20,003 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0059
2023-12-03 23:15:20,148 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6863, Recall: 0.5369, F1_score: 0.6025, Average_Precision: 0.5776
2023-12-03 23:15:20,294 - INFO - Metrics for Container: Accuracy: 0.9884, Precision: 0.5831, Recall: 0.5748, F1_score: 0.5789, Average_Precision: 0.5284
2023-12-03 23:15:20,431 - INFO - Metrics for foreground: Accuracy: 0.9831, Precision: 0.7228, Recall: 0.6460, F1_score: 0.6823, Average_Precision: 0.6173
2023-12-03 23:15:20,431 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5081, Recall: 0.4402, F1_score: 0.4710, Average_Precision: 0.4108
2023-12-03 23:15:24,771 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:15:46,578 - INFO - Epoch(train)[53/100][40/100]lr: 3.0000e-04  eta: 0:43:14  time: 21.8057  inter_cls_loss: 0.0104 inner_cls_loss: 0.1236
2023-12-03 23:16:02,695 - INFO - Epoch(train)[53/100][80/100]lr: 3.0000e-04  eta: 0:37:17  time: 37.9234  inter_cls_loss: 0.0112 inner_cls_loss: 0.1333
2023-12-03 23:16:11,338 - INFO - Epoch(test) test/:
2023-12-03 23:16:20,253 - INFO - Metrics for ore-oil: Accuracy: 0.9919, Precision: 0.3333, Recall: 0.2396, F1_score: 0.2788, Average_Precision: 0.2503
2023-12-03 23:16:20,402 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6698, Recall: 0.4781, F1_score: 0.5580, Average_Precision: 0.4546
2023-12-03 23:16:20,547 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5303, Recall: 0.4698, F1_score: 0.4982, Average_Precision: 0.4052
2023-12-03 23:16:20,693 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0128
2023-12-03 23:16:20,839 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.7033, Recall: 0.4373, F1_score: 0.5392, Average_Precision: 0.5510
2023-12-03 23:16:20,987 - INFO - Metrics for Container: Accuracy: 0.9882, Precision: 0.5841, Recall: 0.5289, F1_score: 0.5551, Average_Precision: 0.5113
2023-12-03 23:16:21,130 - INFO - Metrics for foreground: Accuracy: 0.9839, Precision: 0.7666, Recall: 0.6133, F1_score: 0.6815, Average_Precision: 0.6460
2023-12-03 23:16:21,131 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5125, Recall: 0.3953, F1_score: 0.4444, Average_Precision: 0.4044
2023-12-03 23:16:22,199 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:16:44,498 - INFO - Epoch(train)[54/100][40/100]lr: 3.0000e-04  eta: 0:43:17  time: 22.2973  inter_cls_loss: 0.0075 inner_cls_loss: 0.1117
2023-12-03 23:17:02,104 - INFO - Epoch(train)[54/100][80/100]lr: 3.0000e-04  eta: 0:38:24  time: 39.9044  inter_cls_loss: 0.0126 inner_cls_loss: 0.1161
2023-12-03 23:17:10,666 - INFO - Epoch(test) test/:
2023-12-03 23:17:19,245 - INFO - Metrics for ore-oil: Accuracy: 0.9917, Precision: 0.3259, Recall: 0.2535, F1_score: 0.2852, Average_Precision: 0.2242
2023-12-03 23:17:19,390 - INFO - Metrics for Cell-Container: Accuracy: 0.9981, Precision: 0.6237, Recall: 0.4074, F1_score: 0.4929, Average_Precision: 0.4703
2023-12-03 23:17:19,537 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.5978, Recall: 0.3691, F1_score: 0.4564, Average_Precision: 0.3658
2023-12-03 23:17:19,681 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0116
2023-12-03 23:17:19,827 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6421, Recall: 0.5959, F1_score: 0.6182, Average_Precision: 0.5755
2023-12-03 23:17:19,971 - INFO - Metrics for Container: Accuracy: 0.9885, Precision: 0.5891, Recall: 0.5666, F1_score: 0.5776, Average_Precision: 0.5309
2023-12-03 23:17:20,114 - INFO - Metrics for foreground: Accuracy: 0.9834, Precision: 0.7347, Recall: 0.6398, F1_score: 0.6840, Average_Precision: 0.6279
2023-12-03 23:17:20,114 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.5019, Recall: 0.4046, F1_score: 0.4449, Average_Precision: 0.4009
2023-12-03 23:17:24,359 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:17:46,958 - INFO - Epoch(train)[55/100][40/100]lr: 3.0000e-04  eta: 0:42:56  time: 22.5967  inter_cls_loss: 0.0137 inner_cls_loss: 0.1026
2023-12-03 23:18:05,992 - INFO - Epoch(train)[55/100][80/100]lr: 3.0000e-04  eta: 0:39:12  time: 41.6299  inter_cls_loss: 0.0180 inner_cls_loss: 0.1117
2023-12-03 23:18:14,403 - INFO - Epoch(test) test/:
2023-12-03 23:18:23,317 - INFO - Metrics for ore-oil: Accuracy: 0.9907, Precision: 0.2771, Recall: 0.2604, F1_score: 0.2685, Average_Precision: 0.1970
2023-12-03 23:18:23,463 - INFO - Metrics for Cell-Container: Accuracy: 0.9985, Precision: 0.7248, Recall: 0.5320, F1_score: 0.6136, Average_Precision: 0.5085
2023-12-03 23:18:23,606 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.4948, Recall: 0.3221, F1_score: 0.3902, Average_Precision: 0.3157
2023-12-03 23:18:23,749 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0117
2023-12-03 23:18:23,893 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6050, Recall: 0.5793, F1_score: 0.5919, Average_Precision: 0.5621
2023-12-03 23:18:24,040 - INFO - Metrics for Container: Accuracy: 0.9879, Precision: 0.5619, Recall: 0.5972, F1_score: 0.5790, Average_Precision: 0.5186
2023-12-03 23:18:24,178 - INFO - Metrics for foreground: Accuracy: 0.9824, Precision: 0.6933, Recall: 0.6731, F1_score: 0.6830, Average_Precision: 0.6068
2023-12-03 23:18:24,179 - INFO - Average metrics: Accuracy: 0.9936, Precision: 0.4796, Recall: 0.4234, F1_score: 0.4466, Average_Precision: 0.3886
2023-12-03 23:18:28,459 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:18:51,699 - INFO - Epoch(train)[56/100][40/100]lr: 3.0000e-04  eta: 0:43:11  time: 23.2388  inter_cls_loss: 0.0089 inner_cls_loss: 0.0854
2023-12-03 23:19:10,882 - INFO - Epoch(train)[56/100][80/100]lr: 3.0000e-04  eta: 0:39:3  time: 42.4219  inter_cls_loss: 0.0140 inner_cls_loss: 0.0887
2023-12-03 23:19:19,994 - INFO - Epoch(test) test/:
2023-12-03 23:19:28,787 - INFO - Metrics for ore-oil: Accuracy: 0.9923, Precision: 0.3865, Recall: 0.2859, F1_score: 0.3287, Average_Precision: 0.2782
2023-12-03 23:19:28,927 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6954, Recall: 0.4074, F1_score: 0.5138, Average_Precision: 0.5230
2023-12-03 23:19:29,068 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4804, Recall: 0.3289, F1_score: 0.3904, Average_Precision: 0.3044
2023-12-03 23:19:29,211 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0087
2023-12-03 23:19:29,359 - INFO - Metrics for Dredger: Accuracy: 0.9966, Precision: 0.5957, Recall: 0.5683, F1_score: 0.5817, Average_Precision: 0.5546
2023-12-03 23:19:29,508 - INFO - Metrics for Container: Accuracy: 0.9888, Precision: 0.6058, Recall: 0.5562, F1_score: 0.5800, Average_Precision: 0.5327
2023-12-03 23:19:29,651 - INFO - Metrics for foreground: Accuracy: 0.9836, Precision: 0.7471, Recall: 0.6290, F1_score: 0.6830, Average_Precision: 0.6351
2023-12-03 23:19:29,651 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5016, Recall: 0.3965, F1_score: 0.4397, Average_Precision: 0.4052
2023-12-03 23:19:33,922 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:19:56,329 - INFO - Epoch(train)[57/100][40/100]lr: 3.0000e-04  eta: 0:40:42  time: 22.4039  inter_cls_loss: 0.0092 inner_cls_loss: 0.0715
2023-12-03 23:20:12,523 - INFO - Epoch(train)[57/100][80/100]lr: 3.0000e-04  eta: 0:34:44  time: 38.6010  inter_cls_loss: 0.0113 inner_cls_loss: 0.0731
2023-12-03 23:20:21,215 - INFO - Epoch(test) test/:
2023-12-03 23:20:30,225 - INFO - Metrics for ore-oil: Accuracy: 0.9925, Precision: 0.3833, Recall: 0.2280, F1_score: 0.2859, Average_Precision: 0.2403
2023-12-03 23:20:30,361 - INFO - Metrics for Cell-Container: Accuracy: 0.9980, Precision: 0.5962, Recall: 0.4175, F1_score: 0.4911, Average_Precision: 0.4614
2023-12-03 23:20:30,500 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5338, Recall: 0.4765, F1_score: 0.5035, Average_Precision: 0.4243
2023-12-03 23:20:30,636 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0163
2023-12-03 23:20:30,776 - INFO - Metrics for Dredger: Accuracy: 0.9963, Precision: 0.5503, Recall: 0.6052, F1_score: 0.5764, Average_Precision: 0.5346
2023-12-03 23:20:30,920 - INFO - Metrics for Container: Accuracy: 0.9893, Precision: 0.6350, Recall: 0.5508, F1_score: 0.5899, Average_Precision: 0.5332
2023-12-03 23:20:31,059 - INFO - Metrics for foreground: Accuracy: 0.9841, Precision: 0.7638, Recall: 0.6274, F1_score: 0.6889, Average_Precision: 0.6463
2023-12-03 23:20:31,059 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.4946, Recall: 0.4151, F1_score: 0.4480, Average_Precision: 0.4080
2023-12-03 23:20:35,360 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:20:57,223 - INFO - Epoch(train)[58/100][40/100]lr: 3.0000e-04  eta: 0:38:48  time: 21.8622  inter_cls_loss: 0.0067 inner_cls_loss: 0.0636
2023-12-03 23:21:16,200 - INFO - Epoch(train)[58/100][80/100]lr: 3.0000e-04  eta: 0:35:54  time: 40.8370  inter_cls_loss: 0.0109 inner_cls_loss: 0.0627
2023-12-03 23:21:26,374 - INFO - Epoch(test) test/:
2023-12-03 23:21:35,047 - INFO - Metrics for ore-oil: Accuracy: 0.9925, Precision: 0.3725, Recall: 0.2199, F1_score: 0.2766, Average_Precision: 0.2015
2023-12-03 23:21:35,200 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6273, Recall: 0.4646, F1_score: 0.5338, Average_Precision: 0.5179
2023-12-03 23:21:35,355 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4437, Recall: 0.4765, F1_score: 0.4595, Average_Precision: 0.3765
2023-12-03 23:21:35,508 - INFO - Metrics for LawEnforce: Accuracy: 0.9998, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0098
2023-12-03 23:21:35,665 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6451, Recall: 0.6070, F1_score: 0.6255, Average_Precision: 0.5752
2023-12-03 23:21:35,822 - INFO - Metrics for Container: Accuracy: 0.9888, Precision: 0.6015, Recall: 0.5726, F1_score: 0.5867, Average_Precision: 0.5252
2023-12-03 23:21:35,965 - INFO - Metrics for foreground: Accuracy: 0.9840, Precision: 0.7529, Recall: 0.6404, F1_score: 0.6921, Average_Precision: 0.6248
2023-12-03 23:21:35,965 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.4919, Recall: 0.4259, F1_score: 0.4535, Average_Precision: 0.4044
2023-12-03 23:21:40,313 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:22:03,448 - INFO - Epoch(train)[59/100][40/100]lr: 3.0000e-04  eta: 0:40:5  time: 23.1320  inter_cls_loss: 0.0138 inner_cls_loss: 0.0710
2023-12-03 23:22:20,313 - INFO - Epoch(train)[59/100][80/100]lr: 3.0000e-04  eta: 0:34:19  time: 39.9996  inter_cls_loss: 0.0128 inner_cls_loss: 0.0642
2023-12-03 23:22:29,962 - INFO - Epoch(test) test/:
2023-12-03 23:22:38,825 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.4527, Recall: 0.2766, F1_score: 0.3434, Average_Precision: 0.2811
2023-12-03 23:22:38,974 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6769, Recall: 0.5219, F1_score: 0.5894, Average_Precision: 0.5265
2023-12-03 23:22:39,121 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4797, Recall: 0.3960, F1_score: 0.4338, Average_Precision: 0.3515
2023-12-03 23:22:39,270 - INFO - Metrics for LawEnforce: Accuracy: 0.9998, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0096
2023-12-03 23:22:39,419 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6697, Recall: 0.5387, F1_score: 0.5971, Average_Precision: 0.5850
2023-12-03 23:22:39,573 - INFO - Metrics for Container: Accuracy: 0.9892, Precision: 0.6269, Recall: 0.5513, F1_score: 0.5867, Average_Precision: 0.5397
2023-12-03 23:22:39,719 - INFO - Metrics for foreground: Accuracy: 0.9841, Precision: 0.7744, Recall: 0.6131, F1_score: 0.6844, Average_Precision: 0.6510
2023-12-03 23:22:39,719 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5257, Recall: 0.4139, F1_score: 0.4621, Average_Precision: 0.4206
2023-12-03 23:22:44,068 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:23:06,095 - INFO - Epoch(train)[60/100][40/100]lr: 3.0000e-04  eta: 0:37:15  time: 22.0262  inter_cls_loss: 0.0041 inner_cls_loss: 0.0407
2023-12-03 23:23:23,046 - INFO - Epoch(train)[60/100][80/100]lr: 3.0000e-04  eta: 0:32:38  time: 38.9752  inter_cls_loss: 0.0034 inner_cls_loss: 0.0397
2023-12-03 23:23:31,172 - INFO - Epoch(test) test/:
2023-12-03 23:23:39,952 - INFO - Metrics for ore-oil: Accuracy: 0.9910, Precision: 0.2915, Recall: 0.2581, F1_score: 0.2738, Average_Precision: 0.2239
2023-12-03 23:23:40,103 - INFO - Metrics for Cell-Container: Accuracy: 0.9980, Precision: 0.6312, Recall: 0.2997, F1_score: 0.4064, Average_Precision: 0.4221
2023-12-03 23:23:40,255 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5000, Recall: 0.1611, F1_score: 0.2437, Average_Precision: 0.2833
2023-12-03 23:23:40,404 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0067
2023-12-03 23:23:40,551 - INFO - Metrics for Dredger: Accuracy: 0.9961, Precision: 0.5272, Recall: 0.6089, F1_score: 0.5651, Average_Precision: 0.4343
2023-12-03 23:23:40,703 - INFO - Metrics for Container: Accuracy: 0.9870, Precision: 0.5294, Recall: 0.5955, F1_score: 0.5605, Average_Precision: 0.5264
2023-12-03 23:23:40,848 - INFO - Metrics for foreground: Accuracy: 0.9819, Precision: 0.6797, Recall: 0.6736, F1_score: 0.6766, Average_Precision: 0.6159
2023-12-03 23:23:40,848 - INFO - Average metrics: Accuracy: 0.9932, Precision: 0.4513, Recall: 0.3710, F1_score: 0.3894, Average_Precision: 0.3590
2023-12-03 23:23:45,231 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:24:08,210 - INFO - Epoch(train)[61/100][40/100]lr: 3.0000e-04  eta: 0:37:49  time: 22.9290  inter_cls_loss: 0.0097 inner_cls_loss: 0.0473
2023-12-03 23:24:26,588 - INFO - Epoch(train)[61/100][80/100]lr: 3.0000e-04  eta: 0:33:44  time: 41.3112  inter_cls_loss: 0.0045 inner_cls_loss: 0.0414
2023-12-03 23:24:36,128 - INFO - Epoch(test) test/:
2023-12-03 23:24:45,109 - INFO - Metrics for ore-oil: Accuracy: 0.9926, Precision: 0.4111, Recall: 0.3079, F1_score: 0.3521, Average_Precision: 0.2922
2023-12-03 23:24:45,259 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6722, Recall: 0.4074, F1_score: 0.5073, Average_Precision: 0.5133
2023-12-03 23:24:45,406 - INFO - Metrics for Fishing: Accuracy: 0.9990, Precision: 0.6027, Recall: 0.2953, F1_score: 0.3964, Average_Precision: 0.3758
2023-12-03 23:24:45,550 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0077
2023-12-03 23:24:45,696 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6030, Recall: 0.5996, F1_score: 0.6013, Average_Precision: 0.5713
2023-12-03 23:24:45,846 - INFO - Metrics for Container: Accuracy: 0.9893, Precision: 0.6310, Recall: 0.5497, F1_score: 0.5875, Average_Precision: 0.5252
2023-12-03 23:24:45,988 - INFO - Metrics for foreground: Accuracy: 0.9844, Precision: 0.7701, Recall: 0.6317, F1_score: 0.6941, Average_Precision: 0.6444
2023-12-03 23:24:45,988 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5272, Recall: 0.3988, F1_score: 0.4484, Average_Precision: 0.4185
2023-12-03 23:24:50,366 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:25:13,523 - INFO - Epoch(train)[62/100][40/100]lr: 3.0000e-04  eta: 0:37:14  time: 23.1545  inter_cls_loss: 0.0061 inner_cls_loss: 0.0331
2023-12-03 23:25:31,407 - INFO - Epoch(train)[62/100][80/100]lr: 3.0000e-04  eta: 0:32:39  time: 41.0385  inter_cls_loss: 0.0159 inner_cls_loss: 0.0346
2023-12-03 23:25:41,176 - INFO - Epoch(test) test/:
2023-12-03 23:25:50,082 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4271, Recall: 0.2882, F1_score: 0.3442, Average_Precision: 0.2610
2023-12-03 23:25:50,229 - INFO - Metrics for Cell-Container: Accuracy: 0.9981, Precision: 0.5978, Recall: 0.5455, F1_score: 0.5704, Average_Precision: 0.5320
2023-12-03 23:25:50,380 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3873, Recall: 0.3691, F1_score: 0.3780, Average_Precision: 0.3390
2023-12-03 23:25:50,526 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0114
2023-12-03 23:25:50,674 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6419, Recall: 0.6218, F1_score: 0.6317, Average_Precision: 0.6011
2023-12-03 23:25:50,832 - INFO - Metrics for Container: Accuracy: 0.9885, Precision: 0.5858, Recall: 0.5890, F1_score: 0.5874, Average_Precision: 0.5357
2023-12-03 23:25:50,977 - INFO - Metrics for foreground: Accuracy: 0.9834, Precision: 0.7247, Recall: 0.6585, F1_score: 0.6900, Average_Precision: 0.6314
2023-12-03 23:25:50,977 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.4806, Recall: 0.4389, F1_score: 0.4574, Average_Precision: 0.4160
2023-12-03 23:25:55,365 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:26:18,739 - INFO - Epoch(train)[63/100][40/100]lr: 3.0000e-04  eta: 0:36:36  time: 23.3722  inter_cls_loss: 0.0110 inner_cls_loss: 0.0413
2023-12-03 23:26:36,487 - INFO - Epoch(train)[63/100][80/100]lr: 3.0000e-04  eta: 0:31:52  time: 41.1212  inter_cls_loss: 0.0121 inner_cls_loss: 0.0394
2023-12-03 23:26:45,255 - INFO - Epoch(test) test/:
2023-12-03 23:26:54,270 - INFO - Metrics for ore-oil: Accuracy: 0.9926, Precision: 0.4088, Recall: 0.3009, F1_score: 0.3467, Average_Precision: 0.2846
2023-12-03 23:26:54,420 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6471, Recall: 0.5185, F1_score: 0.5757, Average_Precision: 0.5502
2023-12-03 23:26:54,567 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4203, Recall: 0.3893, F1_score: 0.4042, Average_Precision: 0.3314
2023-12-03 23:26:54,710 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0140
2023-12-03 23:26:54,858 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.7287, Recall: 0.5203, F1_score: 0.6071, Average_Precision: 0.5980
2023-12-03 23:26:55,012 - INFO - Metrics for Container: Accuracy: 0.9886, Precision: 0.5949, Recall: 0.5611, F1_score: 0.5775, Average_Precision: 0.5367
2023-12-03 23:26:55,159 - INFO - Metrics for foreground: Accuracy: 0.9843, Precision: 0.7614, Recall: 0.6433, F1_score: 0.6974, Average_Precision: 0.6476
2023-12-03 23:26:55,159 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5087, Recall: 0.4191, F1_score: 0.4584, Average_Precision: 0.4232
2023-12-03 23:26:59,584 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:27:22,748 - INFO - Epoch(train)[64/100][40/100]lr: 3.0000e-04  eta: 0:35:19  time: 23.1633  inter_cls_loss: 0.0081 inner_cls_loss: 0.0273
2023-12-03 23:27:41,815 - INFO - Epoch(train)[64/100][80/100]lr: 3.0000e-04  eta: 0:31:50  time: 42.2286  inter_cls_loss: 0.0076 inner_cls_loss: 0.0251
2023-12-03 23:27:50,783 - INFO - Epoch(test) test/:
2023-12-03 23:27:59,615 - INFO - Metrics for ore-oil: Accuracy: 0.9936, Precision: 0.5293, Recall: 0.2407, F1_score: 0.3309, Average_Precision: 0.2776
2023-12-03 23:27:59,756 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.7236, Recall: 0.4848, F1_score: 0.5806, Average_Precision: 0.5481
2023-12-03 23:27:59,896 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3953, Recall: 0.4564, F1_score: 0.4237, Average_Precision: 0.3375
2023-12-03 23:28:00,037 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0072
2023-12-03 23:28:00,176 - INFO - Metrics for Dredger: Accuracy: 0.9974, Precision: 0.7753, Recall: 0.5221, F1_score: 0.6240, Average_Precision: 0.6030
2023-12-03 23:28:00,317 - INFO - Metrics for Container: Accuracy: 0.9872, Precision: 0.5347, Recall: 0.6392, F1_score: 0.5823, Average_Precision: 0.5508
2023-12-03 23:28:00,451 - INFO - Metrics for foreground: Accuracy: 0.9834, Precision: 0.7276, Recall: 0.6525, F1_score: 0.6880, Average_Precision: 0.6350
2023-12-03 23:28:00,451 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.5266, Recall: 0.4280, F1_score: 0.4614, Average_Precision: 0.4227
2023-12-03 23:28:04,693 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:28:28,194 - INFO - Epoch(train)[65/100][40/100]lr: 3.0000e-04  eta: 0:34:51  time: 23.4986  inter_cls_loss: 0.0070 inner_cls_loss: 0.0367
2023-12-03 23:28:45,546 - INFO - Epoch(train)[65/100][80/100]lr: 3.0000e-04  eta: 0:29:57  time: 40.8502  inter_cls_loss: 0.0074 inner_cls_loss: 0.0293
2023-12-03 23:28:54,253 - INFO - Epoch(test) test/:
2023-12-03 23:29:03,003 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.4503, Recall: 0.2569, F1_score: 0.3272, Average_Precision: 0.2722
2023-12-03 23:29:03,142 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6180, Recall: 0.4848, F1_score: 0.5434, Average_Precision: 0.5292
2023-12-03 23:29:03,281 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3510, Recall: 0.3557, F1_score: 0.3533, Average_Precision: 0.3099
2023-12-03 23:29:03,417 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0099
2023-12-03 23:29:03,555 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.7210, Recall: 0.4815, F1_score: 0.5774, Average_Precision: 0.5844
2023-12-03 23:29:03,697 - INFO - Metrics for Container: Accuracy: 0.9867, Precision: 0.5180, Recall: 0.6288, F1_score: 0.5680, Average_Precision: 0.5277
2023-12-03 23:29:03,830 - INFO - Metrics for foreground: Accuracy: 0.9832, Precision: 0.7144, Recall: 0.6685, F1_score: 0.6907, Average_Precision: 0.6337
2023-12-03 23:29:03,831 - INFO - Average metrics: Accuracy: 0.9938, Precision: 0.4818, Recall: 0.4109, F1_score: 0.4372, Average_Precision: 0.4096
2023-12-03 23:29:08,113 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:29:29,643 - INFO - Epoch(train)[66/100][40/100]lr: 3.0000e-04  eta: 0:31:2  time: 21.5274  inter_cls_loss: 0.0074 inner_cls_loss: 0.0227
2023-12-03 23:29:46,410 - INFO - Epoch(train)[66/100][80/100]lr: 3.0000e-04  eta: 0:27:17  time: 38.2963  inter_cls_loss: 0.0033 inner_cls_loss: 0.0254
2023-12-03 23:29:56,130 - INFO - Epoch(test) test/:
2023-12-03 23:30:05,044 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.4793, Recall: 0.2407, F1_score: 0.3205, Average_Precision: 0.2934
2023-12-03 23:30:05,186 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6786, Recall: 0.5758, F1_score: 0.6230, Average_Precision: 0.5181
2023-12-03 23:30:05,328 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4889, Recall: 0.4430, F1_score: 0.4648, Average_Precision: 0.3651
2023-12-03 23:30:05,468 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0145
2023-12-03 23:30:05,613 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6744, Recall: 0.5886, F1_score: 0.6286, Average_Precision: 0.6071
2023-12-03 23:30:05,763 - INFO - Metrics for Container: Accuracy: 0.9891, Precision: 0.6174, Recall: 0.5655, F1_score: 0.5903, Average_Precision: 0.5451
2023-12-03 23:30:05,909 - INFO - Metrics for foreground: Accuracy: 0.9844, Precision: 0.7756, Recall: 0.6266, F1_score: 0.6932, Average_Precision: 0.6456
2023-12-03 23:30:05,909 - INFO - Average metrics: Accuracy: 0.9944, Precision: 0.5306, Recall: 0.4343, F1_score: 0.4743, Average_Precision: 0.4270
2023-12-03 23:30:10,139 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:30:33,753 - INFO - Epoch(train)[67/100][40/100]lr: 3.0000e-04  eta: 0:33:3  time: 23.6132  inter_cls_loss: 0.0107 inner_cls_loss: 0.0283
2023-12-03 23:30:50,819 - INFO - Epoch(train)[67/100][80/100]lr: 3.0000e-04  eta: 0:28:8  time: 40.6798  inter_cls_loss: 0.0145 inner_cls_loss: 0.0189
2023-12-03 23:30:59,419 - INFO - Epoch(test) test/:
2023-12-03 23:31:08,309 - INFO - Metrics for ore-oil: Accuracy: 0.9930, Precision: 0.4449, Recall: 0.2616, F1_score: 0.3294, Average_Precision: 0.2629
2023-12-03 23:31:08,450 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6392, Recall: 0.5488, F1_score: 0.5906, Average_Precision: 0.5002
2023-12-03 23:31:08,588 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5253, Recall: 0.3490, F1_score: 0.4194, Average_Precision: 0.3726
2023-12-03 23:31:08,727 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0081
2023-12-03 23:31:08,867 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6448, Recall: 0.5793, F1_score: 0.6103, Average_Precision: 0.5890
2023-12-03 23:31:09,010 - INFO - Metrics for Container: Accuracy: 0.9887, Precision: 0.6063, Recall: 0.5355, F1_score: 0.5687, Average_Precision: 0.5273
2023-12-03 23:31:09,146 - INFO - Metrics for foreground: Accuracy: 0.9841, Precision: 0.7693, Recall: 0.6206, F1_score: 0.6870, Average_Precision: 0.6492
2023-12-03 23:31:09,146 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5185, Recall: 0.4135, F1_score: 0.4579, Average_Precision: 0.4156
2023-12-03 23:31:13,370 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:31:36,206 - INFO - Epoch(train)[68/100][40/100]lr: 3.0000e-04  eta: 0:31:1  time: 22.8358  inter_cls_loss: 0.0039 inner_cls_loss: 0.0096
2023-12-03 23:31:54,278 - INFO - Epoch(train)[68/100][80/100]lr: 3.0000e-04  eta: 0:27:26  time: 40.9072  inter_cls_loss: 0.0052 inner_cls_loss: 0.0101
2023-12-03 23:32:03,611 - INFO - Epoch(test) test/:
2023-12-03 23:32:12,542 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.4345, Recall: 0.1574, F1_score: 0.2311, Average_Precision: 0.2249
2023-12-03 23:32:12,681 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.7778, Recall: 0.3771, F1_score: 0.5079, Average_Precision: 0.5092
2023-12-03 23:32:12,819 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4143, Recall: 0.1946, F1_score: 0.2648, Average_Precision: 0.2496
2023-12-03 23:32:12,956 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0053
2023-12-03 23:32:13,097 - INFO - Metrics for Dredger: Accuracy: 0.9967, Precision: 0.6236, Recall: 0.5258, F1_score: 0.5706, Average_Precision: 0.5302
2023-12-03 23:32:13,239 - INFO - Metrics for Container: Accuracy: 0.9875, Precision: 0.5459, Recall: 0.5944, F1_score: 0.5691, Average_Precision: 0.5219
2023-12-03 23:32:13,371 - INFO - Metrics for foreground: Accuracy: 0.9838, Precision: 0.7640, Recall: 0.6150, F1_score: 0.6814, Average_Precision: 0.6334
2023-12-03 23:32:13,372 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5086, Recall: 0.3521, F1_score: 0.4036, Average_Precision: 0.3821
2023-12-03 23:32:17,654 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:32:40,225 - INFO - Epoch(train)[69/100][40/100]lr: 3.0000e-04  eta: 0:29:42  time: 22.5670  inter_cls_loss: 0.0126 inner_cls_loss: 0.0188
2023-12-03 23:32:57,357 - INFO - Epoch(train)[69/100][80/100]lr: 3.0000e-04  eta: 0:25:48  time: 39.7018  inter_cls_loss: 0.0106 inner_cls_loss: 0.0127
2023-12-03 23:33:07,306 - INFO - Epoch(test) test/:
2023-12-03 23:33:16,167 - INFO - Metrics for ore-oil: Accuracy: 0.9926, Precision: 0.3917, Recall: 0.2303, F1_score: 0.2901, Average_Precision: 0.2611
2023-12-03 23:33:16,323 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.7443, Recall: 0.4411, F1_score: 0.5539, Average_Precision: 0.5340
2023-12-03 23:33:16,479 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5056, Recall: 0.3020, F1_score: 0.3782, Average_Precision: 0.3344
2023-12-03 23:33:16,617 - INFO - Metrics for LawEnforce: Accuracy: 0.9999, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0095
2023-12-03 23:33:16,757 - INFO - Metrics for Dredger: Accuracy: 0.9965, Precision: 0.6107, Recall: 0.4428, F1_score: 0.5134, Average_Precision: 0.5022
2023-12-03 23:33:16,903 - INFO - Metrics for Container: Accuracy: 0.9874, Precision: 0.5428, Recall: 0.5852, F1_score: 0.5632, Average_Precision: 0.5497
2023-12-03 23:33:17,037 - INFO - Metrics for foreground: Accuracy: 0.9835, Precision: 0.7424, Recall: 0.6301, F1_score: 0.6817, Average_Precision: 0.6280
2023-12-03 23:33:17,037 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.5054, Recall: 0.3759, F1_score: 0.4258, Average_Precision: 0.4027
2023-12-03 23:33:21,247 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:33:43,695 - INFO - Epoch(train)[70/100][40/100]lr: 3.0000e-04  eta: 0:28:37  time: 22.4476  inter_cls_loss: 0.0055 inner_cls_loss: 0.0079
2023-12-03 23:34:01,659 - INFO - Epoch(train)[70/100][80/100]lr: 3.0000e-04  eta: 0:25:25  time: 40.4112  inter_cls_loss: 0.0052 inner_cls_loss: 0.0069
2023-12-03 23:34:10,622 - INFO - Epoch(test) test/:
2023-12-03 23:34:19,254 - INFO - Metrics for ore-oil: Accuracy: 0.9930, Precision: 0.4400, Recall: 0.2292, F1_score: 0.3014, Average_Precision: 0.2566
2023-12-03 23:34:19,391 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6549, Recall: 0.5623, F1_score: 0.6051, Average_Precision: 0.5194
2023-12-03 23:34:19,529 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4329, Recall: 0.4765, F1_score: 0.4537, Average_Precision: 0.3592
2023-12-03 23:34:19,667 - INFO - Metrics for LawEnforce: Accuracy: 0.9998, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0062
2023-12-03 23:34:19,807 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6552, Recall: 0.5996, F1_score: 0.6262, Average_Precision: 0.5894
2023-12-03 23:34:19,950 - INFO - Metrics for Container: Accuracy: 0.9888, Precision: 0.6044, Recall: 0.5595, F1_score: 0.5811, Average_Precision: 0.5423
2023-12-03 23:34:20,090 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7639, Recall: 0.6347, F1_score: 0.6933, Average_Precision: 0.6247
2023-12-03 23:34:20,091 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5073, Recall: 0.4374, F1_score: 0.4658, Average_Precision: 0.4140
2023-12-03 23:34:24,334 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:34:47,153 - INFO - Epoch(train)[71/100][40/100]lr: 1.5000e-04  eta: 0:28:5  time: 22.7723  inter_cls_loss: 0.0082 inner_cls_loss: 0.0158
2023-12-03 23:35:03,842 - INFO - Epoch(train)[71/100][80/100]lr: 1.5000e-04  eta: 0:24:0  time: 39.4613  inter_cls_loss: 0.0022 inner_cls_loss: 0.0075
2023-12-03 23:35:13,483 - INFO - Epoch(test) test/:
2023-12-03 23:35:22,340 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.4772, Recall: 0.2789, F1_score: 0.3521, Average_Precision: 0.3065
2023-12-03 23:35:22,482 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6201, Recall: 0.5825, F1_score: 0.6007, Average_Precision: 0.5226
2023-12-03 23:35:22,620 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.4902, Recall: 0.3356, F1_score: 0.3984, Average_Precision: 0.3144
2023-12-03 23:35:22,757 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0134
2023-12-03 23:35:22,895 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.6975, Recall: 0.5701, F1_score: 0.6274, Average_Precision: 0.6175
2023-12-03 23:35:23,040 - INFO - Metrics for Container: Accuracy: 0.9889, Precision: 0.6053, Recall: 0.5852, F1_score: 0.5951, Average_Precision: 0.5507
2023-12-03 23:35:23,173 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7598, Recall: 0.6409, F1_score: 0.6953, Average_Precision: 0.6372
2023-12-03 23:35:23,174 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5214, Recall: 0.4276, F1_score: 0.4670, Average_Precision: 0.4232
2023-12-03 23:35:27,461 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:35:49,455 - INFO - Epoch(train)[72/100][40/100]lr: 1.5000e-04  eta: 0:26:12  time: 21.9918  inter_cls_loss: 0.0071 inner_cls_loss: 0.0089
2023-12-03 23:36:06,146 - INFO - Epoch(train)[72/100][80/100]lr: 1.5000e-04  eta: 0:22:43  time: 38.6827  inter_cls_loss: 0.0031 inner_cls_loss: 0.0053
2023-12-03 23:36:15,180 - INFO - Epoch(test) test/:
2023-12-03 23:36:23,939 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4354, Recall: 0.2731, F1_score: 0.3357, Average_Precision: 0.2763
2023-12-03 23:36:24,075 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6377, Recall: 0.5690, F1_score: 0.6014, Average_Precision: 0.5119
2023-12-03 23:36:24,212 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4545, Recall: 0.3020, F1_score: 0.3629, Average_Precision: 0.2918
2023-12-03 23:36:24,348 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0121
2023-12-03 23:36:24,486 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.6909, Recall: 0.5775, F1_score: 0.6291, Average_Precision: 0.6068
2023-12-03 23:36:24,627 - INFO - Metrics for Container: Accuracy: 0.9891, Precision: 0.6137, Recall: 0.5835, F1_score: 0.5982, Average_Precision: 0.5442
2023-12-03 23:36:24,759 - INFO - Metrics for foreground: Accuracy: 0.9844, Precision: 0.7624, Recall: 0.6460, F1_score: 0.6994, Average_Precision: 0.6233
2023-12-03 23:36:24,759 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5135, Recall: 0.4216, F1_score: 0.4610, Average_Precision: 0.4095
2023-12-03 23:36:29,052 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:36:51,467 - INFO - Epoch(train)[73/100][40/100]lr: 1.5000e-04  eta: 0:25:46  time: 22.4135  inter_cls_loss: 0.0027 inner_cls_loss: 0.0060
2023-12-03 23:37:08,131 - INFO - Epoch(train)[73/100][80/100]lr: 1.5000e-04  eta: 0:22:8  time: 39.0784  inter_cls_loss: 0.0034 inner_cls_loss: 0.0096
2023-12-03 23:37:16,830 - INFO - Epoch(test) test/:
2023-12-03 23:37:25,542 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.4589, Recall: 0.2650, F1_score: 0.3360, Average_Precision: 0.2679
2023-12-03 23:37:25,680 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6400, Recall: 0.5387, F1_score: 0.5850, Average_Precision: 0.5150
2023-12-03 23:37:25,822 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4758, Recall: 0.3960, F1_score: 0.4322, Average_Precision: 0.3204
2023-12-03 23:37:25,962 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0135
2023-12-03 23:37:26,105 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6618, Recall: 0.5886, F1_score: 0.6230, Average_Precision: 0.5980
2023-12-03 23:37:26,247 - INFO - Metrics for Container: Accuracy: 0.9887, Precision: 0.5992, Recall: 0.5737, F1_score: 0.5862, Average_Precision: 0.5416
2023-12-03 23:37:26,378 - INFO - Metrics for foreground: Accuracy: 0.9841, Precision: 0.7562, Recall: 0.6393, F1_score: 0.6928, Average_Precision: 0.6117
2023-12-03 23:37:26,379 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5131, Recall: 0.4288, F1_score: 0.4650, Average_Precision: 0.4097
2023-12-03 23:37:30,594 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:37:52,752 - INFO - Epoch(train)[74/100][40/100]lr: 1.5000e-04  eta: 0:24:33  time: 22.1572  inter_cls_loss: 0.0040 inner_cls_loss: 0.0057
2023-12-03 23:38:10,405 - INFO - Epoch(train)[74/100][80/100]lr: 1.5000e-04  eta: 0:21:43  time: 39.8106  inter_cls_loss: 0.0055 inner_cls_loss: 0.0065
2023-12-03 23:38:19,893 - INFO - Epoch(test) test/:
2023-12-03 23:38:28,639 - INFO - Metrics for ore-oil: Accuracy: 0.9921, Precision: 0.3721, Recall: 0.2928, F1_score: 0.3277, Average_Precision: 0.2561
2023-12-03 23:38:28,777 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6723, Recall: 0.5387, F1_score: 0.5981, Average_Precision: 0.5319
2023-12-03 23:38:28,914 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4750, Recall: 0.2550, F1_score: 0.3319, Average_Precision: 0.3027
2023-12-03 23:38:29,048 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0134
2023-12-03 23:38:29,186 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6660, Recall: 0.5849, F1_score: 0.6228, Average_Precision: 0.6015
2023-12-03 23:38:29,325 - INFO - Metrics for Container: Accuracy: 0.9891, Precision: 0.6148, Recall: 0.5731, F1_score: 0.5932, Average_Precision: 0.5435
2023-12-03 23:38:29,458 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7509, Recall: 0.6533, F1_score: 0.6987, Average_Precision: 0.6089
2023-12-03 23:38:29,458 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5073, Recall: 0.4140, F1_score: 0.4532, Average_Precision: 0.4083
2023-12-03 23:38:33,709 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:38:56,762 - INFO - Epoch(train)[75/100][40/100]lr: 1.5000e-04  eta: 0:24:35  time: 23.0486  inter_cls_loss: 0.0037 inner_cls_loss: 0.0060
2023-12-03 23:39:15,520 - INFO - Epoch(train)[75/100][80/100]lr: 1.5000e-04  eta: 0:21:57  time: 41.8106  inter_cls_loss: 0.0070 inner_cls_loss: 0.0070
2023-12-03 23:39:24,881 - INFO - Epoch(test) test/:
2023-12-03 23:39:33,773 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4229, Recall: 0.2859, F1_score: 0.3412, Average_Precision: 0.2611
2023-12-03 23:39:33,910 - INFO - Metrics for Cell-Container: Accuracy: 0.9981, Precision: 0.5769, Recall: 0.6061, F1_score: 0.5911, Average_Precision: 0.4527
2023-12-03 23:39:34,046 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.4957, Recall: 0.3893, F1_score: 0.4361, Average_Precision: 0.3294
2023-12-03 23:39:34,180 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0126
2023-12-03 23:39:34,318 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6618, Recall: 0.5812, F1_score: 0.6189, Average_Precision: 0.5925
2023-12-03 23:39:34,460 - INFO - Metrics for Container: Accuracy: 0.9894, Precision: 0.6350, Recall: 0.5573, F1_score: 0.5936, Average_Precision: 0.5428
2023-12-03 23:39:34,591 - INFO - Metrics for foreground: Accuracy: 0.9843, Precision: 0.7613, Recall: 0.6447, F1_score: 0.6982, Average_Precision: 0.6089
2023-12-03 23:39:34,591 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5077, Recall: 0.4378, F1_score: 0.4684, Average_Precision: 0.4000
2023-12-03 23:39:38,868 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:40:01,832 - INFO - Epoch(train)[76/100][40/100]lr: 1.5000e-04  eta: 0:23:32  time: 22.9620  inter_cls_loss: 0.0031 inner_cls_loss: 0.0075
2023-12-03 23:40:19,706 - INFO - Epoch(train)[76/100][80/100]lr: 1.5000e-04  eta: 0:20:35  time: 40.8382  inter_cls_loss: 0.0028 inner_cls_loss: 0.0105
2023-12-03 23:40:28,125 - INFO - Epoch(test) test/:
2023-12-03 23:40:36,719 - INFO - Metrics for ore-oil: Accuracy: 0.9925, Precision: 0.3932, Recall: 0.2535, F1_score: 0.3082, Average_Precision: 0.2627
2023-12-03 23:40:36,868 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6159, Recall: 0.5724, F1_score: 0.5934, Average_Precision: 0.4914
2023-12-03 23:40:37,009 - INFO - Metrics for Fishing: Accuracy: 0.9982, Precision: 0.3067, Recall: 0.4631, F1_score: 0.3690, Average_Precision: 0.2836
2023-12-03 23:40:37,147 - INFO - Metrics for LawEnforce: Accuracy: 0.9998, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0176
2023-12-03 23:40:37,286 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6329, Recall: 0.5756, F1_score: 0.6029, Average_Precision: 0.5765
2023-12-03 23:40:37,433 - INFO - Metrics for Container: Accuracy: 0.9884, Precision: 0.5836, Recall: 0.5775, F1_score: 0.5805, Average_Precision: 0.5428
2023-12-03 23:40:37,568 - INFO - Metrics for foreground: Accuracy: 0.9835, Precision: 0.7257, Recall: 0.6625, F1_score: 0.6927, Average_Precision: 0.6140
2023-12-03 23:40:37,568 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.4654, Recall: 0.4435, F1_score: 0.4495, Average_Precision: 0.3984
2023-12-03 23:40:41,818 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:41:04,418 - INFO - Epoch(train)[77/100][40/100]lr: 1.5000e-04  eta: 0:22:13  time: 22.5991  inter_cls_loss: 0.0088 inner_cls_loss: 0.0082
2023-12-03 23:41:20,590 - INFO - Epoch(train)[77/100][80/100]lr: 1.5000e-04  eta: 0:18:44  time: 38.7716  inter_cls_loss: 0.0026 inner_cls_loss: 0.0058
2023-12-03 23:41:29,307 - INFO - Epoch(test) test/:
2023-12-03 23:41:38,129 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4286, Recall: 0.2674, F1_score: 0.3293, Average_Precision: 0.2781
2023-12-03 23:41:38,276 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6391, Recall: 0.5724, F1_score: 0.6039, Average_Precision: 0.5173
2023-12-03 23:41:38,421 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4327, Recall: 0.3020, F1_score: 0.3557, Average_Precision: 0.2958
2023-12-03 23:41:38,562 - INFO - Metrics for LawEnforce: Accuracy: 0.9995, Precision: 0.0182, Recall: 0.0588, F1_score: 0.0278, Average_Precision: 0.0153
2023-12-03 23:41:38,700 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.7078, Recall: 0.5498, F1_score: 0.6189, Average_Precision: 0.5866
2023-12-03 23:41:38,842 - INFO - Metrics for Container: Accuracy: 0.9885, Precision: 0.5845, Recall: 0.5950, F1_score: 0.5897, Average_Precision: 0.5377
2023-12-03 23:41:38,978 - INFO - Metrics for foreground: Accuracy: 0.9840, Precision: 0.7455, Recall: 0.6547, F1_score: 0.6972, Average_Precision: 0.6139
2023-12-03 23:41:38,978 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5081, Recall: 0.4286, F1_score: 0.4603, Average_Precision: 0.4064
2023-12-03 23:41:43,249 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:42:05,881 - INFO - Epoch(train)[78/100][40/100]lr: 1.5000e-04  eta: 0:21:18  time: 22.6297  inter_cls_loss: 0.0017 inner_cls_loss: 0.0080
2023-12-03 23:42:22,954 - INFO - Epoch(train)[78/100][80/100]lr: 1.5000e-04  eta: 0:18:21  time: 39.7024  inter_cls_loss: 0.0022 inner_cls_loss: 0.0065
2023-12-03 23:42:32,182 - INFO - Epoch(test) test/:
2023-12-03 23:42:40,791 - INFO - Metrics for ore-oil: Accuracy: 0.9926, Precision: 0.4146, Recall: 0.3148, F1_score: 0.3579, Average_Precision: 0.2871
2023-12-03 23:42:40,929 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6179, Recall: 0.5825, F1_score: 0.5997, Average_Precision: 0.5084
2023-12-03 23:42:41,068 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4160, Recall: 0.3490, F1_score: 0.3796, Average_Precision: 0.3254
2023-12-03 23:42:41,208 - INFO - Metrics for LawEnforce: Accuracy: 0.9995, Precision: 0.0204, Recall: 0.0588, F1_score: 0.0303, Average_Precision: 0.0146
2023-12-03 23:42:41,344 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6245, Recall: 0.6107, F1_score: 0.6175, Average_Precision: 0.5936
2023-12-03 23:42:41,484 - INFO - Metrics for Container: Accuracy: 0.9892, Precision: 0.6224, Recall: 0.5622, F1_score: 0.5908, Average_Precision: 0.5422
2023-12-03 23:42:41,617 - INFO - Metrics for foreground: Accuracy: 0.9840, Precision: 0.7411, Recall: 0.6598, F1_score: 0.6981, Average_Precision: 0.6116
2023-12-03 23:42:41,618 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.4938, Recall: 0.4483, F1_score: 0.4677, Average_Precision: 0.4118
2023-12-03 23:42:45,885 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:43:08,028 - INFO - Epoch(train)[79/100][40/100]lr: 1.5000e-04  eta: 0:19:55  time: 22.1429  inter_cls_loss: 0.0020 inner_cls_loss: 0.0051
2023-12-03 23:43:25,728 - INFO - Epoch(train)[79/100][80/100]lr: 1.5000e-04  eta: 0:17:35  time: 39.8425  inter_cls_loss: 0.0033 inner_cls_loss: 0.0046
2023-12-03 23:43:33,918 - INFO - Epoch(test) test/:
2023-12-03 23:43:42,818 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.4579, Recall: 0.2894, F1_score: 0.3546, Average_Precision: 0.2872
2023-12-03 23:43:42,956 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.7018, Recall: 0.5387, F1_score: 0.6095, Average_Precision: 0.5275
2023-12-03 23:43:43,094 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4630, Recall: 0.3356, F1_score: 0.3891, Average_Precision: 0.3303
2023-12-03 23:43:43,233 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0129
2023-12-03 23:43:43,379 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6907, Recall: 0.5480, F1_score: 0.6111, Average_Precision: 0.5901
2023-12-03 23:43:43,529 - INFO - Metrics for Container: Accuracy: 0.9893, Precision: 0.6238, Recall: 0.5775, F1_score: 0.5998, Average_Precision: 0.5433
2023-12-03 23:43:43,670 - INFO - Metrics for foreground: Accuracy: 0.9845, Precision: 0.7743, Recall: 0.6331, F1_score: 0.6966, Average_Precision: 0.6329
2023-12-03 23:43:43,670 - INFO - Average metrics: Accuracy: 0.9944, Precision: 0.5302, Recall: 0.4175, F1_score: 0.4658, Average_Precision: 0.4178
2023-12-03 23:43:47,974 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:44:10,634 - INFO - Epoch(train)[80/100][40/100]lr: 1.5000e-04  eta: 0:19:26  time: 22.6554  inter_cls_loss: 0.0026 inner_cls_loss: 0.0036
2023-12-03 23:44:27,577 - INFO - Epoch(train)[80/100][80/100]lr: 1.5000e-04  eta: 0:16:39  time: 39.6023  inter_cls_loss: 0.0019 inner_cls_loss: 0.0016
2023-12-03 23:44:36,267 - INFO - Epoch(test) test/:
2023-12-03 23:44:45,148 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4432, Recall: 0.3113, F1_score: 0.3657, Average_Precision: 0.3088
2023-12-03 23:44:45,286 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6277, Recall: 0.5791, F1_score: 0.6025, Average_Precision: 0.5140
2023-12-03 23:44:45,422 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.3945, Recall: 0.2886, F1_score: 0.3333, Average_Precision: 0.3018
2023-12-03 23:44:45,557 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0128
2023-12-03 23:44:45,691 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.6920, Recall: 0.5720, F1_score: 0.6263, Average_Precision: 0.5878
2023-12-03 23:44:45,831 - INFO - Metrics for Container: Accuracy: 0.9890, Precision: 0.6073, Recall: 0.5884, F1_score: 0.5977, Average_Precision: 0.5407
2023-12-03 23:44:45,963 - INFO - Metrics for foreground: Accuracy: 0.9838, Precision: 0.7411, Recall: 0.6496, F1_score: 0.6923, Average_Precision: 0.6122
2023-12-03 23:44:45,964 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5008, Recall: 0.4270, F1_score: 0.4597, Average_Precision: 0.4112
2023-12-03 23:44:50,247 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:45:12,464 - INFO - Epoch(train)[81/100][40/100]lr: 1.5000e-04  eta: 0:18:6  time: 22.1693  inter_cls_loss: 0.0034 inner_cls_loss: 0.0030
2023-12-03 23:45:29,866 - INFO - Epoch(train)[81/100][80/100]lr: 1.5000e-04  eta: 0:15:49  time: 39.5710  inter_cls_loss: 0.0066 inner_cls_loss: 0.0126
2023-12-03 23:45:38,576 - INFO - Epoch(test) test/:
2023-12-03 23:45:47,248 - INFO - Metrics for ore-oil: Accuracy: 0.9919, Precision: 0.3661, Recall: 0.3275, F1_score: 0.3458, Average_Precision: 0.2403
2023-12-03 23:45:47,384 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.7027, Recall: 0.5253, F1_score: 0.6012, Average_Precision: 0.5263
2023-12-03 23:45:47,520 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.5063, Recall: 0.2685, F1_score: 0.3509, Average_Precision: 0.2962
2023-12-03 23:45:47,657 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0149
2023-12-03 23:45:47,791 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6355, Recall: 0.6144, F1_score: 0.6248, Average_Precision: 0.6006
2023-12-03 23:45:47,931 - INFO - Metrics for Container: Accuracy: 0.9886, Precision: 0.5946, Recall: 0.5781, F1_score: 0.5862, Average_Precision: 0.5412
2023-12-03 23:45:48,065 - INFO - Metrics for foreground: Accuracy: 0.9833, Precision: 0.7202, Recall: 0.6650, F1_score: 0.6915, Average_Precision: 0.6045
2023-12-03 23:45:48,065 - INFO - Average metrics: Accuracy: 0.9940, Precision: 0.5036, Recall: 0.4255, F1_score: 0.4572, Average_Precision: 0.4034
2023-12-03 23:45:52,291 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:46:14,323 - INFO - Epoch(train)[82/100][40/100]lr: 1.5000e-04  eta: 0:17:4  time: 22.0297  inter_cls_loss: 0.0023 inner_cls_loss: 0.0032
2023-12-03 23:46:30,920 - INFO - Epoch(train)[82/100][80/100]lr: 1.5000e-04  eta: 0:14:38  time: 38.6289  inter_cls_loss: 0.0140 inner_cls_loss: 0.0063
2023-12-03 23:46:39,941 - INFO - Epoch(test) test/:
2023-12-03 23:46:48,557 - INFO - Metrics for ore-oil: Accuracy: 0.9926, Precision: 0.4171, Recall: 0.3056, F1_score: 0.3527, Average_Precision: 0.3094
2023-12-03 23:46:48,694 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6269, Recall: 0.5657, F1_score: 0.5947, Average_Precision: 0.5043
2023-12-03 23:46:48,830 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4455, Recall: 0.3289, F1_score: 0.3784, Average_Precision: 0.3184
2023-12-03 23:46:48,967 - INFO - Metrics for LawEnforce: Accuracy: 0.9995, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0132
2023-12-03 23:46:49,106 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6306, Recall: 0.6015, F1_score: 0.6157, Average_Precision: 0.5928
2023-12-03 23:46:49,249 - INFO - Metrics for Container: Accuracy: 0.9889, Precision: 0.6030, Recall: 0.5846, F1_score: 0.5937, Average_Precision: 0.5474
2023-12-03 23:46:49,383 - INFO - Metrics for foreground: Accuracy: 0.9836, Precision: 0.7297, Recall: 0.6623, F1_score: 0.6943, Average_Precision: 0.6072
2023-12-03 23:46:49,383 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.4932, Recall: 0.4355, F1_score: 0.4614, Average_Precision: 0.4132
2023-12-03 23:46:53,642 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:47:15,708 - INFO - Epoch(train)[83/100][40/100]lr: 1.5000e-04  eta: 0:16:10  time: 22.0636  inter_cls_loss: 0.0029 inner_cls_loss: 0.0031
2023-12-03 23:47:32,617 - INFO - Epoch(train)[83/100][80/100]lr: 1.5000e-04  eta: 0:13:57  time: 38.9746  inter_cls_loss: 0.0035 inner_cls_loss: 0.0045
2023-12-03 23:47:42,187 - INFO - Epoch(test) test/:
2023-12-03 23:47:51,041 - INFO - Metrics for ore-oil: Accuracy: 0.9927, Precision: 0.4182, Recall: 0.3079, F1_score: 0.3547, Average_Precision: 0.2789
2023-12-03 23:47:51,180 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6364, Recall: 0.5657, F1_score: 0.5989, Average_Precision: 0.5557
2023-12-03 23:47:51,316 - INFO - Metrics for Fishing: Accuracy: 0.9989, Precision: 0.4872, Recall: 0.2550, F1_score: 0.3348, Average_Precision: 0.3008
2023-12-03 23:47:51,450 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0000, Recall: 0.0000, F1_score: 0.0000, Average_Precision: 0.0103
2023-12-03 23:47:51,587 - INFO - Metrics for Dredger: Accuracy: 0.9968, Precision: 0.6233, Recall: 0.5923, F1_score: 0.6074, Average_Precision: 0.5764
2023-12-03 23:47:51,730 - INFO - Metrics for Container: Accuracy: 0.9889, Precision: 0.6060, Recall: 0.5775, F1_score: 0.5914, Average_Precision: 0.5276
2023-12-03 23:47:51,863 - INFO - Metrics for foreground: Accuracy: 0.9836, Precision: 0.7368, Recall: 0.6490, F1_score: 0.6901, Average_Precision: 0.5998
2023-12-03 23:47:51,864 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.5011, Recall: 0.4210, F1_score: 0.4539, Average_Precision: 0.4071
2023-12-03 23:47:56,080 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:48:18,207 - INFO - Epoch(train)[84/100][40/100]lr: 1.5000e-04  eta: 0:15:18  time: 22.1266  inter_cls_loss: 0.0024 inner_cls_loss: 0.0020
2023-12-03 23:48:35,623 - INFO - Epoch(train)[84/100][80/100]lr: 1.5000e-04  eta: 0:13:20  time: 39.5423  inter_cls_loss: 0.0047 inner_cls_loss: 0.0033
2023-12-03 23:48:44,332 - INFO - Epoch(test) test/:
2023-12-03 23:48:53,301 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4308, Recall: 0.2882, F1_score: 0.3454, Average_Precision: 0.2853
2023-12-03 23:48:53,442 - INFO - Metrics for Cell-Container: Accuracy: 0.9983, Precision: 0.6384, Recall: 0.5825, F1_score: 0.6092, Average_Precision: 0.5335
2023-12-03 23:48:53,584 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4239, Recall: 0.2617, F1_score: 0.3237, Average_Precision: 0.2720
2023-12-03 23:48:53,726 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0345, Recall: 0.0588, F1_score: 0.0435, Average_Precision: 0.0183
2023-12-03 23:48:53,871 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6372, Recall: 0.6125, F1_score: 0.6246, Average_Precision: 0.5873
2023-12-03 23:48:54,020 - INFO - Metrics for Container: Accuracy: 0.9888, Precision: 0.6012, Recall: 0.5852, F1_score: 0.5931, Average_Precision: 0.5413
2023-12-03 23:48:54,160 - INFO - Metrics for foreground: Accuracy: 0.9837, Precision: 0.7379, Recall: 0.6528, F1_score: 0.6928, Average_Precision: 0.6129
2023-12-03 23:48:54,161 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5006, Recall: 0.4345, F1_score: 0.4617, Average_Precision: 0.4072
2023-12-03 23:48:58,418 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:49:21,307 - INFO - Epoch(train)[85/100][40/100]lr: 1.5000e-04  eta: 0:14:52  time: 22.8886  inter_cls_loss: 0.0031 inner_cls_loss: 0.0100
2023-12-03 23:49:37,953 - INFO - Epoch(train)[85/100][80/100]lr: 1.5000e-04  eta: 0:12:31  time: 39.5310  inter_cls_loss: 0.0108 inner_cls_loss: 0.0063
2023-12-03 23:49:46,725 - INFO - Epoch(test) test/:
2023-12-03 23:49:55,343 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.4879, Recall: 0.2789, F1_score: 0.3549, Average_Precision: 0.3071
2023-12-03 23:49:55,481 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6654, Recall: 0.5960, F1_score: 0.6288, Average_Precision: 0.5418
2023-12-03 23:49:55,613 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4205, Recall: 0.2483, F1_score: 0.3122, Average_Precision: 0.2622
2023-12-03 23:49:55,744 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0444, Recall: 0.1176, F1_score: 0.0645, Average_Precision: 0.0231
2023-12-03 23:49:55,877 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6605, Recall: 0.5923, F1_score: 0.6245, Average_Precision: 0.5884
2023-12-03 23:49:56,013 - INFO - Metrics for Container: Accuracy: 0.9894, Precision: 0.6331, Recall: 0.5726, F1_score: 0.6013, Average_Precision: 0.5564
2023-12-03 23:49:56,145 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7661, Recall: 0.6285, F1_score: 0.6905, Average_Precision: 0.6264
2023-12-03 23:49:56,146 - INFO - Average metrics: Accuracy: 0.9944, Precision: 0.5254, Recall: 0.4335, F1_score: 0.4681, Average_Precision: 0.4151
2023-12-03 23:50:00,283 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:50:23,842 - INFO - Epoch(train)[86/100][40/100]lr: 1.5000e-04  eta: 0:14:19  time: 23.5561  inter_cls_loss: 0.0036 inner_cls_loss: 0.0058
2023-12-03 23:50:40,571 - INFO - Epoch(train)[86/100][80/100]lr: 1.5000e-04  eta: 0:11:55  time: 40.2873  inter_cls_loss: 0.0038 inner_cls_loss: 0.0073
2023-12-03 23:50:49,550 - INFO - Epoch(test) test/:
2023-12-03 23:50:58,077 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4367, Recall: 0.3194, F1_score: 0.3690, Average_Precision: 0.3188
2023-12-03 23:50:58,214 - INFO - Metrics for Cell-Container: Accuracy: 0.9981, Precision: 0.5904, Recall: 0.5825, F1_score: 0.5864, Average_Precision: 0.5443
2023-12-03 23:50:58,350 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3830, Recall: 0.3624, F1_score: 0.3724, Average_Precision: 0.3075
2023-12-03 23:50:58,488 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0256, Recall: 0.0588, F1_score: 0.0357, Average_Precision: 0.0221
2023-12-03 23:50:58,627 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6293, Recall: 0.6015, F1_score: 0.6151, Average_Precision: 0.5881
2023-12-03 23:50:58,770 - INFO - Metrics for Container: Accuracy: 0.9896, Precision: 0.6444, Recall: 0.5579, F1_score: 0.5980, Average_Precision: 0.5517
2023-12-03 23:50:58,905 - INFO - Metrics for foreground: Accuracy: 0.9839, Precision: 0.7460, Recall: 0.6469, F1_score: 0.6929, Average_Precision: 0.6251
2023-12-03 23:50:58,905 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.4936, Recall: 0.4471, F1_score: 0.4671, Average_Precision: 0.4225
2023-12-03 23:51:03,152 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:51:26,372 - INFO - Epoch(train)[87/100][40/100]lr: 1.5000e-04  eta: 0:13:9  time: 23.2196  inter_cls_loss: 0.0039 inner_cls_loss: 0.0042
2023-12-03 23:51:43,839 - INFO - Epoch(train)[87/100][80/100]lr: 1.5000e-04  eta: 0:11:11  time: 40.6845  inter_cls_loss: 0.0018 inner_cls_loss: 0.0023
2023-12-03 23:51:52,307 - INFO - Epoch(test) test/:
2023-12-03 23:52:00,993 - INFO - Metrics for ore-oil: Accuracy: 0.9924, Precision: 0.3994, Recall: 0.3102, F1_score: 0.3492, Average_Precision: 0.2803
2023-12-03 23:52:01,136 - INFO - Metrics for Cell-Container: Accuracy: 0.9982, Precision: 0.6157, Recall: 0.5825, F1_score: 0.5986, Average_Precision: 0.5633
2023-12-03 23:52:01,278 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3356, Recall: 0.3356, F1_score: 0.3356, Average_Precision: 0.2855
2023-12-03 23:52:01,419 - INFO - Metrics for LawEnforce: Accuracy: 0.9995, Precision: 0.0400, Recall: 0.1176, F1_score: 0.0597, Average_Precision: 0.0209
2023-12-03 23:52:01,559 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6360, Recall: 0.5867, F1_score: 0.6104, Average_Precision: 0.5809
2023-12-03 23:52:01,708 - INFO - Metrics for Container: Accuracy: 0.9882, Precision: 0.5729, Recall: 0.6070, F1_score: 0.5895, Average_Precision: 0.5425
2023-12-03 23:52:01,847 - INFO - Metrics for foreground: Accuracy: 0.9828, Precision: 0.6991, Recall: 0.6785, F1_score: 0.6886, Average_Precision: 0.5852
2023-12-03 23:52:01,847 - INFO - Average metrics: Accuracy: 0.9938, Precision: 0.4712, Recall: 0.4597, F1_score: 0.4616, Average_Precision: 0.4084
2023-12-03 23:52:06,113 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:52:28,030 - INFO - Epoch(train)[88/100][40/100]lr: 1.5000e-04  eta: 0:11:30  time: 21.9169  inter_cls_loss: 0.0018 inner_cls_loss: 0.0021
2023-12-03 23:52:45,002 - INFO - Epoch(train)[88/100][80/100]lr: 1.5000e-04  eta: 0:9:53  time: 38.8868  inter_cls_loss: 0.0022 inner_cls_loss: 0.0028
2023-12-03 23:52:53,610 - INFO - Epoch(test) test/:
2023-12-03 23:53:02,213 - INFO - Metrics for ore-oil: Accuracy: 0.9926, Precision: 0.4135, Recall: 0.2905, F1_score: 0.3413, Average_Precision: 0.2770
2023-12-03 23:53:02,362 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6745, Recall: 0.5791, F1_score: 0.6232, Average_Precision: 0.5741
2023-12-03 23:53:02,505 - INFO - Metrics for Fishing: Accuracy: 0.9985, Precision: 0.3554, Recall: 0.3960, F1_score: 0.3746, Average_Precision: 0.2755
2023-12-03 23:53:02,647 - INFO - Metrics for LawEnforce: Accuracy: 0.9995, Precision: 0.0577, Recall: 0.1765, F1_score: 0.0870, Average_Precision: 0.0292
2023-12-03 23:53:02,790 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6605, Recall: 0.5886, F1_score: 0.6224, Average_Precision: 0.6081
2023-12-03 23:53:02,935 - INFO - Metrics for Container: Accuracy: 0.9881, Precision: 0.5699, Recall: 0.5961, F1_score: 0.5827, Average_Precision: 0.5458
2023-12-03 23:53:03,073 - INFO - Metrics for foreground: Accuracy: 0.9832, Precision: 0.7143, Recall: 0.6714, F1_score: 0.6922, Average_Precision: 0.5939
2023-12-03 23:53:03,074 - INFO - Average metrics: Accuracy: 0.9939, Precision: 0.4923, Recall: 0.4712, F1_score: 0.4748, Average_Precision: 0.4148
2023-12-03 23:53:07,330 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:53:29,982 - INFO - Epoch(train)[89/100][40/100]lr: 1.5000e-04  eta: 0:10:56  time: 22.6513  inter_cls_loss: 0.0042 inner_cls_loss: 0.0045
2023-12-03 23:53:48,813 - INFO - Epoch(train)[89/100][80/100]lr: 1.5000e-04  eta: 0:9:40  time: 41.4825  inter_cls_loss: 0.0026 inner_cls_loss: 0.0017
2023-12-03 23:53:57,255 - INFO - Epoch(test) test/:
2023-12-03 23:54:06,155 - INFO - Metrics for ore-oil: Accuracy: 0.9922, Precision: 0.3868, Recall: 0.3264, F1_score: 0.3540, Average_Precision: 0.3067
2023-12-03 23:54:06,292 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6530, Recall: 0.5892, F1_score: 0.6195, Average_Precision: 0.5635
2023-12-03 23:54:06,429 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3782, Recall: 0.3960, F1_score: 0.3869, Average_Precision: 0.3312
2023-12-03 23:54:06,567 - INFO - Metrics for LawEnforce: Accuracy: 0.9994, Precision: 0.0411, Recall: 0.1765, F1_score: 0.0667, Average_Precision: 0.0350
2023-12-03 23:54:06,706 - INFO - Metrics for Dredger: Accuracy: 0.9973, Precision: 0.7455, Recall: 0.5295, F1_score: 0.6192, Average_Precision: 0.5970
2023-12-03 23:54:06,851 - INFO - Metrics for Container: Accuracy: 0.9896, Precision: 0.6601, Recall: 0.5131, F1_score: 0.5774, Average_Precision: 0.5450
2023-12-03 23:54:06,990 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7667, Recall: 0.6287, F1_score: 0.6909, Average_Precision: 0.6306
2023-12-03 23:54:06,990 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5188, Recall: 0.4513, F1_score: 0.4735, Average_Precision: 0.4299
2023-12-03 23:54:11,301 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:54:11,356 - INFO - Best model saved to  work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 6d83516b25c831b5af4886a0f5f9d47d, with test/ image AP 0.4299
2023-12-03 23:54:34,700 - INFO - Epoch(train)[90/100][40/100]lr: 1.5000e-04  eta: 0:10:18  time: 23.3438  inter_cls_loss: 0.0085 inner_cls_loss: 0.0050
2023-12-03 23:54:53,650 - INFO - Epoch(train)[90/100][80/100]lr: 1.5000e-04  eta: 0:8:59  time: 42.2916  inter_cls_loss: 0.0034 inner_cls_loss: 0.0022
2023-12-03 23:55:03,131 - INFO - Epoch(test) test/:
2023-12-03 23:55:11,893 - INFO - Metrics for ore-oil: Accuracy: 0.9930, Precision: 0.4436, Recall: 0.2870, F1_score: 0.3486, Average_Precision: 0.3031
2023-12-03 23:55:12,034 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6933, Recall: 0.5556, F1_score: 0.6168, Average_Precision: 0.5740
2023-12-03 23:55:12,177 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4159, Recall: 0.3154, F1_score: 0.3588, Average_Precision: 0.3073
2023-12-03 23:55:12,321 - INFO - Metrics for LawEnforce: Accuracy: 0.9998, Precision: 0.0909, Recall: 0.0588, F1_score: 0.0714, Average_Precision: 0.0406
2023-12-03 23:55:12,465 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6968, Recall: 0.5258, F1_score: 0.5994, Average_Precision: 0.5644
2023-12-03 23:55:12,611 - INFO - Metrics for Container: Accuracy: 0.9885, Precision: 0.5859, Recall: 0.5901, F1_score: 0.5880, Average_Precision: 0.5398
2023-12-03 23:55:12,746 - INFO - Metrics for foreground: Accuracy: 0.9841, Precision: 0.7540, Recall: 0.6469, F1_score: 0.6963, Average_Precision: 0.6167
2023-12-03 23:55:12,746 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5258, Recall: 0.4257, F1_score: 0.4685, Average_Precision: 0.4208
2023-12-03 23:55:17,000 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:55:39,119 - INFO - Epoch(train)[91/100][40/100]lr: 7.5000e-05  eta: 0:8:49  time: 22.0715  inter_cls_loss: 0.0024 inner_cls_loss: 0.0023
2023-12-03 23:55:56,255 - INFO - Epoch(train)[91/100][80/100]lr: 7.5000e-05  eta: 0:7:30  time: 39.2070  inter_cls_loss: 0.0040 inner_cls_loss: 0.0068
2023-12-03 23:56:04,703 - INFO - Epoch(test) test/:
2023-12-03 23:56:13,446 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4348, Recall: 0.3009, F1_score: 0.3557, Average_Precision: 0.2925
2023-12-03 23:56:13,583 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6692, Recall: 0.5926, F1_score: 0.6286, Average_Precision: 0.5735
2023-12-03 23:56:13,724 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3924, Recall: 0.4161, F1_score: 0.4039, Average_Precision: 0.3434
2023-12-03 23:56:13,866 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0800, Recall: 0.1176, F1_score: 0.0952, Average_Precision: 0.0363
2023-12-03 23:56:14,009 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6535, Recall: 0.6089, F1_score: 0.6304, Average_Precision: 0.5781
2023-12-03 23:56:14,156 - INFO - Metrics for Container: Accuracy: 0.9887, Precision: 0.5937, Recall: 0.5983, F1_score: 0.5960, Average_Precision: 0.5401
2023-12-03 23:56:14,293 - INFO - Metrics for foreground: Accuracy: 0.9836, Precision: 0.7267, Recall: 0.6666, F1_score: 0.6953, Average_Precision: 0.5955
2023-12-03 23:56:14,293 - INFO - Average metrics: Accuracy: 0.9941, Precision: 0.5072, Recall: 0.4716, F1_score: 0.4864, Average_Precision: 0.4228
2023-12-03 23:56:18,555 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:56:42,116 - INFO - Epoch(train)[92/100][40/100]lr: 7.5000e-05  eta: 0:8:26  time: 23.5600  inter_cls_loss: 0.0096 inner_cls_loss: 0.0069
2023-12-03 23:57:00,718 - INFO - Epoch(train)[92/100][80/100]lr: 7.5000e-05  eta: 0:7:12  time: 42.1600  inter_cls_loss: 0.0035 inner_cls_loss: 0.0039
2023-12-03 23:57:10,714 - INFO - Epoch(test) test/:
2023-12-03 23:57:19,812 - INFO - Metrics for ore-oil: Accuracy: 0.9933, Precision: 0.4828, Recall: 0.2928, F1_score: 0.3646, Average_Precision: 0.2990
2023-12-03 23:57:19,953 - INFO - Metrics for Cell-Container: Accuracy: 0.9985, Precision: 0.7155, Recall: 0.5758, F1_score: 0.6381, Average_Precision: 0.5842
2023-12-03 23:57:20,096 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4062, Recall: 0.3490, F1_score: 0.3755, Average_Precision: 0.2776
2023-12-03 23:57:20,237 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0571, Recall: 0.1176, F1_score: 0.0769, Average_Precision: 0.0313
2023-12-03 23:57:20,381 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6688, Recall: 0.5849, F1_score: 0.6240, Average_Precision: 0.5676
2023-12-03 23:57:20,530 - INFO - Metrics for Container: Accuracy: 0.9889, Precision: 0.6017, Recall: 0.6037, F1_score: 0.6027, Average_Precision: 0.5503
2023-12-03 23:57:20,671 - INFO - Metrics for foreground: Accuracy: 0.9840, Precision: 0.7455, Recall: 0.6523, F1_score: 0.6958, Average_Precision: 0.6063
2023-12-03 23:57:20,671 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5254, Recall: 0.4537, F1_score: 0.4825, Average_Precision: 0.4166
2023-12-03 23:57:25,029 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:57:48,272 - INFO - Epoch(train)[93/100][40/100]lr: 7.5000e-05  eta: 0:7:21  time: 23.2420  inter_cls_loss: 0.0018 inner_cls_loss: 0.0035
2023-12-03 23:58:05,959 - INFO - Epoch(train)[93/100][80/100]lr: 7.5000e-05  eta: 0:6:8  time: 40.9271  inter_cls_loss: 0.0034 inner_cls_loss: 0.0032
2023-12-03 23:58:15,911 - INFO - Epoch(test) test/:
2023-12-03 23:58:24,783 - INFO - Metrics for ore-oil: Accuracy: 0.9931, Precision: 0.4599, Recall: 0.2986, F1_score: 0.3621, Average_Precision: 0.3165
2023-12-03 23:58:24,926 - INFO - Metrics for Cell-Container: Accuracy: 0.9985, Precision: 0.7004, Recall: 0.6061, F1_score: 0.6498, Average_Precision: 0.5755
2023-12-03 23:58:25,073 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4098, Recall: 0.3356, F1_score: 0.3690, Average_Precision: 0.2922
2023-12-03 23:58:25,220 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0625, Recall: 0.1176, F1_score: 0.0816, Average_Precision: 0.0280
2023-12-03 23:58:25,365 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6542, Recall: 0.5793, F1_score: 0.6145, Average_Precision: 0.5604
2023-12-03 23:58:25,513 - INFO - Metrics for Container: Accuracy: 0.9889, Precision: 0.6015, Recall: 0.5933, F1_score: 0.5974, Average_Precision: 0.5461
2023-12-03 23:58:25,654 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7481, Recall: 0.6587, F1_score: 0.7006, Average_Precision: 0.6001
2023-12-03 23:58:25,655 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5195, Recall: 0.4556, F1_score: 0.4821, Average_Precision: 0.4170
2023-12-03 23:58:30,050 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:58:53,332 - INFO - Epoch(train)[94/100][40/100]lr: 7.5000e-05  eta: 0:6:24  time: 23.2787  inter_cls_loss: 0.0038 inner_cls_loss: 0.0023
2023-12-03 23:59:10,445 - INFO - Epoch(train)[94/100][80/100]lr: 7.5000e-05  eta: 0:5:13  time: 40.3936  inter_cls_loss: 0.0023 inner_cls_loss: 0.0018
2023-12-03 23:59:18,758 - INFO - Epoch(test) test/:
2023-12-03 23:59:27,497 - INFO - Metrics for ore-oil: Accuracy: 0.9930, Precision: 0.4496, Recall: 0.2894, F1_score: 0.3521, Average_Precision: 0.3131
2023-12-03 23:59:27,639 - INFO - Metrics for Cell-Container: Accuracy: 0.9985, Precision: 0.7102, Recall: 0.5859, F1_score: 0.6421, Average_Precision: 0.5885
2023-12-03 23:59:27,780 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4434, Recall: 0.3154, F1_score: 0.3686, Average_Precision: 0.2956
2023-12-03 23:59:27,924 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0769, Recall: 0.1765, F1_score: 0.1071, Average_Precision: 0.0553
2023-12-03 23:59:28,071 - INFO - Metrics for Dredger: Accuracy: 0.9971, Precision: 0.6766, Recall: 0.5867, F1_score: 0.6285, Average_Precision: 0.5790
2023-12-03 23:59:28,224 - INFO - Metrics for Container: Accuracy: 0.9889, Precision: 0.6023, Recall: 0.5977, F1_score: 0.6000, Average_Precision: 0.5385
2023-12-03 23:59:28,370 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7498, Recall: 0.6552, F1_score: 0.6994, Average_Precision: 0.6077
2023-12-03 23:59:28,371 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5298, Recall: 0.4581, F1_score: 0.4854, Average_Precision: 0.4254
2023-12-03 23:59:32,788 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-03 23:59:55,811 - INFO - Epoch(train)[95/100][40/100]lr: 7.5000e-05  eta: 0:5:22  time: 23.0221  inter_cls_loss: 0.0030 inner_cls_loss: 0.0020
2023-12-04 00:00:13,100 - INFO - Epoch(train)[95/100][80/100]lr: 7.5000e-05  eta: 0:4:22  time: 40.3111  inter_cls_loss: 0.0027 inner_cls_loss: 0.0030
2023-12-04 00:00:27,334 - INFO - Epoch(test) test/:
2023-12-04 00:00:36,161 - INFO - Metrics for ore-oil: Accuracy: 0.9930, Precision: 0.4536, Recall: 0.2940, F1_score: 0.3567, Average_Precision: 0.3071
2023-12-04 00:00:36,301 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6401, Recall: 0.6229, F1_score: 0.6314, Average_Precision: 0.5718
2023-12-04 00:00:36,441 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4122, Recall: 0.3624, F1_score: 0.3857, Average_Precision: 0.3269
2023-12-04 00:00:36,579 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0833, Recall: 0.1765, F1_score: 0.1132, Average_Precision: 0.0536
2023-12-04 00:00:36,719 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6358, Recall: 0.5959, F1_score: 0.6152, Average_Precision: 0.5797
2023-12-04 00:00:36,863 - INFO - Metrics for Container: Accuracy: 0.9890, Precision: 0.6097, Recall: 0.5857, F1_score: 0.5974, Average_Precision: 0.5409
2023-12-04 00:00:36,999 - INFO - Metrics for foreground: Accuracy: 0.9841, Precision: 0.7448, Recall: 0.6609, F1_score: 0.7004, Average_Precision: 0.5983
2023-12-04 00:00:36,999 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5114, Recall: 0.4712, F1_score: 0.4857, Average_Precision: 0.4255
2023-12-04 00:00:41,295 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-04 00:01:04,093 - INFO - Epoch(train)[96/100][40/100]lr: 7.5000e-05  eta: 0:4:22  time: 22.7945  inter_cls_loss: 0.0017 inner_cls_loss: 0.0016
2023-12-04 00:01:21,827 - INFO - Epoch(train)[96/100][80/100]lr: 7.5000e-05  eta: 0:3:32  time: 40.5275  inter_cls_loss: 0.0038 inner_cls_loss: 0.0034
2023-12-04 00:01:31,067 - INFO - Epoch(test) test/:
2023-12-04 00:01:39,722 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4399, Recall: 0.2963, F1_score: 0.3541, Average_Precision: 0.3149
2023-12-04 00:01:39,867 - INFO - Metrics for Cell-Container: Accuracy: 0.9985, Precision: 0.6944, Recall: 0.5892, F1_score: 0.6375, Average_Precision: 0.5888
2023-12-04 00:01:40,013 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4206, Recall: 0.3020, F1_score: 0.3516, Average_Precision: 0.2792
2023-12-04 00:01:40,159 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.1026, Recall: 0.2353, F1_score: 0.1429, Average_Precision: 0.0646
2023-12-04 00:01:40,303 - INFO - Metrics for Dredger: Accuracy: 0.9972, Precision: 0.6826, Recall: 0.5793, F1_score: 0.6267, Average_Precision: 0.5705
2023-12-04 00:01:40,452 - INFO - Metrics for Container: Accuracy: 0.9890, Precision: 0.6085, Recall: 0.5939, F1_score: 0.6011, Average_Precision: 0.5389
2023-12-04 00:01:40,593 - INFO - Metrics for foreground: Accuracy: 0.9840, Precision: 0.7478, Recall: 0.6523, F1_score: 0.6968, Average_Precision: 0.5978
2023-12-04 00:01:40,593 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5281, Recall: 0.4640, F1_score: 0.4872, Average_Precision: 0.4221
2023-12-04 00:01:44,912 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-04 00:02:07,637 - INFO - Epoch(train)[97/100][40/100]lr: 7.5000e-05  eta: 0:3:24  time: 22.7242  inter_cls_loss: 0.0008 inner_cls_loss: 0.0012
2023-12-04 00:02:24,790 - INFO - Epoch(train)[97/100][80/100]lr: 7.5000e-05  eta: 0:2:39  time: 39.8779  inter_cls_loss: 0.0008 inner_cls_loss: 0.0014
2023-12-04 00:02:38,142 - INFO - Epoch(test) test/:
2023-12-04 00:02:47,153 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4324, Recall: 0.2998, F1_score: 0.3541, Average_Precision: 0.2986
2023-12-04 00:02:47,300 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6519, Recall: 0.5926, F1_score: 0.6208, Average_Precision: 0.5747
2023-12-04 00:02:47,447 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4474, Recall: 0.3423, F1_score: 0.3878, Average_Precision: 0.2991
2023-12-04 00:02:47,593 - INFO - Metrics for LawEnforce: Accuracy: 0.9997, Precision: 0.0938, Recall: 0.1765, F1_score: 0.1224, Average_Precision: 0.0350
2023-12-04 00:02:47,743 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6268, Recall: 0.6292, F1_score: 0.6280, Average_Precision: 0.5942
2023-12-04 00:02:47,899 - INFO - Metrics for Container: Accuracy: 0.9890, Precision: 0.6082, Recall: 0.5939, F1_score: 0.6009, Average_Precision: 0.5351
2023-12-04 00:02:48,044 - INFO - Metrics for foreground: Accuracy: 0.9841, Precision: 0.7395, Recall: 0.6690, F1_score: 0.7025, Average_Precision: 0.5933
2023-12-04 00:02:48,044 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5143, Recall: 0.4719, F1_score: 0.4881, Average_Precision: 0.4186
2023-12-04 00:02:52,413 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-04 00:03:16,112 - INFO - Epoch(train)[98/100][40/100]lr: 7.5000e-05  eta: 0:2:34  time: 23.6983  inter_cls_loss: 0.0017 inner_cls_loss: 0.0021
2023-12-04 00:03:33,173 - INFO - Epoch(train)[98/100][80/100]lr: 7.5000e-05  eta: 0:1:52  time: 40.7587  inter_cls_loss: 0.0021 inner_cls_loss: 0.0022
2023-12-04 00:03:42,949 - INFO - Epoch(test) test/:
2023-12-04 00:03:51,646 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4408, Recall: 0.3102, F1_score: 0.3641, Average_Precision: 0.3126
2023-12-04 00:03:51,795 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6731, Recall: 0.5892, F1_score: 0.6284, Average_Precision: 0.5872
2023-12-04 00:03:51,947 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4343, Recall: 0.2886, F1_score: 0.3468, Average_Precision: 0.2858
2023-12-04 00:03:52,097 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0769, Recall: 0.1765, F1_score: 0.1071, Average_Precision: 0.0542
2023-12-04 00:03:52,251 - INFO - Metrics for Dredger: Accuracy: 0.9970, Precision: 0.6557, Recall: 0.5904, F1_score: 0.6214, Average_Precision: 0.5640
2023-12-04 00:03:52,406 - INFO - Metrics for Container: Accuracy: 0.9892, Precision: 0.6166, Recall: 0.5890, F1_score: 0.6025, Average_Precision: 0.5380
2023-12-04 00:03:52,547 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7491, Recall: 0.6566, F1_score: 0.6998, Average_Precision: 0.5938
2023-12-04 00:03:52,547 - INFO - Average metrics: Accuracy: 0.9943, Precision: 0.5209, Recall: 0.4572, F1_score: 0.4814, Average_Precision: 0.4194
2023-12-04 00:03:56,938 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-04 00:04:20,038 - INFO - Epoch(train)[99/100][40/100]lr: 7.5000e-05  eta: 0:1:32  time: 23.0974  inter_cls_loss: 0.0067 inner_cls_loss: 0.0090
2023-12-04 00:04:36,780 - INFO - Epoch(train)[99/100][80/100]lr: 7.5000e-05  eta: 0:0:59  time: 39.8414  inter_cls_loss: 0.0034 inner_cls_loss: 0.0030
2023-12-04 00:04:45,904 - INFO - Epoch(test) test/:
2023-12-04 00:04:54,569 - INFO - Metrics for ore-oil: Accuracy: 0.9929, Precision: 0.4395, Recall: 0.2859, F1_score: 0.3464, Average_Precision: 0.2926
2023-12-04 00:04:54,707 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6718, Recall: 0.5859, F1_score: 0.6259, Average_Precision: 0.5779
2023-12-04 00:04:54,846 - INFO - Metrics for Fishing: Accuracy: 0.9987, Precision: 0.4262, Recall: 0.3490, F1_score: 0.3838, Average_Precision: 0.2810
2023-12-04 00:04:54,984 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0952, Recall: 0.2353, F1_score: 0.1356, Average_Precision: 0.0343
2023-12-04 00:04:55,129 - INFO - Metrics for Dredger: Accuracy: 0.9969, Precision: 0.6275, Recall: 0.5904, F1_score: 0.6084, Average_Precision: 0.5548
2023-12-04 00:04:55,272 - INFO - Metrics for Container: Accuracy: 0.9889, Precision: 0.6004, Recall: 0.6037, F1_score: 0.6021, Average_Precision: 0.5329
2023-12-04 00:04:55,406 - INFO - Metrics for foreground: Accuracy: 0.9839, Precision: 0.7360, Recall: 0.6636, F1_score: 0.6979, Average_Precision: 0.5839
2023-12-04 00:04:55,407 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5138, Recall: 0.4734, F1_score: 0.4857, Average_Precision: 0.4082
2023-12-04 00:04:59,693 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-04 00:05:22,585 - INFO - Epoch(train)[100/100][40/100]lr: 7.5000e-05  eta: 0:0:34  time: 22.8919  inter_cls_loss: 0.0015 inner_cls_loss: 0.0015
2023-12-04 00:05:39,880 - INFO - Epoch(train)[100/100][80/100]lr: 7.5000e-05  eta: 0:0:10  time: 40.1868  inter_cls_loss: 0.0037 inner_cls_loss: 0.0069
2023-12-04 00:05:49,165 - INFO - Epoch(test) test/:
2023-12-04 00:05:57,536 - INFO - Metrics for ore-oil: Accuracy: 0.9928, Precision: 0.4327, Recall: 0.3275, F1_score: 0.3729, Average_Precision: 0.3105
2023-12-04 00:05:57,698 - INFO - Metrics for Cell-Container: Accuracy: 0.9985, Precision: 0.6794, Recall: 0.5993, F1_score: 0.6369, Average_Precision: 0.5689
2023-12-04 00:05:57,859 - INFO - Metrics for Fishing: Accuracy: 0.9988, Precision: 0.4545, Recall: 0.3020, F1_score: 0.3629, Average_Precision: 0.2523
2023-12-04 00:05:58,023 - INFO - Metrics for LawEnforce: Accuracy: 0.9996, Precision: 0.0638, Recall: 0.1765, F1_score: 0.0937, Average_Precision: 0.0997
2023-12-04 00:05:58,186 - INFO - Metrics for Dredger: Accuracy: 0.9968, Precision: 0.6137, Recall: 0.6273, F1_score: 0.6204, Average_Precision: 0.5392
2023-12-04 00:05:58,349 - INFO - Metrics for Container: Accuracy: 0.9892, Precision: 0.6193, Recall: 0.5808, F1_score: 0.5994, Average_Precision: 0.5323
2023-12-04 00:05:58,501 - INFO - Metrics for foreground: Accuracy: 0.9839, Precision: 0.7379, Recall: 0.6647, F1_score: 0.6994, Average_Precision: 0.5819
2023-12-04 00:05:58,501 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5145, Recall: 0.4683, F1_score: 0.4837, Average_Precision: 0.4121
2023-12-04 00:06:02,900 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-04 00:06:02,916 - INFO - Last model saved :work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_last_model_weight.pth
2023-12-04 00:06:02,985 - INFO - model weights saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 6d83516b25c831b5af4886a0f5f9d47d!
2023-12-04 00:06:03,018 - INFO - model weights loaded from work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch.pth with MD5 6d83516b25c831b5af4886a0f5f9d47d!
2023-12-04 00:06:03,018 - INFO - Epoch(test) test/:
2023-12-04 00:06:11,059 - INFO - Metrics for ore-oil: Accuracy: 0.9922, Precision: 0.3868, Recall: 0.3264, F1_score: 0.3540, Average_Precision: 0.3067
2023-12-04 00:06:11,197 - INFO - Metrics for Cell-Container: Accuracy: 0.9984, Precision: 0.6530, Recall: 0.5892, F1_score: 0.6195, Average_Precision: 0.5635
2023-12-04 00:06:11,338 - INFO - Metrics for Fishing: Accuracy: 0.9986, Precision: 0.3782, Recall: 0.3960, F1_score: 0.3869, Average_Precision: 0.3312
2023-12-04 00:06:11,475 - INFO - Metrics for LawEnforce: Accuracy: 0.9994, Precision: 0.0411, Recall: 0.1765, F1_score: 0.0667, Average_Precision: 0.0350
2023-12-04 00:06:11,611 - INFO - Metrics for Dredger: Accuracy: 0.9973, Precision: 0.7455, Recall: 0.5295, F1_score: 0.6192, Average_Precision: 0.5970
2023-12-04 00:06:11,750 - INFO - Metrics for Container: Accuracy: 0.9896, Precision: 0.6601, Recall: 0.5131, F1_score: 0.5774, Average_Precision: 0.5450
2023-12-04 00:06:11,885 - INFO - Metrics for foreground: Accuracy: 0.9842, Precision: 0.7667, Recall: 0.6287, F1_score: 0.6909, Average_Precision: 0.6306
2023-12-04 00:06:11,886 - INFO - Average metrics: Accuracy: 0.9942, Precision: 0.5188, Recall: 0.4513, F1_score: 0.4735, Average_Precision: 0.4299
2023-12-04 00:06:16,160 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval.png:
2023-12-04 00:06:16,178 - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2023-12-04 00:06:16,523 - INFO - PR_curve has been saved to work_dirs/srsdd_SuperPoint+Boost-F-attlay3_100_best_model_weights_scratch_PR_curve_eval_6d835.png!
